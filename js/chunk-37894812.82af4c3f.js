(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37894812","chunk-0b9f2357"],{"1e20":function(e,t,n){!function(t,a){e.exports=a(n("b64b"),n("4e82"),n("9911"),n("159b"),n("4de4"),n("99af"),n("ac1f"),n("1276"),n("5319"),n("a9e3"),n("466d"),n("fb6a"),n("d3b7"),n("2b0e"),n("fd87"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("e439"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p){"use strict";function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=f(p);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e){return"object"===g(e)&&null!==e&&e.constructor&&e.constructor===Object}function w(){for(var e=Object(arguments.length<=0?void 0:arguments[0]),t=1;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(n)for(var a=Object.keys(Object(n)),i=0;i<a.length;i++){var o=a[i],s=Object.getOwnPropertyDescriptor(n,o);s&&s.enumerable&&(k(e[o])&&k(n[o])?w(e[o],n[o]):!k(e[o])&&k(n[o])?(e[o]={},w(e[o],n[o])):e[o]=n[o])}}return e}"object"!==("undefined"==typeof Int8Array?"undefined":g(Int8Array))&&(m.default.prototype.$isServer||document.childNodes);var C={data:function(){return{searchResult:{},selectList:{},selectConfig:{},filterSortConfig:{},resultDealStatus:!1,searchFilterDefaultData:void 0,_searchFilterConfig:void 0}},methods:{beforeSearchChange:function(){return!0},beforeTableChange:function(){return!0},tableChange:function(e,t,n){console.log("tableChange 接收到事件改变：",e,t,n);var a=Object.keys(e).length;if(a){if(e.current!==this.pagination.current)return void this.loadTableData(e);if(e.pageSize!==this.pagination.pageSize)return e.current=1,this.pagination.pageSize=e.pageSize,this.handleSelectedClear&&this.handleSelectedClear(),void this.loadTableData(e)}if(!this.beforeTableChange||this.beforeTableChange(e,t,n)){a?e.current===this.pagination.current&&e.pageSize===this.pagination.pageSize&&(e.current=1):e=b(b({},this.pagination),{},{current:1});var i=n.columnKey,o=n.order,s=Object.prototype.hasOwnProperty.call(this.searchResult,"sort");o?s?this.searchResult.sort="ascend"===o?this.filterSortConfig[i]:0-this.filterSortConfig[i]:this.searchResult=b(b({},this.searchResult),{},{sortField:this.filterSortConfig[i]||i,sortType:"ascend"===o?"asc":"desc"}):s?this.searchResult.sort=void 0:this.searchResult=b(b({},this.searchResult),{},{sortField:void 0,sortType:void 0}),this.loadTableData(e)}},searchResultDeal:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log("searchResultDeal 接收到条件变化：",e,t),this.beforeSearchChange(e)){var n=this._resetSearchFilterDefaultData()._getFilterConfig(e);n.deal=t;var a=n.data;n.rows;var i=n.config,o=n.dataType,s=n.columnsName;if("all"===i[e.config.columnsName||e.config.resultName]||this.selectConfig[e.config.columnsName||e.config.resultName]){if("all"===i.resultName&&"delete"===i.status)return this._searchFilterClearAll(e),this.pagination&&(this.pagination.current=1),this.loadTableData(),this;"array"===o&&(a[0]||a[1]||(a=void 0,console.warn("请注意 ".concat(s," 中组件返回的 data 全是空值。")))),null==a||""===a?this._deleteValue():("string"===o||"number"===o?this._dealDataForSingle():"array"===o?this._dealDataForArray():"object"===o?this._dealDataForObject():console.log("啥也不是"),this.selectList=b({},this.selectList),this.pagination&&(this.pagination.current=1),!t&&this.loadTableData()),this._searchFilterClearRef(e)}else console.error("当前没有配置 selectConfig：",e.config.columnsName||e.config.resultName,"，请注意检查 selectConfig 和对应的 dom 节点是否配置正确！")}},_getFilterConfig:function(e){var t,n=e.data,a=e.rows,i=e.config,o=this,s=i.columnsName||i.resultName,r=w(o.searchFilterDefaultData,this.selectConfig[s]);return console.log("合并后的内容：",r,o.searchFilterDefaultData),o._searchFilterConfig={data:n,rows:a,config:i,dataType:(t=n,"[object Null]"===Object.prototype.toString.call(t)?"null":"[object Object]"===Object.prototype.toString.call(t)?"object":"[object Array]"===Object.prototype.toString.call(t)?"array":"[object Undefined]"===Object.prototype.toString.call(t)?"undefined":"[object String]"===Object.prototype.toString.call(t)?"string":"[object Number]"===Object.prototype.toString.call(t)?"number":void 0),columnsName:s,selectList:o.selectList,selectConfig:r,dataCallback:o.selectConfig[s].setText,valueCallback:o.selectConfig[s].setValue,deal:!1,linkMode:r.linkMode||"before",linkType:g(r.link),link:r.link||"-",valueLink:r.valueLink||","},o._searchFilterConfig},_getActValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=this._searchFilterConfig.selectConfig,i="data"===e?a.dataTarget||"data":a.valueTarget||"data",o="data"===e?a.dataKey:a.valueKey,s="data"===i?t:n;return o?s[o]:s},_checkValueCallback:function(){var e=this._searchFilterConfig,t=e.data,n=e.rows,a=e.valueCallback;if(!a)return!0;a.call(this,{data:t,rows:n})},_deleteSelect:function(e){this.$delete(this.selectList,e)},_updateSelect:function(e,t){console.log(e),this.$set(this.selectList,[e],t)},_deleteValue:function(){var e=this,t=this,n=this._searchFilterConfig,a=n.selectConfig,i=n.columnsName,o=n.deal;a.en?(this._checkValueCallback()&&a.en.forEach((function(t){e.searchResult[t]=void 0})),t._deleteSelect(i)):(this._checkValueCallback()&&(this.searchResult[i]=void 0),t._deleteSelect(i)),t.pagination?o||t.loadTableData(b(b({},t.pagination),{},{current:1})):!o&&t.loadTableData()},_dealDataForSingle:function(){var e=this,t=e._searchFilterConfig,n=t.data,a=t.rows,i=t.selectConfig,o=t.columnsName,s=t.dataCallback,r=t.config,l=i.en[0]||o;e._checkValueCallback()&&(this.searchResult[l]=e._getActValue("value",n,a[0]||a)),i.cn.forEach((function(t){e._updateSelect(o,{key:o,label:t,value:s?s({data:n,rows:a}):e._getActValue("data",n,a[0]||a),type:r.type||""})}))},_dealDataForArray:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.linkMode,c=n.linkType,u=n.link,d=n.valueLink,h=n.config,p=s.en,f=s.cn.length>1,m=a.filter((function(e){return!!e})),g="";a.forEach((function(n,o){f&&p.length===a.length?n?(t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])),e._updateSelect(p[o],{key:p[o],label:s.cn[o],value:r?r({data:a,rows:i}):e._getActValue("data",a[o],i[o]),type:h.type||""})):(e._deleteSelect(p[o]),t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)):n?(p.length===a.length?t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])):t._checkValueCallback()&&(e.searchResult[p[0]]=e.searchResult[p[0]]?"".concat(e.searchResult[p[0]]).concat(d||",").concat(e._getActValue("value",a[o],i[o])):e.searchResult[p[0]],s.valueLink||(console.error("请注意设置 valueLink 连词，否则将会导致错误。"),console.error("请注意 searchResult.".concat(s.en[o]," 的值为： ").concat(e.searchResult[s.en[o]],"。")))),r||("string"===c?g=g?"".concat(g).concat(u).concat(t._getActValue("data",a[o],i[o])):t._getActValue("data",a[o],i[o]):1===m.length?(console.log("处理只有一个值的情况"),g=t._getActValue("data",a[o],i[o])):g=a.length-1===o?"".concat(g).concat(u[o]).concat(t._getActValue("data",a[o],i[o])).concat(u[o+1]):"after"===l?"".concat(t._getActValue("data",a[o],i[o])).concat(u[o]):"".concat(u[o]).concat(t._getActValue("data",a[o],i[o])))):t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)})),f&&p.length===a.length||(this.selectList[o]={key:o,label:s.cn[0],value:r?r({data:a,rows:i}):g,type:h.type||""})},_dealDataForObject:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.config;s.cn.forEach((function(n,c){i[c]?(e._checkValueCallback()&&(e.searchResult[s.en[c]]=t._getActValue("value",a,i[c])),e.selectList[o]={key:o,label:n,value:r?r({data:a,rows:i}):t._getActValue("data",a,i[c]),type:l.type||""}):(t._checkValueCallback()&&(e.searchResult[s.en[c]]=void 0),e._deleteSelect(o))}))},_searchFilterClearAll:function(){var e=this;for(var t in this.selectConfig)if(Object.prototype.hasOwnProperty.call(this.selectConfig,t)){var n=this.selectConfig[t].setValue;n?n.call(this):this.selectConfig[t].en.forEach((function(t){e.searchResult[t]=void 0}))}this.$refs.moreSearch&&this.$refs.moreSearch.resetData("all");try{for(var a in this.selectConfig)if(this.selectConfig.hasOwnProperty(a)){var i=this.selectConfig[a].ref;this.$refs["".concat(i||a,"O")]&&this.$refs["".concat(i||a,"O")].resetData(),this.$refs["".concat(i||a,"H")]&&this.$refs["".concat(i||a,"H")].resetData()}}catch(e){console.error("错误预警：",e)}},_searchFilterClearRef:function(e){console.log("清空它的对手：",e);try{var t=e.config.columnsName||e.config.resultName,n=e.config.type,a=this.selectConfig[t].ref;"filterDown"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):"operation"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),e.config.props&&e.config.props.confirm()}catch(e){console.error("错误预警：",e)}},_resetSearchFilterDefaultData:function(){return this.searchFilterDefaultData={cn:[],en:[],link:"",valueLink:"",dataKey:"",valueKey:"",dataTarget:"",valueTarget:"",linkMode:"",setText:void 0,setValue:void 0},this},moreSearchResultDeal:function(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;n++)this.searchResultDeal(e[t[n]],n!==t.length-1)}}};return C}))},2418:function(e,t,n){n("cca6");var a=n("428f");e.exports=a.Object.assign},"25f0":function(e,t,n){"use strict";var a=n("e330"),i=n("5e77").PROPER,o=n("6eeb"),s=n("825a"),r=n("3a9b"),l=n("577e"),c=n("d039"),u=n("ad6d"),d="toString",h=RegExp.prototype,p=h[d],f=a(u),m=c((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),g=i&&p.name!=d;(m||g)&&o(RegExp.prototype,d,(function(){var e=s(this),t=l(e.source),n=e.flags,a=l(void 0===n&&r(h,e)&&!("flags"in h)?f(e):n);return"/"+t+"/"+a}),{unsafe:!0})},"2ca0":function(e,t,n){"use strict";var a=n("23e7"),i=n("e330"),o=n("06cf").f,s=n("50c4"),r=n("577e"),l=n("5a34"),c=n("1d80"),u=n("ab13"),d=n("c430"),h=i("".startsWith),p=i("".slice),f=Math.min,m=u("startsWith"),g=!d&&!m&&!!function(){var e=o(String.prototype,"startsWith");return e&&!e.writable}();a({target:"String",proto:!0,forced:!g&&!m},{startsWith:function(e){var t=r(c(this));l(e);var n=s(f(arguments.length>1?arguments[1]:void 0,t.length)),a=r(e);return h?h(t,a,n):p(t,n,n+a.length)===a}})},"4e82":function(e,t,n){"use strict";var a=n("23e7"),i=n("e330"),o=n("59ed"),s=n("7b0b"),r=n("07fa"),l=n("577e"),c=n("d039"),u=n("addb"),d=n("a640"),h=n("04d1"),p=n("d998"),f=n("2d00"),m=n("512ce"),g=[],v=i(g.sort),y=i(g.push),b=c((function(){g.sort(void 0)})),k=c((function(){g.sort(null)})),w=d("sort"),C=!c((function(){if(f)return f<70;if(!(h&&h>3)){if(p)return!0;if(m)return m<603;var e,t,n,a,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)g.push({k:t+a,v:n})}for(g.sort((function(e,t){return t.v-e.v})),a=0;a<g.length;a++)t=g[a].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),_=b||!k||!w||!C,S=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:l(t)>l(n)?1:-1}};a({target:"Array",proto:!0,forced:_},{sort:function(e){void 0!==e&&o(e);var t=s(this);if(C)return void 0===e?v(t):v(t,e);var n,a,i=[],l=r(t);for(a=0;a<l;a++)a in t&&y(i,t[a]);u(i,S(e)),n=i.length,a=0;while(a<n)t[a]=i[a++];while(a<l)delete t[a++];return t}})},"4ec9":function(e,t,n){"use strict";var a=n("6d61"),i=n("6566");a("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"4fad":function(e,t,n){var a=n("d039"),i=n("861d"),o=n("c6b6"),s=n("d86b"),r=Object.isExtensible,l=a((function(){r(1)}));e.exports=l||s?function(e){return!!i(e)&&((!s||"ArrayBuffer"!=o(e))&&(!r||r(e)))}:r},"58e8":function(e,t,n){!function(t,a){e.exports=a(n("99af"),n("159b"),n("caad"),n("2532"),n("4de4"))}(0,(function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function a(e){for(var a=1;a<arguments.length;a++){var i=null!=arguments[a]?arguments[a]:{};a%2?n(Object(i),!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var i={data:function(){var e=this;return{tableData:[],selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"},pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(t){return"总".concat(t,"条，每页显示").concat(e.pagination.pageSize,"条")}},selectionConfig:{selections:!0},tableSelection:{onChange:null,onSelect:null,onSelectAll:null,onSelectInvert:null,currentPage:null,allPage:null},resultMap:{},searchResult:{}}},computed:{selectOnIndeterminate:function(){return"allPage"===this.selectionContent.selectType&&!!this.selectionContent.noSelectedRowKeys.length&&!!this.selectionContent.selectedRowKeys.length},hasOverSelectionLimit:function(){return this.selectionLimit&&this.selectionContent.selectedRowKeys.length>=this.selectionLimit},rowSelection:function(){var e=this,t=this;return a(a({},t.selectionContent.rowSelection),{},{selectedRowKeys:t.selectionContent.selectedRowKeys,onChange:function(e,n){var a;console.log("onChange selectedRowKeys",e),console.log("onChange selectedRows",n);var i=t.selectionContent.primaryKey;if("allPage"===t.selectionContent.selectType&&!e.length)return t.selectionContent.selectType="",void t.handleSelectedClear();if(t.selectionLimit&&e.length>t.selectionLimit)t.$message.warning("最多选择".concat(t.selectionLimit,"条"));else{t.selectionContent.selectedRowKeys=e;var o=t.selectionContent.noSelectedRows,s=t.selectionContent.selectedRows,r=!1;t.tableData.forEach((function(n){e.includes(n[i])?("allPage"===t.selectionContent.selectType&&(r=!0,delete o[n[i]]),s[n[i]]=n):("allPage"===t.selectionContent.selectType&&(r=!0,o[n[i]]=n),delete s[n[i]])})),t.selectionContent.noSelectedRows=o,t.selectionContent.selectedRows=s,"allPage"===t.selectionContent.selectType&&r&&t._generateNoSelectKey();for(var l=arguments.length,c=new Array(l>2?l-2:0),u=2;u<l;u++)c[u-2]=arguments[u];t.tableSelection.onChange&&(a=t.tableSelection).onChange.apply(a,[e,n].concat(c))}},onSelect:function(e,n,a,i){t.tableSelection.onSelect&&t.tableSelection.onSelect(e,n,a,i)},onSelectAll:function(e,n,a){t.tableSelection.onSelectAll&&t.tableSelection.onSelectAll(e,n,a)},onSelectInvert:function(e){t.tableSelection.onSelectInvert&&t.tableSelection.onSelectInvert(e)},hideDefaultSelections:!0,selections:!!t.selectionConfig.selections&&[{key:"currentPage",text:"当前页",onSelect:function(n){"allPage"===t.selectionContent.selectType&&t.handleSelectedClear(),t.selectionContent.selectType="currentPage";var a=t.selectionContent.primaryKey,i=[],o=[];t.tableData.forEach((function(e){t.selectionContent.selectedRowKeys.includes(e[a])?i.push(e):o.push(e)}));var s=e.selectionContent.selectedRows;if((i.length&&o.length||!i.length)&&o.forEach((function(e){s[e[a]]=e})),!o.length){var r=t.selectionContent.selectedRows;i.forEach((function(e){delete r[e[a]]}))}t.selectionContent.selectedRows=s,t._generateKey()}},{key:"allPage",text:"所有页",onSelect:function(e){if("allPage"===t.selectionContent.selectType&&(t.selectionContent.selectedRowKeys.length||t.selectionContent.noSelectedRowKeys.length))t.handleSelectedClear();else{t.selectionContent.selectType="allPage";var n=t.selectionContent.primaryKey;t.tableData.forEach((function(e){t.selectionContent.selectedRows[e[n]]=e}))}t._generateKey()}}]})}},methods:{setPagination:function(e){this.pagination=a({total:0,pageSize:10,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["5","10","20"],showTotal:function(e){return"总".concat(e,"条")}},e)},setRowSelection:function(e){this.selectionContent.rowSelection=e},dealSelectionCheckBox:function(){var e=this;"allPage"===this.selectionContent.selectType&&(this.tableData.forEach((function(t){try{e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]||e.selectionContent.noSelectedRows[t[e.selectionContent.primaryKey]]||(e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]=t)}catch(e){console.log(e)}})),this._generateKey())},_generateKey:function(){var e=[];for(var t in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.selectedRowKeys=e},_generateNoSelectKey:function(){var e=[];for(var t in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.noSelectedRowKeys=e},handleSelectedClear:function(){return this.selectionContent.selectedRowKeys=[],this.selectionContent.selectedRows={},this.selectionContent.noSelectedRowKeys=[],this.selectionContent.noSelectedRows=[],this.selectionContent.selectType="",this},getRowData:function(e){var t=[];if(e)for(var n in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(n)&&t.push(this.selectionContent.noSelectedRows[n]);else for(var a in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(a)&&t.push(this.selectionContent.selectedRows[a]);return t},setTableSelectType:function(e){this.selectionContent.selectType=e,this.handleSelectedClear()},setSelectRows:function(e){var t=this;e.forEach((function(e){t.selectionContent.selectedRows[e[t.selectionContent.primaryKey]]=e}))},setSelectionStatus:function(e){this.selectionConfig.selections=e},rowClick:function(e){var n=this;if(console.log("单击",e),this.multiple)if(this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key]))this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(t){return t!==e[n.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]];else{if(this.hasOverSelectionLimit)return void this.$message.warning("最多选择".concat(this.selectionLimit,"条"));this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e}else this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=t({},e[this.baseReplaceFields.key],e)},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||this.hasOverSelectionLimit||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.handleOk&&this.handleOk()},dealResult:function(){var n=this;if(this.rules)for(var i in this.rules)if(this.rules.hasOwnProperty(i)){var o=this.rules[i];"object"===e(o)?(this.$refs[this.resultMap[i].ref]&&this.$refs[this.resultMap[i].ref].setData(o),this.resultMap[i]?this.searchResult[this.resultMap[i].key]=o.id:this.searchResult[i]=o.id,this.disabled[i]=!!o.disabled):this.resultMap[i]?this.searchResult[this.resultMap[i].key]=o:this.searchResult[i]=o}return this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(e){n.selectionContent.selectedRowKeys.push(e[n.baseReplaceFields.key]),n.selectionContent.selectedRows=a(a({},n.selectionContent.selectedRows),{},t({},e[n.baseReplaceFields.key],e))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=t({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this}}};return i}))},6566:function(e,t,n){"use strict";var a=n("9bf2").f,i=n("7c73"),o=n("e2cc"),s=n("0366"),r=n("19aa"),l=n("2266"),c=n("7dd0"),u=n("2626"),d=n("83ab"),h=n("f183").fastKey,p=n("69f3"),f=p.set,m=p.getterFor;e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,a){r(e,p),f(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=a&&l(a,e[c],{that:e,AS_ENTRIES:n})})),p=u.prototype,g=m(t),v=function(e,t,n){var a,i,o=g(e),s=y(e,t);return s?s.value=n:(o.last=s={index:i=h(t,!0),key:t,value:n,previous:a=o.last,next:void 0,removed:!1},o.first||(o.first=s),a&&(a.next=s),d?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},y=function(e,t){var n,a=g(e),i=h(t);if("F"!==i)return a.index[i];for(n=a.first;n;n=n.next)if(n.key==t)return n};return o(p,{clear:function(){var e=this,t=g(e),n=t.index,a=t.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete n[a.index],a=a.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,n=g(t),a=y(t,e);if(a){var i=a.next,o=a.previous;delete n.index[a.index],a.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==a&&(n.first=i),n.last==a&&(n.last=o),d?n.size--:t.size--}return!!a},forEach:function(e){var t,n=g(this),a=s(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:n.first){a(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!y(this,e)}}),o(p,n?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),d&&a(p,"size",{get:function(){return g(this).size}}),u},setStrong:function(e,t,n){var a=t+" Iterator",i=m(t),o=m(a);c(e,t,(function(e,t){f(this,{type:a,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=o(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},6968:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("a9e3"),n("caad"),n("159b"),n("2532"))}(0,(function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=[{id:0,name:"草稿"},{id:1,name:"已过账"},{id:3,name:"已红冲"}],n={0:t[0],1:t[1],2:t[2]},a=[{id:0,name:"未支付"},{id:1,name:"部分支付"},{id:2,name:"已支付"}],i={0:a[0],1:a[1]},o=[{id:1,name:"库存高于上限"},{id:2,name:"库存低于下限"},{id:3,name:"有货"},{id:4,name:"缺货"}],s={0:i[0],1:i[1]},r=[{id:5,name:"ERP草稿",color:"#52C41A"},{id:1,name:"已过账",color:"#52C41A"},{id:4,name:"ERP删除",color:"#BBBBBB"},{id:2,name:"草稿",color:"#52C41A"},{id:3,name:"已红冲",color:"#F5222D"},{id:0,name:"未同步",color:"#378EFB"}],l=[{id:0,name:"已下架"},{id:1,name:"已上架"}],c=[{id:1,name:"应收调整"},{id:2,name:"应付调整"}],u=[{id:0,name:"草稿"},{id:1,name:"盘点完成"}],d=[{id:0,name:"全部"},{id:1,name:"采购入库"},{id:2,name:"退货入库"},{id:3,name:"盘盈入库"},{id:4,name:"其它入库"},{id:5,name:"销售出库"},{id:6,name:"采购退货"},{id:7,name:"盘亏出库"},{id:8,name:"采购入库"},{id:9,name:"其它出库"},{id:10,name:"同价调拨入库"},{id:11,name:"同价调拨出库"},{id:12,name:"撤销出库"},{id:13,name:"进销存同步"},{id:14,name:"撤销退货"},{id:15,name:"退货单取消"},{id:16,name:"订货单取消"}],h=[{id:-1,name:"已取消",key:"canceled",btnKeys:["detail","del","share","print","export","copy"]},{id:0,name:"草稿",key:"draft",btnKeys:["detail","submit","submit_audit","del","share","print","export","copy"]},{id:1,name:"待审核",key:"to_audit",btnKeys:["detail","audit","cancel_bill","share","print","export","copy"]},{id:2,name:"待出库",key:"to_stock_removal",btnKeys:["detail","stock_removal","auditee","cancel_bill","share","print","export","copy"]},{id:3,name:"部分出库",key:"portion_stock_removal",btnKeys:["detail","stock_removal","suspend_bill","share","print","export","copy"]},{id:4,name:"待发货",key:"to_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:5,name:"部分发货",key:"portion_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:6,name:"待收货",key:"to_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:7,name:"部分收货",key:"portion_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:8,name:"已完成",key:"finish",btnKeys:["detail","share","print","export","copy"]},{id:9,name:"已中止",key:"suspend",btnKeys:["detail","share","print","export","copy"]}],p=[{id:1,name:"已打印"},{id:0,name:"未打印"}],f=[{id:0,name:"PC端代开"},{id:1,name:"企业微信代开"},{id:2,name:"小程序商城"},{id:3,name:"巡店"},{id:4,name:"Excel导入"}],m=[{id:1,name:"买赠"},{id:2,name:"秒杀"},{id:3,name:"特价"},{id:4,name:"订单促销"},{id:5,name:"组合促销"},{id:6,name:"一口价"},{id:7,name:"拼团"},{id:8,name:"优惠券"},{id:9,name:"分销"}],g=[{id:0,name:"不开发票"},{id:1,name:"普通发票"},{id:2,name:"增值税发票"}],v=Object.freeze({__proto__:null,billStatus:{0:{name:"草稿",color:"#378EFB",icon:"iconcaogao"},1:{name:"已过账",color:"#52C41A",icon:"iconyiguozhang",stocktakingName:"盘点完成",stocktakingIcon:"icon_stocktaking_completed"},3:{name:"已红冲",color:"#F5222D",icon:"iconyihongchong"}},payStockSync:[{id:2,name:"ERP草稿",color:"#52c41a"},{id:3,name:"已过账",color:"#52c41a"},{id:4,name:"ERP删除",color:"#bbbbbb"},{id:5,name:"同步失败",color:"#f5222d"},{id:0,name:"未同步",color:"#378efb"}],payStockSyncMap:{0:{name:"未同步",color:"#378efb"},2:{name:"ERP草稿",color:"#52c41a"},3:{name:"已过账",color:"#52c41a"},4:{name:"ERP删除",color:"#bbbbbb"},5:{name:"同步失败",color:"#f5222d"}},inStockMap:[{id:0,name:"盘盈入库"},{id:2,name:"其它入库"}],outStockMap:[{id:1,name:"盘亏出库"},{id:3,name:"其它出库"}],orderStatus:t,orderStatusMap:n,paymentStatus:a,paymentStatusMap:i,stockStatus:o,stockStatusMap:s,stockSync:r,stockSyncMap:{},saleStatus:l,modeOfPayment:[{id:0,name:"线下支付"},{id:1,name:"银行卡转账"}],exchangePayment:c,stockBillStatus:u,stockInAndOut:d,accountType:[{id:0,name:"微信账户"},{id:1,name:"预付款账户"},{id:2,name:"现金账户"},{id:3,name:"银行卡账户"}],saleOrderStatus:h,printStatus:p,billSource:f,marketingType:m,invoiceType:g}),y="/gateway/goodsservice/api/v1/",b="".concat(y,"price_system/leve_price_name/select_list"),k="".concat(y,"setting/query_goods_attr_setting_list"),w="".concat("/gateway/logisticsservice/api/v1/","deliveryMethod/list");function C(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const _=C({},void 0,{name:"DMixSelect",props:{value:{type:[String,Number,Array],default:void 0},resultName:{type:String,default:""},type:{type:Number,default:0},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},width:{type:[String,Number],default:120},list:{type:Array,default:null},exclude:{type:Array,default:function(){return[]}},mode:{type:String,default:"select"},getPopupContainer:{type:Function,default:function(){return document.querySelector(".mix-select")}}},data:function(){return{actValue:void 0,options:[],selectLoading:!1}},computed:{modalPlaceholder:function(){return this.placeholder},actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:function(e){this.actValue=e},type:{handler:function(){this.options=[],this.getData()}}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;if(console.log(v,this.type),!this.$slots.default)if(this.list)this.options=this.list;else if([0,1,2,11].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$post(11===this.type?b:k,{type:this.type}).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1})).catch((function(){e.selectLoading=!1}))}else if([14].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$get(w).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1}))}else switch(this.type){case 3:this.options=t;break;case 4:this.options=a;break;case 5:this.options=o;break;case 6:this.options=l;break;case 7:this.options=c;break;case 8:this.options=r;break;case 9:this.options=u;break;case 10:this.options=d;break;case 12:this.options=h;break;case 13:this.options=p;break;case 15:this.options=f;break;case 16:this.options=m;break;case 17:this.options=g;break;default:this.options=[]}},handleChange:function(t){var n=e(t);if(null==t||"object"===n&&!t.length)return this.$emit("input",void 0),this.actValue=void 0,void this.$emit("change",{config:{resultName:this.resultName,status:"delete",type:"select"}});var a="number"===n?{}:[];this.options.forEach((function(e){"number"===n?e.id===t&&(a=e):t.includes(e.id)&&a.push(e)})),this.$emit("input",t),this.actValue=t,this.$emit("change",{data:t,rows:a,config:{resultName:this.resultName,status:"select",type:"select"}})},optionsVisibleHandle:function(){this.options.length||this.$slots.default||this.getData()},resetData:function(){this.actValue=void 0,this.$emit("input",void 0)}},render:function(e){var t=this,n=this;return e("div",{class:"mix-select",style:"width: ".concat(n.actWidth)},[e("a-select",{scopedSlots:n.$scopedSlots,props:{value:n.actValue,allowClear:n.allowClear,placeholder:n.modalPlaceholder,mode:n.mode,getPopupContainer:n.getPopupContainer,disabled:n.disabled},style:"width:100%;",on:{dropdownVisibleChange:n.optionsVisibleHandle,change:n.handleChange}},[n.selectLoading?e("a-spin",{props:{size:"small"},slot:"notFoundContent"}):function(){if(t.$slots.default)return t.$slots.default;var n=[];return t.options.forEach((function(a,i){t.exclude.includes(a.id)||n.push(e("a-select-option",{props:{value:a.id,key:i,title:a.name}},a.name))})),n}()])])}},"data-v-c44b6be8",void 0,void 0,!1,void 0,void 0,void 0);return _.install=function(e){e.component(_.name,_)},_}))},"6d61":function(e,t,n){"use strict";var a=n("23e7"),i=n("da84"),o=n("e330"),s=n("94ca"),r=n("6eeb"),l=n("f183"),c=n("2266"),u=n("19aa"),d=n("1626"),h=n("861d"),p=n("d039"),f=n("1c7e"),m=n("d44e"),g=n("7156");e.exports=function(e,t,n){var v=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),b=v?"set":"add",k=i[e],w=k&&k.prototype,C=k,_={},S=function(e){var t=o(w[e]);r(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!h(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})},x=s(e,!d(k)||!(y||w.forEach&&!p((function(){(new k).entries().next()}))));if(x)C=n.getConstructor(t,e,v,b),l.enable();else if(s(e,!0)){var D=new C,R=D[b](y?{}:-0,1)!=D,O=p((function(){D.has(1)})),V=f((function(e){new k(e)})),T=!y&&p((function(){var e=new k,t=5;while(t--)e[b](t,t);return!e.has(-0)}));V||(C=t((function(e,t){u(e,w);var n=g(new k,e,C);return void 0!=t&&c(t,n[b],{that:n,AS_ENTRIES:v}),n})),C.prototype=w,w.constructor=C),(O||T)&&(S("delete"),S("has"),v&&S("get")),(T||R)&&S(b),y&&w.clear&&delete w.clear}return _[e]=C,a({global:!0,forced:C!=k},_),m(C,e),y||n.setStrong(C,e,v),C}},7569:function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){"use strict";function e(e,t){return void 0===t?e:Number(Math.round(e+"e"+(t||0))+"e-"+(t||0))}function t(t,n,a,i){var o,s;try{o=n.toString().split(".")[1].length}catch(t){o=0}try{s=a.toString().split(".")[1].length}catch(t){s=0}var r=Math.pow(10,Math.max(o,s)),l=[e((Math.round(r*n)+Math.round(r*a))/r,i),e((Math.round(r*n)-Math.round(r*a))/r,i),e(Math.round(r*n)*Math.round(r*a)/(r*r),i),e(Math.round(r*n)/Math.round(r*a),i)];r=String(e(l[t],i||0));return i?r.includes(".")?r.split(".")[0]+"."+r.split(".")[1].padEnd(i,0):(r+".").padEnd((r+".").length+i,0):l[t]}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"symbol"!=n(e)&&!isNaN(parseFloat(e))&&isFinite(e)}return{add:function e(n,a,i){return Array.isArray(n)?n.length?n.reduce((function(t,n){return e(t,n,a)}),0):0:t(0,n,a,i)},calc:t,devide:function e(n,a,i){return Array.isArray(n)?2<=n.length?n.reduce((function(t,n){return e(t,n,a)})):"":n&&a?t(3,n,a,i):""},fmtNum:function(t,n,i,o){var s=1<arguments.length&&void 0!==n&&n,r=2<arguments.length?i:void 0;n=3<arguments.length?o:void 0;return void 0===t||null==t?"":a(i=t+"")?(o=!i.includes("."),t=0==(r=void 0===r?o?0:i.split(".")[1].length:r)?Math.round(i)+"":(o?i:e(+i+"",r)+"").split(".")[0],i=e(+i+"",r)+"",i=((i=0==r||o?"":i.split(".")[1])||"").padEnd(r,0),i=(s?t.replace(/(?=(?!\b)(\d{3})+$)/g,","):t)+(i.length?"."+i:""),n?Number(i):i):""},isNum:a,multiply:function e(n,a,i){return Array.isArray(n)?n.length?n.reduce((function(t,n){return e(t,n,a)}),1):0:t(2,n,a,i)},round:e,subtract:function e(n,a,i){n=0<arguments.length&&void 0!==n?n:0;var o=1<arguments.length&&void 0!==a?a:0;i=2<arguments.length?i:void 0;return Array.isArray(n)?n.length?n.reduce((function(t,n){return e(t,n,o)})):0:t(1,n,o,i)},isInteger:function(e){return"number"==typeof e&&!isNaN(e)&&e%1==0}}}))},"7edb":function(e,t,n){var a=n("ae52");e.exports=a},"857a":function(e,t,n){var a=n("e330"),i=n("1d80"),o=n("577e"),s=/"/g,r=a("".replace);e.exports=function(e,t,n,a){var l=o(i(e)),c="<"+t;return""!==n&&(c+=" "+n+'="'+r(o(a),s,"&quot;")+'"'),c+">"+l+"</"+t+">"}},9072:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("159b"),n("a9e3"),n("cfba"),n("ac1f"),n("1276"),n("5319"),n("466d"),n("fb6a"),n("d3b7"),n("b64b"),n("2b0e"),n("fd87"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("3177"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x,D,R,O,V,T,L,$,I,F,M,P){"use strict";function N(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var E=N(a),A=N(d);function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const z={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:E.default},methods:{handleClick:function(){this.$emit("click")}}};var q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[n("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};q._withStripped=!0;const Y=H({render:q,staticRenderFns:[]},void 0,z,void 0,!1,void 0,!1,void 0,void 0,void 0);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function G(e){if(!e&&"object"!==W(e))throw new Error("error arguments","deepClone");var t=e.constructor===Array?[]:{};return Object.keys(e).forEach((function(n){e[n]&&"object"===W(e[n])?t[n]=G(e[n]):t[n]=e[n]})),t}Y.install=function(e){e.component(Y.name,Y)},"object"!==("undefined"==typeof Int8Array?"undefined":W(Int8Array))&&(A.default.prototype.$isServer||document.childNodes);const U={name:"TableCellEllipsisTip",props:{onlyLine:{type:Boolean,default:!1},line:{type:Number,default:1},text:{type:[String,Number],default:""},tip:{type:[String,Number],default:""},position:{type:String,default:"bottom"},id:{type:[String,Number],default:P.guid()},tipExtAttr:{type:Object,default:function(){return{}}}},data:function(){return{elId:P.guid().substr(0,5),showTip:!1,actualTip:""}},computed:{cellStyle:function(){return{"line-clamp":this.line}}},mounted:function(){this.tipChange()},updated:function(){this.tipChange()},methods:{tipChange:function(){var e=this;try{var t=this.text?this.text:this.$el.innerText;this.actualTip=this.tip?this.tip:t,this.$nextTick((function(){setTimeout((function(){try{var t=document.getElementById(e.elId);e.showTip=!!t&&P.isEllipsis(t)}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}),0)}))}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}}};var X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-ellipsis-wrap",attrs:{id:"cell-ellipsis-"+e.id,"cell-ellipsis-id":e.id}},[e.showTip&&!e.onlyLine?n("a-tooltip",e._b({class:"cell-tooltip-"+e.id,attrs:{placement:e.position}},"a-tooltip",e.tipExtAttr,!1),[n("template",{slot:"title"},[e._t("tip",[e._v(e._s(e.actualTip))])],2),e._v(" "),n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n        "+e._s(e.text)+"\n      ")])],2)],2):n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n      "+e._s(e.text)+"\n    ")])],2)],1)};X._withStripped=!0;const J=H({render:X,staticRenderFns:[]},void 0,U,void 0,!1,void 0,!1,void 0,void 0,void 0);J.install=function(e){e.component(J.name,J)};const Q={name:"DOperationBox",components:{IconFontBox:Y,CellEllipsisTip:J},inject:{selectionContent:{from:"selectionContent",default:void 0},pagination:{from:"pagination",default:void 0}},props:{value:{type:Object,default:function(){return{}}},optionList:{type:Array,default:function(){return[]}},moreSearch:{type:Boolean,default:!0},modalConfig:{type:Object,default:function(){return{}}}},data:function(){return{actOptionList:[],loading:{},visible:!1}},computed:{selectList:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},baseModalConfig:function(){return K({title:"",okText:"确定",cancelText:"取消",width:"492px",style:"",class:"",resetText:"清空"},this.modalConfig)},actPagination:function(){return this.pagination?this.pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(e){return"总".concat(e,"条")}}},actSelectionContent:function(){return this.selectionContent?this.selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"}}},created:function(){this.generateOptionList()},watch:{optionList:function(){this.generateOptionList()}},methods:{generateOptionList:function(){var e=this;this.loading={},this.actOptionList=[];var t={name:"",key:"",icon:"",iconColor:"#378EFB",textColor:"#378EFB",size:16,loading:void 0};this.optionList.forEach((function(n){n.loading&&e.$set(e.loading,n.key,!1),e.actOptionList.push(K(K({},t),n))}))},handleSelect:function(e){"more"===e&&this.$slots.modal?this.visible=!0:this.$emit("optionClick",{name:e,close:this.closeLoading(e),key:e})},optionHandle:function(e){this.loading[e.key]||(e.loading&&(this.loading[e.key]=!0),this.$emit("optionClick",{key:e.key,close:this.closeLoading(e.key),data:e,name:e.name}))},handleDelete:function(e){var t=this,n=null;if("all"===e)this.selectList={};else{n=G(this.selectList[e]);var a=this.selectList;delete a[e],this.selectList=K({},a)}this.$nextTick((function(){t.$emit("delete",{name:e,old:n,key:e,config:{name:e,status:"delete",type:"operation",resultName:e}})}))},closeLoading:function(e){var t=this,n=e;return function(){if("all"===n)for(var e in t.loading)t.loading.hasOwnProperty(e)&&(t.loading[e]=!1);else t.loading.hasOwnProperty(n)&&(t.loading[n]=!1)}},modalOk:function(){var e=this;this.modalConfig.ok?this.modalConfig.ok((function(){e.visible=!1})):this.visible=!1},modalCancel:function(){var e=this;this.modalConfig.cancel?this.modalConfig.cancel((function(){e.visible=!1})):this.visible=!1},resetHandle:function(){var e=this;this.modalConfig.reset&&this.modalConfig.reset((function(){e.visible=!1}))}}};var Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"operation-index"},[n("div",{staticClass:"opt-top"},[e.actSelectionContent.selectedRowKeys.length?e._e():n("div",{staticClass:"filter-box"},[n("div",{staticClass:"filter-list"},[e._t("default")],2),e._v(" "),e.moreSearch?n("div",{staticClass:"more-search"},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.handleSelect("more")}}},[e._v("\n          更多搜索\n          "),n("icon-font-box",{attrs:{type:"icongengduosousuo",size:"16",color:"#378EFB"}})],1)]):e._e()]),e._v(" "),e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"select-list"},[n("div",{staticClass:"select-box"},[n("icon-font-box",{attrs:{type:"icon_warning",size:"16",color:"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-text"},[e._v("已选"),n("span",{staticClass:"select-num"},[e._v(e._s("allPage"===e.actSelectionContent.selectType?e.actPagination.total-e.actSelectionContent.noSelectedRowKeys.length:e.actSelectionContent.selectedRowKeys.length))]),e._v("条")]),e._v(" "),n("a",{staticClass:"clear-row",attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleSelect("clear")}}},[e._v("清空选中")])],1),e._v(" "),n("div",{staticClass:"select-rule"},e._l(e.actOptionList,(function(t,a){return n("a",{key:a,staticClass:"select-btn",attrs:{type:"link"},on:{click:function(n){return e.optionHandle(t)}}},[e.loading[t.key]?n("a-spin",{attrs:{size:"small"}}):e._e(),e._v(" "),e.loading[t.key]?e._e():n("icon-font-box",{attrs:{type:t.icon,size:t.size||16,color:t.iconColor||"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-btn-text",style:{color:t.textColor}},[e._v(e._s(t.name))])],1)})),0)]):e._e(),e._v(" "),e.$slots.other?n("div",{staticClass:"other-btn"},[e._t("other")],2):e._e()]),e._v(" "),Object.keys(e.selectList).length&&!e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"opt-bottom"},[e._l(e.selectList,(function(t,a){return n("div",{key:a,staticClass:"tag-box"},[n("div",{staticClass:"tag-label"},[e._v(e._s(t.label))]),e._v(" "),n("div",{staticClass:"tag-info"},[n("cell-ellipsis-tip",{attrs:{tip:t.value}},[e._v(e._s(t.value))])],1),e._v(" "),n("icon-font-box",{staticClass:"tag-close",attrs:{type:"icon_close",size:"14"},on:{click:function(n){return e.handleDelete(t.key)}}})],1)})),e._v(" "),n("a",{attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleDelete("all")}}},[e._v("全部清除")])],2):e._e(),e._v(" "),n("a-modal",{class:e.baseModalConfig.class,style:e.baseModalConfig.style,attrs:{title:e.baseModalConfig.title,"ok-text":e.baseModalConfig.okText,"cancel-text":e.baseModalConfig.cancelText,width:e.baseModalConfig.width,maskClosable:!1,keyboard:!1},on:{ok:e.modalOk,cancel:e.modalCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._t("modal"),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"operation-modal-footer"},[n("div",{staticClass:"operation-reset"},[n("a-button",{attrs:{type:"link"},on:{click:e.resetHandle}},[e._v(e._s(e.baseModalConfig.resetText))])],1),e._v(" "),n("div",{staticClass:"operation-btn"},[n("a-button",{key:"back",on:{click:e.modalCancel}},[e._v("\n            "+e._s(e.baseModalConfig.cancelText)+"\n          ")]),e._v(" "),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("\n            "+e._s(e.baseModalConfig.okText)+"\n          ")])],1)])])],2)],1)};Z._withStripped=!0;const ee=H({render:Z,staticRenderFns:[]},void 0,Q,void 0,!1,void 0,!1,void 0,void 0,void 0);return ee.install=function(e){e.component(ee.name,ee)},ee}))},"90b7":function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){"use strict";var e=function(){return Array.from(arguments).reduce((function(t,n){for(var a in n)t[a]=t[a]&&"[object Object]"===t[a].toString()?e(t[a],n[a]):t[a]=n[a];return t}),{})};function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function a(e,t){return n(e)===t}function i(e,n){if(e===n)return!0;if(e instanceof Date&&n instanceof Date)return e.getTime()===n.getTime();if(!e||!n||"object"!==t(e)&&"object"!==t(n))return e===n;if(e.prototype!==n.prototype)return!1;var a=Object.keys(e);return a.length===Object.keys(n).length&&(Array.isArray(e)&&Array.isArray(n)||"Object"==o(e)&&"Object"==o(n))&&a.every((function(t){return i(e[t],n[t])}));function o(e){return Object.prototype.toString.call(e).slice(8,-1)}}return{merge:e,clone:function(e){var t,n={};for(t in e)n[t]=e[t];return n},deepClone:function(e){return n=[],i=[],function e(o){if(null===o)return null;if("object"!==t(o))return o;var s;a(o,"array")?s=[]:a(o,"regexp")?(s=new RegExp(o.source,getRegExp(o)),o.lastIndex&&(s.lastIndex=o.lastIndex)):s=a(o,"date")?new Date(o.getTime()):(l=Object.getPrototypeOf(o),Object.create(l));var r,l=n.indexOf(o);if(-1!==l)return i[l];for(r in n.push(o),i.push(s),o)s[r]=e(o[r]);return s}(e);var n,i},findKey:function(e,t){for(var n in e)if("function"==typeof t&&t(e[n])||Array.isArray(t)&&e[n][t[0]]===t[1]||"string"==typeof t&&t in e[n]||i(e[n],t))return n},convertKey:function e(t,a,i){if(!["array","object"].includes(n(t)))throw new TypeError("The first argument should be either an object or an array！");if("[object Object]"!==Object.prototype.toString.call(a))throw new TypeError("The parameter keyMap should be an object!");var o=Array.isArray(t)?[]:{};if(t instanceof Object)for(var s in t){var r=Object.keys(a).includes(s)?a[s]:s;o[r]=t[s],i&&["array","object"].includes(n(t[s]))&&Object.keys(t[s]).length&&(o[r]=e(t[s],a,i))}return o}}}))},9911:function(e,t,n){"use strict";var a=n("23e7"),i=n("857a"),o=n("af03");a({target:"String",proto:!0,forced:o("link")},{link:function(e){return i(this,"a","href",e)}})},"9a50":function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("a9e3"),n("cfba"))}(0,(function(e,t,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const o={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:a(n).default},methods:{handleClick:function(){this.$emit("click")}}};var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[n("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};s._withStripped=!0;const r=i({render:s,staticRenderFns:[]},void 0,o,void 0,!1,void 0,!1,void 0,void 0,void 0);return r.install=function(e){e.component(r.name,r)},r}))},a15b:function(e,t,n){"use strict";var a=n("23e7"),i=n("e330"),o=n("44ad"),s=n("fc6a"),r=n("a640"),l=i([].join),c=o!=Object,u=r("join",",");a({target:"Array",proto:!0,forced:c||!u},{join:function(e){return l(s(this),void 0===e?",":e)}})},aa47:function(e,t,n){"use strict";
/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}function c(e,t){if(null==e)return{};var n,a,i=l(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function u(e){return d(e)||h(e)||p(e)||m()}function d(e){if(Array.isArray(e))return f(e)}function h(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function p(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.r(t),n.d(t,"MultiDrag",(function(){return Ht})),n.d(t,"Sortable",(function(){return nt})),n.d(t,"Swap",(function(){return Lt}));var g="1.14.0";function v(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var y=v(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),b=v(/Edge/i),k=v(/firefox/i),w=v(/safari/i)&&!v(/chrome/i)&&!v(/android/i),C=v(/iP(ad|od|hone)/i),_=v(/chrome/i)&&v(/android/i),S={capture:!1,passive:!1};function x(e,t,n){e.addEventListener(t,n,!y&&S)}function D(e,t,n){e.removeEventListener(t,n,!y&&S)}function R(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function O(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function V(e,t,n,a){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&R(e,t):R(e,t))||a&&e===n)return e;if(e===n)break}while(e=O(e))}return null}var T,L=/\s+/g;function $(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var a=(" "+e.className+" ").replace(L," ").replace(" "+t+" "," ");e.className=(a+(n?" "+t:"")).replace(L," ")}}function I(e,t,n){var a=e&&e.style;if(a){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in a||-1!==t.indexOf("webkit")||(t="-webkit-"+t),a[t]=n+("string"===typeof n?"":"px")}}function F(e,t){var n="";if("string"===typeof e)n=e;else do{var a=I(e,"transform");a&&"none"!==a&&(n=a+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function M(e,t,n){if(e){var a=e.getElementsByTagName(t),i=0,o=a.length;if(n)for(;i<o;i++)n(a[i],i);return a}return[]}function P(){var e=document.scrollingElement;return e||document.documentElement}function N(e,t,n,a,i){if(e.getBoundingClientRect||e===window){var o,s,r,l,c,u,d;if(e!==window&&e.parentNode&&e!==P()?(o=e.getBoundingClientRect(),s=o.top,r=o.left,l=o.bottom,c=o.right,u=o.height,d=o.width):(s=0,r=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!y))do{if(i&&i.getBoundingClientRect&&("none"!==I(i,"transform")||n&&"static"!==I(i,"position"))){var h=i.getBoundingClientRect();s-=h.top+parseInt(I(i,"border-top-width")),r-=h.left+parseInt(I(i,"border-left-width")),l=s+o.height,c=r+o.width;break}}while(i=i.parentNode);if(a&&e!==window){var p=F(i||e),f=p&&p.a,m=p&&p.d;p&&(s/=m,r/=f,d/=f,u/=m,l=s+u,c=r+d)}return{top:s,left:r,bottom:l,right:c,width:d,height:u}}}function E(e,t,n){var a=z(e,!0),i=N(e)[t];while(a){var o=N(a)[n],s=void 0;if(s="top"===n||"left"===n?i>=o:i<=o,!s)return a;if(a===P())break;a=z(a,!1)}return!1}function A(e,t,n,a){var i=0,o=0,s=e.children;while(o<s.length){if("none"!==s[o].style.display&&s[o]!==nt.ghost&&(a||s[o]!==nt.dragged)&&V(s[o],n.draggable,e,!1)){if(i===t)return s[o];i++}o++}return null}function j(e,t){var n=e.lastElementChild;while(n&&(n===nt.ghost||"none"===I(n,"display")||t&&!R(n,t)))n=n.previousElementSibling;return n||null}function B(e,t){var n=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===nt.clone||t&&!R(e,t)||n++;return n}function K(e){var t=0,n=0,a=P();if(e)do{var i=F(e),o=i.a,s=i.d;t+=e.scrollLeft*o,n+=e.scrollTop*s}while(e!==a&&(e=e.parentNode));return[t,n]}function H(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var a in t)if(t.hasOwnProperty(a)&&t[a]===e[n][a])return Number(n);return-1}function z(e,t){if(!e||!e.getBoundingClientRect)return P();var n=e,a=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=I(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return P();if(a||t)return n;a=!0}}}while(n=n.parentNode);return P()}function q(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Y(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function W(e,t){return function(){if(!T){var n=arguments,a=this;1===n.length?e.call(a,n[0]):e.apply(a,n),T=setTimeout((function(){T=void 0}),t)}}}function G(){clearTimeout(T),T=void 0}function U(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function X(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function J(e,t){I(e,"position","absolute"),I(e,"top",t.top),I(e,"left",t.left),I(e,"width",t.width),I(e,"height",t.height)}function Q(e){I(e,"position",""),I(e,"top",""),I(e,"left",""),I(e,"width",""),I(e,"height","")}var Z="Sortable"+(new Date).getTime();function ee(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==I(e,"display")&&e!==nt.ghost){t.push({target:e,rect:N(e)});var n=i({},t[t.length-1].rect);if(e.thisAnimationDuration){var a=F(e,!0);a&&(n.top-=a.f,n.left-=a.e)}e.fromRect=n}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(H(t,{target:e}),1)},animateAll:function(n){var a=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof n&&n());var i=!1,o=0;t.forEach((function(e){var t=0,n=e.target,s=n.fromRect,r=N(n),l=n.prevFromRect,c=n.prevToRect,u=e.rect,d=F(n,!0);d&&(r.top-=d.f,r.left-=d.e),n.toRect=r,n.thisAnimationDuration&&Y(l,r)&&!Y(s,r)&&(u.top-r.top)/(u.left-r.left)===(s.top-r.top)/(s.left-r.left)&&(t=ne(u,l,c,a.options)),Y(r,s)||(n.prevFromRect=s,n.prevToRect=r,t||(t=a.options.animation),a.animate(n,u,r,t)),t&&(i=!0,o=Math.max(o,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),i?e=setTimeout((function(){"function"===typeof n&&n()}),o):"function"===typeof n&&n(),t=[]},animate:function(e,t,n,a){if(a){I(e,"transition",""),I(e,"transform","");var i=F(this.el),o=i&&i.a,s=i&&i.d,r=(t.left-n.left)/(o||1),l=(t.top-n.top)/(s||1);e.animatingX=!!r,e.animatingY=!!l,I(e,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=te(e),I(e,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),I(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){I(e,"transition",""),I(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),a)}}}}function te(e){return e.offsetWidth}function ne(e,t,n,a){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*a.animation}var ae=[],ie={initializeByDefault:!0},oe={mount:function(e){for(var t in ie)ie.hasOwnProperty(t)&&!(t in e)&&(e[t]=ie[t]);ae.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),ae.push(e)},pluginEvent:function(e,t,n){var a=this;this.eventCanceled=!1,n.cancel=function(){a.eventCanceled=!0};var o=e+"Global";ae.forEach((function(a){t[a.pluginName]&&(t[a.pluginName][o]&&t[a.pluginName][o](i({sortable:t},n)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](i({sortable:t},n)))}))},initializePlugins:function(e,t,n,a){for(var i in ae.forEach((function(a){var i=a.pluginName;if(e.options[i]||a.initializeByDefault){var o=new a(e,t,e.options);o.sortable=e,o.options=e.options,e[i]=o,r(n,o.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var o=this.modifyOption(e,i,e.options[i]);"undefined"!==typeof o&&(e.options[i]=o)}},getEventProperties:function(e,t){var n={};return ae.forEach((function(a){"function"===typeof a.eventProperties&&r(n,a.eventProperties.call(t[a.pluginName],e))})),n},modifyOption:function(e,t,n){var a;return ae.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"===typeof i.optionListeners[t]&&(a=i.optionListeners[t].call(e[i.pluginName],n))})),a}};function se(e){var t=e.sortable,n=e.rootEl,a=e.name,o=e.targetEl,s=e.cloneEl,r=e.toEl,l=e.fromEl,c=e.oldIndex,u=e.newIndex,d=e.oldDraggableIndex,h=e.newDraggableIndex,p=e.originalEvent,f=e.putSortable,m=e.extraEventProperties;if(t=t||n&&n[Z],t){var g,v=t.options,k="on"+a.charAt(0).toUpperCase()+a.substr(1);!window.CustomEvent||y||b?(g=document.createEvent("Event"),g.initEvent(a,!0,!0)):g=new CustomEvent(a,{bubbles:!0,cancelable:!0}),g.to=r||n,g.from=l||n,g.item=o||n,g.clone=s,g.oldIndex=c,g.newIndex=u,g.oldDraggableIndex=d,g.newDraggableIndex=h,g.originalEvent=p,g.pullMode=f?f.lastPutMode:void 0;var w=i(i({},m),oe.getEventProperties(a,t));for(var C in w)g[C]=w[C];n&&n.dispatchEvent(g),v[k]&&v[k].call(t,g)}}var re=["evt"],le=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.evt,o=c(n,re);oe.pluginEvent.bind(nt)(e,t,i({dragEl:ue,parentEl:de,ghostEl:he,rootEl:pe,nextEl:fe,lastDownEl:me,cloneEl:ge,cloneHidden:ve,dragStarted:Te,putSortable:_e,activeSortable:nt.active,originalEvent:a,oldIndex:ye,oldDraggableIndex:ke,newIndex:be,newDraggableIndex:we,hideGhostForTarget:Qe,unhideGhostForTarget:Ze,cloneNowHidden:function(){ve=!0},cloneNowShown:function(){ve=!1},dispatchSortableEvent:function(e){ce({sortable:t,name:e,originalEvent:a})}},o))};function ce(e){se(i({putSortable:_e,cloneEl:ge,targetEl:ue,rootEl:pe,oldIndex:ye,oldDraggableIndex:ke,newIndex:be,newDraggableIndex:we},e))}var ue,de,he,pe,fe,me,ge,ve,ye,be,ke,we,Ce,_e,Se,xe,De,Re,Oe,Ve,Te,Le,$e,Ie,Fe,Me=!1,Pe=!1,Ne=[],Ee=!1,Ae=!1,je=[],Be=!1,Ke=[],He="undefined"!==typeof document,ze=C,qe=b||y?"cssFloat":"float",Ye=He&&!_&&!C&&"draggable"in document.createElement("div"),We=function(){if(He){if(y)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Ge=function(e,t){var n=I(e),a=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=A(e,0,t),o=A(e,1,t),s=i&&I(i),r=o&&I(o),l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+N(i).width,c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+N(o).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s["float"]&&"none"!==s["float"]){var u="left"===s["float"]?"left":"right";return!o||"both"!==r.clear&&r.clear!==u?"horizontal":"vertical"}return i&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||l>=a&&"none"===n[qe]||o&&"none"===n[qe]&&l+c>a)?"vertical":"horizontal"},Ue=function(e,t,n){var a=n?e.left:e.top,i=n?e.right:e.bottom,o=n?e.width:e.height,s=n?t.left:t.top,r=n?t.right:t.bottom,l=n?t.width:t.height;return a===s||i===r||a+o/2===s+l/2},Xe=function(e,t){var n;return Ne.some((function(a){var i=a[Z].options.emptyInsertThreshold;if(i&&!j(a)){var o=N(a),s=e>=o.left-i&&e<=o.right+i,r=t>=o.top-i&&t<=o.bottom+i;return s&&r?n=a:void 0}})),n},Je=function(e){function t(e,n){return function(a,i,o,s){var r=a.options.group.name&&i.options.group.name&&a.options.group.name===i.options.group.name;if(null==e&&(n||r))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"===typeof e)return t(e(a,i,o,s),n)(a,i,o,s);var l=(n?a:i).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},a=e.group;a&&"object"==o(a)||(a={name:a}),n.name=a.name,n.checkPull=t(a.pull,!0),n.checkPut=t(a.put),n.revertClone=a.revertClone,e.group=n},Qe=function(){!We&&he&&I(he,"display","none")},Ze=function(){!We&&he&&I(he,"display","")};He&&document.addEventListener("click",(function(e){if(Pe)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Pe=!1,!1}),!0);var et=function(e){if(ue){e=e.touches?e.touches[0]:e;var t=Xe(e.clientX,e.clientY);if(t){var n={};for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[Z]._onDragOver(n)}}},tt=function(e){ue&&ue.parentNode[Z]._isOutsideThisEl(e.target)};function nt(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=r({},t),e[Z]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ge(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==nt.supportPointer&&"PointerEvent"in window&&!w,emptyInsertThreshold:5};for(var a in oe.initializePlugins(this,e,n),n)!(a in t)&&(t[a]=n[a]);for(var i in Je(t),this)"_"===i.charAt(0)&&"function"===typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&Ye,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?x(e,"pointerdown",this._onTapStart):(x(e,"mousedown",this._onTapStart),x(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(x(e,"dragover",this),x(e,"dragenter",this)),Ne.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),r(this,ee())}function at(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function it(e,t,n,a,i,o,s,r){var l,c,u=e[Z],d=u.options.onMove;return!window.CustomEvent||y||b?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=a,l.related=i||t,l.relatedRect=o||N(t),l.willInsertAfter=r,l.originalEvent=s,e.dispatchEvent(l),d&&(c=d.call(u,l,s)),c}function ot(e){e.draggable=!1}function st(){Be=!1}function rt(e,t,n){var a=N(A(n.el,0,n.options,!0)),i=10;return t?e.clientX<a.left-i||e.clientY<a.top&&e.clientX<a.right:e.clientY<a.top-i||e.clientY<a.bottom&&e.clientX<a.left}function lt(e,t,n){var a=N(j(n.el,n.options.draggable)),i=10;return t?e.clientX>a.right+i||e.clientX<=a.right&&e.clientY>a.bottom&&e.clientX>=a.left:e.clientX>a.right&&e.clientY>a.top||e.clientX<=a.right&&e.clientY>a.bottom+i}function ct(e,t,n,a,i,o,s,r){var l=a?e.clientY:e.clientX,c=a?n.height:n.width,u=a?n.top:n.left,d=a?n.bottom:n.right,h=!1;if(!s)if(r&&Ie<c*i){if(!Ee&&(1===$e?l>u+c*o/2:l<d-c*o/2)&&(Ee=!0),Ee)h=!0;else if(1===$e?l<u+Ie:l>d-Ie)return-$e}else if(l>u+c*(1-i)/2&&l<d-c*(1-i)/2)return ut(t);return h=h||s,h&&(l<u+c*o/2||l>d-c*o/2)?l>u+c/2?1:-1:0}function ut(e){return B(ue)<B(e)?1:-1}function dt(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,a=0;while(n--)a+=t.charCodeAt(n);return a.toString(36)}function ht(e){Ke.length=0;var t=e.getElementsByTagName("input"),n=t.length;while(n--){var a=t[n];a.checked&&Ke.push(a)}}function pt(e){return setTimeout(e,0)}function ft(e){return clearTimeout(e)}nt.prototype={constructor:nt,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Le=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,ue):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,a=this.options,i=a.preventOnFilter,o=e.type,s=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,r=(s||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||r,c=a.filter;if(ht(n),!ue&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||a.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!w||!r||"SELECT"!==r.tagName.toUpperCase())&&(r=V(r,a.draggable,n,!1),(!r||!r.animated)&&me!==r)){if(ye=B(r),ke=B(r,a.draggable),"function"===typeof c){if(c.call(this,e,r,this))return ce({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:n,fromEl:n}),le("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(a){if(a=V(l,a.trim(),n,!1),a)return ce({sortable:t,rootEl:a,name:"filter",targetEl:r,fromEl:n,toEl:n}),le("filter",t,{evt:e}),!0})),c))return void(i&&e.cancelable&&e.preventDefault());a.handle&&!V(l,a.handle,n,!1)||this._prepareDragStart(e,s,r)}}},_prepareDragStart:function(e,t,n){var a,i=this,o=i.el,s=i.options,r=o.ownerDocument;if(n&&!ue&&n.parentNode===o){var l=N(n);if(pe=o,ue=n,de=ue.parentNode,fe=ue.nextSibling,me=n,Ce=s.group,nt.dragged=ue,Se={target:ue,clientX:(t||e).clientX,clientY:(t||e).clientY},Oe=Se.clientX-l.left,Ve=Se.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ue.style["will-change"]="all",a=function(){le("delayEnded",i,{evt:e}),nt.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!k&&i.nativeDraggable&&(ue.draggable=!0),i._triggerDragStart(e,t),ce({sortable:i,name:"choose",originalEvent:e}),$(ue,s.chosenClass,!0))},s.ignore.split(",").forEach((function(e){M(ue,e.trim(),ot)})),x(r,"dragover",et),x(r,"mousemove",et),x(r,"touchmove",et),x(r,"mouseup",i._onDrop),x(r,"touchend",i._onDrop),x(r,"touchcancel",i._onDrop),k&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ue.draggable=!0),le("delayStart",this,{evt:e}),!s.delay||s.delayOnTouchOnly&&!t||this.nativeDraggable&&(b||y))a();else{if(nt.eventCanceled)return void this._onDrop();x(r,"mouseup",i._disableDelayedDrag),x(r,"touchend",i._disableDelayedDrag),x(r,"touchcancel",i._disableDelayedDrag),x(r,"mousemove",i._delayedDragTouchMoveHandler),x(r,"touchmove",i._delayedDragTouchMoveHandler),s.supportPointer&&x(r,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(a,s.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ue&&ot(ue),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._disableDelayedDrag),D(e,"touchend",this._disableDelayedDrag),D(e,"touchcancel",this._disableDelayedDrag),D(e,"mousemove",this._delayedDragTouchMoveHandler),D(e,"touchmove",this._delayedDragTouchMoveHandler),D(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?x(document,"pointermove",this._onTouchMove):x(document,t?"touchmove":"mousemove",this._onTouchMove):(x(ue,"dragend",this),x(pe,"dragstart",this._onDragStart));try{document.selection?pt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(Me=!1,pe&&ue){le("dragStarted",this,{evt:t}),this.nativeDraggable&&x(document,"dragover",tt);var n=this.options;!e&&$(ue,n.dragClass,!1),$(ue,n.ghostClass,!0),nt.active=this,e&&this._appendGhost(),ce({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(xe){this._lastX=xe.clientX,this._lastY=xe.clientY,Qe();var e=document.elementFromPoint(xe.clientX,xe.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(xe.clientX,xe.clientY),e===t)break;t=e}if(ue.parentNode[Z]._isOutsideThisEl(e),t)do{if(t[Z]){var n=void 0;if(n=t[Z]._onDragOver({clientX:xe.clientX,clientY:xe.clientY,target:e,rootEl:t}),n&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Ze()}},_onTouchMove:function(e){if(Se){var t=this.options,n=t.fallbackTolerance,a=t.fallbackOffset,i=e.touches?e.touches[0]:e,o=he&&F(he,!0),s=he&&o&&o.a,r=he&&o&&o.d,l=ze&&Fe&&K(Fe),c=(i.clientX-Se.clientX+a.x)/(s||1)+(l?l[0]-je[0]:0)/(s||1),u=(i.clientY-Se.clientY+a.y)/(r||1)+(l?l[1]-je[1]:0)/(r||1);if(!nt.active&&!Me){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(he){o?(o.e+=c-(De||0),o.f+=u-(Re||0)):o={a:1,b:0,c:0,d:1,e:c,f:u};var d="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");I(he,"webkitTransform",d),I(he,"mozTransform",d),I(he,"msTransform",d),I(he,"transform",d),De=c,Re=u,xe=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!he){var e=this.options.fallbackOnBody?document.body:pe,t=N(ue,!0,ze,!0,e),n=this.options;if(ze){Fe=e;while("static"===I(Fe,"position")&&"none"===I(Fe,"transform")&&Fe!==document)Fe=Fe.parentNode;Fe!==document.body&&Fe!==document.documentElement?(Fe===document&&(Fe=P()),t.top+=Fe.scrollTop,t.left+=Fe.scrollLeft):Fe=P(),je=K(Fe)}he=ue.cloneNode(!0),$(he,n.ghostClass,!1),$(he,n.fallbackClass,!0),$(he,n.dragClass,!0),I(he,"transition",""),I(he,"transform",""),I(he,"box-sizing","border-box"),I(he,"margin",0),I(he,"top",t.top),I(he,"left",t.left),I(he,"width",t.width),I(he,"height",t.height),I(he,"opacity","0.8"),I(he,"position",ze?"absolute":"fixed"),I(he,"zIndex","100000"),I(he,"pointerEvents","none"),nt.ghost=he,e.appendChild(he),I(he,"transform-origin",Oe/parseInt(he.style.width)*100+"% "+Ve/parseInt(he.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,a=e.dataTransfer,i=n.options;le("dragStart",this,{evt:e}),nt.eventCanceled?this._onDrop():(le("setupClone",this),nt.eventCanceled||(ge=X(ue),ge.draggable=!1,ge.style["will-change"]="",this._hideClone(),$(ge,this.options.chosenClass,!1),nt.clone=ge),n.cloneId=pt((function(){le("clone",n),nt.eventCanceled||(n.options.removeCloneOnHide||pe.insertBefore(ge,ue),n._hideClone(),ce({sortable:n,name:"clone"}))})),!t&&$(ue,i.dragClass,!0),t?(Pe=!0,n._loopId=setInterval(n._emulateDragOver,50)):(D(document,"mouseup",n._onDrop),D(document,"touchend",n._onDrop),D(document,"touchcancel",n._onDrop),a&&(a.effectAllowed="move",i.setData&&i.setData.call(n,a,ue)),x(document,"drop",n),I(ue,"transform","translateZ(0)")),Me=!0,n._dragStartId=pt(n._dragStarted.bind(n,t,e)),x(document,"selectstart",n),Te=!0,w&&I(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,a,o,s=this.el,r=e.target,l=this.options,c=l.group,u=nt.active,d=Ce===c,h=l.sort,p=_e||u,f=this,m=!1;if(!Be){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=V(r,l.draggable,s,!0),L("dragOver"),nt.eventCanceled)return m;if(ue.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||f._ignoreWhileAnimating===r)return M(!1);if(Pe=!1,u&&!l.disabled&&(d?h||(a=de!==pe):_e===this||(this.lastPutMode=Ce.checkPull(this,u,ue,e))&&c.checkPut(this,u,ue,e))){if(o="vertical"===this._getDirection(e,r),t=N(ue),L("dragOverValid"),nt.eventCanceled)return m;if(a)return de=pe,F(),this._hideClone(),L("revert"),nt.eventCanceled||(fe?pe.insertBefore(ue,fe):pe.appendChild(ue)),M(!0);var g=j(s,l.draggable);if(!g||lt(e,o,this)&&!g.animated){if(g===ue)return M(!1);if(g&&s===e.target&&(r=g),r&&(n=N(r)),!1!==it(pe,s,ue,t,r,n,e,!!r))return F(),s.appendChild(ue),de=s,P(),M(!0)}else if(g&&rt(e,o,this)){var v=A(s,0,l,!0);if(v===ue)return M(!1);if(r=v,n=N(r),!1!==it(pe,s,ue,t,r,n,e,!1))return F(),s.insertBefore(ue,v),de=s,P(),M(!0)}else if(r.parentNode===s){n=N(r);var y,b,k=0,w=ue.parentNode!==s,C=!Ue(ue.animated&&ue.toRect||t,r.animated&&r.toRect||n,o),_=o?"top":"left",S=E(r,"top","top")||E(ue,"top","top"),x=S?S.scrollTop:void 0;if(Le!==r&&(y=n[_],Ee=!1,Ae=!C&&l.invertSwap||w),k=ct(e,r,n,o,C?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Ae,Le===r),0!==k){var D=B(ue);do{D-=k,b=de.children[D]}while(b&&("none"===I(b,"display")||b===he))}if(0===k||b===r)return M(!1);Le=r,$e=k;var R=r.nextElementSibling,O=!1;O=1===k;var T=it(pe,s,ue,t,r,n,e,O);if(!1!==T)return 1!==T&&-1!==T||(O=1===T),Be=!0,setTimeout(st,30),F(),O&&!R?s.appendChild(ue):r.parentNode.insertBefore(ue,O?R:r),S&&U(S,0,x-S.scrollTop),de=ue.parentNode,void 0===y||Ae||(Ie=Math.abs(y-N(r)[_])),P(),M(!0)}if(s.contains(ue))return M(!1)}return!1}function L(l,c){le(l,f,i({evt:e,isOwner:d,axis:o?"vertical":"horizontal",revert:a,dragRect:t,targetRect:n,canSort:h,fromSortable:p,target:r,completed:M,onMove:function(n,a){return it(pe,s,ue,t,n,N(n),e,a)},changed:P},c))}function F(){L("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function M(t){return L("dragOverCompleted",{insertion:t}),t&&(d?u._hideClone():u._showClone(f),f!==p&&($(ue,_e?_e.options.ghostClass:u.options.ghostClass,!1),$(ue,l.ghostClass,!0)),_e!==f&&f!==nt.active?_e=f:f===nt.active&&_e&&(_e=null),p===f&&(f._ignoreWhileAnimating=r),f.animateAll((function(){L("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(r===ue&&!ue.animated||r===s&&!r.animated)&&(Le=null),l.dragoverBubble||e.rootEl||r===document||(ue.parentNode[Z]._isOutsideThisEl(e.target),!t&&et(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function P(){be=B(ue),we=B(ue,l.draggable),ce({sortable:f,name:"change",toEl:s,newIndex:be,newDraggableIndex:we,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){D(document,"mousemove",this._onTouchMove),D(document,"touchmove",this._onTouchMove),D(document,"pointermove",this._onTouchMove),D(document,"dragover",et),D(document,"mousemove",et),D(document,"touchmove",et)},_offUpEvents:function(){var e=this.el.ownerDocument;D(e,"mouseup",this._onDrop),D(e,"touchend",this._onDrop),D(e,"pointerup",this._onDrop),D(e,"touchcancel",this._onDrop),D(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;be=B(ue),we=B(ue,n.draggable),le("drop",this,{evt:e}),de=ue&&ue.parentNode,be=B(ue),we=B(ue,n.draggable),nt.eventCanceled||(Me=!1,Ae=!1,Ee=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ft(this.cloneId),ft(this._dragStartId),this.nativeDraggable&&(D(document,"drop",this),D(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),w&&I(document.body,"user-select",""),I(ue,"transform",""),e&&(Te&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),he&&he.parentNode&&he.parentNode.removeChild(he),(pe===de||_e&&"clone"!==_e.lastPutMode)&&ge&&ge.parentNode&&ge.parentNode.removeChild(ge),ue&&(this.nativeDraggable&&D(ue,"dragend",this),ot(ue),ue.style["will-change"]="",Te&&!Me&&$(ue,_e?_e.options.ghostClass:this.options.ghostClass,!1),$(ue,this.options.chosenClass,!1),ce({sortable:this,name:"unchoose",toEl:de,newIndex:null,newDraggableIndex:null,originalEvent:e}),pe!==de?(be>=0&&(ce({rootEl:de,name:"add",toEl:de,fromEl:pe,originalEvent:e}),ce({sortable:this,name:"remove",toEl:de,originalEvent:e}),ce({rootEl:de,name:"sort",toEl:de,fromEl:pe,originalEvent:e}),ce({sortable:this,name:"sort",toEl:de,originalEvent:e})),_e&&_e.save()):be!==ye&&be>=0&&(ce({sortable:this,name:"update",toEl:de,originalEvent:e}),ce({sortable:this,name:"sort",toEl:de,originalEvent:e})),nt.active&&(null!=be&&-1!==be||(be=ye,we=ke),ce({sortable:this,name:"end",toEl:de,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){le("nulling",this),pe=ue=de=he=fe=ge=me=ve=Se=xe=Te=be=we=ye=ke=Le=$e=_e=Ce=nt.dragged=nt.ghost=nt.clone=nt.active=null,Ke.forEach((function(e){e.checked=!0})),Ke.length=De=Re=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ue&&(this._onDragOver(e),at(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],n=this.el.children,a=0,i=n.length,o=this.options;a<i;a++)e=n[a],V(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||dt(e));return t},sort:function(e,t){var n={},a=this.el;this.toArray().forEach((function(e,t){var i=a.children[t];V(i,this.options.draggable,a,!1)&&(n[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(a.removeChild(n[e]),a.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return V(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var a=oe.modifyOption(this,e,t);n[e]="undefined"!==typeof a?a:t,"group"===e&&Je(n)},destroy:function(){le("destroy",this);var e=this.el;e[Z]=null,D(e,"mousedown",this._onTapStart),D(e,"touchstart",this._onTapStart),D(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(D(e,"dragover",this),D(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Ne.splice(Ne.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ve){if(le("hideClone",this),nt.eventCanceled)return;I(ge,"display","none"),this.options.removeCloneOnHide&&ge.parentNode&&ge.parentNode.removeChild(ge),ve=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ve){if(le("showClone",this),nt.eventCanceled)return;ue.parentNode!=pe||this.options.group.revertClone?fe?pe.insertBefore(ge,fe):pe.appendChild(ge):pe.insertBefore(ge,ue),this.options.group.revertClone&&this.animate(ue,ge),I(ge,"display",""),ve=!1}}else this._hideClone()}},He&&x(document,"touchmove",(function(e){(nt.active||Me)&&e.cancelable&&e.preventDefault()})),nt.utils={on:x,off:D,css:I,find:M,is:function(e,t){return!!V(e,t,e,!1)},extend:q,throttle:W,closest:V,toggleClass:$,clone:X,index:B,nextTick:pt,cancelNextTick:ft,detectDirection:Ge,getChild:A},nt.get=function(e){return e[Z]},nt.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(nt.utils=i(i({},nt.utils),e.utils)),oe.mount(e)}))},nt.create=function(e,t){return new nt(e,t)},nt.version=g;var mt,gt,vt,yt,bt,kt,wt=[],Ct=!1;function _t(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):this.options.supportPointer?x(document,"pointermove",this._handleFallbackAutoScroll):t.touches?x(document,"touchmove",this._handleFallbackAutoScroll):x(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?D(document,"dragover",this._handleAutoScroll):(D(document,"pointermove",this._handleFallbackAutoScroll),D(document,"touchmove",this._handleFallbackAutoScroll),D(document,"mousemove",this._handleFallbackAutoScroll)),xt(),St(),G()},nulling:function(){bt=gt=mt=Ct=kt=vt=yt=null,wt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,a=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(a,i);if(bt=e,t||this.options.forceAutoScrollFallback||b||y||w){Rt(e,this.options,o,t);var s=z(o,!0);!Ct||kt&&a===vt&&i===yt||(kt&&xt(),kt=setInterval((function(){var o=z(document.elementFromPoint(a,i),!0);o!==s&&(s=o,St()),Rt(e,n.options,o,t)}),10),vt=a,yt=i)}else{if(!this.options.bubbleScroll||z(o,!0)===P())return void St();Rt(e,this.options,z(o,!1),!1)}}},r(e,{pluginName:"scroll",initializeByDefault:!0})}function St(){wt.forEach((function(e){clearInterval(e.pid)})),wt=[]}function xt(){clearInterval(kt)}var Dt,Rt=W((function(e,t,n,a){if(t.scroll){var i,o=(e.touches?e.touches[0]:e).clientX,s=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,c=P(),u=!1;gt!==n&&(gt=n,St(),mt=t.scroll,i=t.scrollFn,!0===mt&&(mt=z(n,!0)));var d=0,h=mt;do{var p=h,f=N(p),m=f.top,g=f.bottom,v=f.left,y=f.right,b=f.width,k=f.height,w=void 0,C=void 0,_=p.scrollWidth,S=p.scrollHeight,x=I(p),D=p.scrollLeft,R=p.scrollTop;p===c?(w=b<_&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),C=k<S&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(w=b<_&&("auto"===x.overflowX||"scroll"===x.overflowX),C=k<S&&("auto"===x.overflowY||"scroll"===x.overflowY));var O=w&&(Math.abs(y-o)<=r&&D+b<_)-(Math.abs(v-o)<=r&&!!D),V=C&&(Math.abs(g-s)<=r&&R+k<S)-(Math.abs(m-s)<=r&&!!R);if(!wt[d])for(var T=0;T<=d;T++)wt[T]||(wt[T]={});wt[d].vx==O&&wt[d].vy==V&&wt[d].el===p||(wt[d].el=p,wt[d].vx=O,wt[d].vy=V,clearInterval(wt[d].pid),0==O&&0==V||(u=!0,wt[d].pid=setInterval(function(){a&&0===this.layer&&nt.active._onTouchMove(bt);var t=wt[this.layer].vy?wt[this.layer].vy*l:0,n=wt[this.layer].vx?wt[this.layer].vx*l:0;"function"===typeof i&&"continue"!==i.call(nt.dragged.parentNode[Z],n,t,e,bt,wt[this.layer].el)||U(wt[this.layer].el,n,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==c&&(h=z(h,!1)));Ct=u}}),30),Ot=function(e){var t=e.originalEvent,n=e.putSortable,a=e.dragEl,i=e.activeSortable,o=e.dispatchSortableEvent,s=e.hideGhostForTarget,r=e.unhideGhostForTarget;if(t){var l=n||i;s();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);r(),l&&!l.el.contains(u)&&(o("spill"),this.onSpill({dragEl:a,putSortable:n}))}};function Vt(){}function Tt(){}function Lt(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;Dt=t},dragOverValid:function(e){var t=e.completed,n=e.target,a=e.onMove,i=e.activeSortable,o=e.changed,s=e.cancel;if(i.options.swap){var r=this.sortable.el,l=this.options;if(n&&n!==r){var c=Dt;!1!==a(n)?($(n,l.swapClass,!0),Dt=n):Dt=null,c&&c!==Dt&&$(c,l.swapClass,!1)}o(),t(!0),s()}},drop:function(e){var t=e.activeSortable,n=e.putSortable,a=e.dragEl,i=n||this.sortable,o=this.options;Dt&&$(Dt,o.swapClass,!1),Dt&&(o.swap||n&&n.options.swap)&&a!==Dt&&(i.captureAnimationState(),i!==t&&t.captureAnimationState(),$t(a,Dt),i.animateAll(),i!==t&&t.animateAll())},nulling:function(){Dt=null}},r(e,{pluginName:"swap",eventProperties:function(){return{swapItem:Dt}}})}function $t(e,t){var n,a,i=e.parentNode,o=t.parentNode;i&&o&&!i.isEqualNode(t)&&!o.isEqualNode(e)&&(n=B(e),a=B(t),i.isEqualNode(o)&&n<a&&a++,i.insertBefore(t,i.children[n]),o.insertBefore(e,o.children[a]))}Vt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var a=A(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(t,a):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:Ot},r(Vt,{pluginName:"revertOnSpill"}),Tt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable,a=n||this.sortable;a.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),a.animateAll()},drop:Ot},r(Tt,{pluginName:"removeOnSpill"});var It,Ft,Mt,Pt,Nt,Et=[],At=[],jt=!1,Bt=!1,Kt=!1;function Ht(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this));e.options.supportPointer?x(document,"pointerup",this._deselectMultiDrag):(x(document,"mouseup",this._deselectMultiDrag),x(document,"touchend",this._deselectMultiDrag)),x(document,"keydown",this._checkKeyDown),x(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,n){var a="";Et.length&&Ft===e?Et.forEach((function(e,t){a+=(t?", ":"")+e.textContent})):a=n.textContent,t.setData("Text",a)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;Mt=t},delayEnded:function(){this.isMultiDrag=~Et.indexOf(Mt)},setupClone:function(e){var t=e.sortable,n=e.cancel;if(this.isMultiDrag){for(var a=0;a<Et.length;a++)At.push(X(Et[a])),At[a].sortableIndex=Et[a].sortableIndex,At[a].draggable=!1,At[a].style["will-change"]="",$(At[a],this.options.selectedClass,!1),Et[a]===Mt&&$(At[a],this.options.chosenClass,!1);t._hideClone(),n()}},clone:function(e){var t=e.sortable,n=e.rootEl,a=e.dispatchSortableEvent,i=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Et.length&&Ft===t&&(qt(!0,n),a("clone"),i()))},showClone:function(e){var t=e.cloneNowShown,n=e.rootEl,a=e.cancel;this.isMultiDrag&&(qt(!1,n),At.forEach((function(e){I(e,"display","")})),t(),Nt=!1,a())},hideClone:function(e){var t=this,n=(e.sortable,e.cloneNowHidden),a=e.cancel;this.isMultiDrag&&(At.forEach((function(e){I(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)})),n(),Nt=!0,a())},dragStartGlobal:function(e){e.sortable;!this.isMultiDrag&&Ft&&Ft.multiDrag._deselectMultiDrag(),Et.forEach((function(e){e.sortableIndex=B(e)})),Et=Et.sort((function(e,t){return e.sortableIndex-t.sortableIndex})),Kt=!0},dragStarted:function(e){var t=this,n=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){Et.forEach((function(e){e!==Mt&&I(e,"position","absolute")}));var a=N(Mt,!1,!0,!0);Et.forEach((function(e){e!==Mt&&J(e,a)})),Bt=!0,jt=!0}n.animateAll((function(){Bt=!1,jt=!1,t.options.animation&&Et.forEach((function(e){Q(e)})),t.options.sort&&Yt()}))}},dragOver:function(e){var t=e.target,n=e.completed,a=e.cancel;Bt&&~Et.indexOf(t)&&(n(!1),a())},revert:function(e){var t=e.fromSortable,n=e.rootEl,a=e.sortable,i=e.dragRect;Et.length>1&&(Et.forEach((function(e){a.addAnimationState({target:e,rect:Bt?N(e):i}),Q(e),e.fromRect=i,t.removeAnimationState(e)})),Bt=!1,zt(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(e){var t=e.sortable,n=e.isOwner,a=e.insertion,i=e.activeSortable,o=e.parentEl,s=e.putSortable,r=this.options;if(a){if(n&&i._hideClone(),jt=!1,r.animation&&Et.length>1&&(Bt||!n&&!i.options.sort&&!s)){var l=N(Mt,!1,!0,!0);Et.forEach((function(e){e!==Mt&&(J(e,l),o.appendChild(e))})),Bt=!0}if(!n)if(Bt||Yt(),Et.length>1){var c=Nt;i._showClone(t),i.options.animation&&!Nt&&c&&At.forEach((function(e){i.addAnimationState({target:e,rect:Pt}),e.fromRect=Pt,e.thisAnimationDuration=null}))}else i._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,a=e.activeSortable;if(Et.forEach((function(e){e.thisAnimationDuration=null})),a.options.animation&&!n&&a.multiDrag.isMultiDrag){Pt=r({},t);var i=F(Mt,!0);Pt.top-=i.f,Pt.left-=i.e}},dragOverAnimationComplete:function(){Bt&&(Bt=!1,Yt())},drop:function(e){var t=e.originalEvent,n=e.rootEl,a=e.parentEl,i=e.sortable,o=e.dispatchSortableEvent,s=e.oldIndex,r=e.putSortable,l=r||this.sortable;if(t){var c=this.options,u=a.children;if(!Kt)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),$(Mt,c.selectedClass,!~Et.indexOf(Mt)),~Et.indexOf(Mt))Et.splice(Et.indexOf(Mt),1),It=null,se({sortable:i,rootEl:n,name:"deselect",targetEl:Mt,originalEvt:t});else{if(Et.push(Mt),se({sortable:i,rootEl:n,name:"select",targetEl:Mt,originalEvt:t}),t.shiftKey&&It&&i.el.contains(It)){var d,h,p=B(It),f=B(Mt);if(~p&&~f&&p!==f)for(f>p?(h=p,d=f):(h=f,d=p+1);h<d;h++)~Et.indexOf(u[h])||($(u[h],c.selectedClass,!0),Et.push(u[h]),se({sortable:i,rootEl:n,name:"select",targetEl:u[h],originalEvt:t}))}else It=Mt;Ft=l}if(Kt&&this.isMultiDrag){if(Bt=!1,(a[Z].options.sort||a!==n)&&Et.length>1){var m=N(Mt),g=B(Mt,":not(."+this.options.selectedClass+")");if(!jt&&c.animation&&(Mt.thisAnimationDuration=null),l.captureAnimationState(),!jt&&(c.animation&&(Mt.fromRect=m,Et.forEach((function(e){if(e.thisAnimationDuration=null,e!==Mt){var t=Bt?N(e):m;e.fromRect=t,l.addAnimationState({target:e,rect:t})}}))),Yt(),Et.forEach((function(e){u[g]?a.insertBefore(e,u[g]):a.appendChild(e),g++})),s===B(Mt))){var v=!1;Et.forEach((function(e){e.sortableIndex===B(e)||(v=!0)})),v&&o("update")}Et.forEach((function(e){Q(e)})),l.animateAll()}Ft=l}(n===a||r&&"clone"!==r.lastPutMode)&&At.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}},nullingGlobal:function(){this.isMultiDrag=Kt=!1,At.length=0},destroyGlobal:function(){this._deselectMultiDrag(),D(document,"pointerup",this._deselectMultiDrag),D(document,"mouseup",this._deselectMultiDrag),D(document,"touchend",this._deselectMultiDrag),D(document,"keydown",this._checkKeyDown),D(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(("undefined"===typeof Kt||!Kt)&&Ft===this.sortable&&(!e||!V(e.target,this.options.draggable,this.sortable.el,!1))&&(!e||0===e.button))while(Et.length){var t=Et[0];$(t,this.options.selectedClass,!1),Et.shift(),se({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},r(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[Z];t&&t.options.multiDrag&&!~Et.indexOf(e)&&(Ft&&Ft!==t&&(Ft.multiDrag._deselectMultiDrag(),Ft=t),$(e,t.options.selectedClass,!0),Et.push(e))},deselect:function(e){var t=e.parentNode[Z],n=Et.indexOf(e);t&&t.options.multiDrag&&~n&&($(e,t.options.selectedClass,!1),Et.splice(n,1))}},eventProperties:function(){var e=this,t=[],n=[];return Et.forEach((function(a){var i;t.push({multiDragElement:a,index:a.sortableIndex}),i=Bt&&a!==Mt?-1:Bt?B(a,":not(."+e.options.selectedClass+")"):B(a),n.push({multiDragElement:a,index:i})})),{items:u(Et),clones:[].concat(At),oldIndicies:t,newIndicies:n}},optionListeners:{multiDragKey:function(e){return e=e.toLowerCase(),"ctrl"===e?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function zt(e,t){Et.forEach((function(n,a){var i=t.children[n.sortableIndex+(e?Number(a):0)];i?t.insertBefore(n,i):t.appendChild(n)}))}function qt(e,t){At.forEach((function(n,a){var i=t.children[n.sortableIndex+(e?Number(a):0)];i?t.insertBefore(n,i):t.appendChild(n)}))}function Yt(){Et.forEach((function(e){e!==Mt&&e.parentNode&&e.parentNode.removeChild(e)}))}nt.mount(new _t),nt.mount(Tt,Vt),t["default"]=nt},ab26:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("a9e3"),n("498a"))}(0,(function(){"use strict";function e(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const t={name:"DInputSearch",props:{value:{type:String,default:void 0},allowClear:Boolean,placeholder:{type:String,default:"请输入"},width:{type:[String,Number],default:"240px"},maxLength:{type:Number,default:40}},data:function(){return{actValue:""}},watch:{value:function(e){this.actValue=e}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},methods:{resetData:function(){this.actValue=void 0,this.$emit("input",void 0)},onSearch:function(e){var t=e?e.trim():e;this.$emit("search",{data:t,rows:[t],config:{resultName:this.$attrs.resultName||"inputSearch"}})},handleChange:function(e){var t=this;this.$nextTick((function(){t.$emit("change",e),t.$emit("input",t.actValue)}))}}};var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input-search",{staticClass:"d-input-search",style:{width:e.actWidth},attrs:{"max-length":e.maxLength,placeholder:e.placeholder,allowClear:e.allowClear},on:{search:e.onSearch,change:e.handleChange},model:{value:e.actValue,callback:function(t){e.actValue=t},expression:"actValue"}},[e._t("enterButton",[n("a-button",[e._v(" 搜索 ")])],{slot:"enterButton"})],2)};n._withStripped=!0;const a=e({render:n,staticRenderFns:[]},void 0,t,void 0,!1,void 0,!1,void 0,void 0,void 0);return a.install=function(e){e.component(a.name,a)},a}))},ac08:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("a9e3"),n("caad"),n("d3b7"),n("b64b"),n("a15b"),n("159b"),n("ac1f"),n("1276"),n("5319"),n("466d"),n("fb6a"),n("2b0e"),n("fd87"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("4de4"),n("d81d"),n("99af"),n("2532"),n("a434"),n("cfba"),n("07ac"),n("b680"),n("50f6"),n("3177"),n("2ca0"),n("7db0"),n("7edb"),n("aa47"),n("fb19"),n("73c8"),n("04b3"),n("4e82"),n("9911"),n("e439"),n("90b7"),n("7569"),n("25f0"),n("498a"),n("4ec9"),n("3ca3"),n("ddb0"),n("c740"),n("c1df"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x,D,R,O,V,T,L,$,I,F,M,P,N,E,A,j,B,K,H,z,q,Y,W,G,U,X,J,Q,Z,ee,te,ne,ae,ie,oe,se,re,le,ce,ue,de){"use strict";function he(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var pe=he(h),fe=he(K),me=he(q),ge=he(Y),ve=he(U),ye=he(X),be=he(J),ke=he(de);function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){we(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n,a,i,o,s){try{var r=e[o](s),l=r.value}catch(e){return void n(e)}r.done?t(l):Promise.resolve(l).then(a,i)}function xe(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){Se(o,a,i,s,r,"next",e)}function r(e){Se(o,a,i,s,r,"throw",e)}s(void 0)}))}}var De=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,a=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new O(a||[]);return o._invoke=function(e,t,n){var a=d;return function(i,o){if(a===p)throw new Error("Generator is already running");if(a===f){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var r=x(s,n);if(r){if(r===m)continue;return r}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var l=u(e,t,n);if("normal"===l.type){if(a=n.done?f:h,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=f,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",m={};function g(){}function v(){}function y(){}var b={};l(b,o,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(V([])));w&&w!==n&&a.call(w,o)&&(b=w);var C=y.prototype=g.prototype=Object.create(b);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,s,r){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,r)}),(function(e){n("throw",e,s,r)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,r)}))}r(l.arg)}var i;this._invoke=function(e,a){function o(){return new t((function(t,i){n(e,a,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,n){var a=e.iterator[n.method];if(a===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=u(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function V(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(a.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:T}}function T(){return{value:t,done:!0}}return v.prototype=y,l(C,"constructor",y),l(y,"constructor",v),v.displayName=l(y,r,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,r,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},_(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,i,o){void 0===o&&(o=Promise);var s=new S(c(t,n,a,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(C),l(C,r,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=V,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(a,i){return r.type="throw",r.arg=e,n.next=a,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],r=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:V(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),Re=De,Oe="/gateway/saas-platform-service/api/v1/",Ve="/gateway/goodsservice/api/v1/",Te="/gateway/customer-service/api/v1/",Le="/gateway/logisticsservice/api/v1/",$e={province:"".concat(Oe,"address/province"),city:"".concat(Oe,"address/city"),district:"".concat(Oe,"address/district")},Ie="".concat(Oe,"address/get_by_name"),Fe="".concat(Ve,"goods/custom/list"),Me="".concat(Te,"order/get_region_list"),Pe="".concat(Te,"order/get_customer_list"),Ne="".concat(Te,"order/get_customer_type_list"),Ee="".concat(Ve,"setting/query_goods_attr_setting_list"),Ae="".concat(Ve,"price_system/leve_price_name/select_list"),je="".concat(Ve,"/category/get_category_list_with_nocategory_qty"),Be="".concat(Ve,"setting/query_goods_attr_setting_list"),Ke="".concat(Ve,"warehouse/list"),He="".concat(Ve,"goods/get_sku_unit_list"),ze="".concat(Oe,"staffer/get_corp_all"),qe="".concat(Ve,"category/get_category_list"),Ye="".concat(Ve,"warehouse/get_warehouse_by_corp_id"),We="".concat(Ve,"price_system/leve_price/select_list"),Ge="".concat(Oe,"department/get_corp_tree"),Ue="".concat(Oe,"staffer/list"),Xe="".concat("/gateway/billservice/api/v1/","account/check_list"),Je="".concat(Le,"deliveryMethod/list"),Qe="".concat(Le,"deliveryMethod/list"),Ze="".concat(Le,"logisticsCorp/custom/list"),et="".concat(Le,"logisticsCorp/system/list"),tt="".concat(Le,"logisticsCorp/custom/list"),nt="".concat(Te,"order/get_deliverys"),at="".concat(Te,"order/add_delivery"),it="".concat(Te,"order/update_delivery"),ot="".concat(Te,"order/delete_delivery"),st="".concat(Te,"order/set_default_delivery"),rt="".concat(Te,"customer_info/get_level_price");function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e){var t=!1;return function(){for(var n=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];t||(t=!0,window.requestAnimationFrame((function(){e.apply(n,i),t=!1})))}}function ut(e){if(!e&&"object"!==lt(e))throw new Error("error arguments","deepClone");var t=e.constructor===Array?[]:{};return Object.keys(e).forEach((function(n){e[n]&&"object"===lt(e[n])?t[n]=ut(e[n]):t[n]=e[n]})),t}"object"!==("undefined"==typeof Int8Array?"undefined":lt(Int8Array))&&(pe.default.prototype.$isServer||document.childNodes);var dt=function(e){return!e||"{}"===JSON.stringify(e)||"[]"===JSON.stringify(e)||!e},ht=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&""!==e[n]&&null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return t};function pt(e){for(var t=1,n=arguments.length;t<n;t++){var a=arguments[t]||{};for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];void 0!==o&&(e[i]=o)}}return e}var ft={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return xe(Re.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get(Fe,pt({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(ze,t.dialogConfig.rules);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=138;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(Ke,_e(_e({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Pe,_e(_e({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Be,_e({type:["unit","brand","tag"].indexOf(t.name)},t.dialogConfig.rules));case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=138;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(He,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=138;break;case 71:if(!["account"].includes(t.name)){n.next=84;break}if(!t.localDataCache){n.next=76;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 76:return n.next=78,t.$get(Xe,_e({accountType:t.dialogConfig.payType||1,customerId:t.dialogConfig.customerId},t.dialogConfig.rules));case 78:return g=n.sent,v=g.data,t.localDataCache=v,n.abrupt("return",v);case 82:n.next=138;break;case 84:if("delivery"!==t.name){n.next=97;break}if(!t.localDataCache){n.next=89;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 89:return n.next=91,t.$get(Je,t.dialogConfig.rules);case 91:return y=n.sent,b=y.data,t.localDataCache=b,n.abrupt("return",b);case 95:n.next=138;break;case 97:if("logistics"!==t.name){n.next=110;break}if(!t.localDataCache){n.next=102;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 102:return n.next=104,t.$get(et,t.dialogConfig.rules);case 104:return k=n.sent,w=k.data,t.localDataCache=w,n.abrupt("return",w);case 108:n.next=138;break;case 110:if("customLogistics"!==t.name){n.next=123;break}if(!t.localDataCache){n.next=115;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 115:return n.next=117,t.$get(tt,t.dialogConfig.rules);case 117:return C=n.sent,_=C.data,t.localDataCache=_,n.abrupt("return",_);case 121:n.next=138;break;case 123:if("address"!==t.name){n.next=137;break}if(t.replaceFields={key:"businessId",name:"deliveryName"},!t.localDataCache){n.next=129;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 129:return n.next=131,t.$post(nt,{businessId:t.dialogConfig.customerId});case 131:return S=n.sent,x=S.data,t.localDataCache=x,n.abrupt("return",x);case 135:n.next=138;break;case 137:console.log("未知的 name:",t.name);case 138:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch","click")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},handleInputClick:function(){this.dialogConfig.readonly&&this.clickHandle()},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch","enter")||this.dialogFocus||(this.dialogFocus=!0,this.inputValue?this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1,e.matchingData("enter")})).catch((function(){e.loading=!1})).finally((function(){setTimeout((function(){e.dialogFocus=!1}),300)})):(this.dataList=[],this.loading=!1,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300)))},matchingData:function(e){var t=this,n=function(){var n=null,a=dt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var e=dt(this.value);this.inputValue=e?this.value.name||this.value.value:""}},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(dt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch","focus")},focus:function(){this.$refs.mixSearchInput.focus()}}};function mt(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const gt=ft;var vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue,readOnly:e.dialogConfig.readonly},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle,click:e.handleInputClick},scopedSlots:e._u([{key:"suffix",fn:function(){return[n("a-button",{attrs:{type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle}})]},proxy:!0}]),model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})};vt._withStripped=!0;const yt=mt({render:vt,staticRenderFns:[]},void 0,gt,"data-v-f165b002",!1,void 0,!1,void 0,void 0,void 0);function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function kt(e){return function(e){if(Array.isArray(e))return bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var wt={data:function(){var e=this;return{tableData:[],selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"},pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(t){return"总".concat(t,"条，每页显示").concat(e.pagination.pageSize,"条")}},selectionConfig:{selections:!0},tableSelection:{onChange:null,onSelect:null,onSelectAll:null,onSelectInvert:null,currentPage:null,allPage:null},resultMap:{},searchResult:{}}},computed:{selectOnIndeterminate:function(){return"allPage"===this.selectionContent.selectType&&!!this.selectionContent.noSelectedRowKeys.length&&!!this.selectionContent.selectedRowKeys.length},hasOverSelectionLimit:function(){return this.selectionLimit&&this.selectionContent.selectedRowKeys.length>=this.selectionLimit},rowSelection:function(){var e=this,t=this;return _e(_e({},t.selectionContent.rowSelection),{},{selectedRowKeys:t.selectionContent.selectedRowKeys,onChange:function(e,n){var a;console.log("onChange selectedRowKeys",e),console.log("onChange selectedRows",n);var i=t.selectionContent.primaryKey;if("allPage"===t.selectionContent.selectType&&!e.length)return t.selectionContent.selectType="",void t.handleSelectedClear();if(t.selectionLimit&&e.length>t.selectionLimit)t.$message.warning("最多选择".concat(t.selectionLimit,"条"));else{t.selectionContent.selectedRowKeys=e;var o=t.selectionContent.noSelectedRows,s=t.selectionContent.selectedRows,r=!1;t.tableData.forEach((function(n){e.includes(n[i])?("allPage"===t.selectionContent.selectType&&(r=!0,delete o[n[i]]),s[n[i]]=n):("allPage"===t.selectionContent.selectType&&(r=!0,o[n[i]]=n),delete s[n[i]])})),t.selectionContent.noSelectedRows=o,t.selectionContent.selectedRows=s,"allPage"===t.selectionContent.selectType&&r&&t._generateNoSelectKey();for(var l=arguments.length,c=new Array(l>2?l-2:0),u=2;u<l;u++)c[u-2]=arguments[u];t.tableSelection.onChange&&(a=t.tableSelection).onChange.apply(a,[e,n].concat(c))}},onSelect:function(e,n,a,i){t.tableSelection.onSelect&&t.tableSelection.onSelect(e,n,a,i)},onSelectAll:function(e,n,a){t.tableSelection.onSelectAll&&t.tableSelection.onSelectAll(e,n,a)},onSelectInvert:function(e){t.tableSelection.onSelectInvert&&t.tableSelection.onSelectInvert(e)},hideDefaultSelections:!0,selections:!!t.selectionConfig.selections&&[{key:"currentPage",text:"当前页",onSelect:function(n){"allPage"===t.selectionContent.selectType&&t.handleSelectedClear(),t.selectionContent.selectType="currentPage";var a=t.selectionContent.primaryKey,i=[],o=[];t.tableData.forEach((function(e){t.selectionContent.selectedRowKeys.includes(e[a])?i.push(e):o.push(e)}));var s=e.selectionContent.selectedRows;if((i.length&&o.length||!i.length)&&o.forEach((function(e){s[e[a]]=e})),!o.length){var r=t.selectionContent.selectedRows;i.forEach((function(e){delete r[e[a]]}))}t.selectionContent.selectedRows=s,t._generateKey()}},{key:"allPage",text:"所有页",onSelect:function(e){if("allPage"===t.selectionContent.selectType&&(t.selectionContent.selectedRowKeys.length||t.selectionContent.noSelectedRowKeys.length))t.handleSelectedClear();else{t.selectionContent.selectType="allPage";var n=t.selectionContent.primaryKey;t.tableData.forEach((function(e){t.selectionContent.selectedRows[e[n]]=e}))}t._generateKey()}}]})}},methods:{setPagination:function(e){this.pagination=_e({total:0,pageSize:10,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["5","10","20"],showTotal:function(e){return"总".concat(e,"条")}},e)},setRowSelection:function(e){this.selectionContent.rowSelection=e},dealSelectionCheckBox:function(){var e=this;"allPage"===this.selectionContent.selectType&&(this.tableData.forEach((function(t){try{e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]||e.selectionContent.noSelectedRows[t[e.selectionContent.primaryKey]]||(e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]=t)}catch(e){console.log(e)}})),this._generateKey())},_generateKey:function(){var e=[];for(var t in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.selectedRowKeys=e},_generateNoSelectKey:function(){var e=[];for(var t in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.noSelectedRowKeys=e},handleSelectedClear:function(){return this.selectionContent.selectedRowKeys=[],this.selectionContent.selectedRows={},this.selectionContent.noSelectedRowKeys=[],this.selectionContent.noSelectedRows=[],this.selectionContent.selectType="",this},getRowData:function(e){var t=[];if(e)for(var n in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(n)&&t.push(this.selectionContent.noSelectedRows[n]);else for(var a in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(a)&&t.push(this.selectionContent.selectedRows[a]);return t},setTableSelectType:function(e){this.selectionContent.selectType=e,this.handleSelectedClear()},setSelectRows:function(e){var t=this;e.forEach((function(e){t.selectionContent.selectedRows[e[t.selectionContent.primaryKey]]=e}))},setSelectionStatus:function(e){this.selectionConfig.selections=e},rowClick:function(e){var t=this;if(console.log("单击",e),this.multiple)if(this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key]))this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]];else{if(this.hasOverSelectionLimit)return void this.$message.warning("最多选择".concat(this.selectionLimit,"条"));this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e}else this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=we({},e[this.baseReplaceFields.key],e)},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||this.hasOverSelectionLimit||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.handleOk&&this.handleOk()},dealResult:function(){var e=this;if(this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t];"object"===lt(n)?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}return this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=_e(_e({},e.selectionContent.selectedRows),{},we({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=we({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this}}};const Ct={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:fe.default},methods:{handleClick:function(){this.$emit("click")}}};var _t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[n("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};_t._withStripped=!0;const St=mt({render:_t,staticRenderFns:[]},void 0,Ct,void 0,!1,void 0,!1,void 0,void 0,void 0);var xt=pe.default.prototype.$isServer,Dt=!xt&&document.addEventListener?function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}:function(e,t,n){e&&t&&n&&e.attachEvent("on"+t,n)},Rt=!xt&&document.removeEventListener?function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)}:function(e,t,n){e&&t&&e.detachEvent("on"+t,n)};pe.default.use(me.default);var Ot={CONTAIN:{name:"contain",icon:"fullscreen"},ORIGINAL:{name:"original",icon:"fullscreen-exit"}},Vt=!pe.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",Tt={name:"hImageViewer",props:{host:{type:String},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},showDown:{type:Boolean,default:!0},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},prefix:{type:[Boolean,String],default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!0,mode:Ot.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},baseUrlList:[]}},computed:{picList:function(){var e=this;return this.urlList.filter((function(t,n){return n===e.index}))},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.baseUrlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,n=e.deg,a=e.offsetX,i=e.offsetY,o=e.enableTransition,s={transform:"scale(".concat(t,") rotate(").concat(n,"deg)"),transition:o?"transform .3s":"","margin-left":"".concat(a,"px"),"margin-top":"".concat(i,"px")};return this.mode===Ot.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(){var e=this;this.$nextTick((function(){e.$refs.img[0].complete||(e.loading=!0)}))},urlList:{handler:function(){this.exchangeImage()},deep:!0}},methods:{exchangeImage:function(){var e=this.prefix,t=this.baseUrlList,n="";"string"==typeof e?n=e:e&&(n=this.host);for(var a=0;a<this.urlList.length;a++){var i=this.urlList[a];if(/(http|https):\/\//.test(i))t.push(i);else{var o=i.indexOf("/")>0?"/":"";t.push("".concat(n).concat(o?"/":"").concat(i))}}},hide:function(){this.deviceSupportUninstall(),this.onClose()},download:function(){this.$emit("download",this.currentImg)},deviceSupportInstall:function(){var e=this;this._keyDownHandler=ct((function(t){switch(t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}})),this._mouseWheelHandler=ct((function(t){(t.wheelDelta?t.wheelDelta:-t.detail)>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),Dt(document,"keydown",this._keyDownHandler),Dt(document,Vt,this._mouseWheelHandler)},deviceSupportUninstall:function(){Rt(document,"keydown",this._keyDownHandler),Rt(document,Vt,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var n=this.transform,a=n.offsetX,i=n.offsetY,o=e.pageX,s=e.pageY;this._dragHandler=ct((function(e){t.transform.offsetX=a+e.pageX-o,t.transform.offsetY=i+e.pageY-s})),Dt(document,"mousemove",this._dragHandler),Dt(document,"mouseup",(function(){Rt(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(Ot),t=(Object.values(Ot).indexOf(this.mode)+1)%e.length;this.mode=Ot[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=_e({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),a=n.zoomRate,i=n.rotateDeg,o=n.enableTransition,s=this.transform;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-a).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+a).toFixed(3));break;case"clocelise":s.deg+=i;break;case"anticlocelise":s.deg-=i}s.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["h-image-viewer__wrapper"].focus(),this.exchangeImage()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}};const Lt=Tt;var $t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"viewer-fade"}},[n("div",{ref:"h-image-viewer__wrapper",staticClass:"h-image-viewer__wrapper",style:{"z-index":e.zIndex},attrs:{tabindex:"-1"}},[n("div",{staticClass:"h-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick(t)}}}),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__close",on:{click:e.hide}},[n("a-icon",{attrs:{type:"close"}})],1),e._v(" "),e.isSingle?e._e():[n("span",{staticClass:"h-image-viewer__btn h-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[n("a-icon",{attrs:{type:"arrow-left"}})],1),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[n("a-icon",{attrs:{type:"arrow-right"}})],1)],e._v(" "),n("div",{staticClass:"h-image-viewer__btn h-image-viewer__actions"},[n("div",{staticClass:"h-image-viewer__actions__inner"},[n("a-icon",{attrs:{type:"zoom-out"},on:{click:function(t){return e.handleActions("zoomOut")}}}),e._v(" "),n("a-icon",{attrs:{type:"zoom-in"},on:{click:function(t){return e.handleActions("zoomIn")}}}),e._v(" "),n("a-icon",{attrs:{type:"undo"},on:{click:function(t){return e.handleActions("anticlocelise")}}}),e._v(" "),n("a-icon",{attrs:{type:"redo"},on:{click:function(t){return e.handleActions("clocelise")}}}),e._v(" "),e.showDown?n("a-icon",{attrs:{type:"download"},on:{click:e.download}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"h-image-viewer__canvas"},[e._l(e.picList,(function(t){return n("img",{key:t,ref:"img",refInFor:!0,staticClass:"h-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}})})),e._v(" "),e.loading?n("a-icon",{staticClass:"h-image-loading",attrs:{type:"loading"}}):e._e()],2)],2)])};$t._withStripped=!0;const It=mt({render:$t,staticRenderFns:[]},void 0,Lt,void 0,!1,void 0,!1,void 0,void 0,void 0);var Ft="",Mt=function(){return void 0!==document.documentElement.style.objectFit},Pt=function(e,t){return Nt(e,null!==t||void 0!==t?t?"overflow-y":"overflow-x":"overflow").match(/(scroll|auto)/)},Nt=function(e,t){return(window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle)[t]},Et="none",At="contain",jt="cover",Bt="fill",Kt="scale-down",Ht={name:"HImage",inheritAttrs:!1,props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewBtn:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},showDown:{type:Boolean,default:!1},initial:{type:Number,default:0},prefix:{type:[Boolean,String],default:!0},popover:{type:Boolean,default:!1},popoverConfig:{type:Object,default:function(){return{placement:"right",trigger:"hover",width:"200px",height:"100%"}}}},components:{IconFontBox:St,IconFont:fe.default,ImageViewer:It},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1,imageSrc:""}},provide:function(){return{download:this.download}},computed:{imgHost:function(){return this.$config?this.$config.cosPrefix:""},imageStyle:function(){var e=this.fit;return window&&e?Mt()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter:function(){return window&&!Mt()&&this.fit!==Bt},preview:function(){var e=this.previewSrcList;return Array.isArray(e)&&e.length>0},imageIndex:function(){var e=this.initial||0,t=this.previewSrcList.indexOf(this.src);return t>=0&&(e=t),e}},watch:{src:function(){this.imageSrc=this.exchangeImage(),this.show&&this.loadImage()},show:function(e){e&&this.loadImage()}},mounted:function(){this.imageSrc=this.exchangeImage(),this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{exchangeImage:function(){var e=this.src,t=this.prefix;if(!e)return e;if(/(http|https):\/\//.test(e))return e;var n="";"string"==typeof t?n=t:t&&(n=this.imgHost);var a=e.indexOf("/")>0;return"".concat(n).concat(a?"/":"").concat(e)},handleLazyLoad:function(){var e,t,n,a;e=this.$el,t=this._scrollContainer,a=e.getBoundingClientRect(),n=[window,document,document.documentElement,null,void 0].includes(t)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:t.getBoundingClientRect(),a.top<n.bottom&&a.bottom>n.top&&a.right>n.left&&a.left<n.right&&(this.show=!0,this.removeLazyLoadListener())},download:function(e){this.$emit("download",e)},addLazyLoadListener:function(){var e,t,n=this.scrollContainer,a=null;(t=n)&&t.nodeType===Node.ELEMENT_NODE?a=n:(e=n,a="[object String]"===Object.prototype.toString.call(e)?document.querySelector(a):function(e){for(var t=e;t;){if([window,document,document.documentElement].includes(parent))return window;if(Pt(t))return t;t=t.parentNode}return t}(this.$el)),a&&(this._scrollContainer=a,this._lazyLoadHandler=function(e,t,n,a){var i,o=!1,s=0;function r(){i&&clearTimeout(i)}function l(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=this,h=Date.now()-s;function p(){s=Date.now(),n.apply(d,c)}function f(){i=void 0}o||(a&&!i&&p(),r(),void 0===a&&h>e?p():!0!==t&&(i=setTimeout(a?f:p,void 0===a?e-h:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){r(),o=!0},l}(200,this.handleLazyLoad),a.addEventListener("scroll",this._lazyLoadHandler,!1),this.handleLazyLoad())},removeLazyLoadListener:function(){var e=this._scrollContainer,t=this._lazyLoadHandler;!this.$isServer&&e&&t&&(e.removeEventListener("scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},loadImage:function(){var e=this;if(window){this.loading=!0,this.error=!1;var t=new Image;t.onload=function(n){return e.handleLoad(n,t)},t.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(n){var a=e.$attrs[n];t.setAttribute(n,a)})),t.src=this.imageSrc}},handleLoad:function(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError:function(e){this.loading=!1,this.error=!0,this.$emit("error",e)},getImageStyle:function(e){var t=this.imageWidth,n=this.imageHeight,a=this.$el,i=a.clientWidth,o=a.clientHeight;if(!(t&&n&&i&&o))return{};var s=t/n<1;switch(e===Kt&&(e=t<i&&n<o?Et:At),e){case Et:return{width:"auto",height:"auto"};case At:return s?{width:"auto"}:{height:"auto"};case jt:return s?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(e){!this.preview&&this.previewBtn||this.openViewer()},openViewer:function(){Ft=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closeViewer:function(){document.body.style.overflow=Ft,this.showViewer=!1}}};const zt=Ht;var qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"a-image"},[e.loading?e._t("placeholder",[n("div",{staticClass:"a-image__placeholder"},[e._t("loading",[n("a-icon",{staticClass:"placeholder-icon",attrs:{type:"picture"}})])],2)]):e.error&&e.src?e._t("error",[n("div",{staticClass:"a-image__error"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"icontupianjiazaishibai"}})],1)]):e.popover&&e.src?n("a-popover",{attrs:{placement:e.popoverConfig.placement,trigger:e.popoverConfig.trigger}},[n("template",{slot:"content"},[n("img",{style:{width:e.popoverConfig.width,height:e.popoverConfig.height},attrs:{src:e.src}})]),e._v(" "),n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners))],2):e.src?n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)):e.src?e._e():e._t("none",[n("div",{staticClass:"a-image__none"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"iconzanwutupian2"}})],1)]),e._v(" "),e.preview?[e.showViewer?n("image-viewer",{attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,showDown:e.showDown,"url-list":e.previewSrcList,prefix:e.prefix,host:e.imgHost},on:{download:e.download}}):e._e()]:e._e()],2)};qt._withStripped=!0;const Yt=mt({render:qt,staticRenderFns:[]},void 0,zt,void 0,!1,void 0,!1,void 0,void 0,void 0);var Wt={zIndex:2e3,initialIndex:0,urlList:[]},Gt=pe.default.extend(It);Yt.install=function(e){e.component(Yt.name,Yt)},Yt.api=function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=pt({},Wt,e);var t=new Gt({el:document.createElement("div"),propsData:e,methods:{hide:function(){this.deviceSupportUninstall(),this.$el.parentNode.removeChild(this.$el)},download:function(){e.download&&e.download(this.currentImg)}}}),n=e.body?document.body:e.target;console.log(n),document.body.appendChild(t.$el)}(e)};const Ut={name:"TableCellEllipsisTip",props:{onlyLine:{type:Boolean,default:!1},line:{type:Number,default:1},text:{type:[String,Number],default:""},tip:{type:[String,Number],default:""},position:{type:String,default:"bottom"},id:{type:[String,Number],default:Y.guid()},tipExtAttr:{type:Object,default:function(){return{}}}},data:function(){return{elId:Y.guid().substr(0,5),showTip:!1,actualTip:""}},computed:{cellStyle:function(){return{"line-clamp":this.line}}},mounted:function(){this.tipChange()},updated:function(){this.tipChange()},methods:{tipChange:function(){var e=this;try{var t=this.text?this.text:this.$el.innerText;this.actualTip=this.tip?this.tip:t,this.$nextTick((function(){setTimeout((function(){try{var t=document.getElementById(e.elId);e.showTip=!!t&&Y.isEllipsis(t)}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}),0)}))}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}}};var Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-ellipsis-wrap",attrs:{id:"cell-ellipsis-"+e.id,"cell-ellipsis-id":e.id}},[e.showTip&&!e.onlyLine?n("a-tooltip",e._b({class:"cell-tooltip-"+e.id,attrs:{placement:e.position}},"a-tooltip",e.tipExtAttr,!1),[n("template",{slot:"title"},[e._t("tip",[e._v(e._s(e.actualTip))])],2),e._v(" "),n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n        "+e._s(e.text)+"\n      ")])],2)],2):n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n      "+e._s(e.text)+"\n    ")])],2)],1)};Xt._withStripped=!0;const Jt=mt({render:Xt,staticRenderFns:[]},void 0,Ut,void 0,!1,void 0,!1,void 0,void 0,void 0);function Qt(){return Qt=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Qt.apply(this,arguments)}Jt.install=function(e){e.component(Jt.name,Jt)};var Zt=["attrs","props","domProps"],en=["class","style","directives"],tn=["on","nativeOn"],nn=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},an=function(e){return e.reduce((function(e,t){for(var n in t)if(e[n])if(-1!==Zt.indexOf(n))e[n]=Qt({},e[n],t[n]);else if(-1!==en.indexOf(n)){var a=e[n]instanceof Array?e[n]:[e[n]],i=t[n]instanceof Array?t[n]:[t[n]];e[n]=a.concat(i)}else if(-1!==tn.indexOf(n))for(var o in t[n])if(e[n][o]){var s=e[n][o]instanceof Array?e[n][o]:[e[n][o]],r=t[n][o]instanceof Array?t[n][o]:[t[n][o]];e[n][o]=s.concat(r)}else e[n][o]=t[n][o];else if("hook"==n)for(var l in t[n])e[n][l]=e[n][l]?nn(e[n][l],t[n][l]):t[n][l];else e[n]=t[n];else e[n]=t[n];return e}),{})};function on(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var sn=ve.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function rn(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}var ln=["key"],cn={},un={name:"STable",props:{dragOption:{type:Object,default:function(){return{}}},draggable:Boolean,draggableOption:{type:Object,default:function(){return{minWidth:100,maxWidth:560}}},sortList:{type:Array,default:null},sortConfig:{type:Object,default:function(){return{}}},cellWidth:{type:Object,default:void 0},excludeWidth:{type:Array,default:function(){return[]}}},data:function(){return{components:null,columns:[],hash:""}},computed:{actSortConfig:function(){return _e({unshift:["index"],push:[],key:"key"},this.sortConfig)}},created:function(){this.components={header:{cell:this.resizeableTitle}}},mounted:function(){this.columns=this.sortColumns(),Object.keys(this.dragOption).length&&this.initSortable()},render:function(){var e=this,t=arguments[0],n=this.$attrs,a=this.sortColumns(),i={on:_e({},this.$listeners)};return t("a-table",an([{},{props:_e(_e({},n),{},{columns:a}),scopedSlots:_e({},this.$scopedSlots)},{attrs:{components:this.components}},i,{ref:"tableSort"}]),[Object.keys(this.$slots).map((function(n){return"default"!==n?t("template",{slot:n},[e.$slots[n]]):null}))])},components:{"vue-draggable-resizable":be.default},methods:{sortColumns:function(){var e=this,t=this.$attrs.columns?this.updateColumns(this.$attrs.columns):this.generateColumns(this.$slots.default);if(this.sortList&&this.sortList.length){var n={},a=[];t.forEach((function(e){e.key&&(n[e.key]=e)})),this.sortList.forEach((function(t){!n[t[e.actSortConfig.key]]||e.actSortConfig.unshift.includes(t[e.actSortConfig.key])||e.actSortConfig.push.includes(t[e.actSortConfig.key])||a.push(n[t[e.actSortConfig.key]])}));for(var i=this.actSortConfig.unshift.length-1;i>=0;i--)this.actSortConfig.unshift[i]&&n[this.actSortConfig.unshift[i]]&&a.unshift(n[this.actSortConfig.unshift[i]]);for(var o=this.actSortConfig.push.length-1;o>=0;o--)this.actSortConfig.push[o]&&n[this.actSortConfig.push[o]]&&a.push(n[this.actSortConfig.push[o]]);return a}return t},generateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return t.forEach((function(t){if(t.tag){var a=Q.getKey(t),i=Q.getStyle(t),o=Q.getClass(t),s=Q.getOptionProps(t),r=Q.getEvents(t),l={};Object.keys(r).forEach((function(e){var t=void 0;t=e.startsWith("update:")?"on-"+e.substr("update:".length)+"-change":"on-"+e,l[Q.camelize(t)]=r[e]}));var c=Q.getSlots(t),u=c.default,d=rn(c,["default"]),h=sn({},d,s,{style:i,class:o},l);if(a&&(h.key=a),Q.getSlotOptions(t).__ANT_TABLE_COLUMN_GROUP)h.children=e.generateColumns("function"==typeof u?u():u);else{var p=t.data&&t.data.scopedSlots&&t.data.scopedSlots.default;h.customRender=h.customRender||p}n.push(h)}})),n},updateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],a=this.$slots,i=this.$scopedSlots;return t.forEach((function(t){var o=t.slots,s=void 0===o?{}:o,r=t.scopedSlots,l=void 0===r?{}:r,c=rn(t,["slots","scopedSlots"]),u=sn({},c);Object.keys(s).forEach((function(e){var t=s[e];void 0===u[e]&&a[t]&&(u[e]=1===a[t].length?a[t][0]:a[t])})),Object.keys(l).forEach((function(e){var t=l[e];void 0===u[e]&&i[t]&&(u[e]=i[t])})),t.children&&(u.children=e.updateColumns(u.children)),n.push(u)})),n},generateSlot:function(){},resizeableTitle:function(e,t,n){var a=this,i=this.columns;i.forEach((function(e){cn[e.key]=e.width||0}));var o=pe.default.observable(cn),s=null,r=t.key,l=on(t,ln),c={};if(!(c="selection-column"===r?{dataIndex:"selection-column",key:"selection-column",width:40}:i.find((function(e){return(e.dataIndex||e.key)===r})))||!c.width||"selection-column"===r||this.excludeWidth.includes(r))return c&&c.width?e("th",an([{attrs:{width:c.width}},l]),[n]):e("th",an([{},l]),[n]);var u=this.draggableOption,d=u.maxWidth,h=u.minWidth;return e("th",an([{},l,{directives:[{name:"ant-ref",value:function(e){return s=e}}],attrs:{width:c.width},style:{position:"relative"}}]),[n,e(be.default,{key:c.key,class:"table-draggable-handle",attrs:{w:10,x:o[r]||c.width,z:1,axis:"x",draggable:this.draggable,resizable:!1},on:{dragging:function(e){if(o[r]=0,c.width=Math.max(h,Math.min(e,d)),a.cellWidth){var t=_e(_e({},a.cellWidth),{},we({},c.key,c.width));a.$emit("update:cellWidth",_e({},t))}},dragstop:function(){o[r]=s.getBoundingClientRect().width}},style:{height:"100% !important",bottom:0,left:"auto !important",right:"-5px",cursor:this.draggable?"col-resize":"default","touch-action":"none",transform:"none !important",position:"absolute"}})])},initSortable:function(){var e=this,t=this.$refs.tableSort.$el.querySelectorAll("tbody"),n=Object.assign({},this.dragOption);ye.default.create(t[t.length>1?1:0],_e(_e({handle:".ant-table-row",animation:150},n),{},{onUpdate:function(t){var n=e.$attrs["data-source"],a=t.oldIndex,i=t.newIndex,o=n.splice(a,1)[0];n.splice(i,0,o),e.$emit("onUpdate",{dataSource:n,evt:t})},onStart:function(t){e.$emit("onStart",t)},onAdd:function(t){e.$emit("onAdd",t)},onRemove:function(t){e.$emit("onRemove",t)},onChoose:function(t){e.$emit("onChoose",t)},onEnd:function(t){e.$emit("onEnd",t)},onFilter:function(t){e.$emit("onFilter",t)},onMove:function(t){e.$emit("onMove",t)}}))},changeHandler:function(e){this.$emit("change",e)},refresh:function(e){console.log("refresh"),this.$attrs.columns||this.$forceUpdate()}},install:function(e){e.component(un.name,un)}};St.install=function(e){e.component(St.name,St)};const dn={name:"DOperationBox",components:{IconFontBox:St,CellEllipsisTip:Jt},inject:{selectionContent:{from:"selectionContent",default:void 0},pagination:{from:"pagination",default:void 0}},props:{value:{type:Object,default:function(){return{}}},optionList:{type:Array,default:function(){return[]}},moreSearch:{type:Boolean,default:!0},modalConfig:{type:Object,default:function(){return{}}}},data:function(){return{actOptionList:[],loading:{},visible:!1}},computed:{selectList:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},baseModalConfig:function(){return _e({title:"",okText:"确定",cancelText:"取消",width:"492px",style:"",class:"",resetText:"清空"},this.modalConfig)},actPagination:function(){return this.pagination?this.pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(e){return"总".concat(e,"条")}}},actSelectionContent:function(){return this.selectionContent?this.selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"}}},created:function(){this.generateOptionList()},watch:{optionList:function(){this.generateOptionList()}},methods:{generateOptionList:function(){var e=this;this.loading={},this.actOptionList=[];var t={name:"",key:"",icon:"",iconColor:"#378EFB",textColor:"#378EFB",size:16,loading:void 0};this.optionList.forEach((function(n){n.loading&&e.$set(e.loading,n.key,!1),e.actOptionList.push(_e(_e({},t),n))}))},handleSelect:function(e){"more"===e&&this.$slots.modal?this.visible=!0:this.$emit("optionClick",{name:e,close:this.closeLoading(e),key:e})},optionHandle:function(e){this.loading[e.key]||(e.loading&&(this.loading[e.key]=!0),this.$emit("optionClick",{key:e.key,close:this.closeLoading(e.key),data:e,name:e.name}))},handleDelete:function(e){var t=this,n=null;if("all"===e)this.selectList={};else{n=ut(this.selectList[e]);var a=this.selectList;delete a[e],this.selectList=_e({},a)}this.$nextTick((function(){t.$emit("delete",{name:e,old:n,key:e,config:{name:e,status:"delete",type:"operation",resultName:e}})}))},closeLoading:function(e){var t=this,n=e;return function(){if("all"===n)for(var e in t.loading)t.loading.hasOwnProperty(e)&&(t.loading[e]=!1);else t.loading.hasOwnProperty(n)&&(t.loading[n]=!1)}},modalOk:function(){var e=this;this.modalConfig.ok?this.modalConfig.ok((function(){e.visible=!1})):this.visible=!1},modalCancel:function(){var e=this;this.modalConfig.cancel?this.modalConfig.cancel((function(){e.visible=!1})):this.visible=!1},resetHandle:function(){var e=this;this.modalConfig.reset&&this.modalConfig.reset((function(){e.visible=!1}))}}};var hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"operation-index"},[n("div",{staticClass:"opt-top"},[e.actSelectionContent.selectedRowKeys.length?e._e():n("div",{staticClass:"filter-box"},[n("div",{staticClass:"filter-list"},[e._t("default")],2),e._v(" "),e.moreSearch?n("div",{staticClass:"more-search"},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.handleSelect("more")}}},[e._v("\n          更多搜索\n          "),n("icon-font-box",{attrs:{type:"icongengduosousuo",size:"16",color:"#378EFB"}})],1)]):e._e()]),e._v(" "),e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"select-list"},[n("div",{staticClass:"select-box"},[n("icon-font-box",{attrs:{type:"icon_warning",size:"16",color:"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-text"},[e._v("已选"),n("span",{staticClass:"select-num"},[e._v(e._s("allPage"===e.actSelectionContent.selectType?e.actPagination.total-e.actSelectionContent.noSelectedRowKeys.length:e.actSelectionContent.selectedRowKeys.length))]),e._v("条")]),e._v(" "),n("a",{staticClass:"clear-row",attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleSelect("clear")}}},[e._v("清空选中")])],1),e._v(" "),n("div",{staticClass:"select-rule"},e._l(e.actOptionList,(function(t,a){return n("a",{key:a,staticClass:"select-btn",attrs:{type:"link"},on:{click:function(n){return e.optionHandle(t)}}},[e.loading[t.key]?n("a-spin",{attrs:{size:"small"}}):e._e(),e._v(" "),e.loading[t.key]?e._e():n("icon-font-box",{attrs:{type:t.icon,size:t.size||16,color:t.iconColor||"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-btn-text",style:{color:t.textColor}},[e._v(e._s(t.name))])],1)})),0)]):e._e(),e._v(" "),e.$slots.other?n("div",{staticClass:"other-btn"},[e._t("other")],2):e._e()]),e._v(" "),Object.keys(e.selectList).length&&!e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"opt-bottom"},[e._l(e.selectList,(function(t,a){return n("div",{key:a,staticClass:"tag-box"},[n("div",{staticClass:"tag-label"},[e._v(e._s(t.label))]),e._v(" "),n("div",{staticClass:"tag-info"},[n("cell-ellipsis-tip",{attrs:{tip:t.value}},[e._v(e._s(t.value))])],1),e._v(" "),n("icon-font-box",{staticClass:"tag-close",attrs:{type:"icon_close",size:"14"},on:{click:function(n){return e.handleDelete(t.key)}}})],1)})),e._v(" "),n("a",{attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleDelete("all")}}},[e._v("全部清除")])],2):e._e(),e._v(" "),n("a-modal",{class:e.baseModalConfig.class,style:e.baseModalConfig.style,attrs:{title:e.baseModalConfig.title,"ok-text":e.baseModalConfig.okText,"cancel-text":e.baseModalConfig.cancelText,width:e.baseModalConfig.width,maskClosable:!1,keyboard:!1},on:{ok:e.modalOk,cancel:e.modalCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._t("modal"),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"operation-modal-footer"},[n("div",{staticClass:"operation-reset"},[n("a-button",{attrs:{type:"link"},on:{click:e.resetHandle}},[e._v(e._s(e.baseModalConfig.resetText))])],1),e._v(" "),n("div",{staticClass:"operation-btn"},[n("a-button",{key:"back",on:{click:e.modalCancel}},[e._v("\n            "+e._s(e.baseModalConfig.cancelText)+"\n          ")]),e._v(" "),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("\n            "+e._s(e.baseModalConfig.okText)+"\n          ")])],1)])])],2)],1)};hn._withStripped=!0;const pn=mt({render:hn,staticRenderFns:[]},void 0,dn,void 0,!1,void 0,!1,void 0,void 0,void 0);pn.install=function(e){e.component(pn.name,pn)};var fn=[{id:2,name:"ERP草稿",color:"#52c41a"},{id:3,name:"已过账",color:"#52c41a"},{id:4,name:"ERP删除",color:"#bbbbbb"},{id:5,name:"同步失败",color:"#f5222d"},{id:0,name:"未同步",color:"#378efb"}],mn=[{id:0,name:"盘盈入库"},{id:2,name:"其它入库"}],gn=[{id:1,name:"盘亏出库"},{id:3,name:"其它出库"}],vn=[{id:0,name:"草稿"},{id:1,name:"已过账"},{id:3,name:"已红冲"}],yn={0:vn[0],1:vn[1],2:vn[2]},bn=[{id:0,name:"未支付"},{id:1,name:"部分支付"},{id:2,name:"已支付"}],kn={0:bn[0],1:bn[1]},wn=[{id:1,name:"库存高于上限"},{id:2,name:"库存低于下限"},{id:3,name:"有货"},{id:4,name:"缺货"}],Cn={0:kn[0],1:kn[1]},_n=[{id:5,name:"ERP草稿",color:"#52C41A"},{id:1,name:"已过账",color:"#52C41A"},{id:4,name:"ERP删除",color:"#BBBBBB"},{id:2,name:"草稿",color:"#52C41A"},{id:3,name:"已红冲",color:"#F5222D"},{id:0,name:"未同步",color:"#378EFB"}],Sn=[{id:0,name:"已下架"},{id:1,name:"已上架"}],xn=[{id:0,name:"线下支付"},{id:1,name:"银行卡转账"}],Dn=[{id:1,name:"应收调整"},{id:2,name:"应付调整"}],Rn=[{id:0,name:"草稿"},{id:1,name:"盘点完成"}],On=[{id:0,name:"全部"},{id:1,name:"采购入库"},{id:2,name:"退货入库"},{id:3,name:"盘盈入库"},{id:4,name:"其它入库"},{id:5,name:"销售出库"},{id:6,name:"采购退货"},{id:7,name:"盘亏出库"},{id:8,name:"采购入库"},{id:9,name:"其它出库"},{id:10,name:"同价调拨入库"},{id:11,name:"同价调拨出库"},{id:12,name:"撤销出库"},{id:13,name:"进销存同步"},{id:14,name:"撤销退货"},{id:15,name:"退货单取消"},{id:16,name:"订货单取消"}],Vn=[{id:0,name:"微信账户"},{id:1,name:"预付款账户"},{id:2,name:"现金账户"},{id:3,name:"银行卡账户"}],Tn=[{id:-1,name:"已取消",key:"canceled",btnKeys:["detail","del","share","print","export","copy"]},{id:0,name:"草稿",key:"draft",btnKeys:["detail","submit","submit_audit","del","share","print","export","copy"]},{id:1,name:"待审核",key:"to_audit",btnKeys:["detail","audit","cancel_bill","share","print","export","copy"]},{id:2,name:"待出库",key:"to_stock_removal",btnKeys:["detail","stock_removal","auditee","cancel_bill","share","print","export","copy"]},{id:3,name:"部分出库",key:"portion_stock_removal",btnKeys:["detail","stock_removal","suspend_bill","share","print","export","copy"]},{id:4,name:"待发货",key:"to_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:5,name:"部分发货",key:"portion_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:6,name:"待收货",key:"to_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:7,name:"部分收货",key:"portion_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:8,name:"已完成",key:"finish",btnKeys:["detail","share","print","export","copy"]},{id:9,name:"已中止",key:"suspend",btnKeys:["detail","share","print","export","copy"]}],Ln=[{id:1,name:"已打印"},{id:0,name:"未打印"}],$n=[{id:0,name:"PC端代开"},{id:1,name:"企业微信代开"},{id:2,name:"小程序商城"},{id:3,name:"巡店"},{id:4,name:"Excel导入"}],In=[{id:1,name:"买赠"},{id:2,name:"秒杀"},{id:3,name:"特价"},{id:4,name:"订单促销"},{id:5,name:"组合促销"},{id:6,name:"一口价"},{id:7,name:"拼团"},{id:8,name:"优惠券"},{id:9,name:"分销"}],Fn=[{id:0,name:"不开发票"},{id:1,name:"普通发票"},{id:2,name:"增值税发票"}],Mn=Object.freeze({__proto__:null,billStatus:{0:{name:"草稿",color:"#378EFB",icon:"iconcaogao"},1:{name:"已过账",color:"#52C41A",icon:"iconyiguozhang",stocktakingName:"盘点完成",stocktakingIcon:"icon_stocktaking_completed"},3:{name:"已红冲",color:"#F5222D",icon:"iconyihongchong"}},payStockSync:fn,payStockSyncMap:{0:{name:"未同步",color:"#378efb"},2:{name:"ERP草稿",color:"#52c41a"},3:{name:"已过账",color:"#52c41a"},4:{name:"ERP删除",color:"#bbbbbb"},5:{name:"同步失败",color:"#f5222d"}},inStockMap:mn,outStockMap:gn,orderStatus:vn,orderStatusMap:yn,paymentStatus:bn,paymentStatusMap:kn,stockStatus:wn,stockStatusMap:Cn,stockSync:_n,stockSyncMap:{},saleStatus:Sn,modeOfPayment:xn,exchangePayment:Dn,stockBillStatus:Rn,stockInAndOut:On,accountType:Vn,saleOrderStatus:Tn,printStatus:Ln,billSource:$n,marketingType:In,invoiceType:Fn});const Pn=mt({},void 0,{name:"DMixSelect",props:{value:{type:[String,Number,Array],default:void 0},resultName:{type:String,default:""},type:{type:Number,default:0},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},width:{type:[String,Number],default:120},list:{type:Array,default:null},exclude:{type:Array,default:function(){return[]}},mode:{type:String,default:"select"},getPopupContainer:{type:Function,default:function(){return document.querySelector(".mix-select")}}},data:function(){return{actValue:void 0,options:[],selectLoading:!1}},computed:{modalPlaceholder:function(){return this.placeholder},actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:function(e){this.actValue=e},type:{handler:function(){this.options=[],this.getData()}}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;if(console.log(Mn,this.type),!this.$slots.default)if(this.list)this.options=this.list;else if([0,1,2,11].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$post(11===this.type?Ae:Be,{type:this.type}).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1})).catch((function(){e.selectLoading=!1}))}else if([14].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$get(Je).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1}))}else switch(this.type){case 3:this.options=vn;break;case 4:this.options=bn;break;case 5:this.options=wn;break;case 6:this.options=Sn;break;case 7:this.options=Dn;break;case 8:this.options=_n;break;case 9:this.options=Rn;break;case 10:this.options=On;break;case 12:this.options=Tn;break;case 13:this.options=Ln;break;case 15:this.options=$n;break;case 16:this.options=In;break;case 17:this.options=Fn;break;default:this.options=[]}},handleChange:function(e){var t=lt(e);if(null==e||"object"===t&&!e.length)return this.$emit("input",void 0),this.actValue=void 0,void this.$emit("change",{config:{resultName:this.resultName,status:"delete",type:"select"}});var n="number"===t?{}:[];this.options.forEach((function(a){"number"===t?a.id===e&&(n=a):e.includes(a.id)&&n.push(a)})),this.$emit("input",e),this.actValue=e,this.$emit("change",{data:e,rows:n,config:{resultName:this.resultName,status:"select",type:"select"}})},optionsVisibleHandle:function(){this.options.length||this.$slots.default||this.getData()},resetData:function(){this.actValue=void 0,this.$emit("input",void 0)}},render:function(e){var t=this,n=this;return e("div",{class:"mix-select",style:"width: ".concat(n.actWidth)},[e("a-select",{scopedSlots:n.$scopedSlots,props:{value:n.actValue,allowClear:n.allowClear,placeholder:n.modalPlaceholder,mode:n.mode,getPopupContainer:n.getPopupContainer,disabled:n.disabled},style:"width:100%;",on:{dropdownVisibleChange:n.optionsVisibleHandle,change:n.handleChange}},[n.selectLoading?e("a-spin",{props:{size:"small"},slot:"notFoundContent"}):function(){if(t.$slots.default)return t.$slots.default;var n=[];return t.options.forEach((function(a,i){t.exclude.includes(a.id)||n.push(e("a-select-option",{props:{value:a.id,key:i,title:a.name}},a.name))})),n}()])])}},"data-v-c44b6be8",void 0,void 0,!1,void 0,void 0,void 0);Pn.install=function(e){e.component(Pn.name,Pn)};var Nn={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return xe(Re.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get(Fe,pt({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(ze);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=72;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(Ke,_e({pageNum:1,pageSize:30},a));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Pe,_e({pageNum:1,pageSize:30},a));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Be,{type:["unit","brand","tag"].indexOf(t.name)});case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=72;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(He,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=72;break;case 71:["account"].includes(t.name)?console.log("还没做"):console.log("未知的 name:",t.name);case 72:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300))},matchingData:function(e){var t=this,n=function(){var n=null,a=dt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){var e=this;if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var t=dt(this.value);this.inputValue=t?this.value.name||this.value.value:""}else this.inputValue&&this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1}))},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(dt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch")},focus:function(){this.$refs.mixSearchInput.focus()}}};const En=Nn;var An=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[n("a-button",{attrs:{slot:"suffix",type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle},slot:"suffix"})],1)};An._withStripped=!0;const jn=mt({render:An,staticRenderFns:[]},void 0,En,"data-v-225db93a",!1,void 0,!1,void 0,void 0,void 0);var Bn={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"}};const Kn={name:"Empty",components:{empty:Z.empty,loading:Z.loading},props:{text:{type:String,default:""},loading:{type:Boolean,default:!1}}};var Hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"empty"},[n("div",{staticClass:"icon"},[e._t("icon",[e.loading?n("loading",{staticClass:"empty-icon"}):n("empty",{staticClass:"empty-icon"})])],2),e._v(" "),n("h3",{staticClass:"text"},[e._t("default",[e._v(e._s(e.text?e.text:e.loading?"加载中……":"暂无搜索结果"))])],2)])};Hn._withStripped=!0;const zn=mt({render:Hn,staticRenderFns:[]},void 0,Kn,void 0,!1,void 0,!1,void 0,void 0,void 0);function qn(e){return"object"===lt(e)&&null!==e&&e.constructor&&e.constructor===Object}function Yn(){for(var e=Object(arguments.length<=0?void 0:arguments[0]),t=1;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(n)for(var a=Object.keys(Object(n)),i=0;i<a.length;i++){var o=a[i],s=Object.getOwnPropertyDescriptor(n,o);s&&s.enumerable&&(qn(e[o])&&qn(n[o])?Yn(e[o],n[o]):!qn(e[o])&&qn(n[o])?(e[o]={},Yn(e[o],n[o])):e[o]=n[o])}}return e}zn.install=function(e){e.component(zn.name,zn)};var Wn={data:function(){return{searchResult:{},selectList:{},selectConfig:{},filterSortConfig:{},resultDealStatus:!1,searchFilterDefaultData:void 0,_searchFilterConfig:void 0}},methods:{beforeSearchChange:function(){return!0},beforeTableChange:function(){return!0},tableChange:function(e,t,n){console.log("tableChange 接收到事件改变：",e,t,n);var a=Object.keys(e).length;if(a){if(e.current!==this.pagination.current)return void this.loadTableData(e);if(e.pageSize!==this.pagination.pageSize)return e.current=1,this.pagination.pageSize=e.pageSize,this.handleSelectedClear&&this.handleSelectedClear(),void this.loadTableData(e)}if(!this.beforeTableChange||this.beforeTableChange(e,t,n)){a?e.current===this.pagination.current&&e.pageSize===this.pagination.pageSize&&(e.current=1):e=_e(_e({},this.pagination),{},{current:1});var i=n.columnKey,o=n.order,s=Object.prototype.hasOwnProperty.call(this.searchResult,"sort");o?s?this.searchResult.sort="ascend"===o?this.filterSortConfig[i]:0-this.filterSortConfig[i]:this.searchResult=_e(_e({},this.searchResult),{},{sortField:this.filterSortConfig[i]||i,sortType:"ascend"===o?"asc":"desc"}):s?this.searchResult.sort=void 0:this.searchResult=_e(_e({},this.searchResult),{},{sortField:void 0,sortType:void 0}),this.loadTableData(e)}},searchResultDeal:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log("searchResultDeal 接收到条件变化：",e,t),this.beforeSearchChange(e)){var n=this._resetSearchFilterDefaultData()._getFilterConfig(e);n.deal=t;var a=n.data;n.rows;var i=n.config,o=n.dataType,s=n.columnsName;if("all"===i[e.config.columnsName||e.config.resultName]||this.selectConfig[e.config.columnsName||e.config.resultName]){if("all"===i.resultName&&"delete"===i.status)return this._searchFilterClearAll(e),this.pagination&&(this.pagination.current=1),this.loadTableData(),this;"array"===o&&(a[0]||a[1]||(a=void 0,console.warn("请注意 ".concat(s," 中组件返回的 data 全是空值。")))),null==a||""===a?this._deleteValue():("string"===o||"number"===o?this._dealDataForSingle():"array"===o?this._dealDataForArray():"object"===o?this._dealDataForObject():console.log("啥也不是"),this.selectList=_e({},this.selectList),this.pagination&&(this.pagination.current=1),!t&&this.loadTableData()),this._searchFilterClearRef(e)}else console.error("当前没有配置 selectConfig：",e.config.columnsName||e.config.resultName,"，请注意检查 selectConfig 和对应的 dom 节点是否配置正确！")}},_getFilterConfig:function(e){var t,n=e.data,a=e.rows,i=e.config,o=this,s=i.columnsName||i.resultName,r=Yn(o.searchFilterDefaultData,this.selectConfig[s]);return console.log("合并后的内容：",r,o.searchFilterDefaultData),o._searchFilterConfig={data:n,rows:a,config:i,dataType:(t=n,"[object Null]"===Object.prototype.toString.call(t)?"null":"[object Object]"===Object.prototype.toString.call(t)?"object":"[object Array]"===Object.prototype.toString.call(t)?"array":"[object Undefined]"===Object.prototype.toString.call(t)?"undefined":"[object String]"===Object.prototype.toString.call(t)?"string":"[object Number]"===Object.prototype.toString.call(t)?"number":void 0),columnsName:s,selectList:o.selectList,selectConfig:r,dataCallback:o.selectConfig[s].setText,valueCallback:o.selectConfig[s].setValue,deal:!1,linkMode:r.linkMode||"before",linkType:lt(r.link),link:r.link||"-",valueLink:r.valueLink||","},o._searchFilterConfig},_getActValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=this._searchFilterConfig.selectConfig,i="data"===e?a.dataTarget||"data":a.valueTarget||"data",o="data"===e?a.dataKey:a.valueKey,s="data"===i?t:n;return o?s[o]:s},_checkValueCallback:function(){var e=this._searchFilterConfig,t=e.data,n=e.rows,a=e.valueCallback;if(!a)return!0;a.call(this,{data:t,rows:n})},_deleteSelect:function(e){this.$delete(this.selectList,e)},_updateSelect:function(e,t){console.log(e),this.$set(this.selectList,[e],t)},_deleteValue:function(){var e=this,t=this,n=this._searchFilterConfig,a=n.selectConfig,i=n.columnsName,o=n.deal;a.en?(this._checkValueCallback()&&a.en.forEach((function(t){e.searchResult[t]=void 0})),t._deleteSelect(i)):(this._checkValueCallback()&&(this.searchResult[i]=void 0),t._deleteSelect(i)),t.pagination?o||t.loadTableData(_e(_e({},t.pagination),{},{current:1})):!o&&t.loadTableData()},_dealDataForSingle:function(){var e=this,t=e._searchFilterConfig,n=t.data,a=t.rows,i=t.selectConfig,o=t.columnsName,s=t.dataCallback,r=t.config,l=i.en[0]||o;e._checkValueCallback()&&(this.searchResult[l]=e._getActValue("value",n,a[0]||a)),i.cn.forEach((function(t){e._updateSelect(o,{key:o,label:t,value:s?s({data:n,rows:a}):e._getActValue("data",n,a[0]||a),type:r.type||""})}))},_dealDataForArray:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.linkMode,c=n.linkType,u=n.link,d=n.valueLink,h=n.config,p=s.en,f=s.cn.length>1,m=a.filter((function(e){return!!e})),g="";a.forEach((function(n,o){f&&p.length===a.length?n?(t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])),e._updateSelect(p[o],{key:p[o],label:s.cn[o],value:r?r({data:a,rows:i}):e._getActValue("data",a[o],i[o]),type:h.type||""})):(e._deleteSelect(p[o]),t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)):n?(p.length===a.length?t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])):t._checkValueCallback()&&(e.searchResult[p[0]]=e.searchResult[p[0]]?"".concat(e.searchResult[p[0]]).concat(d||",").concat(e._getActValue("value",a[o],i[o])):e.searchResult[p[0]],s.valueLink||(console.error("请注意设置 valueLink 连词，否则将会导致错误。"),console.error("请注意 searchResult.".concat(s.en[o]," 的值为： ").concat(e.searchResult[s.en[o]],"。")))),r||("string"===c?g=g?"".concat(g).concat(u).concat(t._getActValue("data",a[o],i[o])):t._getActValue("data",a[o],i[o]):1===m.length?(console.log("处理只有一个值的情况"),g=t._getActValue("data",a[o],i[o])):g=a.length-1===o?"".concat(g).concat(u[o]).concat(t._getActValue("data",a[o],i[o])).concat(u[o+1]):"after"===l?"".concat(t._getActValue("data",a[o],i[o])).concat(u[o]):"".concat(u[o]).concat(t._getActValue("data",a[o],i[o])))):t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)})),f&&p.length===a.length||(this.selectList[o]={key:o,label:s.cn[0],value:r?r({data:a,rows:i}):g,type:h.type||""})},_dealDataForObject:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.config;s.cn.forEach((function(n,c){i[c]?(e._checkValueCallback()&&(e.searchResult[s.en[c]]=t._getActValue("value",a,i[c])),e.selectList[o]={key:o,label:n,value:r?r({data:a,rows:i}):t._getActValue("data",a,i[c]),type:l.type||""}):(t._checkValueCallback()&&(e.searchResult[s.en[c]]=void 0),e._deleteSelect(o))}))},_searchFilterClearAll:function(){var e=this;for(var t in this.selectConfig)if(Object.prototype.hasOwnProperty.call(this.selectConfig,t)){var n=this.selectConfig[t].setValue;n?n.call(this):this.selectConfig[t].en.forEach((function(t){e.searchResult[t]=void 0}))}this.$refs.moreSearch&&this.$refs.moreSearch.resetData("all");try{for(var a in this.selectConfig)if(this.selectConfig.hasOwnProperty(a)){var i=this.selectConfig[a].ref;this.$refs["".concat(i||a,"O")]&&this.$refs["".concat(i||a,"O")].resetData(),this.$refs["".concat(i||a,"H")]&&this.$refs["".concat(i||a,"H")].resetData()}}catch(e){console.error("错误预警：",e)}},_searchFilterClearRef:function(e){console.log("清空它的对手：",e);try{var t=e.config.columnsName||e.config.resultName,n=e.config.type,a=this.selectConfig[t].ref;"filterDown"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):"operation"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),e.config.props&&e.config.props.confirm()}catch(e){console.error("错误预警：",e)}},_resetSearchFilterDefaultData:function(){return this.searchFilterDefaultData={cn:[],en:[],link:"",valueLink:"",dataKey:"",valueKey:"",dataTarget:"",valueTarget:"",linkMode:"",setText:void 0,setValue:void 0},this},moreSearchResultDeal:function(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;n++)this.searchResultDeal(e[t[n]],n!==t.length-1)}}},Gn={name:"DSelectWarehouse",components:{STable:un,Empty:zn,DOperationBox:pn,CellEllipsisTip:Jt},mixins:[wt,Wn],props:{visible:{type:Boolean,default:!1},width:{type:[String,Number],default:1e3},title:{type:String,default:"选择仓库"},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"id"}}},beforeClose:{type:Function,default:void 0},rules:{type:Object,default:function(){}},cache:{type:Boolean,default:!1},defaultValue:{type:[Object,Array],default:null},categoryInit:{type:Number,default:1},selectionLimit:{type:Number,default:100}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},data:function(){return{tableData:[],classifyOptions:[],classifyValue:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:""},resultMap:{},disabled:{warehouse:!1},opened:!1}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},baseReplaceFields:function(){return _e({key:"id"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},allClassifyOptions:function(){return[{categoryName:"全部分类",haveChild:!0,isLeaf:!1,id:"1",parentId:"0",pathCode:"1",scopedSlots:{title:"custom"},children:[{categoryName:"未分类",haveChild:!1,id:"0",parentId:"1",isLeaf:!0,pathCode:"0",scopedSlots:{title:"custom"}}].concat(kt(this.classifyOptions))}]}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="id",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&(this.reset().dealResult().loadTableData(),this.loadClassify()),this.opened=!0)}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get(Ke,_e(_e({},this.searchResult),{},{pageNum:t.current,pageSize:t.pageSize},this.rules)).then((function(t){t.data&&(e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},searchHandle:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},classifySearchHandle:function(e){console.log("分类检索:",e)},classifyOnSelect:function(e,t){console.log("classifyOnSelect",t,this.classifyValue);var n=t.node;this.searchResult.categoryPath=t.selected?n.dataRef.pathCode:null,this.handleSelectedClear().loadTableData()},loadClassify:function(e){var t=this;if(this.$get(qe,{}).then((function(){})),e)return new Promise((function(n){var a=e.dataRef;t.$get(qe,{categoryType:2,parentId:a.id}).then((function(e){var i=e.data;i.length&&(a.children=i,t.classifyOptions=kt(t.classifyOptions)),n()}))}));this.$get(qe,{categoryType:2,parentId:this.categoryInit}).then((function(e){t.classifyOptions=e.data}))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const Un=Gn;var Xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-warehouse a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"warehouse-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入分类名称"},on:{search:e.classifySearchHandle}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"classify-wrap"},[n("a-tree",{attrs:{loadData:e.loadClassify,replaceFields:{children:"children",value:"id",title:"categoryName",key:"id"},"tree-data":e.allClassifyOptions,defaultExpandedKeys:["1"],defaultSelectedKeys:["1"],showIcon:""},on:{select:e.classifyOnSelect},model:{value:e.classifyValue,callback:function(t){e.classifyValue=t},expression:"classifyValue"}})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"仓库名称"},on:{search:e.searchHandle},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"index",attrs:{width:60},scopedSlots:e._u([{key:"default",fn:function(t,n,a){return[e._v("\n            "+e._s((e.pagination.current-1)*e.pagination.pageSize+a+1)+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:200,"data-index":"name",title:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:100,"data-index":"code",title:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{title:"地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{tip:""+t.regionName+t.address}},[e._v(" "+e._s(t.regionName)+e._s(t.address)+" ")])]}}])}),e._v(" "),n("a-table-column",{attrs:{width:75,title:"可用"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.erpId?"是":"否")+"\n          ")]}}])})],1)],1)])])};Xn._withStripped=!0;const Jn=mt({render:Xn,staticRenderFns:[]},void 0,Un,void 0,!1,void 0,!1,void 0,void 0,void 0);Jn.install=function(e){e.component(Jn.name,Jn)};const Qn=mt({},void 0,{name:"DSelectWarehouseInput",props:{name:{type:String,default:"warehouse"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:Bn,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){this.modalValue=e||void 0},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e,t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];this.multiple=!0===this.valueMode&&t&&!t.length,e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=Jn,this.dialogProps=pt(this.dialogProps,e[this.name],this.dialogConfig)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=pt(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},confirmHandle:function(e){["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=_e({},this.modalValue))},resultExchange:function(e){var t=e.rows[0];"select"!==this.valueMode&&(this.$emit("input",t),this.modalValue=t),this.$emit("change",_e(_e({},e),{},{data:this.multiple?e.rows:t,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"}}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:_e({},this.dialogProps),props:_e(_e({},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:jn}},void 0,void 0,void 0,!1,void 0,void 0,void 0);Qn.install=function(e){e.component(Qn.name,Qn)};var Zn=[],ea=function e(t){for(var n=0;n<t.length;n++){var a=t[n],i=a.id;Zn.push({key:i,title:a.categoryName}),a.children&&e(a.children)}},ta=function e(t,n){for(var a,i=0;i<n.length;i++){var o=n[i];o.children&&(o.children.some((function(e){return e.id===t}))?a=o.id:e(t,o.children)&&(a=e(t,o.children)))}return a},na={name:"DSelectProduct",mixins:[wt],provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},props:{visible:{type:Boolean,default:!1},width:{tpye:[String,Number],default:1250},title:{type:String,default:"选择商品"},cache:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},replaceFields:{type:Object,default:function(){return{key:"id"}}},rules:{type:Object,default:function(){return{}}},origin:{type:String,default:"page"},sortList:{type:Array,default:void 0},mode:{type:String,default:"default"},defaultValue:{type:[Object,Array],default:null},displayItems:{type:Array,default:function(){return["classify","warehouse","brand","shelves","inventory","salesPromotion","bought"]}},selectionLimit:{type:Number,default:100}},data:function(){return{modalConfig:{},tableData:[],tableLoading:!1,scrollHeight:0,inventory:!1,promotion:!1,isBought:!1,searchResult:{type:4,isShowSku:!0,keywords:void 0,customerId:void 0,warehouseId:void 0,brandId:void 0,categoryPath:void 0,saleStatus:1,checkList:"",isOverrideWarehouse:"",showList:[]},resultMap:{warehouse:{key:"warehouseId",ref:"warehouseMixSearch"}},disabled:{warehouse:!1},headerConfig:{1:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],2:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}],3:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],4:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"avgPrice"}],5:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"},{key:"levelPrice"}],6:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"stock"},{key:"avgPrice"}],7:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],8:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],9:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"}],10:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}]},treeData:[{categoryName:"全部分类",key:"1",pathCode:"",id:"1",children:[{categoryName:"未分类",key:"2",isLeaf:!0,pathCode:"0",id:"2"}]}],name:"warehouse",keywordtree:"",expandedKeys:[],autoExpandParent:!0,searchValue:"",tabLable:"0"}},watch:{visible:function(e){var t=this;e&&(this.selectionContent.primaryKey=this.baseReplaceFields.key,this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.modalConfig={title:"选择商品"},this.$nextTick((function(){t.handleSelectedClear(),t.dealResult(),t.cache||(t.mergeResult(),t.dealResult(),"0"===t.tabLable?t.initTreeData():t.loadTableData())})))}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},sortColumns:function(){return this.sortList?this.sortList:this.headerConfig[this.searchResult.type]},baseReplaceFields:function(){return _e({key:"id",warehouse:"warehouseId"},this.replaceFields)}},filters:{getPrice:function(e){return void 0===e||""===e||null===e?"-":e}},methods:{inventoryChange:function(){this.inventory?this.changeData(!0,"2"):this.changeData(!1,"2")},isBoughtChange:function(){this.isBought?(this.tabLable="1",this.changeData(!0,"1")):(this.searchResult.categoryPath="",this.tabLable="0",this.changeData(!1,"1"))},promotionChange:function(){this.promotion?this.changeData(!0,"3"):this.changeData(!1,"3")},onSearchTree:function(e){var t=this,n=e.target.value,a=Zn.map((function(e){return e.title.indexOf(n)>-1?ta(e.key,t.treeData):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:n,autoExpandParent:!0})},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onLoadData:function(e){var t=this;return new Promise((function(n){e.dataRef.children?n():t.$get(qe,{categoryType:0,parentId:e.dataRef.id}).then((function(a){"warehouse"===t.name&&(a.data.length&&(e.dataRef.children=a.data,t.treeData=kt(t.treeData),ea(t.treeData)),n())}))}))},initTreeData:function(){var e=this;this.$get(qe,{categoryType:0,parentId:0}).then((function(t){e.treeData[0].children=e.treeData[0].children.concat(t.data),ea(e.treeData),e.treeData&&e.treeData.length>0&&(e.searchResult.categoryPath=e.treeData[0].pathCode,e.loadTableData())}))},changeData:function(e,t){var n;n=this.searchResult.checkList?this.searchResult.checkList.split(","):[],e?n.includes(t)||n.push(t):n.includes(t)&&n.splice(n.indexOf(t),1),this.searchResult.checkList=n.join(","),this.searchReset().loadTableData()},loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get(Fe,_e(_e({},ht(this.searchResult)),{},{pageNum:t.current,pageSize:t.pageSize,sort:-1})).then((function(t){t.data&&(e.tableData=t.data.list,e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},dealResult:function(){var e=this;if("warehouse"===this.mode&&(this.defaultValue&&this.defaultValue[this.baseReplaceFields.warehouse]?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=this.defaultValue[this.baseReplaceFields.warehouse]):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse&&(this.searchResult.warehouseId=this.rules.warehouse.id))),this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t],a=lt(n);if("warehouse"===t&&"warehouse"===this.mode)return;"object"===a?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}if(this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=_e(_e({},e.selectionContent.selectedRows),{},we({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=we({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this.rules.checkList&&this.rules.checkList.length>0){var i=this.rules.checkList.split(",");i.includes("1")?(this.tabLable="1",this.searchResult.categoryPath="",this.isBought=!0):(this.tabLable="0",this.isBought=!1),i.includes("2")?this.inventory=!0:this.tabLable=!1,i.includes("3")?this.promotion=!0:this.promotion=!1}},onSearch:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},saleChange:function(e){var t=e.data;this.searchResult.saleStatus=t,this.searchReset().loadTableData()},warehouseChange:function(e){"warehouse"===this.mode?e.data?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=e.data.id):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse?this.searchResult.warehouseId=this.rules.warehouse.id:this.searchResult.warehouseId=void 0):(this.handleSelectedClear(),e.data?this.searchResult.warehouseId=e.data.id:this.searchResult.warehouseId=void 0),this.searchReset().loadTableData()},brandChange:function(){this.handleSelectedClear(),this.searchReset().loadTableData()},selectCurrentNode:function(e,t){this.handleSelectedClear();var n=t.node.dataRef;this.searchResult.categoryPath=t.selected?n.pathCode:null,this.searchReset().loadTableData()},tableChange:function(e,t,n){if(e.current===this.pagination.current||e.pageSize!==this.pagination.pageSize)return this.handleSelectedClear(),e.current=1,void this.loadTableData();this.loadTableData(e)},searchReset:function(){return this.tableData=[],this.pagination.current=1,this.pagination.total=0,this},rowClick:function(e){var t=this;console.log("单击",e),this.multiple?this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])?(this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]):(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e):(this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=we({},e[this.baseReplaceFields.key],e))},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.okHandle()},mergeResult:function(){this.pagination.current=1,this.searchResult={type:this.rules.type||4,isShowSku:this.rules.isShowSku||!0,keywords:this.rules.keywords||void 0,customerId:this.rules.customerId||void 0,warehouseId:this.rules.warehouseId||void 0,brandId:this.rules.brandId||void 0,categoryPath:this.rules.categoryPath||void 0,saleStatus:this.rules.saleStatus||void 0,checkList:this.rules.saleStatus||""}},okHandle:function(){if(!(this.selectionContent.selectedRowKeys.length>this.selectionLimit))return this.multiple?this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),void this.$emit("update:visible",!1)):void this.$emit("update:visible",!1):void(this.$attrs.product&&this.selectionContent.selectedRowKeys[0]===this.$attrs.product[this.baseReplaceFields.key]?this.$emit("update:visible",!1):this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.$emit("update:visible",!1)):this.$emit("update:visible",!1));this.$message.warning("最多选择".concat(this.selectionLimit,"条"))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()}},components:{OperationBox:pn,DSelectWarehouseInput:Qn,MixSelect:Pn,Empty:zn,HImage:Yt,CellEllipsisTip:Jt,STable:un}};const aa=na;var ia=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-product a-table-common",attrs:{keyboard:!1,maskClosable:!1,title:e.modalConfig.title,width:e.width},on:{ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{ref:"productModal"},[n("div",{staticClass:"choose-product-content"},["0"===e.tabLable&&e.displayItems.includes("classify")?n("div",{staticClass:"tree-control"},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"请输入分类名称"},on:{change:e.onSearchTree},model:{value:e.keywordtree,callback:function(t){e.keywordtree=t},expression:"keywordtree"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"tree-control-contain"},[n("a-tree",{attrs:{"auto-expand-parent":e.autoExpandParent,"expanded-keys":e.expandedKeys,"load-data":e.onLoadData,replaceFields:{children:"children",title:"categoryName",key:"id"},"tree-data":e.treeData},on:{expand:e.onExpand,select:e.selectCurrentNode}})],1)],1):e._e(),e._v(" "),n("div",{staticClass:"table-control",class:{"table-width":"1"===e.tabLable||!e.displayItems.includes("classify")}},[n("operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{staticStyle:{width:"240px"},attrs:{maxLength:40,allowClear:"",placeholder:"商品名称/编号/条码/关键字"},on:{search:e.onSearch},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),e.displayItems.includes("warehouse")?n("DSelectWarehouseInput",{ref:"warehouseMixSearch",attrs:{disabled:e.disabled.warehouse,width:120,allowClear:"",name:"warehouse",placeholder:"仓库"},on:{change:e.warehouseChange}}):e._e(),e._v(" "),e.displayItems.includes("brand")?n("MixSelect",{attrs:{type:1,width:120,allowClear:""},on:{change:e.brandChange},model:{value:e.searchResult.brandId,callback:function(t){e.$set(e.searchResult,"brandId",t)},expression:"searchResult.brandId"}}):e._e(),e._v(" "),e.displayItems.includes("shelves")?n("MixSelect",{attrs:{list:[{id:1,name:"上架"},{id:0,name:"下架"}],width:120,"allow-clear":"",placeholder:"上下架"},on:{change:e.saleChange},model:{value:e.searchResult.saleStatus,callback:function(t){e.$set(e.searchResult,"saleStatus",t)},expression:"searchResult.saleStatus"}}):e._e(),e._v(" "),e.displayItems.includes("inventory")?n("a-checkbox",{staticClass:"check-line",on:{change:e.inventoryChange},model:{value:e.inventory,callback:function(t){e.inventory=t},expression:"inventory"}},[e._v("库存大于0\n          ")]):e._e(),e._v(" "),e.displayItems.includes("salesPromotion")?n("a-checkbox",{staticClass:"check-line",on:{change:e.promotionChange},model:{value:e.promotion,callback:function(t){e.promotion=t},expression:"promotion"}},[e._v("促销商品\n          ")]):e._e(),e._v(" "),e.displayItems.includes("bought")?n("a-checkbox",{staticClass:"check-line",on:{change:e.isBoughtChange},model:{value:e.isBought,callback:function(t){e.isBought=t},expression:"isBought"}},[e._v("买过商品\n          ")]):e._e()],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table-content",attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:e.selectionContent.primaryKey,scroll:{y:"calc(100vh - 490px)"},"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"code",attrs:{"data-index":"code",title:"商品编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"barCode",attrs:{title:"商品条码"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.barCode||"-"}})]}}])}),e._v(" "),n("a-table-column",{key:"cover",attrs:{title:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h-image",{staticStyle:{width:"48px",height:"48px"},attrs:{initial:0,"preview-src-list":[t.cover],src:e._f("formatImage")(t.cover,48),fit:"cover",popover:""}})]}}])}),e._v(" "),n("a-table-column",{key:"name",attrs:{title:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.name}})]}}])}),e._v(" "),n("a-table-column",{key:"skuName",attrs:{"data-index":"skuName",title:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"warehouseName",attrs:{"data-index":"warehouseName",title:"仓库"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"stock",attrs:{"data-index":"stock",title:"库存数量"}}),e._v(" "),n("a-table-column",{key:"avgPrice",attrs:{"data-index":"avgPrice",title:"成本均价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"lastPrice",attrs:{"data-index":"lastPrice",title:"最近进价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"baseUnitName",attrs:{"data-index":"baseUnitName",title:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"unitPrice",attrs:{"data-index":"unitPrice",title:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"levelPrice",attrs:{"data-index":"levelPrice",title:"级别价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])})],1)],1)])])])};ia._withStripped=!0;const oa=mt({render:ia,staticRenderFns:[]},void 0,aa,void 0,!1,void 0,!1,void 0,void 0,void 0);oa.install=function(e){e.component(oa.name,oa)};var sa={name:"DSelectPeople",mixins:[wt,Wn],components:{CellEllipsisTip:Jt,STable:un,DOperationBox:pn,Empty:zn},props:{width:{type:Number,default:1e3},cache:{type:Boolean,default:!1},visible:{type:Boolean,default:!1},title:{type:String,default:"选择经手人"},placeholderLeft:{type:String,default:"请输入部门名称"},placeholderRight:{type:String,default:"姓名/手机号"},multiple:{type:Boolean,default:!1},beforeClose:{type:Function,default:void 0},replaceFields:{type:Object,default:function(){}},rules:{type:Object,default:function(){return{}}},defaultValue:{type:[Object,Array],default:null},selectionLimit:{type:Number,default:100}},data:function(){return{corpTree:{data:[],keywords:null,expandedKeys:[],selectedKeys:[],autoExpandParent:!0,treeFirstNode:null,loading:!1},tableData:[],searchData:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:{}},opened:!1}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="stafferId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&this.reset().dealResult().getCorpTree(),this.opened=!0)}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},baseReplaceFields:function(){return _e({key:"stafferId"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}}},methods:{onSelectCorpTreeNode:function(e,t){console.log("onSelectCorpTreeNode",e,t),t.selected?this.corpTree.selectedKeys=[t.node.dataRef.businessId]:this.corpTree.selectedKeys=[this.corpTree.treeFirstNode.businessId],this.searchResult.categoryPath=t.selected?t.node.dataRef:this.corpTree.treeFirstNode,this.dealResult().loadTableData()},onExpand:function(e){this.corpTree.expandedKeys=e,this.corpTree.autoExpandParent=!1},getParentKey:function(e,t){for(var n,a=0;a<t.length;a++){var i=t[a];i.children&&(i.children.some((function(t){return t.businessId===e}))?n=i.businessId:this.getParentKey(e,i.children)&&(n=this.getParentKey(e,i.children)))}return n},onSearchTree:function(e){var t=this,n=e.target.value;this.corpTree.expandedKeys=this.searchData.map((function(e){return e.name.indexOf(n)>-1?t.getParentKey(e.businessId,t.corpTree.data):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t})),this.corpTree.autoExpandParent=!0},handleSearchByKeywords:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},loadTableData:function(){var e=arguments,t=this;return xe(Re.mark((function n(){var a,i,o;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.pagination,n.prev=1,t.tableLoading=!0,n.next=5,t.$post(Ue,_e({corpId:t.searchResult.categoryPath.corpId||"",departmentId:t.searchResult.categoryPath.businessId||"",keyword:t.searchResult.keywords||"",dismiss:!1,entryDateBegin:"",entryDateEnd:"",isAdmin:"",locked:!1,normal:!0,pageNum:a.pageNum||1,pageSize:a.pageSize||30},t.rules));case 5:i=n.sent,o=i.data,t.tableData=o.list,t.dealSelectionCheckBox(),t.pagination.total=o.total,t.pagination.current=o.pageNum,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(1),console.error(n.t0);case 16:return n.prev=16,t.tableLoading=!1,n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[1,13,16,19]])})))()},getCorpTree:function(){var e=this;return xe(Re.mark((function t(){var n,a;return Re.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.corpTree.loading=!0,t.next=4,e.$get(Ge);case 4:n=t.sent,a=n.data,e.corpTree.data=a,function t(n){var a=[];return n.forEach((function(n){n.scopedSlots={title:"title"},e.searchData.push(n),n.children&&n.children.length&&t(n.children),a.push(n)})),a}(a),e.corpTree.data&&e.corpTree.data.length>0&&(e.corpTree.treeFirstNode=e.corpTree.data[0],e.corpTree.selectedKeys=[e.corpTree.treeFirstNode.businessId],e.searchResult.categoryPath=e.corpTree.data[0],e.loadTableData()),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0);case 15:return t.prev=15,e.corpTree.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})))()},handleOk:function(){if(this.selectionContent.selectedRowKeys.length>this.selectionLimit)this.$message.warning("最多选择".concat(this.selectionLimit,"条"));else{var e={data:this.selectionContent.selectedRowKeys,rows:this.getRowData()};this.beforeClose?this.beforeClose(e):this.$emit("confirm",e),this.$emit("update:visible",!1)}},reset:function(){return this.tableData=[],this.corpTree.keywords="",this.corpTree.expandedKeys=[],this.corpTree.selectedKeys=[],this.corpTree.autoExpandParent=!0,this.corpTree.data=[],this.searchResult={keywords:"",categoryPath:{}},this.corpTree.treeFirstNode=null,this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this},onOperationClick:function(e){"clear"===e.name&&this.handleSelectedClear()},handleCancel:function(){this.$emit("cancel"),this.$emit("update:visible",!1)}}};const ra=sa;var la=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-people a-table-common modal-reset-no-padding",attrs:{footer:null,keyboard:!1,maskClosable:!1,title:e.title,width:e.width,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"people-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:e.placeholderLeft,allowClear:""},on:{change:e.onSearchTree},model:{value:e.corpTree.keywords,callback:function(t){e.$set(e.corpTree,"keywords",t)},expression:"corpTree.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.corpTree.loading,expression:"corpTree.loading"}],staticClass:"classify-wrap"},[n("a-tree",{attrs:{"auto-expand-parent":e.corpTree.autoExpandParent,"expanded-keys":e.corpTree.expandedKeys,replaceFields:{children:"children",title:"name",key:"businessId"},"selected-keys":e.corpTree.selectedKeys,"tree-data":e.corpTree.data},on:{expand:e.onExpand,select:e.onSelectCorpTreeNode},scopedSlots:e._u([{key:"title",fn:function(t){var a=t.name;return[a.indexOf(e.corpTree.keywords)>-1?n("span",[e._v("\n              "+e._s(a.substr(0,a.indexOf(e.corpTree.keywords)))+"\n              "),n("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.corpTree.keywords))]),e._v("\n              "+e._s(a.substr(a.indexOf(e.corpTree.keywords)+e.corpTree.keywords.length))+"\n            ")]):n("span",[e._v(e._s(a))])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationClick}},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholderRight,allowClear:""},on:{search:e.handleSearchByKeywords},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{"data-index":"name",title:"姓名"}}),e._v(" "),n("a-table-column",{key:"stafferNo",attrs:{"data-index":"stafferNo",title:"编号"}}),e._v(" "),n("a-table-column",{key:"departmentName",attrs:{title:"部门"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.departmentName}})]}}])}),e._v(" "),n("a-table-column",{key:"mobile",attrs:{"data-index":"mobile",title:"联系电话"}})],1)],1)]),e._v(" "),n("div",{staticClass:"select-people-footer"},[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n    "),n("a-button",{attrs:{disabled:!e.selectionContent.selectedRowKeys||0===e.selectionContent.selectedRowKeys.length,type:"primary"},on:{click:e.handleOk}},[e._v("\n      确 定\n    ")])],1)])};la._withStripped=!0;const ca=mt({render:la,staticRenderFns:[]},void 0,ra,void 0,!1,void 0,!1,void 0,void 0,void 0);ca.install=function(e){e.component(ca.name,ca)};var ua={name:"DSelectSaleArea",props:{width:{require:!1,type:String,default:"120"},maxHeight:{require:!1,type:String,default:"300"},placeholder:{require:!1,type:String,default:"销售区域"}},data:function(){return{value:void 0,parentId:0,replaceFields:{children:"children",value:"id",title:"name",key:"id"},treeData:[],apiName:null}},created:function(){this.treeData.length||this.getList([],!1)},methods:{openSelect:function(){this.treeData.length||this.getList([],!1)},getList:function(){var e=arguments,t=this;return xe(Re.mark((function n(){var a,i,o,s;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:[],i=e.length>1&&void 0!==e[1]&&e[1],n.prev=2,n.next=5,t.$post(Me,{businessId:t.parentId});case 5:o=n.sent,(s=o.data).length>0&&(i?(a.children=s,t.treeData=kt(t.treeData)):t.treeData=s),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,10]])})))()},onLoadData:function(e){var t=this;return new Promise((function(n){var a=e.dataRef;a.hasChildren?setTimeout((function(){t.parentId=a.id,t.getList(a,!0),n()}),300):n()}))},changeValue:function(e){this.$emit("sureSelect",e)}}};const da=ua;var ha=function(){var e=this,t=e.$createElement;return(e._self._c||t)("a-tree-select",{style:{width:e.width+"px"},attrs:{allowClear:"","tree-data-simple-mode":"","dropdown-style":{width:+e.width+60+"px",maxHeight:e.maxHeight+"px",overflow:"auto"},"tree-data":e.treeData,placeholder:e.placeholder,"load-data":e.onLoadData,replaceFields:e.replaceFields},on:{change:e.changeValue},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})};ha._withStripped=!0;const pa=mt({render:ha,staticRenderFns:[]},void 0,da,"data-v-1c52a95a",!1,void 0,!1,void 0,void 0,void 0);pa.install=function(e){e.component(pa.name,pa)};var fa={name:"DSelectCustomer",components:{Empty:zn,SelectSaleArea:pa,DOperationBox:pn,CellEllipsisTip:Jt,STable:un},mixins:[wt,Wn],props:{visible:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},cache:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:[Number,String],default:1e3},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"businessId"}}},attrs:{type:Object,default:function(){}},defaultSelectedRowKeys:{type:Object,default:function(){return{selectedRowKeys:[],selectedRows:[]}}},isShowPrice:{type:Boolean,default:!1},customerType:{type:Array,default:function(){return[1,2,3,4]}},sortList:{type:Array,default:void 0},defaultValue:{type:[Array,Object],default:void 0},beforeClose:{type:Function,default:void 0},selectionLimit:{type:Number,default:100},placeholder:{type:String,default:null}},data:function(){return{tableData:[],levelPrices:{data:[],loading:!1},searchResult:{customerTypeIds:[],keywords:null,priceLevelId:null,regionId:null},customers:{loading:!1},categories:{keyword:"",data:[],loading:{}}}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},filteredCategories:function(){var e=this;return this.categories.keyword?this.categories.data.filter((function(t){return t.label.indexOf(e.categories.keyword)>-1})):this.categories.data},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.customers.loading}})}},baseReplaceFields:function(){return _e({key:"businessId"},this.replaceFields)},sortColumns:function(){return this.sortList?this.sortList:[{key:"name"},{key:"region"},{key:"priceLevel"}]},getTitle:function(){return this.customerType.includes(1)&&this.customerType.includes(2)?"客户":this.customerType.includes(1)?"供应商":"客户"},tablePlaceholder:function(){return this.placeholder?this.placeholder:"".concat(this.getTitle,"名称/联系人/手机")}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="businessId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.cache||(this.reset().dealResult().loadTableData(),this.handleFetchCategories(),this.handleFetchLevelPrice()))},defaultSelectedRowKeys:{handler:function(e){var t=ae.deepClone(e);this.selectionContent.selectedRowKeys=t.selectedRowKeys,this.selectionContent.selectedRows=t.selectedRows},immediate:!0}},filters:{balance:function(e,t){if(e){var n=e.filter((function(e){return e.value===t}));return n.length?n[0].label:"-"}return"-"}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.customers.loading=!0,this.$post(Pe,_e(_e({pageNum:t.current,pageSize:t.pageSize,orderCustomerTypeList:this.customerType,keyword:this.searchResult.keywords},this.searchResult),this.rules)).then((function(t){e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum})).finally((function(){e.customers.loading=!1}))},onCustomersSearch:function(e,t){this.searchResult[e]=t,this.handleSelectedClear().loadTableData()},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},handleFetchCategories:function(){var e=this;this.categories.loading=!0,this.$post(Ne).then((function(t){e.categories.data=t.data||[]})).catch((function(e){return console.error(e)})).finally((function(){e.categories.loading=!1}))},handleFetchLevelPrice:function(){var e=this;this.isShowPrice&&(this.levelPrices.loading=!0,this.$post(We).then((function(t){e.levelPrices.data=t.data||[]})).finally((function(){e.levelPrices.loading=!1})))},onOperationOptionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const ma=fa;var ga=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",e._b({staticClass:"d-select-customer a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title||"选择"+e.getTitle,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},"a-modal",e.attrs,!1),[n("div",{staticClass:"customer-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{attrs:{maxLength:40,placeholder:"请输入分类名称"},model:{value:e.categories.keyword,callback:function(t){e.$set(e.categories,"keyword",t)},expression:"categories.keyword"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.categories.loading,expression:"categories.loading"}],staticClass:"classify-wrap"},[n("a-checkbox-group",{attrs:{name:"checkboxgroup"},on:{change:function(t){return e.onCustomersSearch("customerTypeIds",arguments[0])}},model:{value:e.searchResult.customerTypeIds,callback:function(t){e.$set(e.searchResult,"customerTypeIds",t)},expression:"searchResult.customerTypeIds"}},[n("a-row",[n("a-space",{attrs:{direction:"vertical"}},e._l(e.filteredCategories,(function(t,a){return n("a-col",{key:a,attrs:{span:24}},[n("a-checkbox",{attrs:{value:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])],1)})),1)],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationOptionClick}},[n("a-space",[n("a-input-search",{attrs:{maxLength:40,placeholder:e.tablePlaceholder},on:{search:function(t){return e.onCustomersSearch("keywords",arguments[0])}},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.isShowPrice?n("a-select",{staticStyle:{width:"120px"},attrs:{loading:e.levelPrices.loading,allowClear:"",placeholder:"级别价"},on:{change:function(t){return e.onCustomersSearch("priceLevelId",arguments[0])}}},e._l(e.levelPrices.data,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1):e._e(),e._v(" "),n("select-sale-area",{staticClass:"select-area",attrs:{placeholder:"销售区域"},on:{sureSelect:function(t){return e.onCustomersSearch("regionId",arguments[0])}}})],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.customers.loading,expression:"customers.loading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate,"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{title:e.getTitle+"名称","data-index":"name"}}),e._v(" "),n("a-table-column",{key:"region",attrs:{title:"销售区域"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{line:2,tip:""+t.region}},[e._v("\n              "+e._s(t.region)+"\n            ")])]}}])}),e._v(" "),n("a-table-column",{key:"priceLevel",attrs:{"data-index":"priceLevel",title:"级别价"}}),e._v(" "),n("a-table-column",{key:"balanceList1",attrs:{title:"应收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,1))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList2",attrs:{title:"应付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,2))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList3",attrs:{title:"预收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,3))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList4",attrs:{title:"预付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,4))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList5",attrs:{title:"积分"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,5))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList6",attrs:{title:"第三方ERP"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,6))+"\n          ")]}}])})],1)],1)])])};ga._withStripped=!0;const va=mt({render:ga,staticRenderFns:[]},void 0,ma,void 0,!1,void 0,!1,void 0,void 0,void 0);va.install=function(e){e.component(va.name,va)};const ya=mt({},void 0,{name:"SelectGroup",props:{value:{type:[String,Boolean,Number,Array],default:void 0},options:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}}},computed:{baseReplaceFields:function(){return _e({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{lineClick:function(e){if(this.multiple)if(this.checkValue.includes(e[this.baseReplaceFields.key])){var t=this.checkValue.indexOf(e[this.baseReplaceFields.key]);this.checkValue.splice(t,1)}else this.checkValue.push(e[this.baseReplaceFields.key]);else this.checkValue=e[this.baseReplaceFields.key]},getData:function(){var e=this,t=this.options.filter((function(t){return e.multiple?e.checkValue.includes(t[e.baseReplaceFields.key]):t[e.baseReplaceFields.key]===e.checkValue}));return{checkValue:this.checkValue,data:this.checkValue,rows:t}}},render:function(e){var t=this;return e(t.multiple?"a-checkbox-group":"a-radio-group",{props:{value:t.checkValue,name:t.multiple?"a-checkbox-group":"a-radio-group"},on:{input:function(e){t.checkValue=e}},class:"group-out-box"},t.options.map((function(n,a){return e(t.multiple?"a-checkbox":"a-radio",{attrs:{value:n[t.baseReplaceFields.key],key:a},key:a,props:{key:a},on:{click:function(e){e.stopPropagation()}}},n[t.baseReplaceFields.name])})))}},void 0,void 0,void 0,!1,void 0,void 0,void 0),ba={name:"DSelectProductAttr",components:{SelectGroup:ya,Empty:zn},props:{value:{type:Object,default:null},visible:{type:Boolean,default:!1},width:{type:Number,default:816},destory:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入搜索关键字"},type:{type:Number,default:0},productId:{type:Array,default:function(){return[]}},inputValue:{type:String,default:""},replaceFields:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}}},data:function(){return{selectValue:void 0,keywords:"",options:[],loading:!1}},watch:{modalVisible:{handler:function(e){e&&(this.init(),this.value&&(this.selectValue=this.value.id)),this.rules.keywords&&(this.keywords=this.rules.keywords)},immediate:!0}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},title:function(){var e=this.type;return 0===e?"选择单位":1===e?"选择品牌":2===e?"选择标签":3===e?"选择单位":"选择仓库"},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t.name.match(e.keywords))return t})):this.options},baseReplaceFields:function(){return _e({key:"id",name:"name"},this.replaceFields)}},methods:{init:function(){var e=this;this.loading=!0,4===this.type?this.$get(Ye,_e({pageNum:1,pageSize:100},this.rules)).then((function(t){e.options=t.data.list})).finally((function(){e.loading=!1})):3===this.type?this.$post(He,this.productId).then((function(t){e.options=t.data.map((function(e){return _e(_e({},e),{},{name:e.unitName})}))})).finally((function(){e.loading=!1})):this.$post(Be,_e({type:this.type},this.rules)).then((function(t){e.options=t.data})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},handlerAfterClose:function(){this.$emit("afterClose")},handleOk:function(){var e=this,t=this.options.find((function(t){return t.id===e.selectValue})),n=this.options.filter((function(t){return t.id===e.selectValue}));this.$emit("confirm",{data:t,rows:n,baseRows:this.options}),this.modalVisible=!1}}};var ka=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{afterClose:e.handlerAfterClose,destroyOnClose:e.destory,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:function(t){e.modalVisible=!1},ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1)],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},[n("select-group",{attrs:{options:e.filteredOptions,replaceFields:e.baseReplaceFields},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};ka._withStripped=!0;const wa=mt({render:ka,staticRenderFns:[]},void 0,ba,void 0,!1,void 0,!1,void 0,void 0,void 0);wa.install=function(e){e.component(wa.name,wa)};var Ca="SYS_0000",_a={0:"付款账户选择",1:"多账户选择"};const Sa={name:"DSelectPayAccount",components:{Empty:zn},filters:{payAccountConvert:function(e){var t=Vn.find((function(t){return t.id===e}));return t?t.name:"--"}},props:{type:{type:Number,default:0},width:{type:[String,Number],default:816},visible:{type:Boolean,default:!1},payType:{type:Number,default:1},dueMoney:{type:[Number,String],default:0},customerId:{type:[String,Number],default:""},beforeClose:{type:Function,default:null},cache:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},excludeAccountTypes:{type:Array,default:function(){return[]}},defaultValue:{type:[String,Number,Array,Object],default:null},verifyTotalMoney:{type:Boolean,default:!0}},data:function(){return{modalTitles:_a,loading:!1,tableData:[],totalMoney:0,keywords:null}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},locale:function(){return{emptyText:this.$createElement("Empty",{props:{loading:this.loading}})}},filteredTableData:function(){var e=this;return this.keywords?this.includedTableData.filter((function(t){var n=t.name,a=t.bankDeposit,i=t.accountNumber;if(n.match(e.keywords)||a.match(e.keywords)||i.match(e.keywords))return t})):this.includedTableData},includedTableData:function(){var e=this;return this.tableData.filter((function(t){if(!e.excludeAccountTypes.includes(t.type))return t}))}},watch:{visible:function(e){e&&!this.cache?this.loadData():this.tableData.length||this.loadData(),this.rules.keywords&&(this.keywords=this.rules.keywords)}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,this.$get(Xe,_e({accountType:this.payType,customerId:this.customerId},this.rules)).then((function(t){var n=t.code,a=t.data;if(n===Ca){if(e.tableData=a.map((function(t,n){if(0===e.type){var a=!1;return e.defaultValue&&(a=e.defaultValue===t.accountId),_e({checked:a,payMoney:0,index:n+1,sort:n+1,accountType:t.type},t)}if(1===e.type){var i=0;if(e.defaultValue&&"[object Array]"===Object.prototype.toString.call(e.defaultValue)){var o=e.defaultValue.find((function(e){return e.accountId===t.accountId}));o&&(i=o.payMoney,t.payMoney=o.payMoney,e.payMoneyBlur(t))}return _e({payMoney:i,index:n+1,sort:n+1,accountType:t.type},t)}})),0===e.type&&e.tableData.length&&!e.tableData.find((function(e){return e.checked}))){var i=e.tableData.find((function(e){return 2===e.type}));i?i.checked=!0:e.tableData[0].checked=!0}e.$emit("data",e.tableData)}})).finally((function(){e.loading=!1}))},handleOk:function(){var e=this,t=null;if(1===this.type){var n=this.filteredTableData.filter((function(e){return e.checked=void 0,Number(e.payMoney)}));if(t={type:this.type,disabled:this.filteredTableData.length>1,paymentAccounts:n,payMoney:this.totalMoney},this.verifyTotalMoney&&t.payMoney>this.dueMoney)return void this.$message.error("请输入最大本次应付金额且最多2位小数的数值")}else t=this.filteredTableData.filter((function(e){return e.checked}));this.beforeClose?this.beforeClose({data:t,rows:t},(function(){e.$emit("update:visible",!1)})):(this.$emit("confirm",{data:t,rows:t}),this.$emit("update:visible",!1))},payMoneyBlur:function(e){1===e.type&&e.payMoney>e.balance&&(this.$message.error("预付金额小于本次付款金额，无法完成抵扣。"),e.payMoney=0),e.payMoney=ie.fmtNum(e.payMoney,!1,2,!1);var t=this.tableData.reduce((function(e,t){return e+Number(t.payMoney)}),0);this.totalMoney=ie.fmtNum(t,!1,2,!1)},handleCancel:function(){this.$emit("update:visible",!1)},radioChange:function(e){var t=this;this.filteredTableData.forEach((function(e){return e.checked=!1})),this.$nextTick((function(){t.filteredTableData[e].checked=!0}))}}};var xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-pay-account a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.modalTitles[e.type],width:e.width,"cancel-text":"取消(Esc)","ok-text":"确定(Enter)"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[0===e.type?n("div",{staticClass:"single-account"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入关键字"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),n("a-table",{attrs:{customRow:function(t,n){return{on:{click:function(){e.radioChange(n)}}}},"data-source":e.filteredTableData,loading:e.loading,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},"row-key":"index"}},[n("a-table-column",{key:"index",attrs:{width:64,align:"center","data-index":"index"},scopedSlots:e._u([{key:"default",fn:function(t,a,i){return[n("span",{on:{click:function(t){return e.radioChange(i)}}},[n("a-radio",{attrs:{checked:a.checked}})],1)]}}],null,!1,4291464169)}),e._v(" "),n("a-table-column",{attrs:{width:160,"data-index":"type",title:"账户类型"},scopedSlots:e._u([{key:"default",fn:function(t,n){return[e._v("\n          "+e._s(e._f("payAccountConvert")(n.type))+"\n        ")]}}],null,!1,2287724343)}),e._v(" "),n("a-table-column",{attrs:{width:192,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{key:"bankDeposit",attrs:{width:160,"data-index":"bankDeposit",title:"开户银行"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)}),e._v(" "),n("a-table-column",{key:"accountNumber",attrs:{width:160,"data-index":"accountNumber",title:"银行账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)})],1)],1):n("div",{staticClass:"multiple-account"},[n("div",{staticClass:"dialog-pay"},[e._v("应"+e._s(1===e.payType?"付":"收")+"金额：¥"+e._s(e.dueMoney))]),e._v(" "),n("a-table",{staticClass:"account",attrs:{"data-source":e.filteredTableData,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},bordered:"",rowKey:"index"}},[n("a-table-column",{key:"index",staticClass:"style-padding",attrs:{width:88,align:"center","data-index":"index",title:"行号"}}),e._v(" "),n("a-table-column",{staticClass:"style-padding",attrs:{width:358,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{attrs:{width:"100%","data-index":"payMoney",title:"金额"},scopedSlots:e._u([{key:"default",fn:function(t,a){return[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},on:{blur:function(t){return e.payMoneyBlur(a)}},model:{value:a.payMoney,callback:function(t){e.$set(a,"payMoney",t)},expression:"record.payMoney"}})]}}])}),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"total"},[n("div",{staticClass:"name"},[e._v("合计")]),e._v(" "),n("div",{staticStyle:{width:"358px"}}),e._v(" "),n("div",{staticClass:"money"},[e._v(e._s(e.totalMoney))])])])],2)],1)])};xa._withStripped=!0;const Da=mt({render:xa,staticRenderFns:[]},void 0,Sa,void 0,!1,void 0,!1,void 0,void 0,void 0);function Ra(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Da.install=function(e){e.component(Da.name,Da)};var Oa=function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.__PARENTSAPPJSONP__&&window.__POWERED_BY_QIANKUN__?window.__PARENTSAPPJSONP__(n,(function(e){t=e})):window.TMAPCALLBACK[n]=function(e){t=e},document.body.appendChild(a);var i=function(){document.body.removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},Va={"北京市":{city:"北京市",short:"京",lng:"116.39737",lat:"39.939502"},"天津市":{city:"天津市",short:"津",lng:"117.133262",lat:"39.256321"},"上海市":{city:"上海市",short:"沪",lng:"121.36464",lat:"31.303465"},"重庆市":{city:"重庆市",short:"渝",lng:"106.32485",lat:"29.895013"},"河北省":{city:"石家庄",short:"冀",lng:"114.336873",lat:"38.21885"},"山西省":{city:"太原",short:"晋",lng:"112.349964",lat:"38.044464"},"辽宁省":{city:"沈阳",short:"辽",lng:"123.241164",lat:"41.948112"},"吉林省":{city:"长春",short:"吉",lng:"125.228072",lat:"43.894927"},"黑龙江省":{city:"哈尔滨",short:"黑",lng:"126.479088",lat:"45.985284"},"江苏省":{city:"南京",short:"苏",lng:"118.715429",lat:"32.246466"},"浙江省":{city:"杭州",short:"浙",lng:"120.040035",lat:"30.350837"},"安徽省":{city:"合肥",short:"皖",lng:"117.170056",lat:"31.99595"},"福建省":{city:"福州",short:"闽",lng:"119.156964",lat:"26.182279"},"江西省":{city:"南昌",short:"赣",lng:"115.808656",lat:"28.774611"},"山东省":{city:"济南",short:"鲁",lng:"116.912494",lat:"36.812038"},"河南省":{city:"郑州",short:"豫",lng:"113.453802",lat:"34.895028"},"湖北省":{city:"武汉",short:"鄂",lng:"114.116105",lat:"30.764814"},"湖南省":{city:"长沙",short:"湘",lng:"112.800698",lat:"28.474291"},"广东省":{city:"广州",short:"粤",lng:"113.233035",lat:"23.224606"},"海南省":{city:"海口",short:"琼",lng:"110.179083",lat:"19.921006"},"四川省":{city:"成都",short:"川",lng:"103.924003",lat:"30.796585"},"贵州省":{city:"贵阳",short:"黔",lng:"106.499624",lat:"26.844365"},"云南省":{city:"昆明",short:"滇",lng:"102.599397",lat:"25.248948"},"陕西省":{city:"西安",short:"陕",lng:"108.780889",lat:"34.408508"},"甘肃省":{city:"兰州",short:"甘",lng:"103.66644",lat:"36.218003"},"青海省":{city:"西宁",short:"青",lng:"101.605943",lat:"36.752842"},"西藏自治区":{city:"拉萨",short:"藏",lng:"90.972306",lat:"29.838888"},"广西壮族自治区":{city:"南宁",short:"桂",lng:"108.265765",lat:"23.020403"},"内蒙古自治区":{city:"呼和浩特",short:"蒙",lng:"111.614073",lat:"40.951504"},"宁夏回族自治区":{city:"银川",short:"宁",lng:"106.094884",lat:"38.624116"},"新疆维吾尔自治区":{city:"乌鲁木齐",short:"新",lng:"87.476819",lat:"43.894927"},"香港特别行政区":{city:"香港",short:"港",lng:"114.1529",lat:"22.542716"},"澳门地区":{city:"澳门",short:"澳",lng:"113.417008",lat:"22.337477"},"台湾省":{city:"台北",short:"台.",lng:"121.36464",lat:"25.248948"}},Ta="https://apis.map.qq.com",La={geocoder:"".concat(Ta,"/ws/geocoder/v1"),placeSearch:"".concat(Ta,"/ws/place/v1/search"),placeExplore:"".concat(Ta,"/ws/place/v1/explore"),placeDetail:"".concat(Ta,"/ws/place/v1/detail"),placeSuggestion:"".concat(Ta,"/ws/place/v1/suggestion"),district:"".concat(Ta,"/ws/district/v1"),directionDriving:"".concat(Ta,"/ws/direction/v1/driving"),directionTransit:"".concat(Ta,"/ws/direction/v1/transit"),directionWalking:"".concat(Ta,"/ws/direction/v1/walking"),directionBicycling:"".concat(Ta,"/ws/direction/v1/bicycling"),distanceMatrix:"".concat(Ta,"/ws/distance/v1/matrix"),locationIP:"".concat(Ta,"/ws/location/v1/ip"),staticmap:"".concat(Ta,"/ws/staticmap/v2"),coordTranslate:"".concat(Ta,"/ws/coord/v1/translate")},$a=function(e){var t="";if(e)for(var n in e)e.hasOwnProperty(n)&&(t+="".concat(t?"".concat(t,"&"):"").concat(n,"=").concat(e[n]));return t},Ia=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=null,this.mapOptions={key:"T74BZ-KJV6U-EVEVH-B2ZLQ-YIZQF-3PFPB",container:"map",center:{lat:39.908802,lng:116.397502},zoom:16,location:!1,showMarker:!1,success:null,fail:null},this.varia={queue:[],mapStatus:!1,centerMarker:null,on:{tilesloaded:null}},this._init(t)}var t,n,a,i;return t=e,n=[{key:"_init",value:function(e){this._initConfig(e),e&&e.container&&(this._initMap(),this._afterInit())}},{key:"_initConfig",value:function(e){this.mapOptions=this.merge(this.mapOptions,e)}},{key:"_initMap",value:(i=xe(Re.mark((function e(){var t=this;return Re.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=this.mapOptions.key,Oa("https://map.qq.com/api/gljs?v=1.exp&key=".concat(n,"&callback=TMapLoad"));case 2:this.mapOptions.center=this.latLng(this.mapOptions.center),this.map=new TMap.Map(this.mapOptions.container,this.mapOptions),this.map.once("tilesloaded",(function(){t.varia.mapStatus=!0,t.runQueue(),t.mapOptions.success&&t.mapOptions.success()}));case 5:case"end":return e.stop()}var n}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_afterInit",value:function(){this.mapOptions.location&&this.location(),this.mapOptions.showMarker&&this.setMarker(this.mapOptions.center)}},{key:"run",value:function(e,t){this.varia.mapStatus?this[e](t):this.varia.queue.push({name:e,options:t})}},{key:"on",value:function(e,t){console.log(e,t)}},{key:"runQueue",value:function(){var e=this;this.varia.queue.forEach((function(t){e[t.name](t.options)})),this.varia.queue=[]}},{key:"request",value:function(e,t){var n,a,i=(n=this.mapOptions,a="key=".concat(n.key,"&output=jsonp"),{parseLocation:function(e){return Oa("https://apis.map.qq.com/ws/geocoder/v1/?".concat($a(e),"&").concat(a))},placeSearch:function(e){return Oa("".concat(La.placeSearch,"?").concat($a(e),"&").concat(a))},placeExplore:function(e){return Oa("".concat(La.placeExplore,"?").concat($a(e),"&").concat(a))},placeDetail:function(e){return Oa("".concat(La.placeDetail,"?").concat($a(e),"&").concat(a))},suggestion:function(e){return Oa("".concat(La.placeSuggestion,"?").concat($a(e),"&").concat(a))},geocoder:function(e){var t=e.address;return t&&Va[t]&&(e.address="".concat(t).concat(Va[t].city)),Oa("".concat(La.geocoder,"?").concat($a(e),"&").concat(a))},directionDriving:function(e){return Oa("".concat(La.directionDriving,"?").concat($a(e),"&").concat(a))},directionWalking:function(e){return Oa("".concat(La.directionWalking,"?").concat($a(e),"&").concat(a))},directionBicycling:function(e){return Oa("".concat(La.directionBicycling,"?").concat($a(e),"&").concat(a))},directionTransit:function(e){return Oa("".concat(La.directionTransit,"?").concat($a(e),"&").concat(a))},distanceMatrix:function(e){return Oa("".concat(La.distanceMatrix,"?").concat($a(e),"&").concat(a))},district:function(e){return Oa("".concat(La.district,"?").concat($a(e),"&").concat(a))},coordTranslate:function(e){return Oa("".concat(La.coordTranslate,"?").concat($a(e),"&").concat(a))},locationIP:function(e){return Oa("".concat(La.locationIP,"?").concat($a(e),"&").concat(a))}});if(!i[e])throw Error("错误警告: ".concat(e," 不是一个正确的地图请求方法，请使用正确的方法。"));return i[e](t)}},{key:"merge",value:function(e,t){for(var n in t)e[n]=e[n]&&"[object Object]"===e[n].toString()?this.merge(e[n],t[n]):e[n]=t[n];return e}},{key:"destory",value:function(){this.map.destroy()}},{key:"random",value:function(){return Math.floor(1234567890*Math.random())}},{key:"latLng",value:function(e){var t=e.lng,n=e.lat;return new TMap.LatLng(n,t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(e){console.log(e,"设置地图中心点"),this.map.setCenter(this.latLng(e))}},{key:"setRotation",value:function(e){this.map.setRotation(e)}},{key:"setPitch",value:function(e){this.map.setPitch(e)}},{key:"setScale",value:function(e){this.map.setScale(e)}},{key:"setMode",value:function(e){"2D"===e?this.map.setViewMode("2D"):"3D"===e&&(this.map.setViewMode("3D"),this.map.setPitch(70))}},{key:"setMarker",value:function(e,t){var n=this;console.log("setMarker-point-内部函数",e),console.log("setMarker-styles-内部函数",t),this.removeMarker(),console.log("marker-layer-".concat(Math.floor(1e4*Math.random())),"IDDDDD"),console.log(this,"this"),this.varia.centerMarker=new TMap.MultiMarker({id:"marker-layer-".concat(Math.floor(1e4*Math.random())),map:this.map,styles:_e({marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},t),geometries:function(e){var t=n;if("[object Object]"===Object.prototype.toString.call(e))return e.lat=Number(e.lat),e.lng=Number(e.lng),[{id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}}];var a=[];return e.forEach((function(e){a.push({id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}})})),a}(e)})}},{key:"setMarkerCrm",value:function(e){this.varia.centerMarker=new TMap.MultiMarker({id:"marker_".concat(this.random()),map:this.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},geometries:[{id:"markergeo_".concat(this.random()),styleId:"marker_".concat(this.random()),position:new TMap.LatLng(e.lat,e.lng),properties:{title:"marker"}}]})}},{key:"removeMarker",value:function(){console.log("移除marker事件"),console.log(this.varia.centerMarker),this.varia.centerMarker&&(this.varia.centerMarker.setMap(null),this.varia.centerMarker=null)}},{key:"removeCluster",value:function(){}},{key:"setCircle",value:function(e){return new TMap.MultiCircle({id:"circle",map:this.map,geometries:[{center:this.latLng(e),radius:1e3}]})}},{key:"setMarkerCluster",value:function(e){var t=this;return console.log("setMarkerCluster"),this.varia.markerCluster=new TMap.MarkerCluster({id:"marker_".concat(this.random()),map:this.map,enableDefaultStyle:!1,minimumClusterSize:2,geometries:function(e){var n=t;if("[object Object]"===Object.prototype.toString.call(e))return[{position:n.latLng(e)}];var a=[];return e.forEach((function(e){a.push({position:n.latLng(e)})})),a}(e),zoomOnClick:!0,gridSize:60,averageCenter:!1,maxZoom:10}),this.varia.markerCluster}}],n&&Ra(t.prototype,n),a&&Ra(t,a),e}();const Fa={name:"Map",props:{sceneId:{type:String,default:"default"},visible:Boolean,inputValue:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:"100%"},searchInput:{type:Boolean,default:!0},optionSelect:{type:String,default:"title"},intLocation:{type:Boolean,default:!0},config:{type:Object,default:function(){return{}}}},data:function(){return{list:[],actInputValue:"",realDot:!1,glMap:null,id:"TMapSearch_"+ge.default.guid()}},watch:{inputValue:function(e){e!==this.actInputValue&&(this.realDot=!0,this.actInputValue=e)},visible:function(e){e&&(this.glMap||this.initMap(),this.actInputValue=this.inputValue)}},mounted:function(){this.initMap()},methods:{initMap:function(){var e=this;this.$nextTick((function(){e.glMap=new Ia(_e({container:e.id,success:function(){console.log("地图加载完毕！"),e.$emit("init",e.glMap),e.initComplate()}},e.config)),e.actInputValue=e.inputValue,e.searchInput&&e.actInputValue&&e.intLocation&&(e.realDot=!0,e.handleSearch()),e.glMap._afterInit()}))},initComplate:function(){var e=this,t=this;this.$nextTick((function(){setTimeout((function(){e.actInputValue=e.inputValue,t.glMap.request("suggestion",{keyword:e.inputValue}).then((function(e){e.count&&t.setPosition(e.data[0].id,e.data),t.list=e.data||[],t.$forceUpdate()})),t.$forceUpdate(),e.glMap.map.on("click",(function(e){var n=e.latLng.getLat(),a=e.latLng.getLng();t.setCenter({lat:n,lng:a});var i=[];t.glMap.request("parseLocation",{location:n+","+a}).then((function(e){console.log(e,"根据经纬度".concat(n+","+a,"解析地址信息"));var o={adcode:Number(e.result.ad_info.adcode),address:e.result.formatted_addresses.recommend,city:e.result.address_component.city,district:e.result.address_component.district,location:e.result.location,id:"123456ABCD",title:e.result.formatted_addresses.recommend,province:e.result.address_component.province,type:0};console.log(o,"传给外面的数据对象 - item--1"),t.$emit("change",o),i.push(o),t.actInputValue=e.result.formatted_addresses.recommend,t.setPosition("123456ABCD",i),t.glMap.request("suggestion",{keyword:e.result.address+e.result.formatted_addresses.recommend}).then((function(e){console.log(e,"res1"),e.count&&i.push.apply(i,kt(e.data)),t.list=i,t.$forceUpdate()}))}))}))}),1e3)}))},inputHandler:function(e){var t=this;e&&(this.realDot?this.glMap.request("geocoder",{address:e}).then((function(e){t.realDot=!1,e.status?t.handleSearch():t.setAutoPosition(e.result)})):this.glMap.request("suggestion",{keyword:e}).then((function(e){console.log(e,"inputHandler--suggestion - input 输入框 输入关键词"),t.list=e.data})))},handleSearch:function(){var e=this;this.actInputValue&&(this.realDot?this.glMap.request("geocoder",{address:this.actInputValue}).then((function(t){e.realDot=!1,t.status?e.handleSearch():e.setAutoPosition(t.result)})):this.glMap.request("suggestion",{keyword:this.actInputValue}).then((function(t){console.log(t,"handleSearch--suggestion - input 手动调用搜索"),e.list=t.data})))},handleSelect:function(e){if(console.log("handleSelect：",e),e){var t=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(t.location),this.glMap.setMarker(t.location),console.log(t,"传给外面的数据对象 - item--2"),this.$emit("change",t)}},setPosition:function(e,t){this.list=t;var n=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(n.location),this.glMap.setMarker(n.location),this.$forceUpdate()},setCenter:function(e){this.glMap.setMarker(e)},setAutoPosition:function(e){console.log(e)},setAddress:function(e){this.inputHandler(e)},resetValue:function(e){var t=this;this.$nextTick((function(){(t.actInputValue||t.inputValue)&&(t.actInputValue=t.inputValue,t.list=[],t.actInputValue&&!e&&(t.realDot=!0,t.handleSearch()),t.realDot=!1,t.handleSearch())}))}}};var Ma=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-search-wrapper"},[e.searchInput?n("a-auto-complete",{staticClass:"map-search",attrs:{autoFocus:"",placeholder:"请输入"},on:{search:e.inputHandler,select:e.handleSelect},model:{value:e.actInputValue,callback:function(t){e.actInputValue="string"==typeof t?t.trim():t},expression:"actInputValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t[e.optionSelect]))])})),1)],2):e._e(),e._v(" "),n("div",{staticClass:"t-map-search",style:{height:e.height,width:e.width},attrs:{id:e.id}})],1)};Ma._withStripped=!0;const Pa={name:"Manage",components:{GlMap:mt({render:Ma,staticRenderFns:[]},void 0,Fa,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},visible:{type:Boolean,default:!1},title:{type:String,default:"地址定位"},config:{type:Object,default:function(){return null}},inputValue:{type:String,default:""},baseValue:{type:String,default:""}},data:function(){return{flag:!0,cache:null,addressInfo:{},glmap:new Ia}},watch:{visible:function(e){var t=this;this.$nextTick((function(){t.addressInfo={},e&&t.$nextTick((function(){setTimeout((function(){t.inputValue&&t.$refs.map&&t.$refs.map&&(console.log(t.inputValue,"this.inputValue"),t.parseAddress(t.inputValue,(function(e){if(e.length){var n=e[0];t.addressInfo=n,t.cache?t.$refs.map.setPosition(t.cache.id,ge.default.unique([t.cache].concat(kt(e)),"id")):t.$refs.map.setPosition(n.id,e)}else t.$refs.map.setPosition(t.cache.id,[t.cache])})))}),1e3)}))}))}},computed:{modalVisible:{get:function(){return this.visible},set:function(){this.$emit("update:visible",!1)}}},mounted:function(){},methods:{parseAddress:function(e,t){"string"==typeof e&&e.trim().length&&this.glmap.request("suggestion",{keyword:e}).then((function(e){e.count?t&&t(e.data):t&&t(null)}))},handleOk:function(){console.log(this.addressInfo,"点击弹框确定按钮返回  addressInfo 给最外面"),this.cache=this.addressInfo,this.$emit("ok",this.addressInfo),this.modalVisible=!1},handleCancel:function(){this.modalVisible=!1},handleChange:function(e){console.log(e,"弹框输入框选项发生变化，选中项赋值给 - addressInfo"),this.addressInfo=e}}};var Na=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"map-dialog-modal",attrs:{title:e.title,maskClosable:!1,width:"810px",keyboard:!1},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("gl-map",{ref:"map",attrs:{sceneId:e.sceneId,visible:e.modalVisible,inputValue:e.inputValue,intLocation:!1},on:{change:e.handleChange}})],1)};Na._withStripped=!0;const Ea={name:"AddressSearch",components:{MapDialog:mt({render:Na,staticRenderFns:[]},void 0,Pa,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},value:{type:String,default:""},icon:{type:String,default:"environment"},showBtn:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},defaultBtn:{type:Boolean,default:!1}},data:function(){return{dataSource:[],poiPicker:null,list:[],glMap:null,mapVisible:!1}},computed:{autoValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},mounted:function(){this.autoValue=this.value,this.glMap=new Ia},methods:{handleSearch:function(e){var t=this;e&&this.glMap.request("suggestion",{keyword:e}).then((function(e){t.$set(t,"list",e.data)}))},handleBtn:function(){console.log("handleBtn"),this.disabled||(this.defaultBtn?this.mapVisible=!0:this.$emit("btnClick"))},handleSelect:function(e){if(e){var t=this.list.filter((function(t){return t.id===e}))[0];this.autoValue=t.title,this.$emit("change",t)}},resetOption:function(){var e=this;this.$nextTick((function(){e.list=[],e.handleSearch(e.value)}))},handleMapOk:function(e){e.adcode&&(this.autoValue=e.title||e.address,this.$emit("change",e))}}};var Aa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("a-auto-complete",{staticClass:"map-search",attrs:{placeholder:"请输入",disabled:e.disabled},on:{search:e.handleSearch,select:e.handleSelect},model:{value:e.autoValue,callback:function(t){e.autoValue=t},expression:"autoValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.title))])})),1),e._v(" "),e._t("default",[n("a-input",{attrs:{maxLength:e.maxLength}},[e.showBtn?n("a-button",{staticClass:"dot-btn",staticStyle:{"margin-right":"-12px"},attrs:{slot:"suffix",type:"link"},on:{click:function(t){return t.stopPropagation(),e.handleBtn(t)}},slot:"suffix"},[n("a-icon",{attrs:{type:e.icon}})],1):e._e()],1)])],2),e._v(" "),n("map-dialog",{ref:"mapDialog",attrs:{visible:e.mapVisible,title:"设置地址",sceneId:e.sceneId,inputValue:e.autoValue},on:{"update:visible":function(t){e.mapVisible=t},ok:e.handleMapOk}})],1)};Aa._withStripped=!0;const ja=mt({render:Aa,staticRenderFns:[]},void 0,Ea,void 0,!1,void 0,!1,void 0,void 0,void 0);var Ba={name:"AreaSelect",props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:"span"},bottom:{type:String,default:"24px"},level:{type:Number,default:3},disabled:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}},url:{type:String,default:""},loadData:{type:Function,default:null},dealData:{type:Boolean,default:!1},immediate:{type:Boolean,default:!1}},data:function(){return{model:[{name:"province",label:"省"},{name:"city",label:"市"},{name:"district",label:"区"}],selectData:[],areaData:{province:[],city:[],district:[]},$request:null}},watch:{value:{handler:function(e){if(e.length){if(e[e.length-1]===this.selectData[this.selectData.length-1])return;this.dealValue()}else this.selectData=[],this.areaData.city=[],this.areaData.district=[]},deep:!0}},mounted:function(){var e=this;this.url?this.$request=function(t){return e.$get(e.url,t)}:this.$request=this.loadData,this.value.length?this.dealValue():this.getList()},methods:{getList:function(e,t,n){var a=this;this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){e||(a.areaData.province=n.data),e&&!t&&(a.areaData.city=n.data),e&&t&&(a.areaData.district=n.data)}))},dealValue:function(e,t,n){for(var a=this,i=JSON.parse(JSON.stringify(this.value)),o=0;o<i.length;o++)if(!i[o]){i.splice(o,i.length);break}this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){var o=n.data;e||(a.areaData.province=o,i[0]&&a.dealValue(i[0]),1===i.length&&(a.selectData=i,a.dealResult())),e&&!t&&(a.areaData.city=o,i[1]&&a.dealValue(i[0],i[1]),2===i.length&&(a.selectData=i,a.dealResult())),e&&t&&(a.areaData.district=o,3===i.length&&(a.selectData=i,a.dealResult()))}))},handleChange:function(e,t){"province"===t.name&&(this.areaData.city=[],this.areaData.district=[],this.selectData=[e],this.getList(e)),"city"===t.name&&(this.areaData.district=[],this.selectData=[this.selectData[0],e],this.getList.apply(this,kt(this.selectData))),this.dealResult(),this.$emit("input",JSON.parse(JSON.stringify(this.selectData)))},dealResult:function(){var e=this,t=this.areaData.province.filter((function(t){return t.id===e.selectData[0]}))[0]||null,n=this.areaData.city.filter((function(t){return t.id===e.selectData[1]}))[0]||null,a=this.areaData.district.filter((function(t){return t.id===e.selectData[2]}))[0]||null;this.$emit("change",this.selectData,{province:t,city:n,district:a})}}};const Ka=Ba;var Ha=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-row",{staticClass:"area-wrap",attrs:{gutter:12}},[e._l(e.model,(function(t,a){return[a<=e.level-1?n("a-col",{key:a,style:{marginBottom:"span"===e.type||e.model.length-1===a?"":e.bottom},attrs:{span:"span"===e.type?24/e.model.length:24}},[n("a-select",{staticClass:"area-select",attrs:{placeholder:t.label,disabled:e.disabled},on:{change:function(n){return e.handleChange(n,t)}},model:{value:e.selectData[a],callback:function(t){e.$set(e.selectData,a,t)},expression:"selectData[index]"}},e._l(e.areaData[t.name],(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e()]}))],2)};Ha._withStripped=!0;var za={name:"AddressBox",props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},syncInputBox:{type:Boolean,default:!0},value:{type:Object,default:function(){return{address:"",province:"",cityName:"",city:"",provinceName:"",districtName:"",district:"",fullAddress:"",lng:"",lat:"",point:null}}}},data:function(){var e=this;return{actForm:{address:""},outerLocation:{},area:[],areaData:null,confirmLoading:!1,mapLoadArea:!1,getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get($e.city,t):t.provinceId&&t.cityId?e.$get($e.district,t):void 0:e.$get($e.province,t)},getAddressCodeByName:function(t){return e.$get(Ie,t)},isFirst:!0}},components:{AddressSearch:ja,AreaSelect:mt({render:Ha,staticRenderFns:[]},void 0,Ka,void 0,!1,void 0,!1,void 0,void 0,void 0)},watch:{value:{handler:function(){this.generateForm()},deep:!0},actForm:{handler:function(e){this.isFirst?this.isFirst=!1:this.$emit("inputChange",e)},deep:!0}},mounted:function(){this.generateForm()},methods:{generateForm:function(){this.actForm=_e({address:"",province:"",city:"",district:""},this.value),this.area=[],this.actForm.province&&this.area.push(this.actForm.province),this.actForm.city?this.area.push(this.actForm.city):this.actForm.province||(this.area=[]),this.actForm.district?this.area.push(this.actForm.district):this.actForm.province||this.actForm.district||(this.area=[])},handleMapOk:function(e){var t=this;return xe(Re.mark((function n(){return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(e,"地图选择 ok----"),e.adcode){n.next=3;break}return n.abrupt("return");case 3:e&&(t.getAddressCodeByName({provinceName:e.province,cityName:e.city,districtName:e.district}).then((function(e){t.mapLoadArea=!0;var n=e.data,a=n.subAddress,i=a.subAddress;t.area=[n.id,a.id,i.id]})),t.actForm.address=e.title||e.address,t.$emit("input",t.actForm));case 4:case"end":return n.stop()}}),n)})))()},handleAreaChange:function(e,t){if(this.areaData=t,this.mapLoadArea)return this.actForm.province=e[0],this.actForm.city=e[1],this.actForm.district=e[2],this.actForm.provinceName=t.province.name,this.actForm.cityName=t.city.name,this.actForm.districtName=t.district.name,this.$emit("input",this.actForm),void(this.mapLoadArea=!1);this.actForm=_e(_e({},this.actForm),{},{province:t.province&&t.province.id,city:t.city&&t.city.id,district:t.district&&t.district.id,provinceName:t.province&&t.province.name,cityName:t.city&&t.city.name,districtName:t.district&&t.district.name}),this.syncInputBox&&(this.actForm.address="".concat(t.province&&t.province.name||"").concat(t.city&&t.city.name||"").concat(t.district&&t.district.name||"")),this.$emit("input",this.actForm)},getData:function(){return this.areaData}}};const qa=za;var Ya=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form-model-item",{attrs:{label:"省/市/区",prop:"area"}},[n("area-select",{attrs:{loadData:e.getRegion},on:{change:e.handleAreaChange},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"详细地址",prop:"address"}},[n("address-search",{ref:"autoComplete",attrs:{sceneId:e.sceneId,maxLength:e.maxLength,defaultBtn:""},on:{change:e.handleMapOk},model:{value:e.actForm.address,callback:function(t){e.$set(e.actForm,"address",t)},expression:"actForm.address"}})],1)],1)};Ya._withStripped=!0;const Wa=mt({render:Ya,staticRenderFns:[]},void 0,qa,void 0,!1,void 0,!1,void 0,void 0,void 0);Wa.install=function(e){e.component(Wa.name,Wa)},ge.default.ISREPEAT=function(e){return Object.keys(ge.default).includes(e)},ge.default.date.calcWeek=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"YYYY/MM/DD",a=new Date(t),i=ge.default.date.endOf("week",a,n),o=ge.default.date.add(e,"w",i,n),s=ge.default.date.endOf("w",o,n),r=ge.default.date.startOf("w",o,n);return{start:r,end:s}},ge.default.date.calcMonth=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=new Date(e),a=ge.default.date.startOf("month",n,t),i=ge.default.date.endOf("month",n,t);return{start:a,end:i}},ge.default.date.mandom=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=new Date(e),a=n.getMonth()+1,i=ge.default.date.daysInMonth(n),o=[],s=1;s<=i;s++)o.push(ge.default.date.format(ge.default.date.format("2021/".concat(a,"/").concat(s),"YYYY-MM-DD")+" ".concat(ge.default.rangeRandom(0,23),":").concat(ge.default.rangeRandom(0,59)),t||"YYYY-MM-DD hh:mm"));return o[ge.default.rangeRandom(1,i)[0]]},ge.default.date.period=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,a=new Date(n);if(1===e)return ge.default.date.calcWeek(0,a,t);if(2===e)return{start:ge.default.date.subtract(6,"day",a,t),end:ge.default.date.format(t)};if(3===e)return ge.default.date.calcMonth(a,t);if(4===e){var i=ge.default.date.endOf("week",a,t);return{start:ge.default.date.subtract(20,"day",i,t),end:i}}var o=ge.default.date.subtract(2,"month",ge.default.date.startOf("month",a),t),s=ge.default.date.endOf("month",a,t);return{start:o,end:s}},ge.default.date.isPeriod=function(e,t){return 1===e||2===e?ge.default.date.isToday(t):3===e&&void 0},Map.prototype.getByKey=function(e){var t=kt(this.keys()),n=t.findIndex((function(t){return Array.isArray(t)&&t.includes(e)}));return this.get(t[n])},ge.default.amap={jsonpRequest:function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.TMAPCALLBACK[n]=function(e){t=e},document.querySelector("body").appendChild(a);var i=function(){document.querySelector("body").removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},parsePoint:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n){var a=ge.default.urlSerialize("",Object.assign({key:"d59ce84bb495eccd65a4d238c8c06977"},t)),i="https://restapi.amap.com/v3/geocode/geo".concat(a);console.log(i,"请求地址"),n(e.jsonpRequest(i))}))},loadScript:function(e,t){var n=this;return new Promise((function(a,i){var o=document.createElement("script");t&&n.setAttr(o,t),o.onload=function(){return a(o)},o.onerror=function(){return i(o)},o.src=e,document.querySelector("body").appendChild(o)}))},isLoad:function(){for(var e=document.getElementsByTagName("script"),t=!1,n=0;n<e.length;n++)e[n].getAttribute("src").includes("https://webapi.amap.com/maps?v=1.4.6&key=d59ce84bb495eccd65a4d238c8c06977&plugin=AMap.Geocoder")&&(t=!0);return t},setAttr:function(e,t){for(var n in t)e.setAttribute(n,t[n])}},ge.default.caputured=function(){var e=xe(Re.mark((function e(t){var n,a,i,o,s=arguments;return Re.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",[null,o]);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[e.t0,null]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),pe.default.prototype.$caputured=function(){var e=xe(Re.mark((function e(t){var n,a,i,o,s=arguments;return Re.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",{err:null,res:o});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{err:e.t0,res:null});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ge.default.try=function(e,t){try{e&&e()}catch(e){t&&t(e)}},ge.default.jsonToArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){return[].concat(kt(t),[we({},n,e[n])])}),[])},ge.default.icon={report:{iconList:{1:"iconreport01",2:"iconreport02",3:"iconreport03",4:"iconreport04",5:"iconreport05",6:"iconreport06",7:"iconreport07",8:"iconreport08",9:"iconreport09",10:"iconreport10",11:"iconreport11",12:"iconreport12",13:"iconreport13",15:"iconreport15",16:"iconreport16",17:"iconreport17",18:"iconreport18",19:"iconreport19",20:"iconreport20",21:"iconreport21",22:"iconreport22",23:"iconreport23",24:"iconreport24",25:"iconreport25",26:"iconreport26",27:"iconreport27",28:"iconreport28",29:"iconreport29",30:"iconreport30",31:"iconreport31",32:"iconreport32",33:"iconreport33",34:"iconreport34",35:"iconreport35",36:"iconreport36",37:"iconreport37",38:"iconreport38",39:"iconreport39",40:"iconreport40",41:"iconreport41",42:"iconreport42",43:"iconreport43",44:"iconreport44",45:"iconreport45",46:"iconreport46",47:"iconreport47",48:"iconreport48"},colorList:{1:"#0289ff",2:"#00c359",3:"#fc943d",4:"#fb602c"}},approve:{iconList:{},colorList:{}}},ge.default.mapHandler=function(e,t,n){var a=Object.keys(e).find((function(e){return JSON.parse(e).includes(t)}));a?e[a]():n&&n()};var Ga={name:"EditorAddress",components:{AddressBox:Wa},props:{visible:{type:Boolean,default:!1},editData:{type:Object,default:function(){return{}}},customerId:{type:String,default:null,require:!0},hasAddress:{type:Boolean,default:!1}},data:function(){return{form:{deliveryMethod:"",deliveryId:void 0,deliveryName:"",logisticsId:void 0,logisticsName:"",customerName:"",phone:"",detailAddress:"",address:"",province:"",city:"",district:"",longitude:"",latitude:"",provinceName:"",cityName:"",districtName:"",fullAddress:"",loadingInfo:"",allAddress:void 0,isDefault:!1},confirmLoading:!1,basicRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}]},logisticsRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}],customerName:[{required:!0,message:"请输入",trigger:"change"}],phone:[{required:!0,message:"请输入",trigger:"change"}],allAddress:[{required:!0,message:"请选择",trigger:"change"}]},backForm:null,syncInputBox:!0,deliveryTypes:{data:[],loading:!1},logisticsCorps:{data:[],loading:!1}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},rules:function(){return 2===this.form.deliveryMethod?this.logisticsRules:this.basicRules},isUpdateMode:function(){return!!this.form.businessId},title:function(){return this.isUpdateMode?"编辑收货信息":"新增收货信息"}},watch:{visible:function(e){var t=this;return xe(Re.mark((function n(){return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=6;break}return n.next=3,t.handleGetDeliveryType();case 3:return n.next=5,t.handleGetLogistcsCorp();case 5:t.editData&&t.editData.businessId?(t.syncInputBox=!1,t.form=t.editData,t.form.address=t.form.detailAddress,t.form.loadingInfo=t.form.loadingInfo||t.form.fullAddress):(t.syncInputBox=!0,t.form={deliveryId:t.deliveryTypes.data.length&&t.deliveryTypes.data[0].value,customerName:"",isDefault:!t.hasAddress});case 6:case"end":return n.stop()}}),n)})))()},backForm:{handler:function(e){var t=this;e&&(this.form.address=e.address,this.form.province=e.province,this.form.city=e.city,this.form.district=e.district,this.form.detailAddress=e.address,e.address&&e.province&&e.city&&e.district?(this.form.allAddress=!0,this.$nextTick((function(){t.$refs.allAddress&&t.$refs.allAddress.onFieldChange()}))):this.form.allAddress=void 0)},deep:!0}},methods:{handleGetDeliveryType:function(){var e=this;return xe(Re.mark((function t(){var n,a;return Re.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.deliveryTypes.loading=!0,t.next=4,e.$get(Qe);case 4:n=t.sent,a=n.data,e.deliveryTypes.data=a.map((function(e){return _e({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.deliveryTypes.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},handleGetLogistcsCorp:function(){var e=this;return xe(Re.mark((function t(){var n,a;return Re.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.logisticsCorps.loading=!0,t.next=4,e.$get(Ze);case 4:n=t.sent,a=n.data,e.logisticsCorps.data=a.map((function(e){return _e({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.logisticsCorps.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},onDeliveryTypeChange:function(e){var t=this.deliveryTypes.data.find((function(t){return t.value===e}));t&&(this.form.deliveryMethod=t.requireOption)},changePhone:function(e){this.form.phone=e.replace(/[\u4E00-\u9FA5]|[A-Za-z]/g,"")},changeRadio:function(){this.form.isDefault=!this.form.isDefault},handleOk:function(){var e=this;this.$refs.ruleFormReceipt.validate(function(){var t=xe(Re.mark((function t(n){var a,i,o,s,r,l,c,u,d,h,p,f,m,g;return Re.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=46;break}if(a=e.deliveryTypes.data.find((function(t){return t.value===e.form.deliveryId})),2!==e.form.deliveryMethod){t.next=23;break}if(i=e.form.provinceName,o=e.form.cityName,s=e.form.districtName,r=e.form.address,l=[i,o,s,r].join(""),c="",!l){t.next=13;break}return t.next=12,ge.default.amap.parsePoint({address:l});case 12:c=t.sent;case 13:u=c?c.geocodes:[],e.form.longitude=u.length?u[0].location.split(",")[0]:"",e.form.latitude=u.length?u[0].location.split(",")[1]:"",d=[i,o,s].join(""),h="",h=d.includes(r)?d:r.includes(d)?r:d===r?d:l,p=e.logisticsCorps.data.find((function(t){return t.value===e.form.logisticsId})),e.form.logisticsName=p&&p.label,e.form.fullAddress=h,e.form.detailAddress=e.form.address;case 23:return 1===e.form.deliveryMethod&&(e.form.fullAddress=e.form.loadingInfo),e.form.deliveryName=a.label,e.$emit("confirm",e.form),t.prev=26,e.confirmLoading=!0,t.next=30,e.$post(e.isUpdateMode?it:at,_e({customerId:e.customerId},e.form));case 30:if(f=t.sent,m=f.data,g=f.message,m){t.next=35;break}throw new Error(g);case 35:e.$message.success("操作成功！"),e.$emit("success"),t.next=43;break;case 39:t.prev=39,t.t0=t.catch(26),e.$message.error(t.t0),console.error(t.t0);case 43:return t.prev=43,e.confirmLoading=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[26,39,43,46]])})));return function(e){return t.apply(this,arguments)}}())},handleCancel:function(){this.modalVisible=!1,this.$emit("cancel")},afterClose:function(){this.syncInputBox=!0,this.form={customerName:"",isDefault:!1}},inputChange:function(e){this.isUpdateMode&&(this.syncInputBox=!0),this.backForm=_e(_e({},this.form),e)},changeTextarea:function(){this.form.loadingInfo.length>=500&&this.$message.info("限500字")}}};const Ua=Ga;var Xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"receipt-dialog-wrap",attrs:{afterClose:e.afterClose,"confirm-loading":e.confirmLoading,maskClosable:!1,title:e.title,width:500,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("a-form-model",{ref:"ruleFormReceipt",attrs:{"label-col":{span:5},model:e.form,rules:e.rules,"wrapper-col":{span:17}}},[n("a-form-model-item",{attrs:{label:"发货方式",prop:"deliveryId"}},[n("a-select",{attrs:{loading:e.deliveryTypes.loading,placeholder:"请选择"},on:{change:e.onDeliveryTypeChange},model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryTypes.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])})),1)],1),e._v(" "),2===e.form.deliveryMethod?[n("a-form-model-item",{attrs:{label:"物流公司",prop:"logisticsId"}},[n("a-select",{attrs:{loading:e.logisticsCorps.loading,placeholder:"请选择"},model:{value:e.form.logisticsId,callback:function(t){e.$set(e.form,"logisticsId",t)},expression:"form.logisticsId"}},e._l(e.logisticsCorps.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),n("a-form-model-item",{attrs:{label:"收货人",prop:"customerName"}},[n("a-input",{staticClass:"customer-name-wrap",attrs:{maxLength:50,suffix:e.form.customerName.length+"/50",placeholder:"请输入"},model:{value:e.form.customerName,callback:function(t){e.$set(e.form,"customerName","string"==typeof t?t.trim():t)},expression:"form.customerName"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"联系方式",prop:"phone"}},[n("a-input",{attrs:{maxLength:50,placeholder:"请输入"},on:{change:function(t){return e.changePhone(e.form.phone)}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone","string"==typeof t?t.trim():t)},expression:"form.phone"}})],1),e._v(" "),n("a-form-model-item",{ref:"allAddress",staticStyle:{"margin-bottom":"0"},attrs:{label:"所在地区",prop:"allAddress"}},[n("a-form-model",{staticClass:"cus-address-wrap",attrs:{"label-col":{span:0},"wrapper-col":{span:24}}},[n("address-box",{attrs:{maxLength:100,syncInputBox:e.syncInputBox},on:{inputChange:e.inputChange},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)],1)]:e._e(),e._v(" "),1===e.form.deliveryMethod?n("a-form-model-item",{attrs:{label:"装车信息",prop:"loadingInfo"}},[n("a-textarea",{attrs:{maxLength:500,placeholder:"限500字",rows:5},on:{change:e.changeTextarea},model:{value:e.form.loadingInfo,callback:function(t){e.$set(e.form,"loadingInfo","string"==typeof t?t.trim():t)},expression:"form.loadingInfo"}})],1):e._e(),e._v(" "),n("a-radio",{staticStyle:{"margin-left":"76px"},attrs:{checked:e.form.isDefault},on:{click:e.changeRadio}},[e._v("设为默认")])],2)],1)};Xa._withStripped=!0;const Ja=mt({render:Xa,staticRenderFns:[]},void 0,Ua,"data-v-0c26a3f4",!1,void 0,!1,void 0,void 0,void 0);Ja.install=function(e){e.component(Ja.name,Ja)};const Qa={name:"DSelectAddress",components:{CellEllipsisTip:Jt,STable:un,EditorAddress:Ja},props:{width:{type:Number,default:816},cache:{type:Boolean,default:!0},visible:{type:Boolean,default:!1},setContainer:{type:Function,default:function(){return document.querySelector("body")}},customerId:{type:String,default:null,require:!0},title:{type:String,default:"选择收货地址"},beforeClose:{type:Function,default:void 0},value:{type:Object,default:void 0}},data:function(){return{currentMark:-1,addressDetailsShow:!1,clickReceipt:null,opened:!1,list:{data:[],loading:!1,selected:null}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible:function(e){e&&((!this.cache||this.cache&&!this.opened)&&(this.list.selected=null,this.getDeliverys()),this.opened=!0)}},methods:{getDeliverys:function(){var e=this;return xe(Re.mark((function t(){var n,a;return Re.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.list.loading=!0,t.next=4,e.$post(nt,{businessId:e.customerId});case 4:n=t.sent,a=n.data,e.list.data=a||[],t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.list.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},deleteAddress:function(e){var t=this;this.$confirm({title:"操作提示！",content:"您是否确定删除此地址？",okText:"确定",cancelText:"取消",onOk:function(){return xe(Re.mark((function n(){return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(ot,{businessId:e.businessId,customerId:e.customerId});case 3:e.businessId===t.list.selected&&(t.list.selected=null),t.$message.success("操作成功！"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:return n.prev=10,t.getDeliverys(),n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[0,7,10,13]])})))()}})},setDefault:function(e){var t=this;return xe(Re.mark((function n(){var a,i,o;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(st,{businessId:e.businessId,customerId:e.customerId});case 3:if(a=n.sent,i=a.data,o=a.message,i){n.next=8;break}throw new Error(o);case 8:t.$message.success("操作成功！"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0);case 14:return n.prev=14,t.getDeliverys(),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[0,11,14,17]])})))()},handleSelectAddress:function(e){this.list.selected=e.businessId},editAddress:function(e){this.clickReceipt=e,this.addressDetailsShow=!0},addAddress:function(){this.clickReceipt=null,this.addressDetailsShow=!0},onEditAddressSucceed:function(){this.addressDetailsShow=!1,this.getDeliverys()},handleOk:function(){var e=this,t=this.list.data.find((function(t){return t.businessId===e.list.selected}));this.beforeClose?this.beforeClose({data:this.list.selected,rows:[t]}):this.$emit("confirm",{data:this.list.selected,rows:[t]}),this.modalVisible=!1},handleCancel:function(){this.$emit("cancel"),this.modalVisible=!1}}};var Za=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-address",attrs:{footer:null,"get-container":e.setContainer,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.list.loading,expression:"list.loading"}],staticClass:"select-address-content"},[e.list.data&&e.list.data.length>0?n("div",[n("a-radio-group",{staticStyle:{width:"100%"},model:{value:e.list.selected,callback:function(t){e.$set(e.list,"selected",t)},expression:"list.selected"}},e._l(e.list.data,(function(t,a){return n("div",{key:a,staticClass:"content-item",class:{"auto-class":"zt"===t.type||"nothing"===t.type},on:{mouseenter:function(t){e.currentMark=a},mouseleave:function(t){e.currentMark=-1},click:function(n){return n.stopPropagation(),e.handleSelectAddress(t)},dblclick:function(t){return t.stopPropagation(),e.handleOk(t)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentMark===a,expression:"currentMark === index"}],staticClass:"row-btn"},[n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.editAddress(t)}}},[e._v("修改")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.deleteAddress(t)}}},[e._v("删除")])],1),e._v(" "),n("div",[n("a-radio",{style:{display:"block",height:"30px",lineHeight:"30px",marginRight:"14px"},attrs:{value:t.businessId}})],1),e._v(" "),n("div",{staticClass:"details"},[n("div",[e._v("\n              "+e._s(t.deliveryName||"")+"\n                \n              "),t.isDefault?n("a-tag",{attrs:{color:"blue"}},[e._v("默认")]):e._e()],1),e._v(" "),t.customerName&&t.phone?n("div",[e._v(e._s(t.customerName)+"  "+e._s(t.phone))]):e._e(),e._v(" "),t.detailAddress&&2===t.deliveryMethod?n("div",[e._v(e._s(t.detailAddress))]):e._e(),e._v(" "),t.fullAddress&&2!==t.deliveryMethod?n("div",[e._v(e._s(t.fullAddress))]):e._e()])])})),0)],1):n("div",{staticClass:"empty"},[n("a-empty",{attrs:{description:"暂无数据"}})],1)]),e._v(" "),n("div",{staticClass:"select-address-footer"},[n("div",{on:{click:e.addAddress}},[e._v("+新增收货地址")]),e._v(" "),n("div",[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n      "),n("a-button",{attrs:{disabled:!e.list.selected,type:"primary"},on:{click:e.handleOk}},[e._v("确定")])],1)]),e._v(" "),n("EditorAddress",{attrs:{customerId:e.customerId,"edit-data":e.clickReceipt,visible:e.addressDetailsShow,hasAddress:!!e.list.data.length},on:{"update:visible":function(t){e.addressDetailsShow=t},cancel:function(t){e.addressDetailsShow=!1},success:e.onEditAddressSucceed}})],1)};Za._withStripped=!0;const ei=mt({render:Za,staticRenderFns:[]},void 0,Qa,void 0,!1,void 0,!1,void 0,void 0,void 0);ei.install=function(e){e.component(ei.name,ei)};const ti={name:"SelectTree",props:{value:{type:[Array,Number,String],default:void 0},multiple:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},replaceFields:{type:Object,default:function(){return{}}},loadData:{type:Function,default:null}},data:function(){return{treeData:[],spreadData:{}}},computed:{baseReplaceFields:function(){return _e({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},treeCheckValue:{get:function(){return"object"===lt(this.checkValue)?this.checkValue:[this.checkValue]}}},watch:{options:{handler:function(e){console.log("lst",e),this.setOptions()},deep:!0,immediate:!0}},methods:{setOptions:function(){var e=this;this.spreadData={};var t=function t(n){var a=[];return n.forEach((function(n){e.spreadData[n[e.replaceFields.key]]=n,n.children&&(n.children=t(n.children)),a.push(_e(_e({},n),{},{scopedSlots:{icon:"radio"}}))})),a};this.treeData.length?this.treeData=t(this.treeData):this.treeData=t(this.options)},selectHandle:function(e,t){console.log(e,t)},getData:function(){var e=this,t=lt(this.checkValue),n=[];return console.log(this.spreadData),"object"===t?this.checkValue.forEach((function(t){var a="object"===lt(t)?t[e.replaceFields.key]:t;e.spreadData[a]&&n.push(e.spreadData[a])})):this.spreadData[this.checkValue]&&n.push(this.spreadData[this.checkValue]),{checkValue:this.checkValue,data:this.checkValue,rows:this.row||n}},onSelect:function(e,t){this.checkValue=e,this.row=t.checkedNodes.map((function(e){return e.data.props}))}},components:{Empty:zn}};var ni=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mix-modal-select-tree"},[e.options.length?e._e():n("empty"),e._v(" "),e.multiple?[n("a-tree",{attrs:{showIcon:"",checkable:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,multiple:"",loadData:e.loadData},on:{check:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){return[e._v("\n        "+e._s(t.name)+"\n      ")]}}]),model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}})]:[n("a-radio-group",{model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}},[n("a-tree",{attrs:{showIcon:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,loadData:e.loadData,selectable:!1},on:{select:e.selectHandle},scopedSlots:e._u([{key:"radio",fn:function(t){return[n("div",{staticClass:"radio-line"},[n("a-radio",{staticClass:"radio-line",attrs:{value:t[e.baseReplaceFields.key]}})],1)]}},{key:"title",fn:function(t){return[e._v("\n          "+e._s(t.name)+"\n        ")]}}],null,!1,3749490323),model:{value:e.treeCheckValue,callback:function(t){e.treeCheckValue=t},expression:"treeCheckValue"}})],1)]],2)};ni._withStripped=!0;const ai={name:"MixModal",props:{visible:{type:Boolean,default:!1},name:{type:String,default:"brand",validator:function(e){return-1!==["unit","brand","tag","levelPrice","productCategory","specialCategory","salesArea","classification","delivery","area","logistics","customLogistics"].indexOf(e)}},title:{type:String,default:"请选择"},cache:{type:Boolean,default:!1},beforeClose:{type:Function,default:null},defaultValue:{type:[String,Boolean,Number,Array],default:null},multiple:{type:Boolean,default:!1},extrasOperations:{type:Array,default:function(){return["refresh"]}},rules:{type:Object,default:function(){}}},data:function(){var e=this;return{keywords:"",placeholder:"请输入",options:[],checkValue:[],modelProps:{},testValue:[],loading:!0,modelType:"selectGroup",request:null,replaceFields:{key:"id",name:"name"},getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get($e.city,_e(_e({},t),e.rules)):t.provinceId&&t.cityId?e.$get($e.district,_e(_e({},t),e.rules)):void 0:e.$get($e.province,e.rules)}}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t[e.replaceFields["selectGroup"===e.modelType?"name":"title"]].match(e.keywords))return t})):this.options}},watch:{visible:function(e){e&&(this.keywords="",this.options.length&&this.cache||(this.options=[],this.refresh(),this.getList(),this.rules&&this.rules.keywords&&(this.keywords=this.rules.keywords)))},name:function(){this.refresh()}},methods:{refresh:function(){this.options=[],this.setModel(),this.getList()},handleCheckAll:function(){var e=this;this.checkValue=this.options.map((function(t){return t[e.replaceFields.key]}))},setModel:function(){["unit","brand","tag","levelPrice","classification","delivery","logistics"].includes(this.name)?this.modelType="selectGroup":["productCategory","salesArea","area"].includes(this.name)&&(this.modelType="selectTree")},getList:function(){var e=this;if(this.checkValue=this.defaultValue||[],this.loading=!0,["unit","brand","tag"].includes(this.name)){this.checkValue=this.defaultValue||[];var t={type:["unit","brand","tag"].indexOf(this.name)};this.$post(Ee,_e(_e({},t),this.rules)).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))}else["levelPrice"].includes(this.name)?(this.checkValue=this.defaultValue||[],this.replaceFields={},this.$post(Ae,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):["productCategory","specialCategory"].includes(this.name)?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"categoryName"},this.getCateGory(),this.request=this.getCateGory):"salesArea"===this.name?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"name"},this.getCustomerRegionList(),this.request=this.getCustomerRegionList):"classification"===this.name?(this.replaceFields={key:"value",name:"label"},this.$post(Ne,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):"delivery"===this.name?this.$get(Je,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):"area"===this.name?(this.replaceFields={key:"id",title:"name"},this.getRegion().then((function(t){e.options=t.data.map((function(e){return _e(_e({},e),{},{isLeaf:!1})})),e.request=e.getRegionList})).finally((function(){e.loading=!1}))):"logistics"===this.name?this.$get(et,this.rules).then((function(t){e.options=t.data;var n=e.options.filter((function(e){return e.isCheck})).map((function(e){return e.id}));console.log("isCheckedValue:",n),e.checkValue=n})).finally((function(){e.loading=!1})):"customLogistics"===this.name?this.$get(tt,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):(console.error("当前传入名称为：",this.name,"。请确认是否正确！！！"),this.loading=!1)},getCateGory:function(e){var t=this;if(e)return new Promise((function(n){e.dataRef.children?n():t.$get(je,_e({categoryType:["productCategory","specialCategory"].indexOf(t.name),parentId:e.dataRef.id},t.rules)).then((function(a){e.dataRef.children=a.data.categoryLists,t.options=kt(t.options),n(a.data.categoryLists)}))}));this.$get(je,_e({categoryType:["productCategory","specialCategory"].indexOf(this.name),parentId:0},this.rules)).then((function(e){t.loading=!1,t.options=e.data.categoryLists}))},getCustomerRegionList:function(e){var t=this;if(e)return new Promise((function(n){if(e.dataRef.children)n();else{var a=e.dataRef;t.$post(Me,_e({businessId:a.id||0},t.rules)).then((function(a){e.dataRef.children=a.data,t.options=kt(t.options),n(a.data)})).finally((function(){t.loading=!1}))}}));this.$post(Me,_e({businessId:0},this.rules)).then((function(e){t.options=e.data})).finally((function(){t.loading=!1}))},getRegionList:function(e){var t=this,n=null,a=null;return e.dataRef&&e.$parent.dataRef&&(n=e.dataRef.parentId,a=e.dataRef.id),e.dataRef&&!e.$parent.dataRef&&(n=e.dataRef.id),new Promise((function(i){e.dataRef.children?i():t.getRegion({provinceId:n,cityId:a}).then((function(n){e.dataRef.children=n.data.map((function(e){return _e(_e({},e),{},{isLeaf:!!a})})),t.options=kt(t.options),i(n.data)})).finally((function(){t.loading=!1}))}))},okHandle:function(){var e=this.$refs.contentModel.getData();e.isCheckAll=this.checkValue.length===this.options.length,this.beforeClose?this.beforeClose(e,this.cancelHandle):(this.$emit("confirm",e),this.modalVisible=!1)},cancelHandle:function(){this.modalVisible=!1}},components:{SelectGroup:ya,SelectTree:mt({render:ni,staticRenderFns:[]},void 0,ti,void 0,!1,void 0,!1,void 0,void 0,void 0),Empty:zn}};var ii=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:"816px"},on:{cancel:e.cancelHandle,ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.extrasOperations.includes("refresh")?n("a-button",{attrs:{type:"link"},on:{click:e.refresh}},[e._v("刷新")]):e._e(),e._v(" "),(e.extrasOperations.includes("checkAll")&&this.multiple&&this.modelType,e._e())],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},["selectGroup"===e.modelType?n("SelectGroup",{ref:"contentModel",attrs:{multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e(),e._v(" "),"selectTree"===e.modelType?n("SelectTree",{ref:"contentModel",attrs:{"load-data":e.request,multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e()],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};ii._withStripped=!0;const oi=mt({render:ii,staticRenderFns:[]},void 0,ai,void 0,!1,void 0,!1,void 0,void 0,void 0);oi.install=function(e){e.component(oi.name,oi)};var si={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"},account:{name:"SelectPayAccount",key:"accountId",value:"name"},delivery:{name:"SelectDelivery",key:"id",value:"name"},logistics:{name:"SelectLogistics",key:"id",value:"name"},customLogistics:{name:"SelectCustomLogistics",key:"id",value:"name"},address:{name:"SelectAddress",key:"businessId",value:"deliveryName"}};const ri=mt({},void 0,{name:"DMixSearch",props:{name:{type:String,default:"product"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:si,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){"[object Object]"!==Object.prototype.toString.call(e)?this.modalValue=e||void 0:Object.keys(e).length>0?this.modalValue=e:(console.warn("value 不能为空对象"),this.modalValue=void 0)},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e={},t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];if(this.dialogConfig.multiple?this.multiple=this.dialogConfig.multiple:this.multiple=!0===this.valueMode&&t&&!t.length,["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)){var n={type:si[this.name].type};e=we({},this.name,{multiple:this.multiple,rules:n}),this.dialog=oa}else["person","preparer","handler"].includes(this.name)?(e={person:{title:"经手人"},preparer:{title:"制单人"},handler:{title:"经手人"}},this.dialog=ca):["warehouse"].includes(this.name)?(e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=Jn):["customer","supplier","supplierCustomer"].includes(this.name)?(e={customer:{title:"选择客户",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[2]},supplier:{title:"选择供应商",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[1]},supplierCustomer:{title:"选择往来单位",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[3]}},this.dialog=va):["unit","brand","tag","rateUnit"].includes(this.name)?(e={unit:{type:0},brand:{type:1},tag:{type:2},rateUnit:{type:3}},this.dialog=wa):["account"].includes(this.name)?this.dialog=Da:["delivery","logistics","customLogistics"].includes(this.name)?(e={delivery:{name:"delivery"},logistics:{name:"logistics"},customLogistics:{name:"customLogistics"}},this.dialog=oi):"address"===this.name&&(e={address:{readonly:!0}},this.dialog=ei);console.log(e[this.name],this.name);var a=ut(this.dialogConfig);a.defaultValue||(a.defaultValue=this.modalValue),this.dialogProps=Yn(this.dialogProps,e[this.name],a)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=Yn(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},confirmHandle:function(e){console.log(e),["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch","confirm"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=_e({},this.modalValue))},resultExchange:function(e){var t=this.componentMap[this.name],n={},a={};if(n=(a=["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)?e&&e.rows.length?e.rows[0]:null:(["person","unit","brand","tag"].includes(this.name)||["supplier","customer","supplierCustomer"].includes(this.name)||["warehouse"].includes(this.name),e.rows[0]))?_e(_e({},a),{},{id:a[t.key],value:a[t.value]}):{},"address"===this.name){var i="";2===a.deliveryMethod&&(i=[a.customerName||"",a.phone||"",a.fullAddress||""].join(" "),n.value=i)}"select"!==this.valueMode&&(this.$emit("input",n),this.modalValue=n,console.log(this.modalValue)),this.$emit("change",_e(_e({},e),{},{data:this.multiple?e.rows:a?n:null,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:_e({},this.dialogProps),props:_e(_e({getContainer:function(){return document.querySelector("body")}},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:yt}},void 0,void 0,void 0,!1,void 0,void 0,void 0);ri.install=function(e){e.component(ri.name,ri)};const li={name:"FilterInput",props:{value:{type:String,default:""},placeholder:{type:String,default:"请输入"}},computed:{modelValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{changeHandle:function(){var e=this;this.$nextTick((function(){e.$emit("change",{data:e.modelValue})}))},setData:function(e){this.modelValue=e},getData:function(){return this.modelValue},resetData:function(){var e=this;this.modelValue="",this.$nextTick((function(){e.$emit("change",{data:e.value})}))}}};var ci=function(){var e=this,t=e.$createElement;return(e._self._c||t)("a-input",{attrs:{placeholder:e.placeholder},on:{change:e.changeHandle},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}})};ci._withStripped=!0;const ui=mt({render:ci,staticRenderFns:[]},void 0,li,void 0,!1,void 0,!1,void 0,void 0,void 0),di={name:"DSelectTimeRange",model:{prop:"value",event:"update:value"},props:{value:{type:Array,default:function(){return[]}},layout:{type:String,default:"inline"},startText:{type:String,default:"从"},divideText:{type:String,default:"至"},width:{type:[String,Number],default:"140"},placeholder:{type:[String,Array],default:function(){return["请选择","请选择"]}}},computed:{startPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[0]:this.placeholder},endPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[1]:this.placeholder},startValue:{get:function(){return this.value[0]?ke.default(new Date(this.value[0])):null},set:function(e){this.$emit("update:value",[Number(e),this.value[1]])}},endValue:{get:function(){return this.value[1]?ke.default(new Date(this.value[1])):null},set:function(e){this.$emit("update:value",[this.value[0],Number(e)])}}},data:function(){return{endOpen:!1,currentTime:null,isConfirm:!1}},methods:{moment:ke.default,getData:function(){return this.value.map((function(e){if(e)return{data:e,value:ke.default(Number(e)).format("YYYY-MM-DD HH:mm")}}))},changeHandle:function(e,t){var n=this,a=ke.default().valueOf();(!e||Math.abs(e-a)<=5)&&this.$nextTick((function(){n.confirmChange()}))},disabledStartDate:function(e){var t=this.endValue,n=ke.default().endOf("day").valueOf();return!!e&&(t?e<6311232e5||e>t:e<6311232e5||e>n)},disabledEndDate:function(e){var t=this.startValue,n=ke.default().endOf("day").valueOf();return!!e&&(t?e>n||t>=e:e>n||e<6311232e5)},confirmChange:function(e){this.isConfirm=!0;var t=this.value[0]?ke.default(new Date(this.value[0])).format("YYYY-MM-DD HH:mm"):void 0,n=this.value[1]?ke.default(new Date(this.value[1])).format("YYYY-MM-DD HH:mm"):void 0;this.$emit("confirm",{data:[this.value[0],this.value[1]],rows:[t,n]})},handleStartOpenChange:function(e){var t=this;e?this.currentTime=this.startValue:this.isConfirm?(this.isConfirm=!1,this.currentTime=null,!this.endValue&&this.$nextTick((function(){t.endOpen=!0}))):this.disabledStartDate(this.startValue)&&(this.startValue=this.currentTime)},handleEndOpenChange:function(e){this.endOpen=e,e?this.currentTime=this.endValue:this.isConfirm?(this.isConfirm=!1,this.currentTime=null):this.disabledEndDate(this.endValue)&&(this.endValue=this.currentTime)},valueOfDate:function(e){return e?ke.default(e).valueOf():null},resetData:function(){this.$emit("update:value",void 0),this.$emit("confirm",void 0)}}};var hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["select-time-range",{"layout-vertical":"vertical"===e.layout}]},["vertical"===e.layout?n("div",{staticClass:"text"},[e._v(e._s(e.startText))]):e._e(),e._v(" "),n("a-date-picker",{staticClass:"start-picker",style:{width:e.width+"px",minWidth:e.width+"px"},attrs:{showTime:{defaultValue:e.moment("00:00:00","HH:mm:ss")},allowClear:"",format:"YYYY-MM-DD HH:mm",valueFormat:"x","disabled-date":e.disabledStartDate,placeholder:e.startPlaceholder},on:{ok:e.confirmChange,openChange:e.handleStartOpenChange},model:{value:e.startValue,callback:function(t){e.startValue=t},expression:"startValue"}}),e._v(" "),n("div",{staticClass:"text"},[e._v(e._s(e.divideText))]),e._v(" "),n("a-date-picker",{style:{width:e.width+"px",minWidth:e.width+"px"},attrs:{showTime:{defaultValue:e.moment("23:59:59","HH:mm:ss")},allowClear:"",open:e.endOpen,format:"YYYY-MM-DD HH:mm",valueFormat:"x","disabled-date":e.disabledEndDate,placeholder:e.endPlaceholder},on:{ok:e.confirmChange,openChange:e.handleEndOpenChange},model:{value:e.endValue,callback:function(t){e.endValue=t},expression:"endValue"}})],1)};hi._withStripped=!0;const pi=mt({render:hi,staticRenderFns:[]},void 0,di,void 0,!1,void 0,!1,void 0,void 0,void 0);pi.install=function(e){e.component(pi.name,pi)};const fi={name:"TimeRange",components:{SelectTimeRange:pi},props:{value:{type:Array,default:function(){return[]}},config:{type:Object,default:function(){return{placeholder1:"",placeholder2:""}}}},computed:{modelValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},baseConfig:function(){return{placeholder1:this.config.placeholder1||"请选择开始时间",placeholder2:this.config.placeholder2||"请选择结束时间"}}},methods:{moment:ke.default,changeHandle:function(){var e=this;console.log(this.modelValue,"==========="),this.$nextTick((function(){e.$emit("change",{data:e.modelValue})}))},setData:function(e){this.modelValue=e},getData:function(){return this.modelValue.map((function(e){if(e)return{data:e,value:ke.default(Number(e)).format("YYYY-MM-DD HH:mm")}}))},resetData:function(){var e=this;this.modelValue=[void 0,void 0],this.$nextTick((function(){e.$emit("change",{data:e.value})}))}}};var mi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"condition-box"},[n("SelectTimeRange",{attrs:{layout:"vertical",width:"100%"},on:{confirm:e.changeHandle},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}})],1)};mi._withStripped=!0;const gi=mt({render:mi,staticRenderFns:[]},void 0,fi,"data-v-25218151",!1,void 0,!1,void 0,void 0,void 0),vi={name:"FilterAmount",props:{value:{type:Array,default:function(){return[]}},config:{type:Object,default:function(){return{placeholder1:"",placeholder2:""}}}},computed:{modelValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},baseConfig:function(){return{placeholder1:this.config.placeholder1||"请输入",placeholder2:this.config.placeholder2||"请输入"}}},methods:{changeHandle:function(){var e=this;this.$nextTick((function(){e.$emit("change",{data:e.modelValue})}))},setData:function(e){this.modelValue=e},getData:function(){return this.modelValue},resetData:function(){var e=this;this.modelValue=[void 0,void 0],this.$nextTick((function(){e.$emit("change",{data:e.value})}))}}};var yi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"condition-box"},[n("div",{staticClass:"text"},[e._v("从")]),e._v(" "),n("a-input-number",{staticClass:"num-range",attrs:{precision:0,placeholder:e.baseConfig.placeholder1,max:9999999999,min:0,clearable:""},model:{value:e.modelValue[0],callback:function(t){e.$set(e.modelValue,0,t)},expression:"modelValue[0]"}}),e._v(" "),n("div",{staticClass:"text"},[e._v("至")]),e._v(" "),n("a-input-number",{staticClass:"num-range",attrs:{precision:0,placeholder:e.baseConfig.placeholder2,max:9999999999,min:0,clearable:""},model:{value:e.modelValue[1],callback:function(t){e.$set(e.modelValue,1,t)},expression:"modelValue[1]"}})],1)};yi._withStripped=!0;const bi=mt({render:yi,staticRenderFns:[]},void 0,vi,"data-v-6ff1aaa8",!1,void 0,!1,void 0,void 0,void 0),ki=mt({},void 0,{name:"SelectGroup",props:{value:{type:[String,Boolean,Number,Array],default:void 0},options:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}},maxHeight:{type:[String,Number],default:400}},computed:{baseReplaceFields:function(){return _e({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{lineClick:function(e){if(this.multiple)if(this.checkValue.includes(e[this.baseReplaceFields.key])){var t=this.checkValue.indexOf(e[this.baseReplaceFields.key]);this.checkValue.splice(t,1)}else this.checkValue.push(e[this.baseReplaceFields.key]);else this.checkValue=e[this.baseReplaceFields.key]},getData:function(){var e=this,t=this.options.filter((function(t){return e.multiple?e.checkValue.includes(t[e.replaceFields.key]):t[e.replaceFields.key]===e.checkValue}));return{checkValue:this.checkValue,rows:t}}},render:function(e){var t=this;return e(t.multiple?"a-checkbox-group":"a-radio-group",{props:{value:t.checkValue,name:t.multiple?"a-checkbox-group":"a-radio-group"},on:{input:function(e){t.checkValue=e}},class:"group-out-box select-group",style:{maxHeight:"".concat(this.maxHeight,"px")}},t.options.map((function(n,a){return e(t.multiple?"a-checkbox":"a-radio",{attrs:{value:n[t.baseReplaceFields.key],key:a},key:a,props:{key:a},on:{click:function(e){e.stopPropagation()}}},n[t.baseReplaceFields.name])})))}},void 0,void 0,void 0,!1,void 0,void 0,void 0);ki.install=function(e){e.component(ki.name,ki)};const wi={name:"FilterGroup",components:{SelectGroup:ki},props:{name:{type:String,default:"bill"},value:{type:[Boolean,Number,Array,String],default:void 0},config:{type:Object,default:function(){return{placeholder:"",groupType:""}}},list:{type:Array,default:null}},data:function(){return{searchValue:"",options:[],replaceFields:{key:"id",name:"name"},checkBoxName:[],radioName:["bill","payment","inStock","outStock","sales","handler","prepared","stockSync","payStockSync","paymentMode","exchangePayment","brand","unit","tag","stockBill","invoiceType","printStatus"],pagination:{current:1,pageSize:30,total:0}}},computed:{modelValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},baseConfig:function(){return{placeholder:this.config.placeholder||"请输入关键字",groupType:""}},filteredOptions:function(){var e=this;return this.searchValue?this.options.filter((function(t){if(t[e.replaceFields.name].match(e.searchValue))return t})):this.options}},created:function(){this.generateOptions()},methods:{generateOptions:function(){if(this.list)this.options=this.list;else switch(this.name){case"bill":this.options=vn;break;case"payment":this.options=bn;break;case"inStock":this.options=mn;break;case"outStock":this.options=gn;break;case"sales":this.options=Sn;break;case"stockBill":this.options=Rn;break;case"handler":case"prepared":this.replaceFields={key:"stafferId"},this.loadData();break;case"stockSync":this.options=_n;break;case"paymentMode":this.options=xn;break;case"exchangePayment":this.options=Dn;break;case"unit":case"brand":case"tag":case"deliveryMethod":case"customerLevelPrice":this.loadData();break;case"payStock":this.options=fn;break;case"billSource":this.options=$n;break;case"invoiceType":this.options=Fn;break;case"printStatus":this.options=Ln}},loadData:function(){var e=this;"handler"===this.name||"prepared"===this.name?this.$get(ze,{current:this.pagination.current,pageSize:this.pagination.pageSize}).then((function(t){e.options=t.data})):["unit","brand","tag"].includes(this.name)?this.$post(Be,{type:["unit","brand","tag"].includes(this.name)}).then((function(t){e.options=t.data})):"deliveryMethod"===this.name?this.$get(Je).then((function(t){e.options=t.data})):"customerLevelPrice"===this.name&&(this.replaceFields={key:"value",name:"label"},this.$post(rt).then((function(t){e.options=t.data})))},changeHandle:function(){var e=this;this.$nextTick((function(){e.$emit("change",{data:e.modelValue})}))},setData:function(e){this.modelValue=e},getData:function(){var e=this;if(this.checkBoxName.includes(this.name)){var t=[];return this.modelValue.forEach((function(n){t=t.concat(e.options.filter((function(t){return t[e.replaceFields.key]===n})))})),t}return this.options.filter((function(t){return t[e.replaceFields.key]===e.modelValue}))},resetData:function(){var e=this;this.modelValue=this.checkBoxName.includes(this.name)?[]:void 0,this.$nextTick((function(){e.$emit("change",{data:e.value})}))}}};var Ci=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"filter-group"},[n("div",{staticClass:"search-input"},[n("a-input",{attrs:{placeholder:e.baseConfig.placeholder,allowClear:""},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),n("div",{staticClass:"scroll-wrap"},[n("SelectGroup",{attrs:{options:e.filteredOptions,multiple:e.checkBoxName.includes(e.name),replaceFields:e.replaceFields,maxHeight:200},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}})],1)])};Ci._withStripped=!0;const _i=mt({render:Ci,staticRenderFns:[]},void 0,wi,void 0,!1,void 0,!1,void 0,void 0,void 0);var Si={name:"FilterTree",props:{name:{type:String,default:"saleArea"},value:{type:[Number,Array,String],default:void 0},maxHeight:{require:!1,type:String,default:"300"},placeholder:{require:!1,type:String,default:"销售区域"}},data:function(){return{parentId:0,replaceFields:{children:"children",value:"id",title:"name",key:"id"},treeData:[]}},computed:{modelValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},created:function(){this.handleFetchTreeData()},methods:{handleFetchTreeData:function(){"saleArea"===this.name&&this.handleFetchSaleAreas([],!1)},handleFetchSaleAreas:function(){var e=arguments,t=this;return xe(Re.mark((function n(){var a,i,o,s;return Re.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:[],i=e.length>1&&void 0!==e[1]&&e[1],n.prev=2,n.next=5,t.$post(Me,{businessId:t.parentId});case 5:o=n.sent,(s=o.data).length&&(i?(a.children=s,t.treeData=kt(t.treeData)):t.treeData=s),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),console.error(n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,10]])})))()},onLoadData:function(e){var t=this;return new Promise((function(n){var a=e.dataRef;a.hasChildren?setTimeout((function(){t.parentId=a.id,t.handleFetchSaleAreas(a,!0),n()}),300):n()}))},onTreeSelectChange:function(e,t,n){console.log(e,t,n),this.$emit("change",{data:e})},getData:function(){return this.modelValue}}};const xi=Si;var Di=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"filter-tree"},[n("div",{staticClass:"tree-wrap"},[n("a-tree-select",{style:{width:"100%"},attrs:{allowClear:"","tree-data-simple-mode":"","dropdown-style":{maxHeight:e.maxHeight+"px",overflow:"auto"},"tree-data":e.treeData,"load-data":e.onLoadData,placeholder:e.placeholder,replaceFields:e.replaceFields},on:{select:e.onTreeSelectChange},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}})],1)])};Di._withStripped=!0;const Ri={name:"DFilterDropdown",components:{DMixSearch:ri,FilterInput:ui,TimeRange:gi,FilterAmount:bi,FilterGroup:_i,FilterTree:mt({render:Di,staticRenderFns:[]},void 0,xi,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{name:{type:String,default:"default"},value:{type:[String,Array,Object,Boolean],default:void 0},visible:{type:Boolean,default:!1},dataOrigin:{type:Number,default:0},dataSource:{type:Array,default:function(){return[]}},filterType:{type:Array,default:function(){return[]}},autoClose:{type:Boolean,default:!0},width:{type:Number,default:296},immediate:{type:Boolean,default:!1},placeholder:{type:[String,Array],default:"请输入"},config:{type:Object,default:function(){return{placeholder:"",groupType:""}}},list:{type:Array,default:null}},data:function(){return{componentMap:{input:{name:"FilterInput",default:"",childName:"input"},range:{name:"TimeRange",default:[void 0,void 0],childName:"range"},amount:{name:"FilterAmount",default:[void 0,void 0],childName:"amount"},payment:{name:"FilterGroup",default:"",childName:"payment"},bill:{name:"FilterGroup",default:"",childName:"bill"},inStock:{name:"FilterGroup",default:"",childName:"inStock"},outStock:{name:"FilterGroup",default:"",childName:"outStock"},sales:{name:"FilterGroup",default:"",childName:"sales"},stockBill:{name:"FilterGroup",default:"",childName:"stockBill"},handler:{name:"DMixSearch",default:"",childName:"person"},preparer:{name:"DMixSearch",default:"",childName:"person"},stockSync:{name:"FilterGroup",default:"",childName:"stockSync"},paymentMode:{name:"FilterGroup",default:"",childName:"paymentMode"},exchangePayment:{name:"FilterGroup",default:"",childName:"exchangePayment"},supplier:{name:"DMixSearch",default:{},childName:"supplier"},customer:{name:"DMixSearch",default:{},childName:"customer"},supplierCustomer:{name:"DMixSearch",default:{},childName:"supplierCustomer"},unit:{name:"FilterGroup",default:"",childName:"unit"},brand:{name:"FilterGroup",default:"",childName:"brand"},tag:{name:"FilterGroup",default:"",childName:"tag"},warehouse:{name:"DMixSearch",default:{},childName:"warehouse"},account:{name:"DMixSearch",default:{},childName:"account"},payStock:{name:"FilterGroup",default:"",childName:"payStock"},billSource:{name:"FilterGroup",default:"",childName:"billSource"},deliveryMethod:{name:"FilterGroup",default:"",childName:"deliveryMethod"},customerLevelPrice:{name:"FilterGroup",default:"",childName:"customerLevelPrice"},saleArea:{name:"FilterTree",default:"",childName:"saleArea"},invoiceType:{name:"FilterGroup",default:"",childName:"invoiceType"},printStatus:{name:"FilterGroup",default:"",childName:"printStatus"},erpSyncStatus:{name:"FilterGroup",default:"",childName:"payStock"}},modelValue:void 0}},computed:{baseConfig:function(){return _e({placeholder:"",placeholder1:"",placeholder2:"",groupType:""},this.config)},modelVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}}},watch:{value:{handler:function(e){"default"!==this.name&&(this.modelValue=this.componentMap[this.name].default,e&&(this.modelValue=e))},immediate:!0}},methods:{changeHandle:function(e){console.log(e),["supplierCustomer","supplier","customer","warehouse","person","preparer","handler","account"].includes(this.name)?(this.modelValue=e.data,this.$emit("input",e.data),this.confirmHandle("enter")):(this.modelValue=e.data,this.$emit("input",e.data))},next:function(e,t){return"mixSearch"===e&&"focus"!==t&&(this.modelVisible=!1),!0},confirmHandle:function(e){if("default"!==this.name){var t=this.$refs.filterComponent.getData&&this.$refs.filterComponent.getData();console.log(t);var n=t&&t.constructor===Array,a=t;["supplierCustomer","supplier","customer"].includes(this.name)&&(a=this.modelValue.id);var i={data:n?a.length?a:void 0:a,config:{type:"filterDown",status:e,name:this.name,columnsName:this.$attrs.data?this.$attrs.data.column.key:this.name,props:this.$attrs.data||{}},rows:n?t.length?t:void 0:t?[t]:void 0};if(this.$emit("confirm",i),console.log("返回的参数：",i),this.autoClose)try{this.$attrs.data.confirm()}catch(e){console.error("请传入关闭事件")}}else this.$emit("confirm",{type:"filterDown",status:"default",name:this.name,columnsName:this.$attrs.data?this.$attrs.data.column.key:this.name,props:this.$attrs.data||{}})},cancelHandle:function(){if(this.autoClose)try{this.$attrs.data.confirm()}catch(e){console.error("请传入关闭事件")}this.$emit("cancel")},resetHandle:function(e){var t=this;if("default"===this.name)return this.$emit("confirm",{status:"default",name:this.name,columnsName:this.$attrs.data?this.$attrs.data.column.key:this.name,props:this.$attrs.data||{}}),void this.$attrs.data.confirm();this.$refs.filterComponent.resetData&&this.$refs.filterComponent.resetData(),this.$nextTick((function(){e&&t.confirmHandle("reset")}))},resetData:function(e){this.resetHandle(e)}}};var Oi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-filter-dropdown",style:{width:e.width+"px"}},[n("div",{staticClass:"filter-content"},[e._t("default",["default"!==e.name?n(e.componentMap[e.name].name,{ref:"filterComponent",tag:"components",attrs:{placeholder:e.placeholder,name:e.componentMap[e.name].childName,config:e.baseConfig,next:e.next,origin:"filterDropDown",list:e.list},on:{change:e.changeHandle},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}}):e._e()])],2),e._v(" "),n("div",{staticClass:"filter-footer"},[n("div",{staticClass:"btn-reset",on:{click:function(t){return e.resetHandle(!0)}}},[e._v("重置")]),e._v(" "),n("div",{staticClass:"btn-right"},[n("a-button",{on:{click:e.cancelHandle}},[e._v("取消")]),e._v(" "),n("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmHandle("enter")}}},[e._v("确定")])],1)])])};Oi._withStripped=!0;const Vi=mt({render:Oi,staticRenderFns:[]},void 0,Ri,void 0,!1,void 0,!1,void 0,void 0,void 0);return Vi.install=function(e){e.component(Vi.name,Vi)},Vi}))},ae52:function(e,t,n){var a=n("2418");e.exports=a},af03:function(e,t,n){var a=n("d039");e.exports=function(e){return a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},b020:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("159b"),n("d81d"),n("a9e3"),n("d3b7"),n("c1df"),n("b64b"),n("caad"),n("a15b"),n("ac1f"),n("1276"),n("5319"),n("466d"),n("fb6a"),n("2b0e"),n("fd87"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("4de4"),n("99af"),n("2532"),n("a434"),n("cfba"),n("07ac"),n("b680"),n("50f6"),n("3177"),n("2ca0"),n("7db0"),n("7edb"),n("aa47"),n("fb19"),n("73c8"),n("04b3"),n("4e82"),n("9911"),n("e439"),n("90b7"),n("7569"),n("25f0"),n("498a"),n("4ec9"),n("3ca3"),n("ddb0"),n("c740"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x,D,R,O,V,T,L,$,I,F,M,P,N,E,A,j,B,K,H,z,q,Y,W,G,U,X,J,Q,Z,ee,te,ne,ae,ie,oe){"use strict";function se(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var re=se(o),le=se(f),ce=se(H),ue=se(Y),de=se(W),he=se(X),pe=se(J),fe=se(Q);function me(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const ge={name:"DSelectTimeRange",model:{prop:"value",event:"update:value"},props:{value:{type:Array,default:function(){return[]}},layout:{type:String,default:"inline"},startText:{type:String,default:"从"},divideText:{type:String,default:"至"},width:{type:[String,Number],default:"140"},placeholder:{type:[String,Array],default:function(){return["请选择","请选择"]}}},computed:{startPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[0]:this.placeholder},endPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[1]:this.placeholder},startValue:{get:function(){return this.value[0]?re.default(new Date(this.value[0])):null},set:function(e){this.$emit("update:value",[Number(e),this.value[1]])}},endValue:{get:function(){return this.value[1]?re.default(new Date(this.value[1])):null},set:function(e){this.$emit("update:value",[this.value[0],Number(e)])}}},data:function(){return{endOpen:!1,currentTime:null,isConfirm:!1}},methods:{moment:re.default,getData:function(){return this.value.map((function(e){if(e)return{data:e,value:re.default(Number(e)).format("YYYY-MM-DD HH:mm")}}))},changeHandle:function(e,t){var n=this,a=re.default().valueOf();(!e||Math.abs(e-a)<=5)&&this.$nextTick((function(){n.confirmChange()}))},disabledStartDate:function(e){var t=this.endValue,n=re.default().endOf("day").valueOf();return!!e&&(t?e<6311232e5||e>t:e<6311232e5||e>n)},disabledEndDate:function(e){var t=this.startValue,n=re.default().endOf("day").valueOf();return!!e&&(t?e>n||t>=e:e>n||e<6311232e5)},confirmChange:function(e){this.isConfirm=!0;var t=this.value[0]?re.default(new Date(this.value[0])).format("YYYY-MM-DD HH:mm"):void 0,n=this.value[1]?re.default(new Date(this.value[1])).format("YYYY-MM-DD HH:mm"):void 0;this.$emit("confirm",{data:[this.value[0],this.value[1]],rows:[t,n]})},handleStartOpenChange:function(e){var t=this;e?this.currentTime=this.startValue:this.isConfirm?(this.isConfirm=!1,this.currentTime=null,!this.endValue&&this.$nextTick((function(){t.endOpen=!0}))):this.disabledStartDate(this.startValue)&&(this.startValue=this.currentTime)},handleEndOpenChange:function(e){this.endOpen=e,e?this.currentTime=this.endValue:this.isConfirm?(this.isConfirm=!1,this.currentTime=null):this.disabledEndDate(this.endValue)&&(this.endValue=this.currentTime)},valueOfDate:function(e){return e?re.default(e).valueOf():null},resetData:function(){this.$emit("update:value",void 0),this.$emit("confirm",void 0)}}};var ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["select-time-range",{"layout-vertical":"vertical"===e.layout}]},["vertical"===e.layout?n("div",{staticClass:"text"},[e._v(e._s(e.startText))]):e._e(),e._v(" "),n("a-date-picker",{staticClass:"start-picker",style:{width:e.width+"px",minWidth:e.width+"px"},attrs:{showTime:{defaultValue:e.moment("00:00:00","HH:mm:ss")},allowClear:"",format:"YYYY-MM-DD HH:mm",valueFormat:"x","disabled-date":e.disabledStartDate,placeholder:e.startPlaceholder},on:{ok:e.confirmChange,openChange:e.handleStartOpenChange},model:{value:e.startValue,callback:function(t){e.startValue=t},expression:"startValue"}}),e._v(" "),n("div",{staticClass:"text"},[e._v(e._s(e.divideText))]),e._v(" "),n("a-date-picker",{style:{width:e.width+"px",minWidth:e.width+"px"},attrs:{showTime:{defaultValue:e.moment("23:59:59","HH:mm:ss")},allowClear:"",open:e.endOpen,format:"YYYY-MM-DD HH:mm",valueFormat:"x","disabled-date":e.disabledEndDate,placeholder:e.endPlaceholder},on:{ok:e.confirmChange,openChange:e.handleEndOpenChange},model:{value:e.endValue,callback:function(t){e.endValue=t},expression:"endValue"}})],1)};ve._withStripped=!0;const ye=me({render:ve,staticRenderFns:[]},void 0,ge,void 0,!1,void 0,!1,void 0,void 0,void 0);function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e,t,n,a,i,o,s){try{var r=e[o](s),l=r.value}catch(e){return void n(e)}r.done?t(l):Promise.resolve(l).then(a,i)}function _e(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){Ce(o,a,i,s,r,"next",e)}function r(e){Ce(o,a,i,s,r,"throw",e)}s(void 0)}))}}ye.install=function(e){e.component(ye.name,ye)};var Se=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,a=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new O(a||[]);return o._invoke=function(e,t,n){var a=d;return function(i,o){if(a===p)throw new Error("Generator is already running");if(a===f){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var r=x(s,n);if(r){if(r===m)continue;return r}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var l=u(e,t,n);if("normal"===l.type){if(a=n.done?f:h,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=f,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",m={};function g(){}function v(){}function y(){}var b={};l(b,o,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(V([])));w&&w!==n&&a.call(w,o)&&(b=w);var C=y.prototype=g.prototype=Object.create(b);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,s,r){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,r)}),(function(e){n("throw",e,s,r)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,r)}))}r(l.arg)}var i;this._invoke=function(e,a){function o(){return new t((function(t,i){n(e,a,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,n){var a=e.iterator[n.method];if(a===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=u(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function V(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(a.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:T}}function T(){return{value:t,done:!0}}return v.prototype=y,l(C,"constructor",y),l(y,"constructor",v),v.displayName=l(y,r,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,r,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},_(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,i,o){void 0===o&&(o=Promise);var s=new S(c(t,n,a,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(C),l(C,r,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=V,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(a,i){return r.type="throw",r.arg=e,n.next=a,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],r=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:V(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),xe=Se,De="/gateway/saas-platform-service/api/v1/",Re="/gateway/goodsservice/api/v1/",Oe="/gateway/customer-service/api/v1/",Ve="/gateway/logisticsservice/api/v1/",Te={province:"".concat(De,"address/province"),city:"".concat(De,"address/city"),district:"".concat(De,"address/district")},Le="".concat(De,"address/get_by_name"),$e="".concat(Re,"goods/custom/list"),Ie="".concat(Oe,"order/get_region_list"),Fe="".concat(Oe,"order/get_customer_list"),Me="".concat(Oe,"order/get_customer_type_list"),Pe="".concat(Re,"setting/query_goods_attr_setting_list"),Ne="".concat(Re,"price_system/leve_price_name/select_list"),Ee="".concat(Re,"/category/get_category_list_with_nocategory_qty"),Ae="".concat(Re,"setting/query_goods_attr_setting_list"),je="".concat(Re,"warehouse/list"),Be="".concat(Re,"goods/get_sku_unit_list"),Ke="".concat(De,"staffer/get_corp_all"),He="".concat(Re,"category/get_category_list"),ze="".concat(Re,"warehouse/get_warehouse_by_corp_id"),qe="".concat(Re,"price_system/leve_price/select_list"),Ye="".concat(De,"department/get_corp_tree"),We="".concat(De,"staffer/list"),Ge="".concat("/gateway/billservice/api/v1/","account/check_list"),Ue="".concat(Ve,"deliveryMethod/list"),Xe="".concat(Ve,"deliveryMethod/list"),Je="".concat(Ve,"logisticsCorp/custom/list"),Qe="".concat(Ve,"logisticsCorp/system/list"),Ze="".concat(Ve,"logisticsCorp/custom/list"),et="".concat(Oe,"order/get_deliverys"),tt="".concat(Oe,"order/add_delivery"),nt="".concat(Oe,"order/update_delivery"),at="".concat(Oe,"order/delete_delivery"),it="".concat(Oe,"order/set_default_delivery");function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function st(e){var t=!1;return function(){for(var n=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];t||(t=!0,window.requestAnimationFrame((function(){e.apply(n,i),t=!1})))}}function rt(e){if(!e&&"object"!==ot(e))throw new Error("error arguments","deepClone");var t=e.constructor===Array?[]:{};return Object.keys(e).forEach((function(n){e[n]&&"object"===ot(e[n])?t[n]=rt(e[n]):t[n]=e[n]})),t}"object"!==("undefined"==typeof Int8Array?"undefined":ot(Int8Array))&&(le.default.prototype.$isServer||document.childNodes);var lt=function(e){return!e||"{}"===JSON.stringify(e)||"[]"===JSON.stringify(e)||!e},ct=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&""!==e[n]&&null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return t};function ut(e){for(var t=1,n=arguments.length;t<n;t++){var a=arguments[t]||{};for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];void 0!==o&&(e[i]=o)}}return e}var dt={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return _e(xe.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x;return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get($e,ut({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(Ke,t.dialogConfig.rules);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=138;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(je,we(we({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Fe,we(we({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Ae,we({type:["unit","brand","tag"].indexOf(t.name)},t.dialogConfig.rules));case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=138;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(Be,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=138;break;case 71:if(!["account"].includes(t.name)){n.next=84;break}if(!t.localDataCache){n.next=76;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 76:return n.next=78,t.$get(Ge,we({accountType:t.dialogConfig.payType||1,customerId:t.dialogConfig.customerId},t.dialogConfig.rules));case 78:return g=n.sent,v=g.data,t.localDataCache=v,n.abrupt("return",v);case 82:n.next=138;break;case 84:if("delivery"!==t.name){n.next=97;break}if(!t.localDataCache){n.next=89;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 89:return n.next=91,t.$get(Ue,t.dialogConfig.rules);case 91:return y=n.sent,b=y.data,t.localDataCache=b,n.abrupt("return",b);case 95:n.next=138;break;case 97:if("logistics"!==t.name){n.next=110;break}if(!t.localDataCache){n.next=102;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 102:return n.next=104,t.$get(Qe,t.dialogConfig.rules);case 104:return k=n.sent,w=k.data,t.localDataCache=w,n.abrupt("return",w);case 108:n.next=138;break;case 110:if("customLogistics"!==t.name){n.next=123;break}if(!t.localDataCache){n.next=115;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 115:return n.next=117,t.$get(Ze,t.dialogConfig.rules);case 117:return C=n.sent,_=C.data,t.localDataCache=_,n.abrupt("return",_);case 121:n.next=138;break;case 123:if("address"!==t.name){n.next=137;break}if(t.replaceFields={key:"businessId",name:"deliveryName"},!t.localDataCache){n.next=129;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 129:return n.next=131,t.$post(et,{businessId:t.dialogConfig.customerId});case 131:return S=n.sent,x=S.data,t.localDataCache=x,n.abrupt("return",x);case 135:n.next=138;break;case 137:console.log("未知的 name:",t.name);case 138:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch","click")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},handleInputClick:function(){this.dialogConfig.readonly&&this.clickHandle()},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch","enter")||this.dialogFocus||(this.dialogFocus=!0,this.inputValue?this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1,e.matchingData("enter")})).catch((function(){e.loading=!1})).finally((function(){setTimeout((function(){e.dialogFocus=!1}),300)})):(this.dataList=[],this.loading=!1,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300)))},matchingData:function(e){var t=this,n=function(){var n=null,a=lt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var e=lt(this.value);this.inputValue=e?this.value.name||this.value.value:""}},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(lt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch","focus")},focus:function(){this.$refs.mixSearchInput.focus()}}};const ht=dt;var pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue,readOnly:e.dialogConfig.readonly},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle,click:e.handleInputClick},scopedSlots:e._u([{key:"suffix",fn:function(){return[n("a-button",{attrs:{type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle}})]},proxy:!0}]),model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})};pt._withStripped=!0;const ft=me({render:pt,staticRenderFns:[]},void 0,ht,"data-v-f165b002",!1,void 0,!1,void 0,void 0,void 0);function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function gt(e){return function(e){if(Array.isArray(e))return mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var vt={data:function(){var e=this;return{tableData:[],selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"},pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(t){return"总".concat(t,"条，每页显示").concat(e.pagination.pageSize,"条")}},selectionConfig:{selections:!0},tableSelection:{onChange:null,onSelect:null,onSelectAll:null,onSelectInvert:null,currentPage:null,allPage:null},resultMap:{},searchResult:{}}},computed:{selectOnIndeterminate:function(){return"allPage"===this.selectionContent.selectType&&!!this.selectionContent.noSelectedRowKeys.length&&!!this.selectionContent.selectedRowKeys.length},hasOverSelectionLimit:function(){return this.selectionLimit&&this.selectionContent.selectedRowKeys.length>=this.selectionLimit},rowSelection:function(){var e=this,t=this;return we(we({},t.selectionContent.rowSelection),{},{selectedRowKeys:t.selectionContent.selectedRowKeys,onChange:function(e,n){var a;console.log("onChange selectedRowKeys",e),console.log("onChange selectedRows",n);var i=t.selectionContent.primaryKey;if("allPage"===t.selectionContent.selectType&&!e.length)return t.selectionContent.selectType="",void t.handleSelectedClear();if(t.selectionLimit&&e.length>t.selectionLimit)t.$message.warning("最多选择".concat(t.selectionLimit,"条"));else{t.selectionContent.selectedRowKeys=e;var o=t.selectionContent.noSelectedRows,s=t.selectionContent.selectedRows,r=!1;t.tableData.forEach((function(n){e.includes(n[i])?("allPage"===t.selectionContent.selectType&&(r=!0,delete o[n[i]]),s[n[i]]=n):("allPage"===t.selectionContent.selectType&&(r=!0,o[n[i]]=n),delete s[n[i]])})),t.selectionContent.noSelectedRows=o,t.selectionContent.selectedRows=s,"allPage"===t.selectionContent.selectType&&r&&t._generateNoSelectKey();for(var l=arguments.length,c=new Array(l>2?l-2:0),u=2;u<l;u++)c[u-2]=arguments[u];t.tableSelection.onChange&&(a=t.tableSelection).onChange.apply(a,[e,n].concat(c))}},onSelect:function(e,n,a,i){t.tableSelection.onSelect&&t.tableSelection.onSelect(e,n,a,i)},onSelectAll:function(e,n,a){t.tableSelection.onSelectAll&&t.tableSelection.onSelectAll(e,n,a)},onSelectInvert:function(e){t.tableSelection.onSelectInvert&&t.tableSelection.onSelectInvert(e)},hideDefaultSelections:!0,selections:!!t.selectionConfig.selections&&[{key:"currentPage",text:"当前页",onSelect:function(n){"allPage"===t.selectionContent.selectType&&t.handleSelectedClear(),t.selectionContent.selectType="currentPage";var a=t.selectionContent.primaryKey,i=[],o=[];t.tableData.forEach((function(e){t.selectionContent.selectedRowKeys.includes(e[a])?i.push(e):o.push(e)}));var s=e.selectionContent.selectedRows;if((i.length&&o.length||!i.length)&&o.forEach((function(e){s[e[a]]=e})),!o.length){var r=t.selectionContent.selectedRows;i.forEach((function(e){delete r[e[a]]}))}t.selectionContent.selectedRows=s,t._generateKey()}},{key:"allPage",text:"所有页",onSelect:function(e){if("allPage"===t.selectionContent.selectType&&(t.selectionContent.selectedRowKeys.length||t.selectionContent.noSelectedRowKeys.length))t.handleSelectedClear();else{t.selectionContent.selectType="allPage";var n=t.selectionContent.primaryKey;t.tableData.forEach((function(e){t.selectionContent.selectedRows[e[n]]=e}))}t._generateKey()}}]})}},methods:{setPagination:function(e){this.pagination=we({total:0,pageSize:10,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["5","10","20"],showTotal:function(e){return"总".concat(e,"条")}},e)},setRowSelection:function(e){this.selectionContent.rowSelection=e},dealSelectionCheckBox:function(){var e=this;"allPage"===this.selectionContent.selectType&&(this.tableData.forEach((function(t){try{e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]||e.selectionContent.noSelectedRows[t[e.selectionContent.primaryKey]]||(e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]=t)}catch(e){console.log(e)}})),this._generateKey())},_generateKey:function(){var e=[];for(var t in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.selectedRowKeys=e},_generateNoSelectKey:function(){var e=[];for(var t in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.noSelectedRowKeys=e},handleSelectedClear:function(){return this.selectionContent.selectedRowKeys=[],this.selectionContent.selectedRows={},this.selectionContent.noSelectedRowKeys=[],this.selectionContent.noSelectedRows=[],this.selectionContent.selectType="",this},getRowData:function(e){var t=[];if(e)for(var n in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(n)&&t.push(this.selectionContent.noSelectedRows[n]);else for(var a in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(a)&&t.push(this.selectionContent.selectedRows[a]);return t},setTableSelectType:function(e){this.selectionContent.selectType=e,this.handleSelectedClear()},setSelectRows:function(e){var t=this;e.forEach((function(e){t.selectionContent.selectedRows[e[t.selectionContent.primaryKey]]=e}))},setSelectionStatus:function(e){this.selectionConfig.selections=e},rowClick:function(e){var t=this;if(console.log("单击",e),this.multiple)if(this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key]))this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]];else{if(this.hasOverSelectionLimit)return void this.$message.warning("最多选择".concat(this.selectionLimit,"条"));this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e}else this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=be({},e[this.baseReplaceFields.key],e)},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||this.hasOverSelectionLimit||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.handleOk&&this.handleOk()},dealResult:function(){var e=this;if(this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t];"object"===ot(n)?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}return this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=we(we({},e.selectionContent.selectedRows),{},be({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=be({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this}}};const yt={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:ce.default},methods:{handleClick:function(){this.$emit("click")}}};var bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[n("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};bt._withStripped=!0;const kt=me({render:bt,staticRenderFns:[]},void 0,yt,void 0,!1,void 0,!1,void 0,void 0,void 0);var wt=le.default.prototype.$isServer,Ct=!wt&&document.addEventListener?function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}:function(e,t,n){e&&t&&n&&e.attachEvent("on"+t,n)},_t=!wt&&document.removeEventListener?function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)}:function(e,t,n){e&&t&&e.detachEvent("on"+t,n)};le.default.use(ue.default);var St={CONTAIN:{name:"contain",icon:"fullscreen"},ORIGINAL:{name:"original",icon:"fullscreen-exit"}},xt=!le.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",Dt={name:"hImageViewer",props:{host:{type:String},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},showDown:{type:Boolean,default:!0},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},prefix:{type:[Boolean,String],default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!0,mode:St.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},baseUrlList:[]}},computed:{picList:function(){var e=this;return this.urlList.filter((function(t,n){return n===e.index}))},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.baseUrlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,n=e.deg,a=e.offsetX,i=e.offsetY,o=e.enableTransition,s={transform:"scale(".concat(t,") rotate(").concat(n,"deg)"),transition:o?"transform .3s":"","margin-left":"".concat(a,"px"),"margin-top":"".concat(i,"px")};return this.mode===St.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(){var e=this;this.$nextTick((function(){e.$refs.img[0].complete||(e.loading=!0)}))},urlList:{handler:function(){this.exchangeImage()},deep:!0}},methods:{exchangeImage:function(){var e=this.prefix,t=this.baseUrlList,n="";"string"==typeof e?n=e:e&&(n=this.host);for(var a=0;a<this.urlList.length;a++){var i=this.urlList[a];if(/(http|https):\/\//.test(i))t.push(i);else{var o=i.indexOf("/")>0?"/":"";t.push("".concat(n).concat(o?"/":"").concat(i))}}},hide:function(){this.deviceSupportUninstall(),this.onClose()},download:function(){this.$emit("download",this.currentImg)},deviceSupportInstall:function(){var e=this;this._keyDownHandler=st((function(t){switch(t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}})),this._mouseWheelHandler=st((function(t){(t.wheelDelta?t.wheelDelta:-t.detail)>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),Ct(document,"keydown",this._keyDownHandler),Ct(document,xt,this._mouseWheelHandler)},deviceSupportUninstall:function(){_t(document,"keydown",this._keyDownHandler),_t(document,xt,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var n=this.transform,a=n.offsetX,i=n.offsetY,o=e.pageX,s=e.pageY;this._dragHandler=st((function(e){t.transform.offsetX=a+e.pageX-o,t.transform.offsetY=i+e.pageY-s})),Ct(document,"mousemove",this._dragHandler),Ct(document,"mouseup",(function(){_t(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(St),t=(Object.values(St).indexOf(this.mode)+1)%e.length;this.mode=St[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=we({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),a=n.zoomRate,i=n.rotateDeg,o=n.enableTransition,s=this.transform;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-a).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+a).toFixed(3));break;case"clocelise":s.deg+=i;break;case"anticlocelise":s.deg-=i}s.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["h-image-viewer__wrapper"].focus(),this.exchangeImage()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}};const Rt=Dt;var Ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"viewer-fade"}},[n("div",{ref:"h-image-viewer__wrapper",staticClass:"h-image-viewer__wrapper",style:{"z-index":e.zIndex},attrs:{tabindex:"-1"}},[n("div",{staticClass:"h-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick(t)}}}),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__close",on:{click:e.hide}},[n("a-icon",{attrs:{type:"close"}})],1),e._v(" "),e.isSingle?e._e():[n("span",{staticClass:"h-image-viewer__btn h-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[n("a-icon",{attrs:{type:"arrow-left"}})],1),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[n("a-icon",{attrs:{type:"arrow-right"}})],1)],e._v(" "),n("div",{staticClass:"h-image-viewer__btn h-image-viewer__actions"},[n("div",{staticClass:"h-image-viewer__actions__inner"},[n("a-icon",{attrs:{type:"zoom-out"},on:{click:function(t){return e.handleActions("zoomOut")}}}),e._v(" "),n("a-icon",{attrs:{type:"zoom-in"},on:{click:function(t){return e.handleActions("zoomIn")}}}),e._v(" "),n("a-icon",{attrs:{type:"undo"},on:{click:function(t){return e.handleActions("anticlocelise")}}}),e._v(" "),n("a-icon",{attrs:{type:"redo"},on:{click:function(t){return e.handleActions("clocelise")}}}),e._v(" "),e.showDown?n("a-icon",{attrs:{type:"download"},on:{click:e.download}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"h-image-viewer__canvas"},[e._l(e.picList,(function(t){return n("img",{key:t,ref:"img",refInFor:!0,staticClass:"h-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}})})),e._v(" "),e.loading?n("a-icon",{staticClass:"h-image-loading",attrs:{type:"loading"}}):e._e()],2)],2)])};Ot._withStripped=!0;const Vt=me({render:Ot,staticRenderFns:[]},void 0,Rt,void 0,!1,void 0,!1,void 0,void 0,void 0);var Tt="",Lt=function(){return void 0!==document.documentElement.style.objectFit},$t=function(e,t){return It(e,null!==t||void 0!==t?t?"overflow-y":"overflow-x":"overflow").match(/(scroll|auto)/)},It=function(e,t){return(window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle)[t]},Ft="none",Mt="contain",Pt="cover",Nt="fill",Et="scale-down",At={name:"HImage",inheritAttrs:!1,props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewBtn:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},showDown:{type:Boolean,default:!1},initial:{type:Number,default:0},prefix:{type:[Boolean,String],default:!0},popover:{type:Boolean,default:!1},popoverConfig:{type:Object,default:function(){return{placement:"right",trigger:"hover",width:"200px",height:"100%"}}}},components:{IconFontBox:kt,IconFont:ce.default,ImageViewer:Vt},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1,imageSrc:""}},provide:function(){return{download:this.download}},computed:{imgHost:function(){return this.$config?this.$config.cosPrefix:""},imageStyle:function(){var e=this.fit;return window&&e?Lt()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter:function(){return window&&!Lt()&&this.fit!==Nt},preview:function(){var e=this.previewSrcList;return Array.isArray(e)&&e.length>0},imageIndex:function(){var e=this.initial||0,t=this.previewSrcList.indexOf(this.src);return t>=0&&(e=t),e}},watch:{src:function(){this.imageSrc=this.exchangeImage(),this.show&&this.loadImage()},show:function(e){e&&this.loadImage()}},mounted:function(){this.imageSrc=this.exchangeImage(),this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{exchangeImage:function(){var e=this.src,t=this.prefix;if(!e)return e;if(/(http|https):\/\//.test(e))return e;var n="";"string"==typeof t?n=t:t&&(n=this.imgHost);var a=e.indexOf("/")>0;return"".concat(n).concat(a?"/":"").concat(e)},handleLazyLoad:function(){var e,t,n,a;e=this.$el,t=this._scrollContainer,a=e.getBoundingClientRect(),n=[window,document,document.documentElement,null,void 0].includes(t)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:t.getBoundingClientRect(),a.top<n.bottom&&a.bottom>n.top&&a.right>n.left&&a.left<n.right&&(this.show=!0,this.removeLazyLoadListener())},download:function(e){this.$emit("download",e)},addLazyLoadListener:function(){var e,t,n=this.scrollContainer,a=null;(t=n)&&t.nodeType===Node.ELEMENT_NODE?a=n:(e=n,a="[object String]"===Object.prototype.toString.call(e)?document.querySelector(a):function(e){for(var t=e;t;){if([window,document,document.documentElement].includes(parent))return window;if($t(t))return t;t=t.parentNode}return t}(this.$el)),a&&(this._scrollContainer=a,this._lazyLoadHandler=function(e,t,n,a){var i,o=!1,s=0;function r(){i&&clearTimeout(i)}function l(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=this,h=Date.now()-s;function p(){s=Date.now(),n.apply(d,c)}function f(){i=void 0}o||(a&&!i&&p(),r(),void 0===a&&h>e?p():!0!==t&&(i=setTimeout(a?f:p,void 0===a?e-h:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){r(),o=!0},l}(200,this.handleLazyLoad),a.addEventListener("scroll",this._lazyLoadHandler,!1),this.handleLazyLoad())},removeLazyLoadListener:function(){var e=this._scrollContainer,t=this._lazyLoadHandler;!this.$isServer&&e&&t&&(e.removeEventListener("scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},loadImage:function(){var e=this;if(window){this.loading=!0,this.error=!1;var t=new Image;t.onload=function(n){return e.handleLoad(n,t)},t.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(n){var a=e.$attrs[n];t.setAttribute(n,a)})),t.src=this.imageSrc}},handleLoad:function(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError:function(e){this.loading=!1,this.error=!0,this.$emit("error",e)},getImageStyle:function(e){var t=this.imageWidth,n=this.imageHeight,a=this.$el,i=a.clientWidth,o=a.clientHeight;if(!(t&&n&&i&&o))return{};var s=t/n<1;switch(e===Et&&(e=t<i&&n<o?Ft:Mt),e){case Ft:return{width:"auto",height:"auto"};case Mt:return s?{width:"auto"}:{height:"auto"};case Pt:return s?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(e){!this.preview&&this.previewBtn||this.openViewer()},openViewer:function(){Tt=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closeViewer:function(){document.body.style.overflow=Tt,this.showViewer=!1}}};const jt=At;var Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"a-image"},[e.loading?e._t("placeholder",[n("div",{staticClass:"a-image__placeholder"},[e._t("loading",[n("a-icon",{staticClass:"placeholder-icon",attrs:{type:"picture"}})])],2)]):e.error&&e.src?e._t("error",[n("div",{staticClass:"a-image__error"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"icontupianjiazaishibai"}})],1)]):e.popover&&e.src?n("a-popover",{attrs:{placement:e.popoverConfig.placement,trigger:e.popoverConfig.trigger}},[n("template",{slot:"content"},[n("img",{style:{width:e.popoverConfig.width,height:e.popoverConfig.height},attrs:{src:e.src}})]),e._v(" "),n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners))],2):e.src?n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)):e.src?e._e():e._t("none",[n("div",{staticClass:"a-image__none"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"iconzanwutupian2"}})],1)]),e._v(" "),e.preview?[e.showViewer?n("image-viewer",{attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,showDown:e.showDown,"url-list":e.previewSrcList,prefix:e.prefix,host:e.imgHost},on:{download:e.download}}):e._e()]:e._e()],2)};Bt._withStripped=!0;const Kt=me({render:Bt,staticRenderFns:[]},void 0,jt,void 0,!1,void 0,!1,void 0,void 0,void 0);var Ht={zIndex:2e3,initialIndex:0,urlList:[]},zt=le.default.extend(Vt);Kt.install=function(e){e.component(Kt.name,Kt)},Kt.api=function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=ut({},Ht,e);var t=new zt({el:document.createElement("div"),propsData:e,methods:{hide:function(){this.deviceSupportUninstall(),this.$el.parentNode.removeChild(this.$el)},download:function(){e.download&&e.download(this.currentImg)}}}),n=e.body?document.body:e.target;console.log(n),document.body.appendChild(t.$el)}(e)};const qt={name:"TableCellEllipsisTip",props:{onlyLine:{type:Boolean,default:!1},line:{type:Number,default:1},text:{type:[String,Number],default:""},tip:{type:[String,Number],default:""},position:{type:String,default:"bottom"},id:{type:[String,Number],default:W.guid()},tipExtAttr:{type:Object,default:function(){return{}}}},data:function(){return{elId:W.guid().substr(0,5),showTip:!1,actualTip:""}},computed:{cellStyle:function(){return{"line-clamp":this.line}}},mounted:function(){this.tipChange()},updated:function(){this.tipChange()},methods:{tipChange:function(){var e=this;try{var t=this.text?this.text:this.$el.innerText;this.actualTip=this.tip?this.tip:t,this.$nextTick((function(){setTimeout((function(){try{var t=document.getElementById(e.elId);e.showTip=!!t&&W.isEllipsis(t)}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}),0)}))}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}}};var Yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-ellipsis-wrap",attrs:{id:"cell-ellipsis-"+e.id,"cell-ellipsis-id":e.id}},[e.showTip&&!e.onlyLine?n("a-tooltip",e._b({class:"cell-tooltip-"+e.id,attrs:{placement:e.position}},"a-tooltip",e.tipExtAttr,!1),[n("template",{slot:"title"},[e._t("tip",[e._v(e._s(e.actualTip))])],2),e._v(" "),n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n        "+e._s(e.text)+"\n      ")])],2)],2):n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n      "+e._s(e.text)+"\n    ")])],2)],1)};Yt._withStripped=!0;const Wt=me({render:Yt,staticRenderFns:[]},void 0,qt,void 0,!1,void 0,!1,void 0,void 0,void 0);function Gt(){return Gt=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Gt.apply(this,arguments)}Wt.install=function(e){e.component(Wt.name,Wt)};var Ut=["attrs","props","domProps"],Xt=["class","style","directives"],Jt=["on","nativeOn"],Qt=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},Zt=function(e){return e.reduce((function(e,t){for(var n in t)if(e[n])if(-1!==Ut.indexOf(n))e[n]=Gt({},e[n],t[n]);else if(-1!==Xt.indexOf(n)){var a=e[n]instanceof Array?e[n]:[e[n]],i=t[n]instanceof Array?t[n]:[t[n]];e[n]=a.concat(i)}else if(-1!==Jt.indexOf(n))for(var o in t[n])if(e[n][o]){var s=e[n][o]instanceof Array?e[n][o]:[e[n][o]],r=t[n][o]instanceof Array?t[n][o]:[t[n][o]];e[n][o]=s.concat(r)}else e[n][o]=t[n][o];else if("hook"==n)for(var l in t[n])e[n][l]=e[n][l]?Qt(e[n][l],t[n][l]):t[n][l];else e[n]=t[n];else e[n]=t[n];return e}),{})};function en(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var tn=he.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function nn(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}var an=["key"],on={},sn={name:"STable",props:{dragOption:{type:Object,default:function(){return{}}},draggable:Boolean,draggableOption:{type:Object,default:function(){return{minWidth:100,maxWidth:560}}},sortList:{type:Array,default:null},sortConfig:{type:Object,default:function(){return{}}},cellWidth:{type:Object,default:void 0},excludeWidth:{type:Array,default:function(){return[]}}},data:function(){return{components:null,columns:[],hash:""}},computed:{actSortConfig:function(){return we({unshift:["index"],push:[],key:"key"},this.sortConfig)}},created:function(){this.components={header:{cell:this.resizeableTitle}}},mounted:function(){this.columns=this.sortColumns(),Object.keys(this.dragOption).length&&this.initSortable()},render:function(){var e=this,t=arguments[0],n=this.$attrs,a=this.sortColumns(),i={on:we({},this.$listeners)};return t("a-table",Zt([{},{props:we(we({},n),{},{columns:a}),scopedSlots:we({},this.$scopedSlots)},{attrs:{components:this.components}},i,{ref:"tableSort"}]),[Object.keys(this.$slots).map((function(n){return"default"!==n?t("template",{slot:n},[e.$slots[n]]):null}))])},components:{"vue-draggable-resizable":fe.default},methods:{sortColumns:function(){var e=this,t=this.$attrs.columns?this.updateColumns(this.$attrs.columns):this.generateColumns(this.$slots.default);if(this.sortList&&this.sortList.length){var n={},a=[];t.forEach((function(e){e.key&&(n[e.key]=e)})),this.sortList.forEach((function(t){!n[t[e.actSortConfig.key]]||e.actSortConfig.unshift.includes(t[e.actSortConfig.key])||e.actSortConfig.push.includes(t[e.actSortConfig.key])||a.push(n[t[e.actSortConfig.key]])}));for(var i=this.actSortConfig.unshift.length-1;i>=0;i--)this.actSortConfig.unshift[i]&&n[this.actSortConfig.unshift[i]]&&a.unshift(n[this.actSortConfig.unshift[i]]);for(var o=this.actSortConfig.push.length-1;o>=0;o--)this.actSortConfig.push[o]&&n[this.actSortConfig.push[o]]&&a.push(n[this.actSortConfig.push[o]]);return a}return t},generateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return t.forEach((function(t){if(t.tag){var a=Z.getKey(t),i=Z.getStyle(t),o=Z.getClass(t),s=Z.getOptionProps(t),r=Z.getEvents(t),l={};Object.keys(r).forEach((function(e){var t=void 0;t=e.startsWith("update:")?"on-"+e.substr("update:".length)+"-change":"on-"+e,l[Z.camelize(t)]=r[e]}));var c=Z.getSlots(t),u=c.default,d=nn(c,["default"]),h=tn({},d,s,{style:i,class:o},l);if(a&&(h.key=a),Z.getSlotOptions(t).__ANT_TABLE_COLUMN_GROUP)h.children=e.generateColumns("function"==typeof u?u():u);else{var p=t.data&&t.data.scopedSlots&&t.data.scopedSlots.default;h.customRender=h.customRender||p}n.push(h)}})),n},updateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],a=this.$slots,i=this.$scopedSlots;return t.forEach((function(t){var o=t.slots,s=void 0===o?{}:o,r=t.scopedSlots,l=void 0===r?{}:r,c=nn(t,["slots","scopedSlots"]),u=tn({},c);Object.keys(s).forEach((function(e){var t=s[e];void 0===u[e]&&a[t]&&(u[e]=1===a[t].length?a[t][0]:a[t])})),Object.keys(l).forEach((function(e){var t=l[e];void 0===u[e]&&i[t]&&(u[e]=i[t])})),t.children&&(u.children=e.updateColumns(u.children)),n.push(u)})),n},generateSlot:function(){},resizeableTitle:function(e,t,n){var a=this,i=this.columns;i.forEach((function(e){on[e.key]=e.width||0}));var o=le.default.observable(on),s=null,r=t.key,l=en(t,an),c={};if(!(c="selection-column"===r?{dataIndex:"selection-column",key:"selection-column",width:40}:i.find((function(e){return(e.dataIndex||e.key)===r})))||!c.width||"selection-column"===r||this.excludeWidth.includes(r))return c&&c.width?e("th",Zt([{attrs:{width:c.width}},l]),[n]):e("th",Zt([{},l]),[n]);var u=this.draggableOption,d=u.maxWidth,h=u.minWidth;return e("th",Zt([{},l,{directives:[{name:"ant-ref",value:function(e){return s=e}}],attrs:{width:c.width},style:{position:"relative"}}]),[n,e(fe.default,{key:c.key,class:"table-draggable-handle",attrs:{w:10,x:o[r]||c.width,z:1,axis:"x",draggable:this.draggable,resizable:!1},on:{dragging:function(e){if(o[r]=0,c.width=Math.max(h,Math.min(e,d)),a.cellWidth){var t=we(we({},a.cellWidth),{},be({},c.key,c.width));a.$emit("update:cellWidth",we({},t))}},dragstop:function(){o[r]=s.getBoundingClientRect().width}},style:{height:"100% !important",bottom:0,left:"auto !important",right:"-5px",cursor:this.draggable?"col-resize":"default","touch-action":"none",transform:"none !important",position:"absolute"}})])},initSortable:function(){var e=this,t=this.$refs.tableSort.$el.querySelectorAll("tbody"),n=Object.assign({},this.dragOption);pe.default.create(t[t.length>1?1:0],we(we({handle:".ant-table-row",animation:150},n),{},{onUpdate:function(t){var n=e.$attrs["data-source"],a=t.oldIndex,i=t.newIndex,o=n.splice(a,1)[0];n.splice(i,0,o),e.$emit("onUpdate",{dataSource:n,evt:t})},onStart:function(t){e.$emit("onStart",t)},onAdd:function(t){e.$emit("onAdd",t)},onRemove:function(t){e.$emit("onRemove",t)},onChoose:function(t){e.$emit("onChoose",t)},onEnd:function(t){e.$emit("onEnd",t)},onFilter:function(t){e.$emit("onFilter",t)},onMove:function(t){e.$emit("onMove",t)}}))},changeHandler:function(e){this.$emit("change",e)},refresh:function(e){console.log("refresh"),this.$attrs.columns||this.$forceUpdate()}},install:function(e){e.component(sn.name,sn)}};kt.install=function(e){e.component(kt.name,kt)};const rn={name:"DOperationBox",components:{IconFontBox:kt,CellEllipsisTip:Wt},inject:{selectionContent:{from:"selectionContent",default:void 0},pagination:{from:"pagination",default:void 0}},props:{value:{type:Object,default:function(){return{}}},optionList:{type:Array,default:function(){return[]}},moreSearch:{type:Boolean,default:!0},modalConfig:{type:Object,default:function(){return{}}}},data:function(){return{actOptionList:[],loading:{},visible:!1}},computed:{selectList:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},baseModalConfig:function(){return we({title:"",okText:"确定",cancelText:"取消",width:"492px",style:"",class:"",resetText:"清空"},this.modalConfig)},actPagination:function(){return this.pagination?this.pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(e){return"总".concat(e,"条")}}},actSelectionContent:function(){return this.selectionContent?this.selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"}}},created:function(){this.generateOptionList()},watch:{optionList:function(){this.generateOptionList()}},methods:{generateOptionList:function(){var e=this;this.loading={},this.actOptionList=[];var t={name:"",key:"",icon:"",iconColor:"#378EFB",textColor:"#378EFB",size:16,loading:void 0};this.optionList.forEach((function(n){n.loading&&e.$set(e.loading,n.key,!1),e.actOptionList.push(we(we({},t),n))}))},handleSelect:function(e){"more"===e&&this.$slots.modal?this.visible=!0:this.$emit("optionClick",{name:e,close:this.closeLoading(e),key:e})},optionHandle:function(e){this.loading[e.key]||(e.loading&&(this.loading[e.key]=!0),this.$emit("optionClick",{key:e.key,close:this.closeLoading(e.key),data:e,name:e.name}))},handleDelete:function(e){var t=this,n=null;if("all"===e)this.selectList={};else{n=rt(this.selectList[e]);var a=this.selectList;delete a[e],this.selectList=we({},a)}this.$nextTick((function(){t.$emit("delete",{name:e,old:n,key:e,config:{name:e,status:"delete",type:"operation",resultName:e}})}))},closeLoading:function(e){var t=this,n=e;return function(){if("all"===n)for(var e in t.loading)t.loading.hasOwnProperty(e)&&(t.loading[e]=!1);else t.loading.hasOwnProperty(n)&&(t.loading[n]=!1)}},modalOk:function(){var e=this;this.modalConfig.ok?this.modalConfig.ok((function(){e.visible=!1})):this.visible=!1},modalCancel:function(){var e=this;this.modalConfig.cancel?this.modalConfig.cancel((function(){e.visible=!1})):this.visible=!1},resetHandle:function(){var e=this;this.modalConfig.reset&&this.modalConfig.reset((function(){e.visible=!1}))}}};var ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"operation-index"},[n("div",{staticClass:"opt-top"},[e.actSelectionContent.selectedRowKeys.length?e._e():n("div",{staticClass:"filter-box"},[n("div",{staticClass:"filter-list"},[e._t("default")],2),e._v(" "),e.moreSearch?n("div",{staticClass:"more-search"},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.handleSelect("more")}}},[e._v("\n          更多搜索\n          "),n("icon-font-box",{attrs:{type:"icongengduosousuo",size:"16",color:"#378EFB"}})],1)]):e._e()]),e._v(" "),e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"select-list"},[n("div",{staticClass:"select-box"},[n("icon-font-box",{attrs:{type:"icon_warning",size:"16",color:"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-text"},[e._v("已选"),n("span",{staticClass:"select-num"},[e._v(e._s("allPage"===e.actSelectionContent.selectType?e.actPagination.total-e.actSelectionContent.noSelectedRowKeys.length:e.actSelectionContent.selectedRowKeys.length))]),e._v("条")]),e._v(" "),n("a",{staticClass:"clear-row",attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleSelect("clear")}}},[e._v("清空选中")])],1),e._v(" "),n("div",{staticClass:"select-rule"},e._l(e.actOptionList,(function(t,a){return n("a",{key:a,staticClass:"select-btn",attrs:{type:"link"},on:{click:function(n){return e.optionHandle(t)}}},[e.loading[t.key]?n("a-spin",{attrs:{size:"small"}}):e._e(),e._v(" "),e.loading[t.key]?e._e():n("icon-font-box",{attrs:{type:t.icon,size:t.size||16,color:t.iconColor||"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-btn-text",style:{color:t.textColor}},[e._v(e._s(t.name))])],1)})),0)]):e._e(),e._v(" "),e.$slots.other?n("div",{staticClass:"other-btn"},[e._t("other")],2):e._e()]),e._v(" "),Object.keys(e.selectList).length&&!e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"opt-bottom"},[e._l(e.selectList,(function(t,a){return n("div",{key:a,staticClass:"tag-box"},[n("div",{staticClass:"tag-label"},[e._v(e._s(t.label))]),e._v(" "),n("div",{staticClass:"tag-info"},[n("cell-ellipsis-tip",{attrs:{tip:t.value}},[e._v(e._s(t.value))])],1),e._v(" "),n("icon-font-box",{staticClass:"tag-close",attrs:{type:"icon_close",size:"14"},on:{click:function(n){return e.handleDelete(t.key)}}})],1)})),e._v(" "),n("a",{attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleDelete("all")}}},[e._v("全部清除")])],2):e._e(),e._v(" "),n("a-modal",{class:e.baseModalConfig.class,style:e.baseModalConfig.style,attrs:{title:e.baseModalConfig.title,"ok-text":e.baseModalConfig.okText,"cancel-text":e.baseModalConfig.cancelText,width:e.baseModalConfig.width,maskClosable:!1,keyboard:!1},on:{ok:e.modalOk,cancel:e.modalCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._t("modal"),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"operation-modal-footer"},[n("div",{staticClass:"operation-reset"},[n("a-button",{attrs:{type:"link"},on:{click:e.resetHandle}},[e._v(e._s(e.baseModalConfig.resetText))])],1),e._v(" "),n("div",{staticClass:"operation-btn"},[n("a-button",{key:"back",on:{click:e.modalCancel}},[e._v("\n            "+e._s(e.baseModalConfig.cancelText)+"\n          ")]),e._v(" "),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("\n            "+e._s(e.baseModalConfig.okText)+"\n          ")])],1)])])],2)],1)};ln._withStripped=!0;const cn=me({render:ln,staticRenderFns:[]},void 0,rn,void 0,!1,void 0,!1,void 0,void 0,void 0);cn.install=function(e){e.component(cn.name,cn)};var un=[{id:0,name:"草稿"},{id:1,name:"已过账"},{id:3,name:"已红冲"}],dn={0:un[0],1:un[1],2:un[2]},hn=[{id:0,name:"未支付"},{id:1,name:"部分支付"},{id:2,name:"已支付"}],pn={0:hn[0],1:hn[1]},fn=[{id:1,name:"库存高于上限"},{id:2,name:"库存低于下限"},{id:3,name:"有货"},{id:4,name:"缺货"}],mn={0:pn[0],1:pn[1]},gn=[{id:5,name:"ERP草稿",color:"#52C41A"},{id:1,name:"已过账",color:"#52C41A"},{id:4,name:"ERP删除",color:"#BBBBBB"},{id:2,name:"草稿",color:"#52C41A"},{id:3,name:"已红冲",color:"#F5222D"},{id:0,name:"未同步",color:"#378EFB"}],vn=[{id:0,name:"已下架"},{id:1,name:"已上架"}],yn=[{id:1,name:"应收调整"},{id:2,name:"应付调整"}],bn=[{id:0,name:"草稿"},{id:1,name:"盘点完成"}],kn=[{id:0,name:"全部"},{id:1,name:"采购入库"},{id:2,name:"退货入库"},{id:3,name:"盘盈入库"},{id:4,name:"其它入库"},{id:5,name:"销售出库"},{id:6,name:"采购退货"},{id:7,name:"盘亏出库"},{id:8,name:"采购入库"},{id:9,name:"其它出库"},{id:10,name:"同价调拨入库"},{id:11,name:"同价调拨出库"},{id:12,name:"撤销出库"},{id:13,name:"进销存同步"},{id:14,name:"撤销退货"},{id:15,name:"退货单取消"},{id:16,name:"订货单取消"}],wn=[{id:0,name:"微信账户"},{id:1,name:"预付款账户"},{id:2,name:"现金账户"},{id:3,name:"银行卡账户"}],Cn=[{id:-1,name:"已取消",key:"canceled",btnKeys:["detail","del","share","print","export","copy"]},{id:0,name:"草稿",key:"draft",btnKeys:["detail","submit","submit_audit","del","share","print","export","copy"]},{id:1,name:"待审核",key:"to_audit",btnKeys:["detail","audit","cancel_bill","share","print","export","copy"]},{id:2,name:"待出库",key:"to_stock_removal",btnKeys:["detail","stock_removal","auditee","cancel_bill","share","print","export","copy"]},{id:3,name:"部分出库",key:"portion_stock_removal",btnKeys:["detail","stock_removal","suspend_bill","share","print","export","copy"]},{id:4,name:"待发货",key:"to_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:5,name:"部分发货",key:"portion_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:6,name:"待收货",key:"to_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:7,name:"部分收货",key:"portion_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:8,name:"已完成",key:"finish",btnKeys:["detail","share","print","export","copy"]},{id:9,name:"已中止",key:"suspend",btnKeys:["detail","share","print","export","copy"]}],_n=[{id:1,name:"已打印"},{id:0,name:"未打印"}],Sn=[{id:0,name:"PC端代开"},{id:1,name:"企业微信代开"},{id:2,name:"小程序商城"},{id:3,name:"巡店"},{id:4,name:"Excel导入"}],xn=[{id:1,name:"买赠"},{id:2,name:"秒杀"},{id:3,name:"特价"},{id:4,name:"订单促销"},{id:5,name:"组合促销"},{id:6,name:"一口价"},{id:7,name:"拼团"},{id:8,name:"优惠券"},{id:9,name:"分销"}],Dn=[{id:0,name:"不开发票"},{id:1,name:"普通发票"},{id:2,name:"增值税发票"}],Rn=Object.freeze({__proto__:null,billStatus:{0:{name:"草稿",color:"#378EFB",icon:"iconcaogao"},1:{name:"已过账",color:"#52C41A",icon:"iconyiguozhang",stocktakingName:"盘点完成",stocktakingIcon:"icon_stocktaking_completed"},3:{name:"已红冲",color:"#F5222D",icon:"iconyihongchong"}},payStockSync:[{id:2,name:"ERP草稿",color:"#52c41a"},{id:3,name:"已过账",color:"#52c41a"},{id:4,name:"ERP删除",color:"#bbbbbb"},{id:5,name:"同步失败",color:"#f5222d"},{id:0,name:"未同步",color:"#378efb"}],payStockSyncMap:{0:{name:"未同步",color:"#378efb"},2:{name:"ERP草稿",color:"#52c41a"},3:{name:"已过账",color:"#52c41a"},4:{name:"ERP删除",color:"#bbbbbb"},5:{name:"同步失败",color:"#f5222d"}},inStockMap:[{id:0,name:"盘盈入库"},{id:2,name:"其它入库"}],outStockMap:[{id:1,name:"盘亏出库"},{id:3,name:"其它出库"}],orderStatus:un,orderStatusMap:dn,paymentStatus:hn,paymentStatusMap:pn,stockStatus:fn,stockStatusMap:mn,stockSync:gn,stockSyncMap:{},saleStatus:vn,modeOfPayment:[{id:0,name:"线下支付"},{id:1,name:"银行卡转账"}],exchangePayment:yn,stockBillStatus:bn,stockInAndOut:kn,accountType:wn,saleOrderStatus:Cn,printStatus:_n,billSource:Sn,marketingType:xn,invoiceType:Dn});const On=me({},void 0,{name:"DMixSelect",props:{value:{type:[String,Number,Array],default:void 0},resultName:{type:String,default:""},type:{type:Number,default:0},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},width:{type:[String,Number],default:120},list:{type:Array,default:null},exclude:{type:Array,default:function(){return[]}},mode:{type:String,default:"select"},getPopupContainer:{type:Function,default:function(){return document.querySelector(".mix-select")}}},data:function(){return{actValue:void 0,options:[],selectLoading:!1}},computed:{modalPlaceholder:function(){return this.placeholder},actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:function(e){this.actValue=e},type:{handler:function(){this.options=[],this.getData()}}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;if(console.log(Rn,this.type),!this.$slots.default)if(this.list)this.options=this.list;else if([0,1,2,11].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$post(11===this.type?Ne:Ae,{type:this.type}).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1})).catch((function(){e.selectLoading=!1}))}else if([14].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$get(Ue).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1}))}else switch(this.type){case 3:this.options=un;break;case 4:this.options=hn;break;case 5:this.options=fn;break;case 6:this.options=vn;break;case 7:this.options=yn;break;case 8:this.options=gn;break;case 9:this.options=bn;break;case 10:this.options=kn;break;case 12:this.options=Cn;break;case 13:this.options=_n;break;case 15:this.options=Sn;break;case 16:this.options=xn;break;case 17:this.options=Dn;break;default:this.options=[]}},handleChange:function(e){var t=ot(e);if(null==e||"object"===t&&!e.length)return this.$emit("input",void 0),this.actValue=void 0,void this.$emit("change",{config:{resultName:this.resultName,status:"delete",type:"select"}});var n="number"===t?{}:[];this.options.forEach((function(a){"number"===t?a.id===e&&(n=a):e.includes(a.id)&&n.push(a)})),this.$emit("input",e),this.actValue=e,this.$emit("change",{data:e,rows:n,config:{resultName:this.resultName,status:"select",type:"select"}})},optionsVisibleHandle:function(){this.options.length||this.$slots.default||this.getData()},resetData:function(){this.actValue=void 0,this.$emit("input",void 0)}},render:function(e){var t=this,n=this;return e("div",{class:"mix-select",style:"width: ".concat(n.actWidth)},[e("a-select",{scopedSlots:n.$scopedSlots,props:{value:n.actValue,allowClear:n.allowClear,placeholder:n.modalPlaceholder,mode:n.mode,getPopupContainer:n.getPopupContainer,disabled:n.disabled},style:"width:100%;",on:{dropdownVisibleChange:n.optionsVisibleHandle,change:n.handleChange}},[n.selectLoading?e("a-spin",{props:{size:"small"},slot:"notFoundContent"}):function(){if(t.$slots.default)return t.$slots.default;var n=[];return t.options.forEach((function(a,i){t.exclude.includes(a.id)||n.push(e("a-select-option",{props:{value:a.id,key:i,title:a.name}},a.name))})),n}()])])}},"data-v-c44b6be8",void 0,void 0,!1,void 0,void 0,void 0);On.install=function(e){e.component(On.name,On)};var Vn={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return _e(xe.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m;return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get($e,ut({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(Ke);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=72;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(je,we({pageNum:1,pageSize:30},a));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Fe,we({pageNum:1,pageSize:30},a));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Ae,{type:["unit","brand","tag"].indexOf(t.name)});case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=72;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(Be,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=72;break;case 71:["account"].includes(t.name)?console.log("还没做"):console.log("未知的 name:",t.name);case 72:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300))},matchingData:function(e){var t=this,n=function(){var n=null,a=lt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){var e=this;if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var t=lt(this.value);this.inputValue=t?this.value.name||this.value.value:""}else this.inputValue&&this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1}))},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(lt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch")},focus:function(){this.$refs.mixSearchInput.focus()}}};const Tn=Vn;var Ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[n("a-button",{attrs:{slot:"suffix",type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle},slot:"suffix"})],1)};Ln._withStripped=!0;const $n=me({render:Ln,staticRenderFns:[]},void 0,Tn,"data-v-225db93a",!1,void 0,!1,void 0,void 0,void 0);var In={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"}};const Fn={name:"Empty",components:{empty:ee.empty,loading:ee.loading},props:{text:{type:String,default:""},loading:{type:Boolean,default:!1}}};var Mn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"empty"},[n("div",{staticClass:"icon"},[e._t("icon",[e.loading?n("loading",{staticClass:"empty-icon"}):n("empty",{staticClass:"empty-icon"})])],2),e._v(" "),n("h3",{staticClass:"text"},[e._t("default",[e._v(e._s(e.text?e.text:e.loading?"加载中……":"暂无搜索结果"))])],2)])};Mn._withStripped=!0;const Pn=me({render:Mn,staticRenderFns:[]},void 0,Fn,void 0,!1,void 0,!1,void 0,void 0,void 0);function Nn(e){return"object"===ot(e)&&null!==e&&e.constructor&&e.constructor===Object}function En(){for(var e=Object(arguments.length<=0?void 0:arguments[0]),t=1;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(n)for(var a=Object.keys(Object(n)),i=0;i<a.length;i++){var o=a[i],s=Object.getOwnPropertyDescriptor(n,o);s&&s.enumerable&&(Nn(e[o])&&Nn(n[o])?En(e[o],n[o]):!Nn(e[o])&&Nn(n[o])?(e[o]={},En(e[o],n[o])):e[o]=n[o])}}return e}Pn.install=function(e){e.component(Pn.name,Pn)};var An={data:function(){return{searchResult:{},selectList:{},selectConfig:{},filterSortConfig:{},resultDealStatus:!1,searchFilterDefaultData:void 0,_searchFilterConfig:void 0}},methods:{beforeSearchChange:function(){return!0},beforeTableChange:function(){return!0},tableChange:function(e,t,n){console.log("tableChange 接收到事件改变：",e,t,n);var a=Object.keys(e).length;if(a){if(e.current!==this.pagination.current)return void this.loadTableData(e);if(e.pageSize!==this.pagination.pageSize)return e.current=1,this.pagination.pageSize=e.pageSize,this.handleSelectedClear&&this.handleSelectedClear(),void this.loadTableData(e)}if(!this.beforeTableChange||this.beforeTableChange(e,t,n)){a?e.current===this.pagination.current&&e.pageSize===this.pagination.pageSize&&(e.current=1):e=we(we({},this.pagination),{},{current:1});var i=n.columnKey,o=n.order,s=Object.prototype.hasOwnProperty.call(this.searchResult,"sort");o?s?this.searchResult.sort="ascend"===o?this.filterSortConfig[i]:0-this.filterSortConfig[i]:this.searchResult=we(we({},this.searchResult),{},{sortField:this.filterSortConfig[i]||i,sortType:"ascend"===o?"asc":"desc"}):s?this.searchResult.sort=void 0:this.searchResult=we(we({},this.searchResult),{},{sortField:void 0,sortType:void 0}),this.loadTableData(e)}},searchResultDeal:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log("searchResultDeal 接收到条件变化：",e,t),this.beforeSearchChange(e)){var n=this._resetSearchFilterDefaultData()._getFilterConfig(e);n.deal=t;var a=n.data;n.rows;var i=n.config,o=n.dataType,s=n.columnsName;if("all"===i[e.config.columnsName||e.config.resultName]||this.selectConfig[e.config.columnsName||e.config.resultName]){if("all"===i.resultName&&"delete"===i.status)return this._searchFilterClearAll(e),this.pagination&&(this.pagination.current=1),this.loadTableData(),this;"array"===o&&(a[0]||a[1]||(a=void 0,console.warn("请注意 ".concat(s," 中组件返回的 data 全是空值。")))),null==a||""===a?this._deleteValue():("string"===o||"number"===o?this._dealDataForSingle():"array"===o?this._dealDataForArray():"object"===o?this._dealDataForObject():console.log("啥也不是"),this.selectList=we({},this.selectList),this.pagination&&(this.pagination.current=1),!t&&this.loadTableData()),this._searchFilterClearRef(e)}else console.error("当前没有配置 selectConfig：",e.config.columnsName||e.config.resultName,"，请注意检查 selectConfig 和对应的 dom 节点是否配置正确！")}},_getFilterConfig:function(e){var t,n=e.data,a=e.rows,i=e.config,o=this,s=i.columnsName||i.resultName,r=En(o.searchFilterDefaultData,this.selectConfig[s]);return console.log("合并后的内容：",r,o.searchFilterDefaultData),o._searchFilterConfig={data:n,rows:a,config:i,dataType:(t=n,"[object Null]"===Object.prototype.toString.call(t)?"null":"[object Object]"===Object.prototype.toString.call(t)?"object":"[object Array]"===Object.prototype.toString.call(t)?"array":"[object Undefined]"===Object.prototype.toString.call(t)?"undefined":"[object String]"===Object.prototype.toString.call(t)?"string":"[object Number]"===Object.prototype.toString.call(t)?"number":void 0),columnsName:s,selectList:o.selectList,selectConfig:r,dataCallback:o.selectConfig[s].setText,valueCallback:o.selectConfig[s].setValue,deal:!1,linkMode:r.linkMode||"before",linkType:ot(r.link),link:r.link||"-",valueLink:r.valueLink||","},o._searchFilterConfig},_getActValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=this._searchFilterConfig.selectConfig,i="data"===e?a.dataTarget||"data":a.valueTarget||"data",o="data"===e?a.dataKey:a.valueKey,s="data"===i?t:n;return o?s[o]:s},_checkValueCallback:function(){var e=this._searchFilterConfig,t=e.data,n=e.rows,a=e.valueCallback;if(!a)return!0;a.call(this,{data:t,rows:n})},_deleteSelect:function(e){this.$delete(this.selectList,e)},_updateSelect:function(e,t){console.log(e),this.$set(this.selectList,[e],t)},_deleteValue:function(){var e=this,t=this,n=this._searchFilterConfig,a=n.selectConfig,i=n.columnsName,o=n.deal;a.en?(this._checkValueCallback()&&a.en.forEach((function(t){e.searchResult[t]=void 0})),t._deleteSelect(i)):(this._checkValueCallback()&&(this.searchResult[i]=void 0),t._deleteSelect(i)),t.pagination?o||t.loadTableData(we(we({},t.pagination),{},{current:1})):!o&&t.loadTableData()},_dealDataForSingle:function(){var e=this,t=e._searchFilterConfig,n=t.data,a=t.rows,i=t.selectConfig,o=t.columnsName,s=t.dataCallback,r=t.config,l=i.en[0]||o;e._checkValueCallback()&&(this.searchResult[l]=e._getActValue("value",n,a[0]||a)),i.cn.forEach((function(t){e._updateSelect(o,{key:o,label:t,value:s?s({data:n,rows:a}):e._getActValue("data",n,a[0]||a),type:r.type||""})}))},_dealDataForArray:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.linkMode,c=n.linkType,u=n.link,d=n.valueLink,h=n.config,p=s.en,f=s.cn.length>1,m=a.filter((function(e){return!!e})),g="";a.forEach((function(n,o){f&&p.length===a.length?n?(t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])),e._updateSelect(p[o],{key:p[o],label:s.cn[o],value:r?r({data:a,rows:i}):e._getActValue("data",a[o],i[o]),type:h.type||""})):(e._deleteSelect(p[o]),t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)):n?(p.length===a.length?t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])):t._checkValueCallback()&&(e.searchResult[p[0]]=e.searchResult[p[0]]?"".concat(e.searchResult[p[0]]).concat(d||",").concat(e._getActValue("value",a[o],i[o])):e.searchResult[p[0]],s.valueLink||(console.error("请注意设置 valueLink 连词，否则将会导致错误。"),console.error("请注意 searchResult.".concat(s.en[o]," 的值为： ").concat(e.searchResult[s.en[o]],"。")))),r||("string"===c?g=g?"".concat(g).concat(u).concat(t._getActValue("data",a[o],i[o])):t._getActValue("data",a[o],i[o]):1===m.length?(console.log("处理只有一个值的情况"),g=t._getActValue("data",a[o],i[o])):g=a.length-1===o?"".concat(g).concat(u[o]).concat(t._getActValue("data",a[o],i[o])).concat(u[o+1]):"after"===l?"".concat(t._getActValue("data",a[o],i[o])).concat(u[o]):"".concat(u[o]).concat(t._getActValue("data",a[o],i[o])))):t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)})),f&&p.length===a.length||(this.selectList[o]={key:o,label:s.cn[0],value:r?r({data:a,rows:i}):g,type:h.type||""})},_dealDataForObject:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.config;s.cn.forEach((function(n,c){i[c]?(e._checkValueCallback()&&(e.searchResult[s.en[c]]=t._getActValue("value",a,i[c])),e.selectList[o]={key:o,label:n,value:r?r({data:a,rows:i}):t._getActValue("data",a,i[c]),type:l.type||""}):(t._checkValueCallback()&&(e.searchResult[s.en[c]]=void 0),e._deleteSelect(o))}))},_searchFilterClearAll:function(){var e=this;for(var t in this.selectConfig)if(Object.prototype.hasOwnProperty.call(this.selectConfig,t)){var n=this.selectConfig[t].setValue;n?n.call(this):this.selectConfig[t].en.forEach((function(t){e.searchResult[t]=void 0}))}this.$refs.moreSearch&&this.$refs.moreSearch.resetData("all");try{for(var a in this.selectConfig)if(this.selectConfig.hasOwnProperty(a)){var i=this.selectConfig[a].ref;this.$refs["".concat(i||a,"O")]&&this.$refs["".concat(i||a,"O")].resetData(),this.$refs["".concat(i||a,"H")]&&this.$refs["".concat(i||a,"H")].resetData()}}catch(e){console.error("错误预警：",e)}},_searchFilterClearRef:function(e){console.log("清空它的对手：",e);try{var t=e.config.columnsName||e.config.resultName,n=e.config.type,a=this.selectConfig[t].ref;"filterDown"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):"operation"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),e.config.props&&e.config.props.confirm()}catch(e){console.error("错误预警：",e)}},_resetSearchFilterDefaultData:function(){return this.searchFilterDefaultData={cn:[],en:[],link:"",valueLink:"",dataKey:"",valueKey:"",dataTarget:"",valueTarget:"",linkMode:"",setText:void 0,setValue:void 0},this},moreSearchResultDeal:function(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;n++)this.searchResultDeal(e[t[n]],n!==t.length-1)}}},jn={name:"DSelectWarehouse",components:{STable:sn,Empty:Pn,DOperationBox:cn,CellEllipsisTip:Wt},mixins:[vt,An],props:{visible:{type:Boolean,default:!1},width:{type:[String,Number],default:1e3},title:{type:String,default:"选择仓库"},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"id"}}},beforeClose:{type:Function,default:void 0},rules:{type:Object,default:function(){}},cache:{type:Boolean,default:!1},defaultValue:{type:[Object,Array],default:null},categoryInit:{type:Number,default:1},selectionLimit:{type:Number,default:100}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},data:function(){return{tableData:[],classifyOptions:[],classifyValue:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:""},resultMap:{},disabled:{warehouse:!1},opened:!1}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},baseReplaceFields:function(){return we({key:"id"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},allClassifyOptions:function(){return[{categoryName:"全部分类",haveChild:!0,isLeaf:!1,id:"1",parentId:"0",pathCode:"1",scopedSlots:{title:"custom"},children:[{categoryName:"未分类",haveChild:!1,id:"0",parentId:"1",isLeaf:!0,pathCode:"0",scopedSlots:{title:"custom"}}].concat(gt(this.classifyOptions))}]}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="id",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&(this.reset().dealResult().loadTableData(),this.loadClassify()),this.opened=!0)}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get(je,we(we({},this.searchResult),{},{pageNum:t.current,pageSize:t.pageSize},this.rules)).then((function(t){t.data&&(e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},searchHandle:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},classifySearchHandle:function(e){console.log("分类检索:",e)},classifyOnSelect:function(e,t){console.log("classifyOnSelect",t,this.classifyValue);var n=t.node;this.searchResult.categoryPath=t.selected?n.dataRef.pathCode:null,this.handleSelectedClear().loadTableData()},loadClassify:function(e){var t=this;if(this.$get(He,{}).then((function(){})),e)return new Promise((function(n){var a=e.dataRef;t.$get(He,{categoryType:2,parentId:a.id}).then((function(e){var i=e.data;i.length&&(a.children=i,t.classifyOptions=gt(t.classifyOptions)),n()}))}));this.$get(He,{categoryType:2,parentId:this.categoryInit}).then((function(e){t.classifyOptions=e.data}))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const Bn=jn;var Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-warehouse a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"warehouse-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入分类名称"},on:{search:e.classifySearchHandle}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"classify-wrap"},[n("a-tree",{attrs:{loadData:e.loadClassify,replaceFields:{children:"children",value:"id",title:"categoryName",key:"id"},"tree-data":e.allClassifyOptions,defaultExpandedKeys:["1"],defaultSelectedKeys:["1"],showIcon:""},on:{select:e.classifyOnSelect},model:{value:e.classifyValue,callback:function(t){e.classifyValue=t},expression:"classifyValue"}})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"仓库名称"},on:{search:e.searchHandle},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"index",attrs:{width:60},scopedSlots:e._u([{key:"default",fn:function(t,n,a){return[e._v("\n            "+e._s((e.pagination.current-1)*e.pagination.pageSize+a+1)+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:200,"data-index":"name",title:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:100,"data-index":"code",title:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{title:"地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{tip:""+t.regionName+t.address}},[e._v(" "+e._s(t.regionName)+e._s(t.address)+" ")])]}}])}),e._v(" "),n("a-table-column",{attrs:{width:75,title:"可用"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.erpId?"是":"否")+"\n          ")]}}])})],1)],1)])])};Kn._withStripped=!0;const Hn=me({render:Kn,staticRenderFns:[]},void 0,Bn,void 0,!1,void 0,!1,void 0,void 0,void 0);Hn.install=function(e){e.component(Hn.name,Hn)};const zn=me({},void 0,{name:"DSelectWarehouseInput",props:{name:{type:String,default:"warehouse"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:In,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){this.modalValue=e||void 0},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e,t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];this.multiple=!0===this.valueMode&&t&&!t.length,e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=Hn,this.dialogProps=ut(this.dialogProps,e[this.name],this.dialogConfig)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=ut(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},confirmHandle:function(e){["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=we({},this.modalValue))},resultExchange:function(e){var t=e.rows[0];"select"!==this.valueMode&&(this.$emit("input",t),this.modalValue=t),this.$emit("change",we(we({},e),{},{data:this.multiple?e.rows:t,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"}}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:we({},this.dialogProps),props:we(we({},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:$n}},void 0,void 0,void 0,!1,void 0,void 0,void 0);zn.install=function(e){e.component(zn.name,zn)};var qn=[],Yn=function e(t){for(var n=0;n<t.length;n++){var a=t[n],i=a.id;qn.push({key:i,title:a.categoryName}),a.children&&e(a.children)}},Wn=function e(t,n){for(var a,i=0;i<n.length;i++){var o=n[i];o.children&&(o.children.some((function(e){return e.id===t}))?a=o.id:e(t,o.children)&&(a=e(t,o.children)))}return a},Gn={name:"DSelectProduct",mixins:[vt],provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},props:{visible:{type:Boolean,default:!1},width:{tpye:[String,Number],default:1250},title:{type:String,default:"选择商品"},cache:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},replaceFields:{type:Object,default:function(){return{key:"id"}}},rules:{type:Object,default:function(){return{}}},origin:{type:String,default:"page"},sortList:{type:Array,default:void 0},mode:{type:String,default:"default"},defaultValue:{type:[Object,Array],default:null},displayItems:{type:Array,default:function(){return["classify","warehouse","brand","shelves","inventory","salesPromotion","bought"]}},selectionLimit:{type:Number,default:100}},data:function(){return{modalConfig:{},tableData:[],tableLoading:!1,scrollHeight:0,inventory:!1,promotion:!1,isBought:!1,searchResult:{type:4,isShowSku:!0,keywords:void 0,customerId:void 0,warehouseId:void 0,brandId:void 0,categoryPath:void 0,saleStatus:1,checkList:"",isOverrideWarehouse:"",showList:[]},resultMap:{warehouse:{key:"warehouseId",ref:"warehouseMixSearch"}},disabled:{warehouse:!1},headerConfig:{1:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],2:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}],3:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],4:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"avgPrice"}],5:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"},{key:"levelPrice"}],6:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"stock"},{key:"avgPrice"}],7:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],8:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],9:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"}],10:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}]},treeData:[{categoryName:"全部分类",key:"1",pathCode:"",id:"1",children:[{categoryName:"未分类",key:"2",isLeaf:!0,pathCode:"0",id:"2"}]}],name:"warehouse",keywordtree:"",expandedKeys:[],autoExpandParent:!0,searchValue:"",tabLable:"0"}},watch:{visible:function(e){var t=this;e&&(this.selectionContent.primaryKey=this.baseReplaceFields.key,this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.modalConfig={title:"选择商品"},this.$nextTick((function(){t.handleSelectedClear(),t.dealResult(),t.cache||(t.mergeResult(),t.dealResult(),"0"===t.tabLable?t.initTreeData():t.loadTableData())})))}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},sortColumns:function(){return this.sortList?this.sortList:this.headerConfig[this.searchResult.type]},baseReplaceFields:function(){return we({key:"id",warehouse:"warehouseId"},this.replaceFields)}},filters:{getPrice:function(e){return void 0===e||""===e||null===e?"-":e}},methods:{inventoryChange:function(){this.inventory?this.changeData(!0,"2"):this.changeData(!1,"2")},isBoughtChange:function(){this.isBought?(this.tabLable="1",this.changeData(!0,"1")):(this.searchResult.categoryPath="",this.tabLable="0",this.changeData(!1,"1"))},promotionChange:function(){this.promotion?this.changeData(!0,"3"):this.changeData(!1,"3")},onSearchTree:function(e){var t=this,n=e.target.value,a=qn.map((function(e){return e.title.indexOf(n)>-1?Wn(e.key,t.treeData):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:n,autoExpandParent:!0})},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onLoadData:function(e){var t=this;return new Promise((function(n){e.dataRef.children?n():t.$get(He,{categoryType:0,parentId:e.dataRef.id}).then((function(a){"warehouse"===t.name&&(a.data.length&&(e.dataRef.children=a.data,t.treeData=gt(t.treeData),Yn(t.treeData)),n())}))}))},initTreeData:function(){var e=this;this.$get(He,{categoryType:0,parentId:0}).then((function(t){e.treeData[0].children=e.treeData[0].children.concat(t.data),Yn(e.treeData),e.treeData&&e.treeData.length>0&&(e.searchResult.categoryPath=e.treeData[0].pathCode,e.loadTableData())}))},changeData:function(e,t){var n;n=this.searchResult.checkList?this.searchResult.checkList.split(","):[],e?n.includes(t)||n.push(t):n.includes(t)&&n.splice(n.indexOf(t),1),this.searchResult.checkList=n.join(","),this.searchReset().loadTableData()},loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get($e,we(we({},ct(this.searchResult)),{},{pageNum:t.current,pageSize:t.pageSize,sort:-1})).then((function(t){t.data&&(e.tableData=t.data.list,e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},dealResult:function(){var e=this;if("warehouse"===this.mode&&(this.defaultValue&&this.defaultValue[this.baseReplaceFields.warehouse]?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=this.defaultValue[this.baseReplaceFields.warehouse]):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse&&(this.searchResult.warehouseId=this.rules.warehouse.id))),this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t],a=ot(n);if("warehouse"===t&&"warehouse"===this.mode)return;"object"===a?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}if(this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=we(we({},e.selectionContent.selectedRows),{},be({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=be({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this.rules.checkList&&this.rules.checkList.length>0){var i=this.rules.checkList.split(",");i.includes("1")?(this.tabLable="1",this.searchResult.categoryPath="",this.isBought=!0):(this.tabLable="0",this.isBought=!1),i.includes("2")?this.inventory=!0:this.tabLable=!1,i.includes("3")?this.promotion=!0:this.promotion=!1}},onSearch:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},saleChange:function(e){var t=e.data;this.searchResult.saleStatus=t,this.searchReset().loadTableData()},warehouseChange:function(e){"warehouse"===this.mode?e.data?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=e.data.id):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse?this.searchResult.warehouseId=this.rules.warehouse.id:this.searchResult.warehouseId=void 0):(this.handleSelectedClear(),e.data?this.searchResult.warehouseId=e.data.id:this.searchResult.warehouseId=void 0),this.searchReset().loadTableData()},brandChange:function(){this.handleSelectedClear(),this.searchReset().loadTableData()},selectCurrentNode:function(e,t){this.handleSelectedClear();var n=t.node.dataRef;this.searchResult.categoryPath=t.selected?n.pathCode:null,this.searchReset().loadTableData()},tableChange:function(e,t,n){if(e.current===this.pagination.current||e.pageSize!==this.pagination.pageSize)return this.handleSelectedClear(),e.current=1,void this.loadTableData();this.loadTableData(e)},searchReset:function(){return this.tableData=[],this.pagination.current=1,this.pagination.total=0,this},rowClick:function(e){var t=this;console.log("单击",e),this.multiple?this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])?(this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]):(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e):(this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=be({},e[this.baseReplaceFields.key],e))},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.okHandle()},mergeResult:function(){this.pagination.current=1,this.searchResult={type:this.rules.type||4,isShowSku:this.rules.isShowSku||!0,keywords:this.rules.keywords||void 0,customerId:this.rules.customerId||void 0,warehouseId:this.rules.warehouseId||void 0,brandId:this.rules.brandId||void 0,categoryPath:this.rules.categoryPath||void 0,saleStatus:this.rules.saleStatus||void 0,checkList:this.rules.saleStatus||""}},okHandle:function(){if(!(this.selectionContent.selectedRowKeys.length>this.selectionLimit))return this.multiple?this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),void this.$emit("update:visible",!1)):void this.$emit("update:visible",!1):void(this.$attrs.product&&this.selectionContent.selectedRowKeys[0]===this.$attrs.product[this.baseReplaceFields.key]?this.$emit("update:visible",!1):this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.$emit("update:visible",!1)):this.$emit("update:visible",!1));this.$message.warning("最多选择".concat(this.selectionLimit,"条"))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()}},components:{OperationBox:cn,DSelectWarehouseInput:zn,MixSelect:On,Empty:Pn,HImage:Kt,CellEllipsisTip:Wt,STable:sn}};const Un=Gn;var Xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-product a-table-common",attrs:{keyboard:!1,maskClosable:!1,title:e.modalConfig.title,width:e.width},on:{ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{ref:"productModal"},[n("div",{staticClass:"choose-product-content"},["0"===e.tabLable&&e.displayItems.includes("classify")?n("div",{staticClass:"tree-control"},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"请输入分类名称"},on:{change:e.onSearchTree},model:{value:e.keywordtree,callback:function(t){e.keywordtree=t},expression:"keywordtree"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"tree-control-contain"},[n("a-tree",{attrs:{"auto-expand-parent":e.autoExpandParent,"expanded-keys":e.expandedKeys,"load-data":e.onLoadData,replaceFields:{children:"children",title:"categoryName",key:"id"},"tree-data":e.treeData},on:{expand:e.onExpand,select:e.selectCurrentNode}})],1)],1):e._e(),e._v(" "),n("div",{staticClass:"table-control",class:{"table-width":"1"===e.tabLable||!e.displayItems.includes("classify")}},[n("operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{staticStyle:{width:"240px"},attrs:{maxLength:40,allowClear:"",placeholder:"商品名称/编号/条码/关键字"},on:{search:e.onSearch},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),e.displayItems.includes("warehouse")?n("DSelectWarehouseInput",{ref:"warehouseMixSearch",attrs:{disabled:e.disabled.warehouse,width:120,allowClear:"",name:"warehouse",placeholder:"仓库"},on:{change:e.warehouseChange}}):e._e(),e._v(" "),e.displayItems.includes("brand")?n("MixSelect",{attrs:{type:1,width:120,allowClear:""},on:{change:e.brandChange},model:{value:e.searchResult.brandId,callback:function(t){e.$set(e.searchResult,"brandId",t)},expression:"searchResult.brandId"}}):e._e(),e._v(" "),e.displayItems.includes("shelves")?n("MixSelect",{attrs:{list:[{id:1,name:"上架"},{id:0,name:"下架"}],width:120,"allow-clear":"",placeholder:"上下架"},on:{change:e.saleChange},model:{value:e.searchResult.saleStatus,callback:function(t){e.$set(e.searchResult,"saleStatus",t)},expression:"searchResult.saleStatus"}}):e._e(),e._v(" "),e.displayItems.includes("inventory")?n("a-checkbox",{staticClass:"check-line",on:{change:e.inventoryChange},model:{value:e.inventory,callback:function(t){e.inventory=t},expression:"inventory"}},[e._v("库存大于0\n          ")]):e._e(),e._v(" "),e.displayItems.includes("salesPromotion")?n("a-checkbox",{staticClass:"check-line",on:{change:e.promotionChange},model:{value:e.promotion,callback:function(t){e.promotion=t},expression:"promotion"}},[e._v("促销商品\n          ")]):e._e(),e._v(" "),e.displayItems.includes("bought")?n("a-checkbox",{staticClass:"check-line",on:{change:e.isBoughtChange},model:{value:e.isBought,callback:function(t){e.isBought=t},expression:"isBought"}},[e._v("买过商品\n          ")]):e._e()],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table-content",attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:e.selectionContent.primaryKey,scroll:{y:"calc(100vh - 490px)"},"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"code",attrs:{"data-index":"code",title:"商品编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"barCode",attrs:{title:"商品条码"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.barCode||"-"}})]}}])}),e._v(" "),n("a-table-column",{key:"cover",attrs:{title:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h-image",{staticStyle:{width:"48px",height:"48px"},attrs:{initial:0,"preview-src-list":[t.cover],src:e._f("formatImage")(t.cover,48),fit:"cover",popover:""}})]}}])}),e._v(" "),n("a-table-column",{key:"name",attrs:{title:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.name}})]}}])}),e._v(" "),n("a-table-column",{key:"skuName",attrs:{"data-index":"skuName",title:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"warehouseName",attrs:{"data-index":"warehouseName",title:"仓库"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"stock",attrs:{"data-index":"stock",title:"库存数量"}}),e._v(" "),n("a-table-column",{key:"avgPrice",attrs:{"data-index":"avgPrice",title:"成本均价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"lastPrice",attrs:{"data-index":"lastPrice",title:"最近进价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"baseUnitName",attrs:{"data-index":"baseUnitName",title:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"unitPrice",attrs:{"data-index":"unitPrice",title:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"levelPrice",attrs:{"data-index":"levelPrice",title:"级别价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])})],1)],1)])])])};Xn._withStripped=!0;const Jn=me({render:Xn,staticRenderFns:[]},void 0,Un,void 0,!1,void 0,!1,void 0,void 0,void 0);Jn.install=function(e){e.component(Jn.name,Jn)};var Qn={name:"DSelectPeople",mixins:[vt,An],components:{CellEllipsisTip:Wt,STable:sn,DOperationBox:cn,Empty:Pn},props:{width:{type:Number,default:1e3},cache:{type:Boolean,default:!1},visible:{type:Boolean,default:!1},title:{type:String,default:"选择经手人"},placeholderLeft:{type:String,default:"请输入部门名称"},placeholderRight:{type:String,default:"姓名/手机号"},multiple:{type:Boolean,default:!1},beforeClose:{type:Function,default:void 0},replaceFields:{type:Object,default:function(){}},rules:{type:Object,default:function(){return{}}},defaultValue:{type:[Object,Array],default:null},selectionLimit:{type:Number,default:100}},data:function(){return{corpTree:{data:[],keywords:null,expandedKeys:[],selectedKeys:[],autoExpandParent:!0,treeFirstNode:null,loading:!1},tableData:[],searchData:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:{}},opened:!1}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="stafferId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&this.reset().dealResult().getCorpTree(),this.opened=!0)}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},baseReplaceFields:function(){return we({key:"stafferId"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}}},methods:{onSelectCorpTreeNode:function(e,t){console.log("onSelectCorpTreeNode",e,t),t.selected?this.corpTree.selectedKeys=[t.node.dataRef.businessId]:this.corpTree.selectedKeys=[this.corpTree.treeFirstNode.businessId],this.searchResult.categoryPath=t.selected?t.node.dataRef:this.corpTree.treeFirstNode,this.dealResult().loadTableData()},onExpand:function(e){this.corpTree.expandedKeys=e,this.corpTree.autoExpandParent=!1},getParentKey:function(e,t){for(var n,a=0;a<t.length;a++){var i=t[a];i.children&&(i.children.some((function(t){return t.businessId===e}))?n=i.businessId:this.getParentKey(e,i.children)&&(n=this.getParentKey(e,i.children)))}return n},onSearchTree:function(e){var t=this,n=e.target.value;this.corpTree.expandedKeys=this.searchData.map((function(e){return e.name.indexOf(n)>-1?t.getParentKey(e.businessId,t.corpTree.data):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t})),this.corpTree.autoExpandParent=!0},handleSearchByKeywords:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},loadTableData:function(){var e=arguments,t=this;return _e(xe.mark((function n(){var a,i,o;return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.pagination,n.prev=1,t.tableLoading=!0,n.next=5,t.$post(We,we({corpId:t.searchResult.categoryPath.corpId||"",departmentId:t.searchResult.categoryPath.businessId||"",keyword:t.searchResult.keywords||"",dismiss:!1,entryDateBegin:"",entryDateEnd:"",isAdmin:"",locked:!1,normal:!0,pageNum:a.pageNum||1,pageSize:a.pageSize||30},t.rules));case 5:i=n.sent,o=i.data,t.tableData=o.list,t.dealSelectionCheckBox(),t.pagination.total=o.total,t.pagination.current=o.pageNum,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(1),console.error(n.t0);case 16:return n.prev=16,t.tableLoading=!1,n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[1,13,16,19]])})))()},getCorpTree:function(){var e=this;return _e(xe.mark((function t(){var n,a;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.corpTree.loading=!0,t.next=4,e.$get(Ye);case 4:n=t.sent,a=n.data,e.corpTree.data=a,function t(n){var a=[];return n.forEach((function(n){n.scopedSlots={title:"title"},e.searchData.push(n),n.children&&n.children.length&&t(n.children),a.push(n)})),a}(a),e.corpTree.data&&e.corpTree.data.length>0&&(e.corpTree.treeFirstNode=e.corpTree.data[0],e.corpTree.selectedKeys=[e.corpTree.treeFirstNode.businessId],e.searchResult.categoryPath=e.corpTree.data[0],e.loadTableData()),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0);case 15:return t.prev=15,e.corpTree.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})))()},handleOk:function(){if(this.selectionContent.selectedRowKeys.length>this.selectionLimit)this.$message.warning("最多选择".concat(this.selectionLimit,"条"));else{var e={data:this.selectionContent.selectedRowKeys,rows:this.getRowData()};this.beforeClose?this.beforeClose(e):this.$emit("confirm",e),this.$emit("update:visible",!1)}},reset:function(){return this.tableData=[],this.corpTree.keywords="",this.corpTree.expandedKeys=[],this.corpTree.selectedKeys=[],this.corpTree.autoExpandParent=!0,this.corpTree.data=[],this.searchResult={keywords:"",categoryPath:{}},this.corpTree.treeFirstNode=null,this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this},onOperationClick:function(e){"clear"===e.name&&this.handleSelectedClear()},handleCancel:function(){this.$emit("cancel"),this.$emit("update:visible",!1)}}};const Zn=Qn;var ea=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-people a-table-common modal-reset-no-padding",attrs:{footer:null,keyboard:!1,maskClosable:!1,title:e.title,width:e.width,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"people-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:e.placeholderLeft,allowClear:""},on:{change:e.onSearchTree},model:{value:e.corpTree.keywords,callback:function(t){e.$set(e.corpTree,"keywords",t)},expression:"corpTree.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.corpTree.loading,expression:"corpTree.loading"}],staticClass:"classify-wrap"},[n("a-tree",{attrs:{"auto-expand-parent":e.corpTree.autoExpandParent,"expanded-keys":e.corpTree.expandedKeys,replaceFields:{children:"children",title:"name",key:"businessId"},"selected-keys":e.corpTree.selectedKeys,"tree-data":e.corpTree.data},on:{expand:e.onExpand,select:e.onSelectCorpTreeNode},scopedSlots:e._u([{key:"title",fn:function(t){var a=t.name;return[a.indexOf(e.corpTree.keywords)>-1?n("span",[e._v("\n              "+e._s(a.substr(0,a.indexOf(e.corpTree.keywords)))+"\n              "),n("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.corpTree.keywords))]),e._v("\n              "+e._s(a.substr(a.indexOf(e.corpTree.keywords)+e.corpTree.keywords.length))+"\n            ")]):n("span",[e._v(e._s(a))])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationClick}},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholderRight,allowClear:""},on:{search:e.handleSearchByKeywords},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{"data-index":"name",title:"姓名"}}),e._v(" "),n("a-table-column",{key:"stafferNo",attrs:{"data-index":"stafferNo",title:"编号"}}),e._v(" "),n("a-table-column",{key:"departmentName",attrs:{title:"部门"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.departmentName}})]}}])}),e._v(" "),n("a-table-column",{key:"mobile",attrs:{"data-index":"mobile",title:"联系电话"}})],1)],1)]),e._v(" "),n("div",{staticClass:"select-people-footer"},[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n    "),n("a-button",{attrs:{disabled:!e.selectionContent.selectedRowKeys||0===e.selectionContent.selectedRowKeys.length,type:"primary"},on:{click:e.handleOk}},[e._v("\n      确 定\n    ")])],1)])};ea._withStripped=!0;const ta=me({render:ea,staticRenderFns:[]},void 0,Zn,void 0,!1,void 0,!1,void 0,void 0,void 0);ta.install=function(e){e.component(ta.name,ta)};var na={name:"DSelectSaleArea",props:{width:{require:!1,type:String,default:"120"},maxHeight:{require:!1,type:String,default:"300"},placeholder:{require:!1,type:String,default:"销售区域"}},data:function(){return{value:void 0,parentId:0,replaceFields:{children:"children",value:"id",title:"name",key:"id"},treeData:[],apiName:null}},created:function(){this.treeData.length||this.getList([],!1)},methods:{openSelect:function(){this.treeData.length||this.getList([],!1)},getList:function(){var e=arguments,t=this;return _e(xe.mark((function n(){var a,i,o,s;return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:[],i=e.length>1&&void 0!==e[1]&&e[1],n.prev=2,n.next=5,t.$post(Ie,{businessId:t.parentId});case 5:o=n.sent,(s=o.data).length>0&&(i?(a.children=s,t.treeData=gt(t.treeData)):t.treeData=s),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,10]])})))()},onLoadData:function(e){var t=this;return new Promise((function(n){var a=e.dataRef;a.hasChildren?setTimeout((function(){t.parentId=a.id,t.getList(a,!0),n()}),300):n()}))},changeValue:function(e){this.$emit("sureSelect",e)}}};const aa=na;var ia=function(){var e=this,t=e.$createElement;return(e._self._c||t)("a-tree-select",{style:{width:e.width+"px"},attrs:{allowClear:"","tree-data-simple-mode":"","dropdown-style":{width:+e.width+60+"px",maxHeight:e.maxHeight+"px",overflow:"auto"},"tree-data":e.treeData,placeholder:e.placeholder,"load-data":e.onLoadData,replaceFields:e.replaceFields},on:{change:e.changeValue},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})};ia._withStripped=!0;const oa=me({render:ia,staticRenderFns:[]},void 0,aa,"data-v-1c52a95a",!1,void 0,!1,void 0,void 0,void 0);oa.install=function(e){e.component(oa.name,oa)};var sa={name:"DSelectCustomer",components:{Empty:Pn,SelectSaleArea:oa,DOperationBox:cn,CellEllipsisTip:Wt,STable:sn},mixins:[vt,An],props:{visible:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},cache:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:[Number,String],default:1e3},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"businessId"}}},attrs:{type:Object,default:function(){}},defaultSelectedRowKeys:{type:Object,default:function(){return{selectedRowKeys:[],selectedRows:[]}}},isShowPrice:{type:Boolean,default:!1},customerType:{type:Array,default:function(){return[1,2,3,4]}},sortList:{type:Array,default:void 0},defaultValue:{type:[Array,Object],default:void 0},beforeClose:{type:Function,default:void 0},selectionLimit:{type:Number,default:100},placeholder:{type:String,default:null}},data:function(){return{tableData:[],levelPrices:{data:[],loading:!1},searchResult:{customerTypeIds:[],keywords:null,priceLevelId:null,regionId:null},customers:{loading:!1},categories:{keyword:"",data:[],loading:{}}}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},filteredCategories:function(){var e=this;return this.categories.keyword?this.categories.data.filter((function(t){return t.label.indexOf(e.categories.keyword)>-1})):this.categories.data},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.customers.loading}})}},baseReplaceFields:function(){return we({key:"businessId"},this.replaceFields)},sortColumns:function(){return this.sortList?this.sortList:[{key:"name"},{key:"region"},{key:"priceLevel"}]},getTitle:function(){return this.customerType.includes(1)&&this.customerType.includes(2)?"客户":this.customerType.includes(1)?"供应商":"客户"},tablePlaceholder:function(){return this.placeholder?this.placeholder:"".concat(this.getTitle,"名称/联系人/手机")}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="businessId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.cache||(this.reset().dealResult().loadTableData(),this.handleFetchCategories(),this.handleFetchLevelPrice()))},defaultSelectedRowKeys:{handler:function(e){var t=ie.deepClone(e);this.selectionContent.selectedRowKeys=t.selectedRowKeys,this.selectionContent.selectedRows=t.selectedRows},immediate:!0}},filters:{balance:function(e,t){if(e){var n=e.filter((function(e){return e.value===t}));return n.length?n[0].label:"-"}return"-"}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.customers.loading=!0,this.$post(Fe,we(we({pageNum:t.current,pageSize:t.pageSize,orderCustomerTypeList:this.customerType,keyword:this.searchResult.keywords},this.searchResult),this.rules)).then((function(t){e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum})).finally((function(){e.customers.loading=!1}))},onCustomersSearch:function(e,t){this.searchResult[e]=t,this.handleSelectedClear().loadTableData()},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},handleFetchCategories:function(){var e=this;this.categories.loading=!0,this.$post(Me).then((function(t){e.categories.data=t.data||[]})).catch((function(e){return console.error(e)})).finally((function(){e.categories.loading=!1}))},handleFetchLevelPrice:function(){var e=this;this.isShowPrice&&(this.levelPrices.loading=!0,this.$post(qe).then((function(t){e.levelPrices.data=t.data||[]})).finally((function(){e.levelPrices.loading=!1})))},onOperationOptionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const ra=sa;var la=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",e._b({staticClass:"d-select-customer a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title||"选择"+e.getTitle,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},"a-modal",e.attrs,!1),[n("div",{staticClass:"customer-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{attrs:{maxLength:40,placeholder:"请输入分类名称"},model:{value:e.categories.keyword,callback:function(t){e.$set(e.categories,"keyword",t)},expression:"categories.keyword"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.categories.loading,expression:"categories.loading"}],staticClass:"classify-wrap"},[n("a-checkbox-group",{attrs:{name:"checkboxgroup"},on:{change:function(t){return e.onCustomersSearch("customerTypeIds",arguments[0])}},model:{value:e.searchResult.customerTypeIds,callback:function(t){e.$set(e.searchResult,"customerTypeIds",t)},expression:"searchResult.customerTypeIds"}},[n("a-row",[n("a-space",{attrs:{direction:"vertical"}},e._l(e.filteredCategories,(function(t,a){return n("a-col",{key:a,attrs:{span:24}},[n("a-checkbox",{attrs:{value:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])],1)})),1)],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationOptionClick}},[n("a-space",[n("a-input-search",{attrs:{maxLength:40,placeholder:e.tablePlaceholder},on:{search:function(t){return e.onCustomersSearch("keywords",arguments[0])}},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.isShowPrice?n("a-select",{staticStyle:{width:"120px"},attrs:{loading:e.levelPrices.loading,allowClear:"",placeholder:"级别价"},on:{change:function(t){return e.onCustomersSearch("priceLevelId",arguments[0])}}},e._l(e.levelPrices.data,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1):e._e(),e._v(" "),n("select-sale-area",{staticClass:"select-area",attrs:{placeholder:"销售区域"},on:{sureSelect:function(t){return e.onCustomersSearch("regionId",arguments[0])}}})],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.customers.loading,expression:"customers.loading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate,"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{title:e.getTitle+"名称","data-index":"name"}}),e._v(" "),n("a-table-column",{key:"region",attrs:{title:"销售区域"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{line:2,tip:""+t.region}},[e._v("\n              "+e._s(t.region)+"\n            ")])]}}])}),e._v(" "),n("a-table-column",{key:"priceLevel",attrs:{"data-index":"priceLevel",title:"级别价"}}),e._v(" "),n("a-table-column",{key:"balanceList1",attrs:{title:"应收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,1))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList2",attrs:{title:"应付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,2))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList3",attrs:{title:"预收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,3))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList4",attrs:{title:"预付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,4))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList5",attrs:{title:"积分"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,5))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList6",attrs:{title:"第三方ERP"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,6))+"\n          ")]}}])})],1)],1)])])};la._withStripped=!0;const ca=me({render:la,staticRenderFns:[]},void 0,ra,void 0,!1,void 0,!1,void 0,void 0,void 0);ca.install=function(e){e.component(ca.name,ca)};const ua=me({},void 0,{name:"SelectGroup",props:{value:{type:[String,Boolean,Number,Array],default:void 0},options:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}}},computed:{baseReplaceFields:function(){return we({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{lineClick:function(e){if(this.multiple)if(this.checkValue.includes(e[this.baseReplaceFields.key])){var t=this.checkValue.indexOf(e[this.baseReplaceFields.key]);this.checkValue.splice(t,1)}else this.checkValue.push(e[this.baseReplaceFields.key]);else this.checkValue=e[this.baseReplaceFields.key]},getData:function(){var e=this,t=this.options.filter((function(t){return e.multiple?e.checkValue.includes(t[e.baseReplaceFields.key]):t[e.baseReplaceFields.key]===e.checkValue}));return{checkValue:this.checkValue,data:this.checkValue,rows:t}}},render:function(e){var t=this;return e(t.multiple?"a-checkbox-group":"a-radio-group",{props:{value:t.checkValue,name:t.multiple?"a-checkbox-group":"a-radio-group"},on:{input:function(e){t.checkValue=e}},class:"group-out-box"},t.options.map((function(n,a){return e(t.multiple?"a-checkbox":"a-radio",{attrs:{value:n[t.baseReplaceFields.key],key:a},key:a,props:{key:a},on:{click:function(e){e.stopPropagation()}}},n[t.baseReplaceFields.name])})))}},void 0,void 0,void 0,!1,void 0,void 0,void 0),da={name:"DSelectProductAttr",components:{SelectGroup:ua,Empty:Pn},props:{value:{type:Object,default:null},visible:{type:Boolean,default:!1},width:{type:Number,default:816},destory:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入搜索关键字"},type:{type:Number,default:0},productId:{type:Array,default:function(){return[]}},inputValue:{type:String,default:""},replaceFields:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}}},data:function(){return{selectValue:void 0,keywords:"",options:[],loading:!1}},watch:{modalVisible:{handler:function(e){e&&(this.init(),this.value&&(this.selectValue=this.value.id)),this.rules.keywords&&(this.keywords=this.rules.keywords)},immediate:!0}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},title:function(){var e=this.type;return 0===e?"选择单位":1===e?"选择品牌":2===e?"选择标签":3===e?"选择单位":"选择仓库"},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t.name.match(e.keywords))return t})):this.options},baseReplaceFields:function(){return we({key:"id",name:"name"},this.replaceFields)}},methods:{init:function(){var e=this;this.loading=!0,4===this.type?this.$get(ze,we({pageNum:1,pageSize:100},this.rules)).then((function(t){e.options=t.data.list})).finally((function(){e.loading=!1})):3===this.type?this.$post(Be,this.productId).then((function(t){e.options=t.data.map((function(e){return we(we({},e),{},{name:e.unitName})}))})).finally((function(){e.loading=!1})):this.$post(Ae,we({type:this.type},this.rules)).then((function(t){e.options=t.data})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},handlerAfterClose:function(){this.$emit("afterClose")},handleOk:function(){var e=this,t=this.options.find((function(t){return t.id===e.selectValue})),n=this.options.filter((function(t){return t.id===e.selectValue}));this.$emit("confirm",{data:t,rows:n,baseRows:this.options}),this.modalVisible=!1}}};var ha=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{afterClose:e.handlerAfterClose,destroyOnClose:e.destory,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:function(t){e.modalVisible=!1},ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1)],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},[n("select-group",{attrs:{options:e.filteredOptions,replaceFields:e.baseReplaceFields},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};ha._withStripped=!0;const pa=me({render:ha,staticRenderFns:[]},void 0,da,void 0,!1,void 0,!1,void 0,void 0,void 0);pa.install=function(e){e.component(pa.name,pa)};var fa="SYS_0000",ma={0:"付款账户选择",1:"多账户选择"};const ga={name:"DSelectPayAccount",components:{Empty:Pn},filters:{payAccountConvert:function(e){var t=wn.find((function(t){return t.id===e}));return t?t.name:"--"}},props:{type:{type:Number,default:0},width:{type:[String,Number],default:816},visible:{type:Boolean,default:!1},payType:{type:Number,default:1},dueMoney:{type:[Number,String],default:0},customerId:{type:[String,Number],default:""},beforeClose:{type:Function,default:null},cache:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},excludeAccountTypes:{type:Array,default:function(){return[]}},defaultValue:{type:[String,Number,Array,Object],default:null},verifyTotalMoney:{type:Boolean,default:!0}},data:function(){return{modalTitles:ma,loading:!1,tableData:[],totalMoney:0,keywords:null}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},locale:function(){return{emptyText:this.$createElement("Empty",{props:{loading:this.loading}})}},filteredTableData:function(){var e=this;return this.keywords?this.includedTableData.filter((function(t){var n=t.name,a=t.bankDeposit,i=t.accountNumber;if(n.match(e.keywords)||a.match(e.keywords)||i.match(e.keywords))return t})):this.includedTableData},includedTableData:function(){var e=this;return this.tableData.filter((function(t){if(!e.excludeAccountTypes.includes(t.type))return t}))}},watch:{visible:function(e){e&&!this.cache?this.loadData():this.tableData.length||this.loadData(),this.rules.keywords&&(this.keywords=this.rules.keywords)}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,this.$get(Ge,we({accountType:this.payType,customerId:this.customerId},this.rules)).then((function(t){var n=t.code,a=t.data;if(n===fa){if(e.tableData=a.map((function(t,n){if(0===e.type){var a=!1;return e.defaultValue&&(a=e.defaultValue===t.accountId),we({checked:a,payMoney:0,index:n+1,sort:n+1,accountType:t.type},t)}if(1===e.type){var i=0;if(e.defaultValue&&"[object Array]"===Object.prototype.toString.call(e.defaultValue)){var o=e.defaultValue.find((function(e){return e.accountId===t.accountId}));o&&(i=o.payMoney,t.payMoney=o.payMoney,e.payMoneyBlur(t))}return we({payMoney:i,index:n+1,sort:n+1,accountType:t.type},t)}})),0===e.type&&e.tableData.length&&!e.tableData.find((function(e){return e.checked}))){var i=e.tableData.find((function(e){return 2===e.type}));i?i.checked=!0:e.tableData[0].checked=!0}e.$emit("data",e.tableData)}})).finally((function(){e.loading=!1}))},handleOk:function(){var e=this,t=null;if(1===this.type){var n=this.filteredTableData.filter((function(e){return e.checked=void 0,Number(e.payMoney)}));if(t={type:this.type,disabled:this.filteredTableData.length>1,paymentAccounts:n,payMoney:this.totalMoney},this.verifyTotalMoney&&t.payMoney>this.dueMoney)return void this.$message.error("请输入最大本次应付金额且最多2位小数的数值")}else t=this.filteredTableData.filter((function(e){return e.checked}));this.beforeClose?this.beforeClose({data:t,rows:t},(function(){e.$emit("update:visible",!1)})):(this.$emit("confirm",{data:t,rows:t}),this.$emit("update:visible",!1))},payMoneyBlur:function(e){1===e.type&&e.payMoney>e.balance&&(this.$message.error("预付金额小于本次付款金额，无法完成抵扣。"),e.payMoney=0),e.payMoney=oe.fmtNum(e.payMoney,!1,2,!1);var t=this.tableData.reduce((function(e,t){return e+Number(t.payMoney)}),0);this.totalMoney=oe.fmtNum(t,!1,2,!1)},handleCancel:function(){this.$emit("update:visible",!1)},radioChange:function(e){var t=this;this.filteredTableData.forEach((function(e){return e.checked=!1})),this.$nextTick((function(){t.filteredTableData[e].checked=!0}))}}};var va=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-pay-account a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.modalTitles[e.type],width:e.width,"cancel-text":"取消(Esc)","ok-text":"确定(Enter)"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[0===e.type?n("div",{staticClass:"single-account"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入关键字"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),n("a-table",{attrs:{customRow:function(t,n){return{on:{click:function(){e.radioChange(n)}}}},"data-source":e.filteredTableData,loading:e.loading,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},"row-key":"index"}},[n("a-table-column",{key:"index",attrs:{width:64,align:"center","data-index":"index"},scopedSlots:e._u([{key:"default",fn:function(t,a,i){return[n("span",{on:{click:function(t){return e.radioChange(i)}}},[n("a-radio",{attrs:{checked:a.checked}})],1)]}}],null,!1,4291464169)}),e._v(" "),n("a-table-column",{attrs:{width:160,"data-index":"type",title:"账户类型"},scopedSlots:e._u([{key:"default",fn:function(t,n){return[e._v("\n          "+e._s(e._f("payAccountConvert")(n.type))+"\n        ")]}}],null,!1,2287724343)}),e._v(" "),n("a-table-column",{attrs:{width:192,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{key:"bankDeposit",attrs:{width:160,"data-index":"bankDeposit",title:"开户银行"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)}),e._v(" "),n("a-table-column",{key:"accountNumber",attrs:{width:160,"data-index":"accountNumber",title:"银行账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)})],1)],1):n("div",{staticClass:"multiple-account"},[n("div",{staticClass:"dialog-pay"},[e._v("应"+e._s(1===e.payType?"付":"收")+"金额：¥"+e._s(e.dueMoney))]),e._v(" "),n("a-table",{staticClass:"account",attrs:{"data-source":e.filteredTableData,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},bordered:"",rowKey:"index"}},[n("a-table-column",{key:"index",staticClass:"style-padding",attrs:{width:88,align:"center","data-index":"index",title:"行号"}}),e._v(" "),n("a-table-column",{staticClass:"style-padding",attrs:{width:358,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{attrs:{width:"100%","data-index":"payMoney",title:"金额"},scopedSlots:e._u([{key:"default",fn:function(t,a){return[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},on:{blur:function(t){return e.payMoneyBlur(a)}},model:{value:a.payMoney,callback:function(t){e.$set(a,"payMoney",t)},expression:"record.payMoney"}})]}}])}),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"total"},[n("div",{staticClass:"name"},[e._v("合计")]),e._v(" "),n("div",{staticStyle:{width:"358px"}}),e._v(" "),n("div",{staticClass:"money"},[e._v(e._s(e.totalMoney))])])])],2)],1)])};va._withStripped=!0;const ya=me({render:va,staticRenderFns:[]},void 0,ga,void 0,!1,void 0,!1,void 0,void 0,void 0);function ba(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}ya.install=function(e){e.component(ya.name,ya)};var ka=function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.__PARENTSAPPJSONP__&&window.__POWERED_BY_QIANKUN__?window.__PARENTSAPPJSONP__(n,(function(e){t=e})):window.TMAPCALLBACK[n]=function(e){t=e},document.body.appendChild(a);var i=function(){document.body.removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},wa={"北京市":{city:"北京市",short:"京",lng:"116.39737",lat:"39.939502"},"天津市":{city:"天津市",short:"津",lng:"117.133262",lat:"39.256321"},"上海市":{city:"上海市",short:"沪",lng:"121.36464",lat:"31.303465"},"重庆市":{city:"重庆市",short:"渝",lng:"106.32485",lat:"29.895013"},"河北省":{city:"石家庄",short:"冀",lng:"114.336873",lat:"38.21885"},"山西省":{city:"太原",short:"晋",lng:"112.349964",lat:"38.044464"},"辽宁省":{city:"沈阳",short:"辽",lng:"123.241164",lat:"41.948112"},"吉林省":{city:"长春",short:"吉",lng:"125.228072",lat:"43.894927"},"黑龙江省":{city:"哈尔滨",short:"黑",lng:"126.479088",lat:"45.985284"},"江苏省":{city:"南京",short:"苏",lng:"118.715429",lat:"32.246466"},"浙江省":{city:"杭州",short:"浙",lng:"120.040035",lat:"30.350837"},"安徽省":{city:"合肥",short:"皖",lng:"117.170056",lat:"31.99595"},"福建省":{city:"福州",short:"闽",lng:"119.156964",lat:"26.182279"},"江西省":{city:"南昌",short:"赣",lng:"115.808656",lat:"28.774611"},"山东省":{city:"济南",short:"鲁",lng:"116.912494",lat:"36.812038"},"河南省":{city:"郑州",short:"豫",lng:"113.453802",lat:"34.895028"},"湖北省":{city:"武汉",short:"鄂",lng:"114.116105",lat:"30.764814"},"湖南省":{city:"长沙",short:"湘",lng:"112.800698",lat:"28.474291"},"广东省":{city:"广州",short:"粤",lng:"113.233035",lat:"23.224606"},"海南省":{city:"海口",short:"琼",lng:"110.179083",lat:"19.921006"},"四川省":{city:"成都",short:"川",lng:"103.924003",lat:"30.796585"},"贵州省":{city:"贵阳",short:"黔",lng:"106.499624",lat:"26.844365"},"云南省":{city:"昆明",short:"滇",lng:"102.599397",lat:"25.248948"},"陕西省":{city:"西安",short:"陕",lng:"108.780889",lat:"34.408508"},"甘肃省":{city:"兰州",short:"甘",lng:"103.66644",lat:"36.218003"},"青海省":{city:"西宁",short:"青",lng:"101.605943",lat:"36.752842"},"西藏自治区":{city:"拉萨",short:"藏",lng:"90.972306",lat:"29.838888"},"广西壮族自治区":{city:"南宁",short:"桂",lng:"108.265765",lat:"23.020403"},"内蒙古自治区":{city:"呼和浩特",short:"蒙",lng:"111.614073",lat:"40.951504"},"宁夏回族自治区":{city:"银川",short:"宁",lng:"106.094884",lat:"38.624116"},"新疆维吾尔自治区":{city:"乌鲁木齐",short:"新",lng:"87.476819",lat:"43.894927"},"香港特别行政区":{city:"香港",short:"港",lng:"114.1529",lat:"22.542716"},"澳门地区":{city:"澳门",short:"澳",lng:"113.417008",lat:"22.337477"},"台湾省":{city:"台北",short:"台.",lng:"121.36464",lat:"25.248948"}},Ca="https://apis.map.qq.com",_a={geocoder:"".concat(Ca,"/ws/geocoder/v1"),placeSearch:"".concat(Ca,"/ws/place/v1/search"),placeExplore:"".concat(Ca,"/ws/place/v1/explore"),placeDetail:"".concat(Ca,"/ws/place/v1/detail"),placeSuggestion:"".concat(Ca,"/ws/place/v1/suggestion"),district:"".concat(Ca,"/ws/district/v1"),directionDriving:"".concat(Ca,"/ws/direction/v1/driving"),directionTransit:"".concat(Ca,"/ws/direction/v1/transit"),directionWalking:"".concat(Ca,"/ws/direction/v1/walking"),directionBicycling:"".concat(Ca,"/ws/direction/v1/bicycling"),distanceMatrix:"".concat(Ca,"/ws/distance/v1/matrix"),locationIP:"".concat(Ca,"/ws/location/v1/ip"),staticmap:"".concat(Ca,"/ws/staticmap/v2"),coordTranslate:"".concat(Ca,"/ws/coord/v1/translate")},Sa=function(e){var t="";if(e)for(var n in e)e.hasOwnProperty(n)&&(t+="".concat(t?"".concat(t,"&"):"").concat(n,"=").concat(e[n]));return t},xa=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=null,this.mapOptions={key:"T74BZ-KJV6U-EVEVH-B2ZLQ-YIZQF-3PFPB",container:"map",center:{lat:39.908802,lng:116.397502},zoom:16,location:!1,showMarker:!1,success:null,fail:null},this.varia={queue:[],mapStatus:!1,centerMarker:null,on:{tilesloaded:null}},this._init(t)}var t,n,a,i;return t=e,n=[{key:"_init",value:function(e){this._initConfig(e),e&&e.container&&(this._initMap(),this._afterInit())}},{key:"_initConfig",value:function(e){this.mapOptions=this.merge(this.mapOptions,e)}},{key:"_initMap",value:(i=_e(xe.mark((function e(){var t=this;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=this.mapOptions.key,ka("https://map.qq.com/api/gljs?v=1.exp&key=".concat(n,"&callback=TMapLoad"));case 2:this.mapOptions.center=this.latLng(this.mapOptions.center),this.map=new TMap.Map(this.mapOptions.container,this.mapOptions),this.map.once("tilesloaded",(function(){t.varia.mapStatus=!0,t.runQueue(),t.mapOptions.success&&t.mapOptions.success()}));case 5:case"end":return e.stop()}var n}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_afterInit",value:function(){this.mapOptions.location&&this.location(),this.mapOptions.showMarker&&this.setMarker(this.mapOptions.center)}},{key:"run",value:function(e,t){this.varia.mapStatus?this[e](t):this.varia.queue.push({name:e,options:t})}},{key:"on",value:function(e,t){console.log(e,t)}},{key:"runQueue",value:function(){var e=this;this.varia.queue.forEach((function(t){e[t.name](t.options)})),this.varia.queue=[]}},{key:"request",value:function(e,t){var n,a,i=(n=this.mapOptions,a="key=".concat(n.key,"&output=jsonp"),{parseLocation:function(e){return ka("https://apis.map.qq.com/ws/geocoder/v1/?".concat(Sa(e),"&").concat(a))},placeSearch:function(e){return ka("".concat(_a.placeSearch,"?").concat(Sa(e),"&").concat(a))},placeExplore:function(e){return ka("".concat(_a.placeExplore,"?").concat(Sa(e),"&").concat(a))},placeDetail:function(e){return ka("".concat(_a.placeDetail,"?").concat(Sa(e),"&").concat(a))},suggestion:function(e){return ka("".concat(_a.placeSuggestion,"?").concat(Sa(e),"&").concat(a))},geocoder:function(e){var t=e.address;return t&&wa[t]&&(e.address="".concat(t).concat(wa[t].city)),ka("".concat(_a.geocoder,"?").concat(Sa(e),"&").concat(a))},directionDriving:function(e){return ka("".concat(_a.directionDriving,"?").concat(Sa(e),"&").concat(a))},directionWalking:function(e){return ka("".concat(_a.directionWalking,"?").concat(Sa(e),"&").concat(a))},directionBicycling:function(e){return ka("".concat(_a.directionBicycling,"?").concat(Sa(e),"&").concat(a))},directionTransit:function(e){return ka("".concat(_a.directionTransit,"?").concat(Sa(e),"&").concat(a))},distanceMatrix:function(e){return ka("".concat(_a.distanceMatrix,"?").concat(Sa(e),"&").concat(a))},district:function(e){return ka("".concat(_a.district,"?").concat(Sa(e),"&").concat(a))},coordTranslate:function(e){return ka("".concat(_a.coordTranslate,"?").concat(Sa(e),"&").concat(a))},locationIP:function(e){return ka("".concat(_a.locationIP,"?").concat(Sa(e),"&").concat(a))}});if(!i[e])throw Error("错误警告: ".concat(e," 不是一个正确的地图请求方法，请使用正确的方法。"));return i[e](t)}},{key:"merge",value:function(e,t){for(var n in t)e[n]=e[n]&&"[object Object]"===e[n].toString()?this.merge(e[n],t[n]):e[n]=t[n];return e}},{key:"destory",value:function(){this.map.destroy()}},{key:"random",value:function(){return Math.floor(1234567890*Math.random())}},{key:"latLng",value:function(e){var t=e.lng,n=e.lat;return new TMap.LatLng(n,t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(e){console.log(e,"设置地图中心点"),this.map.setCenter(this.latLng(e))}},{key:"setRotation",value:function(e){this.map.setRotation(e)}},{key:"setPitch",value:function(e){this.map.setPitch(e)}},{key:"setScale",value:function(e){this.map.setScale(e)}},{key:"setMode",value:function(e){"2D"===e?this.map.setViewMode("2D"):"3D"===e&&(this.map.setViewMode("3D"),this.map.setPitch(70))}},{key:"setMarker",value:function(e,t){var n=this;console.log("setMarker-point-内部函数",e),console.log("setMarker-styles-内部函数",t),this.removeMarker(),console.log("marker-layer-".concat(Math.floor(1e4*Math.random())),"IDDDDD"),console.log(this,"this"),this.varia.centerMarker=new TMap.MultiMarker({id:"marker-layer-".concat(Math.floor(1e4*Math.random())),map:this.map,styles:we({marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},t),geometries:function(e){var t=n;if("[object Object]"===Object.prototype.toString.call(e))return e.lat=Number(e.lat),e.lng=Number(e.lng),[{id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}}];var a=[];return e.forEach((function(e){a.push({id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}})})),a}(e)})}},{key:"setMarkerCrm",value:function(e){this.varia.centerMarker=new TMap.MultiMarker({id:"marker_".concat(this.random()),map:this.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},geometries:[{id:"markergeo_".concat(this.random()),styleId:"marker_".concat(this.random()),position:new TMap.LatLng(e.lat,e.lng),properties:{title:"marker"}}]})}},{key:"removeMarker",value:function(){console.log("移除marker事件"),console.log(this.varia.centerMarker),this.varia.centerMarker&&(this.varia.centerMarker.setMap(null),this.varia.centerMarker=null)}},{key:"removeCluster",value:function(){}},{key:"setCircle",value:function(e){return new TMap.MultiCircle({id:"circle",map:this.map,geometries:[{center:this.latLng(e),radius:1e3}]})}},{key:"setMarkerCluster",value:function(e){var t=this;return console.log("setMarkerCluster"),this.varia.markerCluster=new TMap.MarkerCluster({id:"marker_".concat(this.random()),map:this.map,enableDefaultStyle:!1,minimumClusterSize:2,geometries:function(e){var n=t;if("[object Object]"===Object.prototype.toString.call(e))return[{position:n.latLng(e)}];var a=[];return e.forEach((function(e){a.push({position:n.latLng(e)})})),a}(e),zoomOnClick:!0,gridSize:60,averageCenter:!1,maxZoom:10}),this.varia.markerCluster}}],n&&ba(t.prototype,n),a&&ba(t,a),e}();const Da={name:"Map",props:{sceneId:{type:String,default:"default"},visible:Boolean,inputValue:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:"100%"},searchInput:{type:Boolean,default:!0},optionSelect:{type:String,default:"title"},intLocation:{type:Boolean,default:!0},config:{type:Object,default:function(){return{}}}},data:function(){return{list:[],actInputValue:"",realDot:!1,glMap:null,id:"TMapSearch_"+de.default.guid()}},watch:{inputValue:function(e){e!==this.actInputValue&&(this.realDot=!0,this.actInputValue=e)},visible:function(e){e&&(this.glMap||this.initMap(),this.actInputValue=this.inputValue)}},mounted:function(){this.initMap()},methods:{initMap:function(){var e=this;this.$nextTick((function(){e.glMap=new xa(we({container:e.id,success:function(){console.log("地图加载完毕！"),e.$emit("init",e.glMap),e.initComplate()}},e.config)),e.actInputValue=e.inputValue,e.searchInput&&e.actInputValue&&e.intLocation&&(e.realDot=!0,e.handleSearch()),e.glMap._afterInit()}))},initComplate:function(){var e=this,t=this;this.$nextTick((function(){setTimeout((function(){e.actInputValue=e.inputValue,t.glMap.request("suggestion",{keyword:e.inputValue}).then((function(e){e.count&&t.setPosition(e.data[0].id,e.data),t.list=e.data||[],t.$forceUpdate()})),t.$forceUpdate(),e.glMap.map.on("click",(function(e){var n=e.latLng.getLat(),a=e.latLng.getLng();t.setCenter({lat:n,lng:a});var i=[];t.glMap.request("parseLocation",{location:n+","+a}).then((function(e){console.log(e,"根据经纬度".concat(n+","+a,"解析地址信息"));var o={adcode:Number(e.result.ad_info.adcode),address:e.result.formatted_addresses.recommend,city:e.result.address_component.city,district:e.result.address_component.district,location:e.result.location,id:"123456ABCD",title:e.result.formatted_addresses.recommend,province:e.result.address_component.province,type:0};console.log(o,"传给外面的数据对象 - item--1"),t.$emit("change",o),i.push(o),t.actInputValue=e.result.formatted_addresses.recommend,t.setPosition("123456ABCD",i),t.glMap.request("suggestion",{keyword:e.result.address+e.result.formatted_addresses.recommend}).then((function(e){console.log(e,"res1"),e.count&&i.push.apply(i,gt(e.data)),t.list=i,t.$forceUpdate()}))}))}))}),1e3)}))},inputHandler:function(e){var t=this;e&&(this.realDot?this.glMap.request("geocoder",{address:e}).then((function(e){t.realDot=!1,e.status?t.handleSearch():t.setAutoPosition(e.result)})):this.glMap.request("suggestion",{keyword:e}).then((function(e){console.log(e,"inputHandler--suggestion - input 输入框 输入关键词"),t.list=e.data})))},handleSearch:function(){var e=this;this.actInputValue&&(this.realDot?this.glMap.request("geocoder",{address:this.actInputValue}).then((function(t){e.realDot=!1,t.status?e.handleSearch():e.setAutoPosition(t.result)})):this.glMap.request("suggestion",{keyword:this.actInputValue}).then((function(t){console.log(t,"handleSearch--suggestion - input 手动调用搜索"),e.list=t.data})))},handleSelect:function(e){if(console.log("handleSelect：",e),e){var t=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(t.location),this.glMap.setMarker(t.location),console.log(t,"传给外面的数据对象 - item--2"),this.$emit("change",t)}},setPosition:function(e,t){this.list=t;var n=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(n.location),this.glMap.setMarker(n.location),this.$forceUpdate()},setCenter:function(e){this.glMap.setMarker(e)},setAutoPosition:function(e){console.log(e)},setAddress:function(e){this.inputHandler(e)},resetValue:function(e){var t=this;this.$nextTick((function(){(t.actInputValue||t.inputValue)&&(t.actInputValue=t.inputValue,t.list=[],t.actInputValue&&!e&&(t.realDot=!0,t.handleSearch()),t.realDot=!1,t.handleSearch())}))}}};var Ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-search-wrapper"},[e.searchInput?n("a-auto-complete",{staticClass:"map-search",attrs:{autoFocus:"",placeholder:"请输入"},on:{search:e.inputHandler,select:e.handleSelect},model:{value:e.actInputValue,callback:function(t){e.actInputValue="string"==typeof t?t.trim():t},expression:"actInputValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t[e.optionSelect]))])})),1)],2):e._e(),e._v(" "),n("div",{staticClass:"t-map-search",style:{height:e.height,width:e.width},attrs:{id:e.id}})],1)};Ra._withStripped=!0;const Oa={name:"Manage",components:{GlMap:me({render:Ra,staticRenderFns:[]},void 0,Da,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},visible:{type:Boolean,default:!1},title:{type:String,default:"地址定位"},config:{type:Object,default:function(){return null}},inputValue:{type:String,default:""},baseValue:{type:String,default:""}},data:function(){return{flag:!0,cache:null,addressInfo:{},glmap:new xa}},watch:{visible:function(e){var t=this;this.$nextTick((function(){t.addressInfo={},e&&t.$nextTick((function(){setTimeout((function(){t.inputValue&&t.$refs.map&&t.$refs.map&&(console.log(t.inputValue,"this.inputValue"),t.parseAddress(t.inputValue,(function(e){if(e.length){var n=e[0];t.addressInfo=n,t.cache?t.$refs.map.setPosition(t.cache.id,de.default.unique([t.cache].concat(gt(e)),"id")):t.$refs.map.setPosition(n.id,e)}else t.$refs.map.setPosition(t.cache.id,[t.cache])})))}),1e3)}))}))}},computed:{modalVisible:{get:function(){return this.visible},set:function(){this.$emit("update:visible",!1)}}},mounted:function(){},methods:{parseAddress:function(e,t){"string"==typeof e&&e.trim().length&&this.glmap.request("suggestion",{keyword:e}).then((function(e){e.count?t&&t(e.data):t&&t(null)}))},handleOk:function(){console.log(this.addressInfo,"点击弹框确定按钮返回  addressInfo 给最外面"),this.cache=this.addressInfo,this.$emit("ok",this.addressInfo),this.modalVisible=!1},handleCancel:function(){this.modalVisible=!1},handleChange:function(e){console.log(e,"弹框输入框选项发生变化，选中项赋值给 - addressInfo"),this.addressInfo=e}}};var Va=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"map-dialog-modal",attrs:{title:e.title,maskClosable:!1,width:"810px",keyboard:!1},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("gl-map",{ref:"map",attrs:{sceneId:e.sceneId,visible:e.modalVisible,inputValue:e.inputValue,intLocation:!1},on:{change:e.handleChange}})],1)};Va._withStripped=!0;const Ta={name:"AddressSearch",components:{MapDialog:me({render:Va,staticRenderFns:[]},void 0,Oa,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},value:{type:String,default:""},icon:{type:String,default:"environment"},showBtn:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},defaultBtn:{type:Boolean,default:!1}},data:function(){return{dataSource:[],poiPicker:null,list:[],glMap:null,mapVisible:!1}},computed:{autoValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},mounted:function(){this.autoValue=this.value,this.glMap=new xa},methods:{handleSearch:function(e){var t=this;e&&this.glMap.request("suggestion",{keyword:e}).then((function(e){t.$set(t,"list",e.data)}))},handleBtn:function(){console.log("handleBtn"),this.disabled||(this.defaultBtn?this.mapVisible=!0:this.$emit("btnClick"))},handleSelect:function(e){if(e){var t=this.list.filter((function(t){return t.id===e}))[0];this.autoValue=t.title,this.$emit("change",t)}},resetOption:function(){var e=this;this.$nextTick((function(){e.list=[],e.handleSearch(e.value)}))},handleMapOk:function(e){e.adcode&&(this.autoValue=e.title||e.address,this.$emit("change",e))}}};var La=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("a-auto-complete",{staticClass:"map-search",attrs:{placeholder:"请输入",disabled:e.disabled},on:{search:e.handleSearch,select:e.handleSelect},model:{value:e.autoValue,callback:function(t){e.autoValue=t},expression:"autoValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.title))])})),1),e._v(" "),e._t("default",[n("a-input",{attrs:{maxLength:e.maxLength}},[e.showBtn?n("a-button",{staticClass:"dot-btn",staticStyle:{"margin-right":"-12px"},attrs:{slot:"suffix",type:"link"},on:{click:function(t){return t.stopPropagation(),e.handleBtn(t)}},slot:"suffix"},[n("a-icon",{attrs:{type:e.icon}})],1):e._e()],1)])],2),e._v(" "),n("map-dialog",{ref:"mapDialog",attrs:{visible:e.mapVisible,title:"设置地址",sceneId:e.sceneId,inputValue:e.autoValue},on:{"update:visible":function(t){e.mapVisible=t},ok:e.handleMapOk}})],1)};La._withStripped=!0;const $a=me({render:La,staticRenderFns:[]},void 0,Ta,void 0,!1,void 0,!1,void 0,void 0,void 0);var Ia={name:"AreaSelect",props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:"span"},bottom:{type:String,default:"24px"},level:{type:Number,default:3},disabled:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}},url:{type:String,default:""},loadData:{type:Function,default:null},dealData:{type:Boolean,default:!1},immediate:{type:Boolean,default:!1}},data:function(){return{model:[{name:"province",label:"省"},{name:"city",label:"市"},{name:"district",label:"区"}],selectData:[],areaData:{province:[],city:[],district:[]},$request:null}},watch:{value:{handler:function(e){if(e.length){if(e[e.length-1]===this.selectData[this.selectData.length-1])return;this.dealValue()}else this.selectData=[],this.areaData.city=[],this.areaData.district=[]},deep:!0}},mounted:function(){var e=this;this.url?this.$request=function(t){return e.$get(e.url,t)}:this.$request=this.loadData,this.value.length?this.dealValue():this.getList()},methods:{getList:function(e,t,n){var a=this;this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){e||(a.areaData.province=n.data),e&&!t&&(a.areaData.city=n.data),e&&t&&(a.areaData.district=n.data)}))},dealValue:function(e,t,n){for(var a=this,i=JSON.parse(JSON.stringify(this.value)),o=0;o<i.length;o++)if(!i[o]){i.splice(o,i.length);break}this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){var o=n.data;e||(a.areaData.province=o,i[0]&&a.dealValue(i[0]),1===i.length&&(a.selectData=i,a.dealResult())),e&&!t&&(a.areaData.city=o,i[1]&&a.dealValue(i[0],i[1]),2===i.length&&(a.selectData=i,a.dealResult())),e&&t&&(a.areaData.district=o,3===i.length&&(a.selectData=i,a.dealResult()))}))},handleChange:function(e,t){"province"===t.name&&(this.areaData.city=[],this.areaData.district=[],this.selectData=[e],this.getList(e)),"city"===t.name&&(this.areaData.district=[],this.selectData=[this.selectData[0],e],this.getList.apply(this,gt(this.selectData))),this.dealResult(),this.$emit("input",JSON.parse(JSON.stringify(this.selectData)))},dealResult:function(){var e=this,t=this.areaData.province.filter((function(t){return t.id===e.selectData[0]}))[0]||null,n=this.areaData.city.filter((function(t){return t.id===e.selectData[1]}))[0]||null,a=this.areaData.district.filter((function(t){return t.id===e.selectData[2]}))[0]||null;this.$emit("change",this.selectData,{province:t,city:n,district:a})}}};const Fa=Ia;var Ma=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-row",{staticClass:"area-wrap",attrs:{gutter:12}},[e._l(e.model,(function(t,a){return[a<=e.level-1?n("a-col",{key:a,style:{marginBottom:"span"===e.type||e.model.length-1===a?"":e.bottom},attrs:{span:"span"===e.type?24/e.model.length:24}},[n("a-select",{staticClass:"area-select",attrs:{placeholder:t.label,disabled:e.disabled},on:{change:function(n){return e.handleChange(n,t)}},model:{value:e.selectData[a],callback:function(t){e.$set(e.selectData,a,t)},expression:"selectData[index]"}},e._l(e.areaData[t.name],(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e()]}))],2)};Ma._withStripped=!0;var Pa={name:"AddressBox",props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},syncInputBox:{type:Boolean,default:!0},value:{type:Object,default:function(){return{address:"",province:"",cityName:"",city:"",provinceName:"",districtName:"",district:"",fullAddress:"",lng:"",lat:"",point:null}}}},data:function(){var e=this;return{actForm:{address:""},outerLocation:{},area:[],areaData:null,confirmLoading:!1,mapLoadArea:!1,getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get(Te.city,t):t.provinceId&&t.cityId?e.$get(Te.district,t):void 0:e.$get(Te.province,t)},getAddressCodeByName:function(t){return e.$get(Le,t)},isFirst:!0}},components:{AddressSearch:$a,AreaSelect:me({render:Ma,staticRenderFns:[]},void 0,Fa,void 0,!1,void 0,!1,void 0,void 0,void 0)},watch:{value:{handler:function(){this.generateForm()},deep:!0},actForm:{handler:function(e){this.isFirst?this.isFirst=!1:this.$emit("inputChange",e)},deep:!0}},mounted:function(){this.generateForm()},methods:{generateForm:function(){this.actForm=we({address:"",province:"",city:"",district:""},this.value),this.area=[],this.actForm.province&&this.area.push(this.actForm.province),this.actForm.city?this.area.push(this.actForm.city):this.actForm.province||(this.area=[]),this.actForm.district?this.area.push(this.actForm.district):this.actForm.province||this.actForm.district||(this.area=[])},handleMapOk:function(e){var t=this;return _e(xe.mark((function n(){return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(e,"地图选择 ok----"),e.adcode){n.next=3;break}return n.abrupt("return");case 3:e&&(t.getAddressCodeByName({provinceName:e.province,cityName:e.city,districtName:e.district}).then((function(e){t.mapLoadArea=!0;var n=e.data,a=n.subAddress,i=a.subAddress;t.area=[n.id,a.id,i.id]})),t.actForm.address=e.title||e.address,t.$emit("input",t.actForm));case 4:case"end":return n.stop()}}),n)})))()},handleAreaChange:function(e,t){if(this.areaData=t,this.mapLoadArea)return this.actForm.province=e[0],this.actForm.city=e[1],this.actForm.district=e[2],this.actForm.provinceName=t.province.name,this.actForm.cityName=t.city.name,this.actForm.districtName=t.district.name,this.$emit("input",this.actForm),void(this.mapLoadArea=!1);this.actForm=we(we({},this.actForm),{},{province:t.province&&t.province.id,city:t.city&&t.city.id,district:t.district&&t.district.id,provinceName:t.province&&t.province.name,cityName:t.city&&t.city.name,districtName:t.district&&t.district.name}),this.syncInputBox&&(this.actForm.address="".concat(t.province&&t.province.name||"").concat(t.city&&t.city.name||"").concat(t.district&&t.district.name||"")),this.$emit("input",this.actForm)},getData:function(){return this.areaData}}};const Na=Pa;var Ea=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form-model-item",{attrs:{label:"省/市/区",prop:"area"}},[n("area-select",{attrs:{loadData:e.getRegion},on:{change:e.handleAreaChange},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"详细地址",prop:"address"}},[n("address-search",{ref:"autoComplete",attrs:{sceneId:e.sceneId,maxLength:e.maxLength,defaultBtn:""},on:{change:e.handleMapOk},model:{value:e.actForm.address,callback:function(t){e.$set(e.actForm,"address",t)},expression:"actForm.address"}})],1)],1)};Ea._withStripped=!0;const Aa=me({render:Ea,staticRenderFns:[]},void 0,Na,void 0,!1,void 0,!1,void 0,void 0,void 0);Aa.install=function(e){e.component(Aa.name,Aa)},de.default.ISREPEAT=function(e){return Object.keys(de.default).includes(e)},de.default.date.calcWeek=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"YYYY/MM/DD",a=new Date(t),i=de.default.date.endOf("week",a,n),o=de.default.date.add(e,"w",i,n),s=de.default.date.endOf("w",o,n),r=de.default.date.startOf("w",o,n);return{start:r,end:s}},de.default.date.calcMonth=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=new Date(e),a=de.default.date.startOf("month",n,t),i=de.default.date.endOf("month",n,t);return{start:a,end:i}},de.default.date.mandom=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=new Date(e),a=n.getMonth()+1,i=de.default.date.daysInMonth(n),o=[],s=1;s<=i;s++)o.push(de.default.date.format(de.default.date.format("2021/".concat(a,"/").concat(s),"YYYY-MM-DD")+" ".concat(de.default.rangeRandom(0,23),":").concat(de.default.rangeRandom(0,59)),t||"YYYY-MM-DD hh:mm"));return o[de.default.rangeRandom(1,i)[0]]},de.default.date.period=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,a=new Date(n);if(1===e)return de.default.date.calcWeek(0,a,t);if(2===e)return{start:de.default.date.subtract(6,"day",a,t),end:de.default.date.format(t)};if(3===e)return de.default.date.calcMonth(a,t);if(4===e){var i=de.default.date.endOf("week",a,t);return{start:de.default.date.subtract(20,"day",i,t),end:i}}var o=de.default.date.subtract(2,"month",de.default.date.startOf("month",a),t),s=de.default.date.endOf("month",a,t);return{start:o,end:s}},de.default.date.isPeriod=function(e,t){return 1===e||2===e?de.default.date.isToday(t):3===e&&void 0},Map.prototype.getByKey=function(e){var t=gt(this.keys()),n=t.findIndex((function(t){return Array.isArray(t)&&t.includes(e)}));return this.get(t[n])},de.default.amap={jsonpRequest:function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.TMAPCALLBACK[n]=function(e){t=e},document.querySelector("body").appendChild(a);var i=function(){document.querySelector("body").removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},parsePoint:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n){var a=de.default.urlSerialize("",Object.assign({key:"d59ce84bb495eccd65a4d238c8c06977"},t)),i="https://restapi.amap.com/v3/geocode/geo".concat(a);console.log(i,"请求地址"),n(e.jsonpRequest(i))}))},loadScript:function(e,t){var n=this;return new Promise((function(a,i){var o=document.createElement("script");t&&n.setAttr(o,t),o.onload=function(){return a(o)},o.onerror=function(){return i(o)},o.src=e,document.querySelector("body").appendChild(o)}))},isLoad:function(){for(var e=document.getElementsByTagName("script"),t=!1,n=0;n<e.length;n++)e[n].getAttribute("src").includes("https://webapi.amap.com/maps?v=1.4.6&key=d59ce84bb495eccd65a4d238c8c06977&plugin=AMap.Geocoder")&&(t=!0);return t},setAttr:function(e,t){for(var n in t)e.setAttribute(n,t[n])}},de.default.caputured=function(){var e=_e(xe.mark((function e(t){var n,a,i,o,s=arguments;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",[null,o]);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[e.t0,null]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),le.default.prototype.$caputured=function(){var e=_e(xe.mark((function e(t){var n,a,i,o,s=arguments;return xe.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",{err:null,res:o});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{err:e.t0,res:null});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),de.default.try=function(e,t){try{e&&e()}catch(e){t&&t(e)}},de.default.jsonToArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){return[].concat(gt(t),[be({},n,e[n])])}),[])},de.default.icon={report:{iconList:{1:"iconreport01",2:"iconreport02",3:"iconreport03",4:"iconreport04",5:"iconreport05",6:"iconreport06",7:"iconreport07",8:"iconreport08",9:"iconreport09",10:"iconreport10",11:"iconreport11",12:"iconreport12",13:"iconreport13",15:"iconreport15",16:"iconreport16",17:"iconreport17",18:"iconreport18",19:"iconreport19",20:"iconreport20",21:"iconreport21",22:"iconreport22",23:"iconreport23",24:"iconreport24",25:"iconreport25",26:"iconreport26",27:"iconreport27",28:"iconreport28",29:"iconreport29",30:"iconreport30",31:"iconreport31",32:"iconreport32",33:"iconreport33",34:"iconreport34",35:"iconreport35",36:"iconreport36",37:"iconreport37",38:"iconreport38",39:"iconreport39",40:"iconreport40",41:"iconreport41",42:"iconreport42",43:"iconreport43",44:"iconreport44",45:"iconreport45",46:"iconreport46",47:"iconreport47",48:"iconreport48"},colorList:{1:"#0289ff",2:"#00c359",3:"#fc943d",4:"#fb602c"}},approve:{iconList:{},colorList:{}}},de.default.mapHandler=function(e,t,n){var a=Object.keys(e).find((function(e){return JSON.parse(e).includes(t)}));a?e[a]():n&&n()};var ja={name:"EditorAddress",components:{AddressBox:Aa},props:{visible:{type:Boolean,default:!1},editData:{type:Object,default:function(){return{}}},customerId:{type:String,default:null,require:!0},hasAddress:{type:Boolean,default:!1}},data:function(){return{form:{deliveryMethod:"",deliveryId:void 0,deliveryName:"",logisticsId:void 0,logisticsName:"",customerName:"",phone:"",detailAddress:"",address:"",province:"",city:"",district:"",longitude:"",latitude:"",provinceName:"",cityName:"",districtName:"",fullAddress:"",loadingInfo:"",allAddress:void 0,isDefault:!1},confirmLoading:!1,basicRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}]},logisticsRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}],customerName:[{required:!0,message:"请输入",trigger:"change"}],phone:[{required:!0,message:"请输入",trigger:"change"}],allAddress:[{required:!0,message:"请选择",trigger:"change"}]},backForm:null,syncInputBox:!0,deliveryTypes:{data:[],loading:!1},logisticsCorps:{data:[],loading:!1}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},rules:function(){return 2===this.form.deliveryMethod?this.logisticsRules:this.basicRules},isUpdateMode:function(){return!!this.form.businessId},title:function(){return this.isUpdateMode?"编辑收货信息":"新增收货信息"}},watch:{visible:function(e){var t=this;return _e(xe.mark((function n(){return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=6;break}return n.next=3,t.handleGetDeliveryType();case 3:return n.next=5,t.handleGetLogistcsCorp();case 5:t.editData&&t.editData.businessId?(t.syncInputBox=!1,t.form=t.editData,t.form.address=t.form.detailAddress,t.form.loadingInfo=t.form.loadingInfo||t.form.fullAddress):(t.syncInputBox=!0,t.form={deliveryId:t.deliveryTypes.data.length&&t.deliveryTypes.data[0].value,customerName:"",isDefault:!t.hasAddress});case 6:case"end":return n.stop()}}),n)})))()},backForm:{handler:function(e){var t=this;e&&(this.form.address=e.address,this.form.province=e.province,this.form.city=e.city,this.form.district=e.district,this.form.detailAddress=e.address,e.address&&e.province&&e.city&&e.district?(this.form.allAddress=!0,this.$nextTick((function(){t.$refs.allAddress&&t.$refs.allAddress.onFieldChange()}))):this.form.allAddress=void 0)},deep:!0}},methods:{handleGetDeliveryType:function(){var e=this;return _e(xe.mark((function t(){var n,a;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.deliveryTypes.loading=!0,t.next=4,e.$get(Xe);case 4:n=t.sent,a=n.data,e.deliveryTypes.data=a.map((function(e){return we({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.deliveryTypes.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},handleGetLogistcsCorp:function(){var e=this;return _e(xe.mark((function t(){var n,a;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.logisticsCorps.loading=!0,t.next=4,e.$get(Je);case 4:n=t.sent,a=n.data,e.logisticsCorps.data=a.map((function(e){return we({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.logisticsCorps.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},onDeliveryTypeChange:function(e){var t=this.deliveryTypes.data.find((function(t){return t.value===e}));t&&(this.form.deliveryMethod=t.requireOption)},changePhone:function(e){this.form.phone=e.replace(/[\u4E00-\u9FA5]|[A-Za-z]/g,"")},changeRadio:function(){this.form.isDefault=!this.form.isDefault},handleOk:function(){var e=this;this.$refs.ruleFormReceipt.validate(function(){var t=_e(xe.mark((function t(n){var a,i,o,s,r,l,c,u,d,h,p,f,m,g;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=46;break}if(a=e.deliveryTypes.data.find((function(t){return t.value===e.form.deliveryId})),2!==e.form.deliveryMethod){t.next=23;break}if(i=e.form.provinceName,o=e.form.cityName,s=e.form.districtName,r=e.form.address,l=[i,o,s,r].join(""),c="",!l){t.next=13;break}return t.next=12,de.default.amap.parsePoint({address:l});case 12:c=t.sent;case 13:u=c?c.geocodes:[],e.form.longitude=u.length?u[0].location.split(",")[0]:"",e.form.latitude=u.length?u[0].location.split(",")[1]:"",d=[i,o,s].join(""),h="",h=d.includes(r)?d:r.includes(d)?r:d===r?d:l,p=e.logisticsCorps.data.find((function(t){return t.value===e.form.logisticsId})),e.form.logisticsName=p&&p.label,e.form.fullAddress=h,e.form.detailAddress=e.form.address;case 23:return 1===e.form.deliveryMethod&&(e.form.fullAddress=e.form.loadingInfo),e.form.deliveryName=a.label,e.$emit("confirm",e.form),t.prev=26,e.confirmLoading=!0,t.next=30,e.$post(e.isUpdateMode?nt:tt,we({customerId:e.customerId},e.form));case 30:if(f=t.sent,m=f.data,g=f.message,m){t.next=35;break}throw new Error(g);case 35:e.$message.success("操作成功！"),e.$emit("success"),t.next=43;break;case 39:t.prev=39,t.t0=t.catch(26),e.$message.error(t.t0),console.error(t.t0);case 43:return t.prev=43,e.confirmLoading=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[26,39,43,46]])})));return function(e){return t.apply(this,arguments)}}())},handleCancel:function(){this.modalVisible=!1,this.$emit("cancel")},afterClose:function(){this.syncInputBox=!0,this.form={customerName:"",isDefault:!1}},inputChange:function(e){this.isUpdateMode&&(this.syncInputBox=!0),this.backForm=we(we({},this.form),e)},changeTextarea:function(){this.form.loadingInfo.length>=500&&this.$message.info("限500字")}}};const Ba=ja;var Ka=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"receipt-dialog-wrap",attrs:{afterClose:e.afterClose,"confirm-loading":e.confirmLoading,maskClosable:!1,title:e.title,width:500,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("a-form-model",{ref:"ruleFormReceipt",attrs:{"label-col":{span:5},model:e.form,rules:e.rules,"wrapper-col":{span:17}}},[n("a-form-model-item",{attrs:{label:"发货方式",prop:"deliveryId"}},[n("a-select",{attrs:{loading:e.deliveryTypes.loading,placeholder:"请选择"},on:{change:e.onDeliveryTypeChange},model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryTypes.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])})),1)],1),e._v(" "),2===e.form.deliveryMethod?[n("a-form-model-item",{attrs:{label:"物流公司",prop:"logisticsId"}},[n("a-select",{attrs:{loading:e.logisticsCorps.loading,placeholder:"请选择"},model:{value:e.form.logisticsId,callback:function(t){e.$set(e.form,"logisticsId",t)},expression:"form.logisticsId"}},e._l(e.logisticsCorps.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),n("a-form-model-item",{attrs:{label:"收货人",prop:"customerName"}},[n("a-input",{staticClass:"customer-name-wrap",attrs:{maxLength:50,suffix:e.form.customerName.length+"/50",placeholder:"请输入"},model:{value:e.form.customerName,callback:function(t){e.$set(e.form,"customerName","string"==typeof t?t.trim():t)},expression:"form.customerName"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"联系方式",prop:"phone"}},[n("a-input",{attrs:{maxLength:50,placeholder:"请输入"},on:{change:function(t){return e.changePhone(e.form.phone)}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone","string"==typeof t?t.trim():t)},expression:"form.phone"}})],1),e._v(" "),n("a-form-model-item",{ref:"allAddress",staticStyle:{"margin-bottom":"0"},attrs:{label:"所在地区",prop:"allAddress"}},[n("a-form-model",{staticClass:"cus-address-wrap",attrs:{"label-col":{span:0},"wrapper-col":{span:24}}},[n("address-box",{attrs:{maxLength:100,syncInputBox:e.syncInputBox},on:{inputChange:e.inputChange},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)],1)]:e._e(),e._v(" "),1===e.form.deliveryMethod?n("a-form-model-item",{attrs:{label:"装车信息",prop:"loadingInfo"}},[n("a-textarea",{attrs:{maxLength:500,placeholder:"限500字",rows:5},on:{change:e.changeTextarea},model:{value:e.form.loadingInfo,callback:function(t){e.$set(e.form,"loadingInfo","string"==typeof t?t.trim():t)},expression:"form.loadingInfo"}})],1):e._e(),e._v(" "),n("a-radio",{staticStyle:{"margin-left":"76px"},attrs:{checked:e.form.isDefault},on:{click:e.changeRadio}},[e._v("设为默认")])],2)],1)};Ka._withStripped=!0;const Ha=me({render:Ka,staticRenderFns:[]},void 0,Ba,"data-v-0c26a3f4",!1,void 0,!1,void 0,void 0,void 0);Ha.install=function(e){e.component(Ha.name,Ha)};const za={name:"DSelectAddress",components:{CellEllipsisTip:Wt,STable:sn,EditorAddress:Ha},props:{width:{type:Number,default:816},cache:{type:Boolean,default:!0},visible:{type:Boolean,default:!1},setContainer:{type:Function,default:function(){return document.querySelector("body")}},customerId:{type:String,default:null,require:!0},title:{type:String,default:"选择收货地址"},beforeClose:{type:Function,default:void 0},value:{type:Object,default:void 0}},data:function(){return{currentMark:-1,addressDetailsShow:!1,clickReceipt:null,opened:!1,list:{data:[],loading:!1,selected:null}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible:function(e){e&&((!this.cache||this.cache&&!this.opened)&&(this.list.selected=null,this.getDeliverys()),this.opened=!0)}},methods:{getDeliverys:function(){var e=this;return _e(xe.mark((function t(){var n,a;return xe.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.list.loading=!0,t.next=4,e.$post(et,{businessId:e.customerId});case 4:n=t.sent,a=n.data,e.list.data=a||[],t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.list.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},deleteAddress:function(e){var t=this;this.$confirm({title:"操作提示！",content:"您是否确定删除此地址？",okText:"确定",cancelText:"取消",onOk:function(){return _e(xe.mark((function n(){return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(at,{businessId:e.businessId,customerId:e.customerId});case 3:e.businessId===t.list.selected&&(t.list.selected=null),t.$message.success("操作成功！"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:return n.prev=10,t.getDeliverys(),n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[0,7,10,13]])})))()}})},setDefault:function(e){var t=this;return _e(xe.mark((function n(){var a,i,o;return xe.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(it,{businessId:e.businessId,customerId:e.customerId});case 3:if(a=n.sent,i=a.data,o=a.message,i){n.next=8;break}throw new Error(o);case 8:t.$message.success("操作成功！"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0);case 14:return n.prev=14,t.getDeliverys(),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[0,11,14,17]])})))()},handleSelectAddress:function(e){this.list.selected=e.businessId},editAddress:function(e){this.clickReceipt=e,this.addressDetailsShow=!0},addAddress:function(){this.clickReceipt=null,this.addressDetailsShow=!0},onEditAddressSucceed:function(){this.addressDetailsShow=!1,this.getDeliverys()},handleOk:function(){var e=this,t=this.list.data.find((function(t){return t.businessId===e.list.selected}));this.beforeClose?this.beforeClose({data:this.list.selected,rows:[t]}):this.$emit("confirm",{data:this.list.selected,rows:[t]}),this.modalVisible=!1},handleCancel:function(){this.$emit("cancel"),this.modalVisible=!1}}};var qa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-address",attrs:{footer:null,"get-container":e.setContainer,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.list.loading,expression:"list.loading"}],staticClass:"select-address-content"},[e.list.data&&e.list.data.length>0?n("div",[n("a-radio-group",{staticStyle:{width:"100%"},model:{value:e.list.selected,callback:function(t){e.$set(e.list,"selected",t)},expression:"list.selected"}},e._l(e.list.data,(function(t,a){return n("div",{key:a,staticClass:"content-item",class:{"auto-class":"zt"===t.type||"nothing"===t.type},on:{mouseenter:function(t){e.currentMark=a},mouseleave:function(t){e.currentMark=-1},click:function(n){return n.stopPropagation(),e.handleSelectAddress(t)},dblclick:function(t){return t.stopPropagation(),e.handleOk(t)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentMark===a,expression:"currentMark === index"}],staticClass:"row-btn"},[n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.editAddress(t)}}},[e._v("修改")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.deleteAddress(t)}}},[e._v("删除")])],1),e._v(" "),n("div",[n("a-radio",{style:{display:"block",height:"30px",lineHeight:"30px",marginRight:"14px"},attrs:{value:t.businessId}})],1),e._v(" "),n("div",{staticClass:"details"},[n("div",[e._v("\n              "+e._s(t.deliveryName||"")+"\n                \n              "),t.isDefault?n("a-tag",{attrs:{color:"blue"}},[e._v("默认")]):e._e()],1),e._v(" "),t.customerName&&t.phone?n("div",[e._v(e._s(t.customerName)+"  "+e._s(t.phone))]):e._e(),e._v(" "),t.detailAddress&&2===t.deliveryMethod?n("div",[e._v(e._s(t.detailAddress))]):e._e(),e._v(" "),t.fullAddress&&2!==t.deliveryMethod?n("div",[e._v(e._s(t.fullAddress))]):e._e()])])})),0)],1):n("div",{staticClass:"empty"},[n("a-empty",{attrs:{description:"暂无数据"}})],1)]),e._v(" "),n("div",{staticClass:"select-address-footer"},[n("div",{on:{click:e.addAddress}},[e._v("+新增收货地址")]),e._v(" "),n("div",[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n      "),n("a-button",{attrs:{disabled:!e.list.selected,type:"primary"},on:{click:e.handleOk}},[e._v("确定")])],1)]),e._v(" "),n("EditorAddress",{attrs:{customerId:e.customerId,"edit-data":e.clickReceipt,visible:e.addressDetailsShow,hasAddress:!!e.list.data.length},on:{"update:visible":function(t){e.addressDetailsShow=t},cancel:function(t){e.addressDetailsShow=!1},success:e.onEditAddressSucceed}})],1)};qa._withStripped=!0;const Ya=me({render:qa,staticRenderFns:[]},void 0,za,void 0,!1,void 0,!1,void 0,void 0,void 0);Ya.install=function(e){e.component(Ya.name,Ya)};const Wa={name:"SelectTree",props:{value:{type:[Array,Number,String],default:void 0},multiple:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},replaceFields:{type:Object,default:function(){return{}}},loadData:{type:Function,default:null}},data:function(){return{treeData:[],spreadData:{}}},computed:{baseReplaceFields:function(){return we({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},treeCheckValue:{get:function(){return"object"===ot(this.checkValue)?this.checkValue:[this.checkValue]}}},watch:{options:{handler:function(e){console.log("lst",e),this.setOptions()},deep:!0,immediate:!0}},methods:{setOptions:function(){var e=this;this.spreadData={};var t=function t(n){var a=[];return n.forEach((function(n){e.spreadData[n[e.replaceFields.key]]=n,n.children&&(n.children=t(n.children)),a.push(we(we({},n),{},{scopedSlots:{icon:"radio"}}))})),a};this.treeData.length?this.treeData=t(this.treeData):this.treeData=t(this.options)},selectHandle:function(e,t){console.log(e,t)},getData:function(){var e=this,t=ot(this.checkValue),n=[];return console.log(this.spreadData),"object"===t?this.checkValue.forEach((function(t){var a="object"===ot(t)?t[e.replaceFields.key]:t;e.spreadData[a]&&n.push(e.spreadData[a])})):this.spreadData[this.checkValue]&&n.push(this.spreadData[this.checkValue]),{checkValue:this.checkValue,data:this.checkValue,rows:this.row||n}},onSelect:function(e,t){this.checkValue=e,this.row=t.checkedNodes.map((function(e){return e.data.props}))}},components:{Empty:Pn}};var Ga=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mix-modal-select-tree"},[e.options.length?e._e():n("empty"),e._v(" "),e.multiple?[n("a-tree",{attrs:{showIcon:"",checkable:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,multiple:"",loadData:e.loadData},on:{check:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){return[e._v("\n        "+e._s(t.name)+"\n      ")]}}]),model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}})]:[n("a-radio-group",{model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}},[n("a-tree",{attrs:{showIcon:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,loadData:e.loadData,selectable:!1},on:{select:e.selectHandle},scopedSlots:e._u([{key:"radio",fn:function(t){return[n("div",{staticClass:"radio-line"},[n("a-radio",{staticClass:"radio-line",attrs:{value:t[e.baseReplaceFields.key]}})],1)]}},{key:"title",fn:function(t){return[e._v("\n          "+e._s(t.name)+"\n        ")]}}],null,!1,3749490323),model:{value:e.treeCheckValue,callback:function(t){e.treeCheckValue=t},expression:"treeCheckValue"}})],1)]],2)};Ga._withStripped=!0;const Ua={name:"MixModal",props:{visible:{type:Boolean,default:!1},name:{type:String,default:"brand",validator:function(e){return-1!==["unit","brand","tag","levelPrice","productCategory","specialCategory","salesArea","classification","delivery","area","logistics","customLogistics"].indexOf(e)}},title:{type:String,default:"请选择"},cache:{type:Boolean,default:!1},beforeClose:{type:Function,default:null},defaultValue:{type:[String,Boolean,Number,Array],default:null},multiple:{type:Boolean,default:!1},extrasOperations:{type:Array,default:function(){return["refresh"]}},rules:{type:Object,default:function(){}}},data:function(){var e=this;return{keywords:"",placeholder:"请输入",options:[],checkValue:[],modelProps:{},testValue:[],loading:!0,modelType:"selectGroup",request:null,replaceFields:{key:"id",name:"name"},getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get(Te.city,we(we({},t),e.rules)):t.provinceId&&t.cityId?e.$get(Te.district,we(we({},t),e.rules)):void 0:e.$get(Te.province,e.rules)}}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t[e.replaceFields["selectGroup"===e.modelType?"name":"title"]].match(e.keywords))return t})):this.options}},watch:{visible:function(e){e&&(this.keywords="",this.options.length&&this.cache||(this.options=[],this.refresh(),this.getList(),this.rules&&this.rules.keywords&&(this.keywords=this.rules.keywords)))},name:function(){this.refresh()}},methods:{refresh:function(){this.options=[],this.setModel(),this.getList()},handleCheckAll:function(){var e=this;this.checkValue=this.options.map((function(t){return t[e.replaceFields.key]}))},setModel:function(){["unit","brand","tag","levelPrice","classification","delivery","logistics"].includes(this.name)?this.modelType="selectGroup":["productCategory","salesArea","area"].includes(this.name)&&(this.modelType="selectTree")},getList:function(){var e=this;if(this.checkValue=this.defaultValue||[],this.loading=!0,["unit","brand","tag"].includes(this.name)){this.checkValue=this.defaultValue||[];var t={type:["unit","brand","tag"].indexOf(this.name)};this.$post(Pe,we(we({},t),this.rules)).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))}else["levelPrice"].includes(this.name)?(this.checkValue=this.defaultValue||[],this.replaceFields={},this.$post(Ne,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):["productCategory","specialCategory"].includes(this.name)?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"categoryName"},this.getCateGory(),this.request=this.getCateGory):"salesArea"===this.name?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"name"},this.getCustomerRegionList(),this.request=this.getCustomerRegionList):"classification"===this.name?(this.replaceFields={key:"value",name:"label"},this.$post(Me,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):"delivery"===this.name?this.$get(Ue,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):"area"===this.name?(this.replaceFields={key:"id",title:"name"},this.getRegion().then((function(t){e.options=t.data.map((function(e){return we(we({},e),{},{isLeaf:!1})})),e.request=e.getRegionList})).finally((function(){e.loading=!1}))):"logistics"===this.name?this.$get(Qe,this.rules).then((function(t){e.options=t.data;var n=e.options.filter((function(e){return e.isCheck})).map((function(e){return e.id}));console.log("isCheckedValue:",n),e.checkValue=n})).finally((function(){e.loading=!1})):"customLogistics"===this.name?this.$get(Ze,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):(console.error("当前传入名称为：",this.name,"。请确认是否正确！！！"),this.loading=!1)},getCateGory:function(e){var t=this;if(e)return new Promise((function(n){e.dataRef.children?n():t.$get(Ee,we({categoryType:["productCategory","specialCategory"].indexOf(t.name),parentId:e.dataRef.id},t.rules)).then((function(a){e.dataRef.children=a.data.categoryLists,t.options=gt(t.options),n(a.data.categoryLists)}))}));this.$get(Ee,we({categoryType:["productCategory","specialCategory"].indexOf(this.name),parentId:0},this.rules)).then((function(e){t.loading=!1,t.options=e.data.categoryLists}))},getCustomerRegionList:function(e){var t=this;if(e)return new Promise((function(n){if(e.dataRef.children)n();else{var a=e.dataRef;t.$post(Ie,we({businessId:a.id||0},t.rules)).then((function(a){e.dataRef.children=a.data,t.options=gt(t.options),n(a.data)})).finally((function(){t.loading=!1}))}}));this.$post(Ie,we({businessId:0},this.rules)).then((function(e){t.options=e.data})).finally((function(){t.loading=!1}))},getRegionList:function(e){var t=this,n=null,a=null;return e.dataRef&&e.$parent.dataRef&&(n=e.dataRef.parentId,a=e.dataRef.id),e.dataRef&&!e.$parent.dataRef&&(n=e.dataRef.id),new Promise((function(i){e.dataRef.children?i():t.getRegion({provinceId:n,cityId:a}).then((function(n){e.dataRef.children=n.data.map((function(e){return we(we({},e),{},{isLeaf:!!a})})),t.options=gt(t.options),i(n.data)})).finally((function(){t.loading=!1}))}))},okHandle:function(){var e=this.$refs.contentModel.getData();e.isCheckAll=this.checkValue.length===this.options.length,this.beforeClose?this.beforeClose(e,this.cancelHandle):(this.$emit("confirm",e),this.modalVisible=!1)},cancelHandle:function(){this.modalVisible=!1}},components:{SelectGroup:ua,SelectTree:me({render:Ga,staticRenderFns:[]},void 0,Wa,void 0,!1,void 0,!1,void 0,void 0,void 0),Empty:Pn}};var Xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:"816px"},on:{cancel:e.cancelHandle,ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.extrasOperations.includes("refresh")?n("a-button",{attrs:{type:"link"},on:{click:e.refresh}},[e._v("刷新")]):e._e(),e._v(" "),(e.extrasOperations.includes("checkAll")&&this.multiple&&this.modelType,e._e())],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},["selectGroup"===e.modelType?n("SelectGroup",{ref:"contentModel",attrs:{multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e(),e._v(" "),"selectTree"===e.modelType?n("SelectTree",{ref:"contentModel",attrs:{"load-data":e.request,multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e()],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};Xa._withStripped=!0;const Ja=me({render:Xa,staticRenderFns:[]},void 0,Ua,void 0,!1,void 0,!1,void 0,void 0,void 0);Ja.install=function(e){e.component(Ja.name,Ja)};var Qa={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"},account:{name:"SelectPayAccount",key:"accountId",value:"name"},delivery:{name:"SelectDelivery",key:"id",value:"name"},logistics:{name:"SelectLogistics",key:"id",value:"name"},customLogistics:{name:"SelectCustomLogistics",key:"id",value:"name"},address:{name:"SelectAddress",key:"businessId",value:"deliveryName"}};const Za=me({},void 0,{name:"DMixSearch",props:{name:{type:String,default:"product"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:Qa,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){"[object Object]"!==Object.prototype.toString.call(e)?this.modalValue=e||void 0:Object.keys(e).length>0?this.modalValue=e:(console.warn("value 不能为空对象"),this.modalValue=void 0)},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e={},t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];if(this.dialogConfig.multiple?this.multiple=this.dialogConfig.multiple:this.multiple=!0===this.valueMode&&t&&!t.length,["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)){var n={type:Qa[this.name].type};e=be({},this.name,{multiple:this.multiple,rules:n}),this.dialog=Jn}else["person","preparer","handler"].includes(this.name)?(e={person:{title:"经手人"},preparer:{title:"制单人"},handler:{title:"经手人"}},this.dialog=ta):["warehouse"].includes(this.name)?(e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=Hn):["customer","supplier","supplierCustomer"].includes(this.name)?(e={customer:{title:"选择客户",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[2]},supplier:{title:"选择供应商",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[1]},supplierCustomer:{title:"选择往来单位",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[3]}},this.dialog=ca):["unit","brand","tag","rateUnit"].includes(this.name)?(e={unit:{type:0},brand:{type:1},tag:{type:2},rateUnit:{type:3}},this.dialog=pa):["account"].includes(this.name)?this.dialog=ya:["delivery","logistics","customLogistics"].includes(this.name)?(e={delivery:{name:"delivery"},logistics:{name:"logistics"},customLogistics:{name:"customLogistics"}},this.dialog=Ja):"address"===this.name&&(e={address:{readonly:!0}},this.dialog=Ya);console.log(e[this.name],this.name);var a=rt(this.dialogConfig);a.defaultValue||(a.defaultValue=this.modalValue),this.dialogProps=En(this.dialogProps,e[this.name],a)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=En(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},confirmHandle:function(e){console.log(e),["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch","confirm"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=we({},this.modalValue))},resultExchange:function(e){var t=this.componentMap[this.name],n={},a={};if(n=(a=["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)?e&&e.rows.length?e.rows[0]:null:(["person","unit","brand","tag"].includes(this.name)||["supplier","customer","supplierCustomer"].includes(this.name)||["warehouse"].includes(this.name),e.rows[0]))?we(we({},a),{},{id:a[t.key],value:a[t.value]}):{},"address"===this.name){var i="";2===a.deliveryMethod&&(i=[a.customerName||"",a.phone||"",a.fullAddress||""].join(" "),n.value=i)}"select"!==this.valueMode&&(this.$emit("input",n),this.modalValue=n,console.log(this.modalValue)),this.$emit("change",we(we({},e),{},{data:this.multiple?e.rows:a?n:null,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:we({},this.dialogProps),props:we(we({getContainer:function(){return document.querySelector("body")}},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:ft}},void 0,void 0,void 0,!1,void 0,void 0,void 0);Za.install=function(e){e.component(Za.name,Za)};const ei={name:"DNumberRange",model:{prop:"value",event:"update:value"},props:{value:{type:Array,default:function(){return[void 0,void 0]}},placeholder:{type:[String,Array],default:"请输入"}},computed:{startValue:{get:function(){return this.value&&(this.value[0]||0===this.value[0])?this.value[0]:null},set:function(e){e>this.value[1]?this.$emit("update:value",[this.startValue,this.value[1]]):this.$emit("update:value",[e,this.value[1]])}},endValue:{get:function(){return this.value&&(this.value[1]||0===this.value[1])?this.value[1]:null},set:function(e){e<this.value[0]?this.$emit("update:value",[this.value[0],this.endValue]):this.$emit("update:value",[this.value[0],e])}},startPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[0]:this.placeholder},endPlaceholder:function(){return"[object Array]"===Object.prototype.toString.call(this.placeholder)?this.placeholder[1]:this.placeholder}},methods:{resetData:function(){var e=this;this.startValue=void 0,this.$nextTick((function(){e.endValue=void 0}))}}};var ti=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-number-range"},[n("a-input-number",{staticClass:"range-number",attrs:{placeholder:e.startPlaceholder,max:9999999999,min:0},model:{value:e.startValue,callback:function(t){e.startValue=t},expression:"startValue"}}),e._v(" "),n("span",{staticClass:"range-to"},[e._v("至")]),e._v(" "),n("a-input-number",{staticClass:"range-number",attrs:{placeholder:e.endPlaceholder,max:9999999999,min:0},model:{value:e.endValue,callback:function(t){e.endValue=t},expression:"endValue"}})],1)};ti._withStripped=!0;const ni=me({render:ti,staticRenderFns:[]},void 0,ei,void 0,!1,void 0,!1,void 0,void 0,void 0);ni.install=function(e){e.component(ni.name,ni)};const ai={name:"DMoreSearch",components:{DSelectTimeRange:ye,DMixSearch:Za,DNumberRange:ni,DMixSelect:On},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"标题"},beforeClose:{type:Function,default:null},rulesList:{type:Array,default:function(){return[{type:"timeRange",label:"录单时间",field:"timeRange",placeholder:"请选择时间"},{type:"numberRange",label:"采购金额",field:"amount",placeholder:"请输入金额"},{type:"mixSearch",mixType:"handler",label:"经手人",field:"handler"},{type:"mixSearch",mixType:"preparer",label:"制单人",field:"preparer"},{type:"mixSelect",mixType:"print",label:"打印状态",field:"print"}]}}},data:function(){return{searchResult:{}}},created:function(){var e=this;this.rulesList.forEach((function(t){e.$set(e.searchResult,t.field,void 0)}))},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}}},methods:{handleOk:function(){var e=this,t={};this.rulesList.forEach((function(n){var a,i,o=e.searchResult[n.field];if("timeRange"===n.type){if(o&&(o[0]||o[1])){var s=e.timeRangeConvert(o);a=s,i=s}}else"numberRange"===n.type?(a=o,i=o):(a=o,i=[o]);o&&(t[n.field]={data:a,rows:i,config:{resultName:n.field}})})),this.beforeClose?this.beforeClose(t,(function(){e.modalVisible=!1})):(this.$emit("confirm",t),console.log(t),this.modalVisible=!1)},timeRangeConvert:function(e){return e.map((function(e){return{data:e,value:e?re.default(Number(e)).format("YYYY-MM-DD hh:mm:ss"):void 0}}))},selectChange:function(e){console.log("result:",e),e.data?this.searchResult[e.config.resultName]=e.rows:this.searchResult[e.config.resultName]=void 0},handleReset:function(){var e=this;this.rulesList.forEach((function(t){console.log("处理中：",t),e.$set(e.searchResult,t.field,void 0)})),this.resetData("all")},resetData:function(e){var t=this;"all"===e?this.rulesList.forEach((function(e){t.$refs[e.field]&&t.$refs[e.field][0]&&t.$refs[e.field][0].resetData()})):this.$refs[e]&&this.$refs[e][0]&&this.$refs[e][0].resetData()}}};var ii=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-more-search",attrs:{maskClosable:!1,keyboard:!1,title:e.title},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("a-form-model",{attrs:{"label-col":{span:6},"wrapper-col":{span:18}}},[e._l(e.rulesList,(function(t,a){return[n("a-form-item",{key:a,attrs:{label:t.label}},["timeRange"===t.type?n("d-select-time-range",{ref:t.field,refInFor:!0,attrs:{placeholder:t.placeholder,width:161},model:{value:e.searchResult[t.field],callback:function(n){e.$set(e.searchResult,t.field,n)},expression:"searchResult[item.field]"}}):"numberRange"===t.type?n("d-number-range",{ref:t.field,refInFor:!0,attrs:{placeholder:t.placeholder},model:{value:e.searchResult[t.field],callback:function(n){e.$set(e.searchResult,t.field,n)},expression:"searchResult[item.field]"}}):"mixSearch"===t.type?n("d-mix-search",{ref:t.field,refInFor:!0,attrs:{placeholder:t.placeholder,name:t.mixType,"result-name":t.mixType,width:"100%"},model:{value:e.searchResult[t.field],callback:function(n){e.$set(e.searchResult,t.field,n)},expression:"searchResult[item.field]"}}):"mixSelect"===t.type?n("d-mix-select",{ref:t.field,refInFor:!0,attrs:{placeholder:t.placeholder,type:13,"result-name":t.field,allowClear:"",width:"100%"},on:{change:e.selectChange}}):e._e()],1)]}))],2),e._v(" "),n("template",{slot:"footer"},[n("a-button",{staticClass:"reset",attrs:{type:"link"},on:{click:e.handleReset}},[e._v(" 清空 ")]),e._v(" "),n("a-button",{key:"back",on:{click:function(t){e.modalVisible=!1}}},[e._v(" 取消 ")]),e._v(" "),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定 ")])],1)],2)};ii._withStripped=!0;const oi=me({render:ii,staticRenderFns:[]},void 0,ai,void 0,!1,void 0,!1,void 0,void 0,void 0);return oi.install=function(e){e.component(oi.name,oi)},oi}))},b1d8:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("b64b"),n("d81d"),n("159b"),n("caad"),n("2532"),n("2ca0"),n("7db0"),n("a434"),n("7edb"),n("aa47"),n("2b0e"),n("fb19"),n("73c8"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p){"use strict";function f(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=f(c),g=f(u),v=f(d),y=f(h);function b(){return b=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},b.apply(this,arguments)}var k=["attrs","props","domProps"],w=["class","style","directives"],C=["on","nativeOn"],_=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},S=function(e){return e.reduce((function(e,t){for(var n in t)if(e[n])if(-1!==k.indexOf(n))e[n]=b({},e[n],t[n]);else if(-1!==w.indexOf(n)){var a=e[n]instanceof Array?e[n]:[e[n]],i=t[n]instanceof Array?t[n]:[t[n]];e[n]=a.concat(i)}else if(-1!==C.indexOf(n))for(var o in t[n])if(e[n][o]){var s=e[n][o]instanceof Array?e[n][o]:[e[n][o]],r=t[n][o]instanceof Array?t[n][o]:[t[n][o]];e[n][o]=s.concat(r)}else e[n][o]=t[n][o];else if("hook"==n)for(var l in t[n])e[n][l]=e[n][l]?_(e[n][l],t[n][l]):t[n][l];else e[n]=t[n];else e[n]=t[n];return e}),{})};function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=m.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function T(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}var L=["key"],$={},I={name:"STable",props:{dragOption:{type:Object,default:function(){return{}}},draggable:Boolean,draggableOption:{type:Object,default:function(){return{minWidth:100,maxWidth:560}}},sortList:{type:Array,default:null},sortConfig:{type:Object,default:function(){return{}}},cellWidth:{type:Object,default:void 0},excludeWidth:{type:Array,default:function(){return[]}}},data:function(){return{components:null,columns:[],hash:""}},computed:{actSortConfig:function(){return O({unshift:["index"],push:[],key:"key"},this.sortConfig)}},created:function(){this.components={header:{cell:this.resizeableTitle}}},mounted:function(){this.columns=this.sortColumns(),Object.keys(this.dragOption).length&&this.initSortable()},render:function(){var e=this,t=arguments[0],n=this.$attrs,a=this.sortColumns(),i={on:O({},this.$listeners)};return t("a-table",S([{},{props:O(O({},n),{},{columns:a}),scopedSlots:O({},this.$scopedSlots)},{attrs:{components:this.components}},i,{ref:"tableSort"}]),[Object.keys(this.$slots).map((function(n){return"default"!==n?t("template",{slot:n},[e.$slots[n]]):null}))])},components:{"vue-draggable-resizable":y.default},methods:{sortColumns:function(){var e=this,t=this.$attrs.columns?this.updateColumns(this.$attrs.columns):this.generateColumns(this.$slots.default);if(this.sortList&&this.sortList.length){var n={},a=[];t.forEach((function(e){e.key&&(n[e.key]=e)})),this.sortList.forEach((function(t){!n[t[e.actSortConfig.key]]||e.actSortConfig.unshift.includes(t[e.actSortConfig.key])||e.actSortConfig.push.includes(t[e.actSortConfig.key])||a.push(n[t[e.actSortConfig.key]])}));for(var i=this.actSortConfig.unshift.length-1;i>=0;i--)this.actSortConfig.unshift[i]&&n[this.actSortConfig.unshift[i]]&&a.unshift(n[this.actSortConfig.unshift[i]]);for(var o=this.actSortConfig.push.length-1;o>=0;o--)this.actSortConfig.push[o]&&n[this.actSortConfig.push[o]]&&a.push(n[this.actSortConfig.push[o]]);return a}return t},generateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return t.forEach((function(t){if(t.tag){var a=p.getKey(t),i=p.getStyle(t),o=p.getClass(t),s=p.getOptionProps(t),r=p.getEvents(t),l={};Object.keys(r).forEach((function(e){var t=void 0;t=e.startsWith("update:")?"on-"+e.substr("update:".length)+"-change":"on-"+e,l[p.camelize(t)]=r[e]}));var c=p.getSlots(t),u=c.default,d=T(c,["default"]),h=V({},d,s,{style:i,class:o},l);if(a&&(h.key=a),p.getSlotOptions(t).__ANT_TABLE_COLUMN_GROUP)h.children=e.generateColumns("function"==typeof u?u():u);else{var f=t.data&&t.data.scopedSlots&&t.data.scopedSlots.default;h.customRender=h.customRender||f}n.push(h)}})),n},updateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],a=this.$slots,i=this.$scopedSlots;return t.forEach((function(t){var o=t.slots,s=void 0===o?{}:o,r=t.scopedSlots,l=void 0===r?{}:r,c=T(t,["slots","scopedSlots"]),u=V({},c);Object.keys(s).forEach((function(e){var t=s[e];void 0===u[e]&&a[t]&&(u[e]=1===a[t].length?a[t][0]:a[t])})),Object.keys(l).forEach((function(e){var t=l[e];void 0===u[e]&&i[t]&&(u[e]=i[t])})),t.children&&(u.children=e.updateColumns(u.children)),n.push(u)})),n},generateSlot:function(){},resizeableTitle:function(e,t,n){var a=this,i=this.columns;i.forEach((function(e){$[e.key]=e.width||0}));var o=v.default.observable($),s=null,r=t.key,l=D(t,L),c={};if(!(c="selection-column"===r?{dataIndex:"selection-column",key:"selection-column",width:40}:i.find((function(e){return(e.dataIndex||e.key)===r})))||!c.width||"selection-column"===r||this.excludeWidth.includes(r))return c&&c.width?e("th",S([{attrs:{width:c.width}},l]),[n]):e("th",S([{},l]),[n]);var u=this.draggableOption,d=u.maxWidth,h=u.minWidth;return e("th",S([{},l,{directives:[{name:"ant-ref",value:function(e){return s=e}}],attrs:{width:c.width},style:{position:"relative"}}]),[n,e(y.default,{key:c.key,class:"table-draggable-handle",attrs:{w:10,x:o[r]||c.width,z:1,axis:"x",draggable:this.draggable,resizable:!1},on:{dragging:function(e){if(o[r]=0,c.width=Math.max(h,Math.min(e,d)),a.cellWidth){var t=O(O({},a.cellWidth),{},x({},c.key,c.width));a.$emit("update:cellWidth",O({},t))}},dragstop:function(){o[r]=s.getBoundingClientRect().width}},style:{height:"100% !important",bottom:0,left:"auto !important",right:"-5px",cursor:this.draggable?"col-resize":"default","touch-action":"none",transform:"none !important",position:"absolute"}})])},initSortable:function(){var e=this,t=this.$refs.tableSort.$el.querySelectorAll("tbody"),n=Object.assign({},this.dragOption);g.default.create(t[t.length>1?1:0],O(O({handle:".ant-table-row",animation:150},n),{},{onUpdate:function(t){var n=e.$attrs["data-source"],a=t.oldIndex,i=t.newIndex,o=n.splice(a,1)[0];n.splice(i,0,o),e.$emit("onUpdate",{dataSource:n,evt:t})},onStart:function(t){e.$emit("onStart",t)},onAdd:function(t){e.$emit("onAdd",t)},onRemove:function(t){e.$emit("onRemove",t)},onChoose:function(t){e.$emit("onChoose",t)},onEnd:function(t){e.$emit("onEnd",t)},onFilter:function(t){e.$emit("onFilter",t)},onMove:function(t){e.$emit("onMove",t)}}))},changeHandler:function(e){this.$emit("change",e)},refresh:function(e){console.log("refresh"),this.$attrs.columns||this.$forceUpdate()}},install:function(e){e.component(I.name,I)}};return I}))},bb2f:function(e,t,n){var a=n("d039");e.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bc9b:function(e,t,n){},c740:function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").findIndex,o=n("44d2"),s="findIndex",r=!0;s in[]&&Array(1)[s]((function(){r=!1})),a({target:"Array",proto:!0,forced:r},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},d3e0:function(e,t,n){"use strict";n("bc9b")},d81d:function(e,t,n){"use strict";var a=n("23e7"),i=n("b727").map,o=n("1dde"),s=o("map");a({target:"Array",proto:!0,forced:!s},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},d86b:function(e,t,n){var a=n("d039");e.exports=a((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},f183:function(e,t,n){var a=n("23e7"),i=n("e330"),o=n("d012"),s=n("861d"),r=n("1a2d"),l=n("9bf2").f,c=n("241c"),u=n("057f"),d=n("4fad"),h=n("90e3"),p=n("bb2f"),f=!1,m=h("meta"),g=0,v=function(e){l(e,m,{value:{objectID:"O"+g++,weakData:{}}})},y=function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,m)){if(!d(e))return"F";if(!t)return"E";v(e)}return e[m].objectID},b=function(e,t){if(!r(e,m)){if(!d(e))return!0;if(!t)return!1;v(e)}return e[m].weakData},k=function(e){return p&&f&&d(e)&&!r(e,m)&&v(e),e},w=function(){C.enable=function(){},f=!0;var e=c.f,t=i([].splice),n={};n[m]=1,e(n).length&&(c.f=function(n){for(var a=e(n),i=0,o=a.length;i<o;i++)if(a[i]===m){t(a,i,1);break}return a},a({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},C=e.exports={enable:w,fastKey:y,getWeakData:b,onFreeze:k};o[m]=!0},f1a2:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"integral-view"},[n("d-operation-box",{on:{delete:e.searchResultDeal,optionClick:e.operationClick},model:{value:e.selectList,callback:function(t){e.selectList=t},expression:"selectList"}},[n("d-input-search",{ref:"keywordsO",staticClass:"margin-right-16 redemption",attrs:{"max-length":40,placeholder:"请输入积分兑换单号",width:264,resultName:"keywords",allowClear:""},on:{search:e.searchResultDeal}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索 ")])],1),n("d-mix-search",{ref:"customerO",staticClass:"margin-right-16",attrs:{name:"address",placeholder:"客户",resultName:"customer",width:120},on:{change:e.searchResultDeal}}),n("d-mix-search",{ref:"productO",staticClass:"margin-right-16",attrs:{name:"product",placeholder:"商品",resultName:"product",width:120,"dialog-config":{rules:{type:6}}},on:{change:e.searchResultDeal}}),n("d-mix-select",{ref:"billStatusO",attrs:{type:8,allowClear:"",resultName:"billStatus",width:120},on:{change:e.searchResultDeal}})],1),n("s-table",{staticClass:"a-table-common",attrs:{"data-source":e.tableData,rowSelection:e.rowSelection,rowKey:e.selectionContent.primaryKey,selectOnIndeterminate:e.selectOnIndeterminate,pagination:e.pagination,scroll:{x:1300,y:"calc(100vh - "+e.calcHeight+"px)",scrollToFirstRowOnChange:!0}},on:{change:e.tableChange},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",{staticClass:"footer"},[n("div",{staticClass:"footer-he"},[e._v("合计")]),n("div",{staticClass:"footer-ji"},[e._v("12551223积分")])])]},proxy:!0}])},[n("a-table-column",{key:"index",staticClass:"center-text",attrs:{width:82,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t,n,a){return[e._v(" "+e._s((e.pagination.current-1)*e.pagination.pageSize+a+1)+" ")]}}])}),n("a-table-column",{key:"keywords",staticClass:"order-no",attrs:{"data-index":"number",title:"单号",sorter:!0},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"keywordsH",attrs:{name:"input",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}}])}),n("a-table-column",{key:"time",attrs:{"data-index":"time",title:"兑换时间"},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"timeH",attrs:{name:"range",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}}])}),n("a-table-column",{key:"customer",attrs:{"data-index":"customer",title:"客户",sorter:!0,"filter-dropdown-visible":e.filterDropdownVisible.customer},on:{"update:filterDropdownVisible":function(t){return e.$set(e.filterDropdownVisible,"customer",t)},"update:filter-dropdown-visible":function(t){return e.$set(e.filterDropdownVisible,"customer",t)}},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"customer",attrs:{name:"customer",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r},visible:e.filterDropdownVisible.customer},on:{confirm:e.searchResultDeal,"update:visible":function(t){return e.$set(e.filterDropdownVisible,"customer",t)}}})}}])}),n("a-table-column",{key:"exchangeScore",staticClass:"redeem",attrs:{"data-index":"exchangeScore",title:"兑换积分",sorter:!0}}),n("a-table-column",{key:"billStatus",attrs:{"data-index":"billStatus",title:"单据状态",sorter:!0},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"billStatusH",attrs:{name:"bill",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}}])}),n("a-table-column",{key:"user",attrs:{"data-index":"user",title:"兑换人"}}),n("a-table-column",{key:"handler",attrs:{"data-index":"handler",title:"经手人","filter-dropdown-visible":e.filterDropdownVisible.handler},on:{"update:filterDropdownVisible":function(t){return e.$set(e.filterDropdownVisible,"handler",t)},"update:filter-dropdown-visible":function(t){return e.$set(e.filterDropdownVisible,"handler",t)}},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"handlerH",attrs:{name:"handler",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}}])}),n("a-table-column",{key:"businessManager",attrs:{"data-index":"businessManager",title:"业务经理"},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"businessManager",attrs:{name:"handler",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}}])}),n("a-table-column",{key:"syncStatus",attrs:{"data-index":"syncStatus",title:"同步状态"},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var a=t.setSelectedKeys,i=t.selectedKeys,o=t.confirm,s=t.clearFilters,r=t.column;return n("d-filter-dropdown",{ref:"syncStatusH",attrs:{name:"input",data:{setSelectedKeys:a,selectedKeys:i,confirm:o,clearFilters:s,column:r}},on:{confirm:e.searchResultDeal}})}},{key:"default",fn:function(t){return[n("div",{staticClass:"sync"},[n("div",{class:1==t?"sync-yuan":2==t?"sync-yuan1":"sync-yuan2"}),n("span",{staticClass:"sync-text"},[e._v(e._s(1==t?"未同步":2==t?"ERP草稿":3==t?"ERP删除":"同步失败"))]),n("icon-font-box",{staticClass:"icon-5",attrs:{type:"icontishi",size:"14",height:"14"}})],1)]}}])}),n("a-table-column",{key:"action",attrs:{title:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a-button",{staticClass:"details"},[e._v(" 详情 ")]),n("a-button",{staticClass:"print"},[e._v(" 打印 ")]),n("a-button",{staticClass:"cancel"},[e._v(" 取消 ")])]}}])})],1),n("d-more-search",{ref:"moreSearch",attrs:{visible:e.moreVisible,rulesList:[{type:"timeRange",label:"录单时间",field:"timeRange",placeholder:"请选择时间"},{type:"numberRange",label:"采购金额",field:"amount",placeholder:"请输入金额"},{type:"mixSearch",mixType:"handler",label:"经手人",field:"handler"},{type:"mixSearch",mixType:"preparer",label:"制单人",field:"preparer"},{type:"mixSelect",mixType:"print",label:"打印状态",field:"print"}]},on:{"update:visible":function(t){e.moreVisible=t},confirm:e.moreSearchResultDeal}})],1)},i=[],o=n("5530"),s=n("1e20"),r=n.n(s),l=n("58e8"),c=n.n(l),u=n("ab26"),d=n.n(u),h=n("b020"),p=n.n(h),f=n("ac08"),m=n.n(f),g=n("b1d8"),v=n.n(g),y=n("9a50"),b=n.n(y),k=n("6968"),w=n.n(k),C=n("f9f1"),_=n.n(C),S=n("9072"),x=n.n(S),D=(n("b64b"),n("99af"),n("b0c0"),{name:"IntegralIndex",components:{DOperationBox:x.a,DMixSearch:_.a,DMixSelect:w.a,IconFontBox:b.a,STable:v.a,DFilterDropdown:m.a,DMoreSearch:p.a,DInputSearch:d.a},mixins:[c.a,r.a],provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},data:function(){return{searchResult:{keywords:void 0,number:void 0,sort:void 0,customer:void 0,product:void 0,billStatus:void 0,startTime:void 0,endTime:void 0,handler:void 0,amount:void 0,preparer:void 0},tableLoading:!1,selectConfig:{keywords:{cn:["单号"],en:["keywords"]},time:{cn:["时间"],en:["startTime","endTime"],link:["开始","至","结束"],dataKey:"value",valueKey:"data"},customer:{cn:["客户"],en:["customer"],dataKey:"name",valueKey:"businessId",dataTarget:"rows",valueTarget:"rows"},product:{cn:["商品"],en:["product"],dataKey:"name",valueKey:"id"},billStatus:{cn:["单据状态"],en:["billStatus"],dataKey:"name",valueKey:"id",dataTarget:"rows",valueTarget:"rows"},handler:{cn:["经手人"],en:["handler"],dataKey:"name",valueKey:"stafferId"},preparer:{cn:["制单人"],en:["preparer"],dataKey:"name",valueKey:"stafferId"},amount:{cn:["金额"],en:["amount1","amount2"],link:["开始","至","结束"],linkMode:"after"}},filterSortConfig:{number:1},filterDropdownVisible:{handler:!1,customer:!1},moreVisible:!1,searchValue:""}},created:function(){this.selectionContent.primaryKey="id",this.loadTableData()},computed:{calcHeight:function(){return Object.keys(this.selectList).length?392:344}},methods:{loadTableData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;console.log("检索条件：",this.searchResult),this.tableLoading=!0,this.tableData=[];for(var t=0;t<e.pageSize;t++)this.tableData.push({id:"".concat(t).concat(e.current).concat(e.pageSize),key:"".concat(t).concat(e.current).concat(e.pageSize),number:"JF-20210705-0001",time:"2020/09/22 23:45",customer:"书亦烧仙草(环球中心店)",exchangeScore:"1280积分",billStatus:"已完成",user:"徐永松",handler:"徐永松2",businessManager:"徐永松3",syncStatus:t%3});console.log("page",e),this.dealSelectionCheckBox(),this.pagination.current=e.current,this.pagination.total=400,this.tableLoading=!1},operationClick:function(e){console.log(e),"more"===e.key&&(this.moreVisible=!0),"clear"===e.key&&this.handleSelectedClear()},beforeSearchChange:function(e){return"number"!==e.name||(this.searchValue="",!0)},onSearch:function(e){this.searchResult.number=e,this.selectList=Object(o["a"])(Object(o["a"])({},this.selectList),{},{number:{label:"单号",value:e,key:"number"}}),this.$refs["numberH"]&&this.$refs["numberH"].resetData()},changeHandle:function(){}}}),R=D,O=(n("d3e0"),n("2877")),V=Object(O["a"])(R,a,i,!1,null,"17da038d",null);t["default"]=V.exports},f9f1:function(e,t,n){!function(t,a){e.exports=a(n("b0c0"),n("a9e3"),n("d3b7"),n("b64b"),n("caad"),n("a15b"),n("159b"),n("ac1f"),n("1276"),n("5319"),n("466d"),n("fb6a"),n("2b0e"),n("fd87"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("4de4"),n("d81d"),n("99af"),n("2532"),n("a434"),n("cfba"),n("07ac"),n("b680"),n("50f6"),n("3177"),n("2ca0"),n("7db0"),n("7edb"),n("aa47"),n("fb19"),n("73c8"),n("04b3"),n("4e82"),n("9911"),n("e439"),n("90b7"),n("7569"),n("25f0"),n("498a"),n("4ec9"),n("3ca3"),n("ddb0"),n("c740"))}(0,(function(e,t,n,a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x,D,R,O,V,T,L,$,I,F,M,P,N,E,A,j,B,K,H,z,q,Y,W,G,U,X,J,Q,Z,ee,te,ne,ae,ie){"use strict";function oe(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var se=oe(h),re=oe(K),le=oe(q),ce=oe(Y),ue=oe(U),de=oe(X),he=oe(J);function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n,a,i,o,s){try{var r=e[o](s),l=r.value}catch(e){return void n(e)}r.done?t(l):Promise.resolve(l).then(a,i)}function ve(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){ge(o,a,i,s,r,"next",e)}function r(e){ge(o,a,i,s,r,"throw",e)}s(void 0)}))}}var ye=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,a=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new O(a||[]);return o._invoke=function(e,t,n){var a=d;return function(i,o){if(a===p)throw new Error("Generator is already running");if(a===f){if("throw"===i)throw o;return T()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var r=x(s,n);if(r){if(r===m)continue;return r}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var l=u(e,t,n);if("normal"===l.type){if(a=n.done?f:h,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=f,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",m={};function g(){}function v(){}function y(){}var b={};l(b,o,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(V([])));w&&w!==n&&a.call(w,o)&&(b=w);var C=y.prototype=g.prototype=Object.create(b);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,s,r){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&a.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,r)}),(function(e){n("throw",e,s,r)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,r)}))}r(l.arg)}var i;this._invoke=function(e,a){function o(){return new t((function(t,i){n(e,a,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,n){var a=e.iterator[n.method];if(a===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=u(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function V(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(a.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:T}}function T(){return{value:t,done:!0}}return v.prototype=y,l(C,"constructor",y),l(y,"constructor",v),v.displayName=l(y,r,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,r,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},_(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,i,o){void 0===o&&(o=Promise);var s=new S(c(t,n,a,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(C),l(C,r,"Generator"),l(C,o,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=V,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(a,i){return r.type="throw",r.arg=e,n.next=a,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],r=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:V(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),be=ye,ke="/gateway/saas-platform-service/api/v1/",we="/gateway/goodsservice/api/v1/",Ce="/gateway/customer-service/api/v1/",_e="/gateway/logisticsservice/api/v1/",Se={province:"".concat(ke,"address/province"),city:"".concat(ke,"address/city"),district:"".concat(ke,"address/district")},xe="".concat(ke,"address/get_by_name"),De="".concat(we,"goods/custom/list"),Re="".concat(Ce,"order/get_region_list"),Oe="".concat(Ce,"order/get_customer_list"),Ve="".concat(Ce,"order/get_customer_type_list"),Te="".concat(we,"setting/query_goods_attr_setting_list"),Le="".concat(we,"price_system/leve_price_name/select_list"),$e="".concat(we,"/category/get_category_list_with_nocategory_qty"),Ie="".concat(we,"setting/query_goods_attr_setting_list"),Fe="".concat(we,"warehouse/list"),Me="".concat(we,"goods/get_sku_unit_list"),Pe="".concat(ke,"staffer/get_corp_all"),Ne="".concat(we,"category/get_category_list"),Ee="".concat(we,"warehouse/get_warehouse_by_corp_id"),Ae="".concat(we,"price_system/leve_price/select_list"),je="".concat(ke,"department/get_corp_tree"),Be="".concat(ke,"staffer/list"),Ke="".concat("/gateway/billservice/api/v1/","account/check_list"),He="".concat(_e,"deliveryMethod/list"),ze="".concat(_e,"deliveryMethod/list"),qe="".concat(_e,"logisticsCorp/custom/list"),Ye="".concat(_e,"logisticsCorp/system/list"),We="".concat(_e,"logisticsCorp/custom/list"),Ge="".concat(Ce,"order/get_deliverys"),Ue="".concat(Ce,"order/add_delivery"),Xe="".concat(Ce,"order/update_delivery"),Je="".concat(Ce,"order/delete_delivery"),Qe="".concat(Ce,"order/set_default_delivery");function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function et(e){var t=!1;return function(){for(var n=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];t||(t=!0,window.requestAnimationFrame((function(){e.apply(n,i),t=!1})))}}function tt(e){if(!e&&"object"!==Ze(e))throw new Error("error arguments","deepClone");var t=e.constructor===Array?[]:{};return Object.keys(e).forEach((function(n){e[n]&&"object"===Ze(e[n])?t[n]=tt(e[n]):t[n]=e[n]})),t}"object"!==("undefined"==typeof Int8Array?"undefined":Ze(Int8Array))&&(se.default.prototype.$isServer||document.childNodes);var nt=function(e){return!e||"{}"===JSON.stringify(e)||"[]"===JSON.stringify(e)||!e},at=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&""!==e[n]&&null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return t};function it(e){for(var t=1,n=arguments.length;t<n;t++){var a=arguments[t]||{};for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];void 0!==o&&(e[i]=o)}}return e}var ot={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return ve(be.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m,g,v,y,b,k,w,C,_,S,x;return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get(De,it({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(Pe,t.dialogConfig.rules);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=138;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(Fe,me(me({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Oe,me(me({pageNum:1,pageSize:30},a),t.dialogConfig.rules));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Ie,me({type:["unit","brand","tag"].indexOf(t.name)},t.dialogConfig.rules));case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=138;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(Me,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=138;break;case 71:if(!["account"].includes(t.name)){n.next=84;break}if(!t.localDataCache){n.next=76;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 76:return n.next=78,t.$get(Ke,me({accountType:t.dialogConfig.payType||1,customerId:t.dialogConfig.customerId},t.dialogConfig.rules));case 78:return g=n.sent,v=g.data,t.localDataCache=v,n.abrupt("return",v);case 82:n.next=138;break;case 84:if("delivery"!==t.name){n.next=97;break}if(!t.localDataCache){n.next=89;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 89:return n.next=91,t.$get(He,t.dialogConfig.rules);case 91:return y=n.sent,b=y.data,t.localDataCache=b,n.abrupt("return",b);case 95:n.next=138;break;case 97:if("logistics"!==t.name){n.next=110;break}if(!t.localDataCache){n.next=102;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 102:return n.next=104,t.$get(Ye,t.dialogConfig.rules);case 104:return k=n.sent,w=k.data,t.localDataCache=w,n.abrupt("return",w);case 108:n.next=138;break;case 110:if("customLogistics"!==t.name){n.next=123;break}if(!t.localDataCache){n.next=115;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 115:return n.next=117,t.$get(We,t.dialogConfig.rules);case 117:return C=n.sent,_=C.data,t.localDataCache=_,n.abrupt("return",_);case 121:n.next=138;break;case 123:if("address"!==t.name){n.next=137;break}if(t.replaceFields={key:"businessId",name:"deliveryName"},!t.localDataCache){n.next=129;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 129:return n.next=131,t.$post(Ge,{businessId:t.dialogConfig.customerId});case 131:return S=n.sent,x=S.data,t.localDataCache=x,n.abrupt("return",x);case 135:n.next=138;break;case 137:console.log("未知的 name:",t.name);case 138:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch","click")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},handleInputClick:function(){this.dialogConfig.readonly&&this.clickHandle()},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch","enter")||this.dialogFocus||(this.dialogFocus=!0,this.inputValue?this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1,e.matchingData("enter")})).catch((function(){e.loading=!1})).finally((function(){setTimeout((function(){e.dialogFocus=!1}),300)})):(this.dataList=[],this.loading=!1,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300)))},matchingData:function(e){var t=this,n=function(){var n=null,a=nt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var e=nt(this.value);this.inputValue=e?this.value.name||this.value.value:""}},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(nt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch","focus")},focus:function(){this.$refs.mixSearchInput.focus()}}};function st(e,t,n,a,i,o,s,r,l,c){"boolean"!=typeof s&&(l=r,r=s,s=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),a&&(u._scopeId=a),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=d):t&&(d=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}const rt=ot;var lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue,readOnly:e.dialogConfig.readonly},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle,click:e.handleInputClick},scopedSlots:e._u([{key:"suffix",fn:function(){return[n("a-button",{attrs:{type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle}})]},proxy:!0}]),model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})};lt._withStripped=!0;const ct=st({render:lt,staticRenderFns:[]},void 0,rt,"data-v-f165b002",!1,void 0,!1,void 0,void 0,void 0);function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function dt(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ht={data:function(){var e=this;return{tableData:[],selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"},pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(t){return"总".concat(t,"条，每页显示").concat(e.pagination.pageSize,"条")}},selectionConfig:{selections:!0},tableSelection:{onChange:null,onSelect:null,onSelectAll:null,onSelectInvert:null,currentPage:null,allPage:null},resultMap:{},searchResult:{}}},computed:{selectOnIndeterminate:function(){return"allPage"===this.selectionContent.selectType&&!!this.selectionContent.noSelectedRowKeys.length&&!!this.selectionContent.selectedRowKeys.length},hasOverSelectionLimit:function(){return this.selectionLimit&&this.selectionContent.selectedRowKeys.length>=this.selectionLimit},rowSelection:function(){var e=this,t=this;return me(me({},t.selectionContent.rowSelection),{},{selectedRowKeys:t.selectionContent.selectedRowKeys,onChange:function(e,n){var a;console.log("onChange selectedRowKeys",e),console.log("onChange selectedRows",n);var i=t.selectionContent.primaryKey;if("allPage"===t.selectionContent.selectType&&!e.length)return t.selectionContent.selectType="",void t.handleSelectedClear();if(t.selectionLimit&&e.length>t.selectionLimit)t.$message.warning("最多选择".concat(t.selectionLimit,"条"));else{t.selectionContent.selectedRowKeys=e;var o=t.selectionContent.noSelectedRows,s=t.selectionContent.selectedRows,r=!1;t.tableData.forEach((function(n){e.includes(n[i])?("allPage"===t.selectionContent.selectType&&(r=!0,delete o[n[i]]),s[n[i]]=n):("allPage"===t.selectionContent.selectType&&(r=!0,o[n[i]]=n),delete s[n[i]])})),t.selectionContent.noSelectedRows=o,t.selectionContent.selectedRows=s,"allPage"===t.selectionContent.selectType&&r&&t._generateNoSelectKey();for(var l=arguments.length,c=new Array(l>2?l-2:0),u=2;u<l;u++)c[u-2]=arguments[u];t.tableSelection.onChange&&(a=t.tableSelection).onChange.apply(a,[e,n].concat(c))}},onSelect:function(e,n,a,i){t.tableSelection.onSelect&&t.tableSelection.onSelect(e,n,a,i)},onSelectAll:function(e,n,a){t.tableSelection.onSelectAll&&t.tableSelection.onSelectAll(e,n,a)},onSelectInvert:function(e){t.tableSelection.onSelectInvert&&t.tableSelection.onSelectInvert(e)},hideDefaultSelections:!0,selections:!!t.selectionConfig.selections&&[{key:"currentPage",text:"当前页",onSelect:function(n){"allPage"===t.selectionContent.selectType&&t.handleSelectedClear(),t.selectionContent.selectType="currentPage";var a=t.selectionContent.primaryKey,i=[],o=[];t.tableData.forEach((function(e){t.selectionContent.selectedRowKeys.includes(e[a])?i.push(e):o.push(e)}));var s=e.selectionContent.selectedRows;if((i.length&&o.length||!i.length)&&o.forEach((function(e){s[e[a]]=e})),!o.length){var r=t.selectionContent.selectedRows;i.forEach((function(e){delete r[e[a]]}))}t.selectionContent.selectedRows=s,t._generateKey()}},{key:"allPage",text:"所有页",onSelect:function(e){if("allPage"===t.selectionContent.selectType&&(t.selectionContent.selectedRowKeys.length||t.selectionContent.noSelectedRowKeys.length))t.handleSelectedClear();else{t.selectionContent.selectType="allPage";var n=t.selectionContent.primaryKey;t.tableData.forEach((function(e){t.selectionContent.selectedRows[e[n]]=e}))}t._generateKey()}}]})}},methods:{setPagination:function(e){this.pagination=me({total:0,pageSize:10,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["5","10","20"],showTotal:function(e){return"总".concat(e,"条")}},e)},setRowSelection:function(e){this.selectionContent.rowSelection=e},dealSelectionCheckBox:function(){var e=this;"allPage"===this.selectionContent.selectType&&(this.tableData.forEach((function(t){try{e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]||e.selectionContent.noSelectedRows[t[e.selectionContent.primaryKey]]||(e.selectionContent.selectedRows[t[e.selectionContent.primaryKey]]=t)}catch(e){console.log(e)}})),this._generateKey())},_generateKey:function(){var e=[];for(var t in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.selectedRowKeys=e},_generateNoSelectKey:function(){var e=[];for(var t in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(t)&&e.push(t);this.selectionContent.noSelectedRowKeys=e},handleSelectedClear:function(){return this.selectionContent.selectedRowKeys=[],this.selectionContent.selectedRows={},this.selectionContent.noSelectedRowKeys=[],this.selectionContent.noSelectedRows=[],this.selectionContent.selectType="",this},getRowData:function(e){var t=[];if(e)for(var n in this.selectionContent.noSelectedRows)this.selectionContent.noSelectedRows.hasOwnProperty(n)&&t.push(this.selectionContent.noSelectedRows[n]);else for(var a in this.selectionContent.selectedRows)this.selectionContent.selectedRows.hasOwnProperty(a)&&t.push(this.selectionContent.selectedRows[a]);return t},setTableSelectType:function(e){this.selectionContent.selectType=e,this.handleSelectedClear()},setSelectRows:function(e){var t=this;e.forEach((function(e){t.selectionContent.selectedRows[e[t.selectionContent.primaryKey]]=e}))},setSelectionStatus:function(e){this.selectionConfig.selections=e},rowClick:function(e){var t=this;if(console.log("单击",e),this.multiple)if(this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key]))this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]];else{if(this.hasOverSelectionLimit)return void this.$message.warning("最多选择".concat(this.selectionLimit,"条"));this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e}else this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=pe({},e[this.baseReplaceFields.key],e)},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||this.hasOverSelectionLimit||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.handleOk&&this.handleOk()},dealResult:function(){var e=this;if(this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t];"object"===Ze(n)?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}return this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=me(me({},e.selectionContent.selectedRows),{},pe({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=pe({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this}}};const pt={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:re.default},methods:{handleClick:function(){this.$emit("click")}}};var ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[n("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};ft._withStripped=!0;const mt=st({render:ft,staticRenderFns:[]},void 0,pt,void 0,!1,void 0,!1,void 0,void 0,void 0);var gt=se.default.prototype.$isServer,vt=!gt&&document.addEventListener?function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}:function(e,t,n){e&&t&&n&&e.attachEvent("on"+t,n)},yt=!gt&&document.removeEventListener?function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)}:function(e,t,n){e&&t&&e.detachEvent("on"+t,n)};se.default.use(le.default);var bt={CONTAIN:{name:"contain",icon:"fullscreen"},ORIGINAL:{name:"original",icon:"fullscreen-exit"}},kt=!se.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",wt={name:"hImageViewer",props:{host:{type:String},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},showDown:{type:Boolean,default:!0},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},prefix:{type:[Boolean,String],default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!0,mode:bt.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},baseUrlList:[]}},computed:{picList:function(){var e=this;return this.urlList.filter((function(t,n){return n===e.index}))},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.baseUrlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,n=e.deg,a=e.offsetX,i=e.offsetY,o=e.enableTransition,s={transform:"scale(".concat(t,") rotate(").concat(n,"deg)"),transition:o?"transform .3s":"","margin-left":"".concat(a,"px"),"margin-top":"".concat(i,"px")};return this.mode===bt.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(){var e=this;this.$nextTick((function(){e.$refs.img[0].complete||(e.loading=!0)}))},urlList:{handler:function(){this.exchangeImage()},deep:!0}},methods:{exchangeImage:function(){var e=this.prefix,t=this.baseUrlList,n="";"string"==typeof e?n=e:e&&(n=this.host);for(var a=0;a<this.urlList.length;a++){var i=this.urlList[a];if(/(http|https):\/\//.test(i))t.push(i);else{var o=i.indexOf("/")>0?"/":"";t.push("".concat(n).concat(o?"/":"").concat(i))}}},hide:function(){this.deviceSupportUninstall(),this.onClose()},download:function(){this.$emit("download",this.currentImg)},deviceSupportInstall:function(){var e=this;this._keyDownHandler=et((function(t){switch(t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}})),this._mouseWheelHandler=et((function(t){(t.wheelDelta?t.wheelDelta:-t.detail)>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),vt(document,"keydown",this._keyDownHandler),vt(document,kt,this._mouseWheelHandler)},deviceSupportUninstall:function(){yt(document,"keydown",this._keyDownHandler),yt(document,kt,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var n=this.transform,a=n.offsetX,i=n.offsetY,o=e.pageX,s=e.pageY;this._dragHandler=et((function(e){t.transform.offsetX=a+e.pageX-o,t.transform.offsetY=i+e.pageY-s})),vt(document,"mousemove",this._dragHandler),vt(document,"mouseup",(function(){yt(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(bt),t=(Object.values(bt).indexOf(this.mode)+1)%e.length;this.mode=bt[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var n=me({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),a=n.zoomRate,i=n.rotateDeg,o=n.enableTransition,s=this.transform;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-a).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+a).toFixed(3));break;case"clocelise":s.deg+=i;break;case"anticlocelise":s.deg-=i}s.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["h-image-viewer__wrapper"].focus(),this.exchangeImage()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}};const Ct=wt;var _t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"viewer-fade"}},[n("div",{ref:"h-image-viewer__wrapper",staticClass:"h-image-viewer__wrapper",style:{"z-index":e.zIndex},attrs:{tabindex:"-1"}},[n("div",{staticClass:"h-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick(t)}}}),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__close",on:{click:e.hide}},[n("a-icon",{attrs:{type:"close"}})],1),e._v(" "),e.isSingle?e._e():[n("span",{staticClass:"h-image-viewer__btn h-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[n("a-icon",{attrs:{type:"arrow-left"}})],1),e._v(" "),n("span",{staticClass:"h-image-viewer__btn h-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[n("a-icon",{attrs:{type:"arrow-right"}})],1)],e._v(" "),n("div",{staticClass:"h-image-viewer__btn h-image-viewer__actions"},[n("div",{staticClass:"h-image-viewer__actions__inner"},[n("a-icon",{attrs:{type:"zoom-out"},on:{click:function(t){return e.handleActions("zoomOut")}}}),e._v(" "),n("a-icon",{attrs:{type:"zoom-in"},on:{click:function(t){return e.handleActions("zoomIn")}}}),e._v(" "),n("a-icon",{attrs:{type:"undo"},on:{click:function(t){return e.handleActions("anticlocelise")}}}),e._v(" "),n("a-icon",{attrs:{type:"redo"},on:{click:function(t){return e.handleActions("clocelise")}}}),e._v(" "),e.showDown?n("a-icon",{attrs:{type:"download"},on:{click:e.download}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"h-image-viewer__canvas"},[e._l(e.picList,(function(t){return n("img",{key:t,ref:"img",refInFor:!0,staticClass:"h-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}})})),e._v(" "),e.loading?n("a-icon",{staticClass:"h-image-loading",attrs:{type:"loading"}}):e._e()],2)],2)])};_t._withStripped=!0;const St=st({render:_t,staticRenderFns:[]},void 0,Ct,void 0,!1,void 0,!1,void 0,void 0,void 0);var xt="",Dt=function(){return void 0!==document.documentElement.style.objectFit},Rt=function(e,t){return Ot(e,null!==t||void 0!==t?t?"overflow-y":"overflow-x":"overflow").match(/(scroll|auto)/)},Ot=function(e,t){return(window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle)[t]},Vt="none",Tt="contain",Lt="cover",$t="fill",It="scale-down",Ft={name:"HImage",inheritAttrs:!1,props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewBtn:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},showDown:{type:Boolean,default:!1},initial:{type:Number,default:0},prefix:{type:[Boolean,String],default:!0},popover:{type:Boolean,default:!1},popoverConfig:{type:Object,default:function(){return{placement:"right",trigger:"hover",width:"200px",height:"100%"}}}},components:{IconFontBox:mt,IconFont:re.default,ImageViewer:St},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1,imageSrc:""}},provide:function(){return{download:this.download}},computed:{imgHost:function(){return this.$config?this.$config.cosPrefix:""},imageStyle:function(){var e=this.fit;return window&&e?Dt()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter:function(){return window&&!Dt()&&this.fit!==$t},preview:function(){var e=this.previewSrcList;return Array.isArray(e)&&e.length>0},imageIndex:function(){var e=this.initial||0,t=this.previewSrcList.indexOf(this.src);return t>=0&&(e=t),e}},watch:{src:function(){this.imageSrc=this.exchangeImage(),this.show&&this.loadImage()},show:function(e){e&&this.loadImage()}},mounted:function(){this.imageSrc=this.exchangeImage(),this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{exchangeImage:function(){var e=this.src,t=this.prefix;if(!e)return e;if(/(http|https):\/\//.test(e))return e;var n="";"string"==typeof t?n=t:t&&(n=this.imgHost);var a=e.indexOf("/")>0;return"".concat(n).concat(a?"/":"").concat(e)},handleLazyLoad:function(){var e,t,n,a;e=this.$el,t=this._scrollContainer,a=e.getBoundingClientRect(),n=[window,document,document.documentElement,null,void 0].includes(t)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:t.getBoundingClientRect(),a.top<n.bottom&&a.bottom>n.top&&a.right>n.left&&a.left<n.right&&(this.show=!0,this.removeLazyLoadListener())},download:function(e){this.$emit("download",e)},addLazyLoadListener:function(){var e,t,n=this.scrollContainer,a=null;(t=n)&&t.nodeType===Node.ELEMENT_NODE?a=n:(e=n,a="[object String]"===Object.prototype.toString.call(e)?document.querySelector(a):function(e){for(var t=e;t;){if([window,document,document.documentElement].includes(parent))return window;if(Rt(t))return t;t=t.parentNode}return t}(this.$el)),a&&(this._scrollContainer=a,this._lazyLoadHandler=function(e,t,n,a){var i,o=!1,s=0;function r(){i&&clearTimeout(i)}function l(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=this,h=Date.now()-s;function p(){s=Date.now(),n.apply(d,c)}function f(){i=void 0}o||(a&&!i&&p(),r(),void 0===a&&h>e?p():!0!==t&&(i=setTimeout(a?f:p,void 0===a?e-h:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){r(),o=!0},l}(200,this.handleLazyLoad),a.addEventListener("scroll",this._lazyLoadHandler,!1),this.handleLazyLoad())},removeLazyLoadListener:function(){var e=this._scrollContainer,t=this._lazyLoadHandler;!this.$isServer&&e&&t&&(e.removeEventListener("scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},loadImage:function(){var e=this;if(window){this.loading=!0,this.error=!1;var t=new Image;t.onload=function(n){return e.handleLoad(n,t)},t.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(n){var a=e.$attrs[n];t.setAttribute(n,a)})),t.src=this.imageSrc}},handleLoad:function(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError:function(e){this.loading=!1,this.error=!0,this.$emit("error",e)},getImageStyle:function(e){var t=this.imageWidth,n=this.imageHeight,a=this.$el,i=a.clientWidth,o=a.clientHeight;if(!(t&&n&&i&&o))return{};var s=t/n<1;switch(e===It&&(e=t<i&&n<o?Vt:Tt),e){case Vt:return{width:"auto",height:"auto"};case Tt:return s?{width:"auto"}:{height:"auto"};case Lt:return s?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(e){!this.preview&&this.previewBtn||this.openViewer()},openViewer:function(){xt=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closeViewer:function(){document.body.style.overflow=xt,this.showViewer=!1}}};const Mt=Ft;var Pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"a-image"},[e.loading?e._t("placeholder",[n("div",{staticClass:"a-image__placeholder"},[e._t("loading",[n("a-icon",{staticClass:"placeholder-icon",attrs:{type:"picture"}})])],2)]):e.error&&e.src?e._t("error",[n("div",{staticClass:"a-image__error"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"icontupianjiazaishibai"}})],1)]):e.popover&&e.src?n("a-popover",{attrs:{placement:e.popoverConfig.placement,trigger:e.popoverConfig.trigger}},[n("template",{slot:"content"},[n("img",{style:{width:e.popoverConfig.width,height:e.popoverConfig.height},attrs:{src:e.src}})]),e._v(" "),n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners))],2):e.src?n("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)):e.src?e._e():e._t("none",[n("div",{staticClass:"a-image__none"},[n("icon-font",{staticClass:"img-icon",attrs:{type:"iconzanwutupian2"}})],1)]),e._v(" "),e.preview?[e.showViewer?n("image-viewer",{attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,showDown:e.showDown,"url-list":e.previewSrcList,prefix:e.prefix,host:e.imgHost},on:{download:e.download}}):e._e()]:e._e()],2)};Pt._withStripped=!0;const Nt=st({render:Pt,staticRenderFns:[]},void 0,Mt,void 0,!1,void 0,!1,void 0,void 0,void 0);var Et={zIndex:2e3,initialIndex:0,urlList:[]},At=se.default.extend(St);Nt.install=function(e){e.component(Nt.name,Nt)},Nt.api=function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=it({},Et,e);var t=new At({el:document.createElement("div"),propsData:e,methods:{hide:function(){this.deviceSupportUninstall(),this.$el.parentNode.removeChild(this.$el)},download:function(){e.download&&e.download(this.currentImg)}}}),n=e.body?document.body:e.target;console.log(n),document.body.appendChild(t.$el)}(e)};const jt={name:"TableCellEllipsisTip",props:{onlyLine:{type:Boolean,default:!1},line:{type:Number,default:1},text:{type:[String,Number],default:""},tip:{type:[String,Number],default:""},position:{type:String,default:"bottom"},id:{type:[String,Number],default:Y.guid()},tipExtAttr:{type:Object,default:function(){return{}}}},data:function(){return{elId:Y.guid().substr(0,5),showTip:!1,actualTip:""}},computed:{cellStyle:function(){return{"line-clamp":this.line}}},mounted:function(){this.tipChange()},updated:function(){this.tipChange()},methods:{tipChange:function(){var e=this;try{var t=this.text?this.text:this.$el.innerText;this.actualTip=this.tip?this.tip:t,this.$nextTick((function(){setTimeout((function(){try{var t=document.getElementById(e.elId);e.showTip=!!t&&Y.isEllipsis(t)}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}),0)}))}catch(e){console.error("请注意，TableCellEllipsisTip 组件没有获取到有效的 tip 值！")}}}};var Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cell-ellipsis-wrap",attrs:{id:"cell-ellipsis-"+e.id,"cell-ellipsis-id":e.id}},[e.showTip&&!e.onlyLine?n("a-tooltip",e._b({class:"cell-tooltip-"+e.id,attrs:{placement:e.position}},"a-tooltip",e.tipExtAttr,!1),[n("template",{slot:"title"},[e._t("tip",[e._v(e._s(e.actualTip))])],2),e._v(" "),n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n        "+e._s(e.text)+"\n      ")])],2)],2):n("div",{staticClass:"cell-content cell-ellipsis",style:e.cellStyle,attrs:{id:e.elId}},[e._t("default",[e._v("\n      "+e._s(e.text)+"\n    ")])],2)],1)};Bt._withStripped=!0;const Kt=st({render:Bt,staticRenderFns:[]},void 0,jt,void 0,!1,void 0,!1,void 0,void 0,void 0);function Ht(){return Ht=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ht.apply(this,arguments)}Kt.install=function(e){e.component(Kt.name,Kt)};var zt=["attrs","props","domProps"],qt=["class","style","directives"],Yt=["on","nativeOn"],Wt=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},Gt=function(e){return e.reduce((function(e,t){for(var n in t)if(e[n])if(-1!==zt.indexOf(n))e[n]=Ht({},e[n],t[n]);else if(-1!==qt.indexOf(n)){var a=e[n]instanceof Array?e[n]:[e[n]],i=t[n]instanceof Array?t[n]:[t[n]];e[n]=a.concat(i)}else if(-1!==Yt.indexOf(n))for(var o in t[n])if(e[n][o]){var s=e[n][o]instanceof Array?e[n][o]:[e[n][o]],r=t[n][o]instanceof Array?t[n][o]:[t[n][o]];e[n][o]=s.concat(r)}else e[n][o]=t[n][o];else if("hook"==n)for(var l in t[n])e[n][l]=e[n][l]?Wt(e[n][l],t[n][l]):t[n][l];else e[n]=t[n];else e[n]=t[n];return e}),{})};function Ut(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Xt=ue.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};function Jt(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}var Qt=["key"],Zt={},en={name:"STable",props:{dragOption:{type:Object,default:function(){return{}}},draggable:Boolean,draggableOption:{type:Object,default:function(){return{minWidth:100,maxWidth:560}}},sortList:{type:Array,default:null},sortConfig:{type:Object,default:function(){return{}}},cellWidth:{type:Object,default:void 0},excludeWidth:{type:Array,default:function(){return[]}}},data:function(){return{components:null,columns:[],hash:""}},computed:{actSortConfig:function(){return me({unshift:["index"],push:[],key:"key"},this.sortConfig)}},created:function(){this.components={header:{cell:this.resizeableTitle}}},mounted:function(){this.columns=this.sortColumns(),Object.keys(this.dragOption).length&&this.initSortable()},render:function(){var e=this,t=arguments[0],n=this.$attrs,a=this.sortColumns(),i={on:me({},this.$listeners)};return t("a-table",Gt([{},{props:me(me({},n),{},{columns:a}),scopedSlots:me({},this.$scopedSlots)},{attrs:{components:this.components}},i,{ref:"tableSort"}]),[Object.keys(this.$slots).map((function(n){return"default"!==n?t("template",{slot:n},[e.$slots[n]]):null}))])},components:{"vue-draggable-resizable":he.default},methods:{sortColumns:function(){var e=this,t=this.$attrs.columns?this.updateColumns(this.$attrs.columns):this.generateColumns(this.$slots.default);if(this.sortList&&this.sortList.length){var n={},a=[];t.forEach((function(e){e.key&&(n[e.key]=e)})),this.sortList.forEach((function(t){!n[t[e.actSortConfig.key]]||e.actSortConfig.unshift.includes(t[e.actSortConfig.key])||e.actSortConfig.push.includes(t[e.actSortConfig.key])||a.push(n[t[e.actSortConfig.key]])}));for(var i=this.actSortConfig.unshift.length-1;i>=0;i--)this.actSortConfig.unshift[i]&&n[this.actSortConfig.unshift[i]]&&a.unshift(n[this.actSortConfig.unshift[i]]);for(var o=this.actSortConfig.push.length-1;o>=0;o--)this.actSortConfig.push[o]&&n[this.actSortConfig.push[o]]&&a.push(n[this.actSortConfig.push[o]]);return a}return t},generateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return t.forEach((function(t){if(t.tag){var a=Q.getKey(t),i=Q.getStyle(t),o=Q.getClass(t),s=Q.getOptionProps(t),r=Q.getEvents(t),l={};Object.keys(r).forEach((function(e){var t=void 0;t=e.startsWith("update:")?"on-"+e.substr("update:".length)+"-change":"on-"+e,l[Q.camelize(t)]=r[e]}));var c=Q.getSlots(t),u=c.default,d=Jt(c,["default"]),h=Xt({},d,s,{style:i,class:o},l);if(a&&(h.key=a),Q.getSlotOptions(t).__ANT_TABLE_COLUMN_GROUP)h.children=e.generateColumns("function"==typeof u?u():u);else{var p=t.data&&t.data.scopedSlots&&t.data.scopedSlots.default;h.customRender=h.customRender||p}n.push(h)}})),n},updateColumns:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],a=this.$slots,i=this.$scopedSlots;return t.forEach((function(t){var o=t.slots,s=void 0===o?{}:o,r=t.scopedSlots,l=void 0===r?{}:r,c=Jt(t,["slots","scopedSlots"]),u=Xt({},c);Object.keys(s).forEach((function(e){var t=s[e];void 0===u[e]&&a[t]&&(u[e]=1===a[t].length?a[t][0]:a[t])})),Object.keys(l).forEach((function(e){var t=l[e];void 0===u[e]&&i[t]&&(u[e]=i[t])})),t.children&&(u.children=e.updateColumns(u.children)),n.push(u)})),n},generateSlot:function(){},resizeableTitle:function(e,t,n){var a=this,i=this.columns;i.forEach((function(e){Zt[e.key]=e.width||0}));var o=se.default.observable(Zt),s=null,r=t.key,l=Ut(t,Qt),c={};if(!(c="selection-column"===r?{dataIndex:"selection-column",key:"selection-column",width:40}:i.find((function(e){return(e.dataIndex||e.key)===r})))||!c.width||"selection-column"===r||this.excludeWidth.includes(r))return c&&c.width?e("th",Gt([{attrs:{width:c.width}},l]),[n]):e("th",Gt([{},l]),[n]);var u=this.draggableOption,d=u.maxWidth,h=u.minWidth;return e("th",Gt([{},l,{directives:[{name:"ant-ref",value:function(e){return s=e}}],attrs:{width:c.width},style:{position:"relative"}}]),[n,e(he.default,{key:c.key,class:"table-draggable-handle",attrs:{w:10,x:o[r]||c.width,z:1,axis:"x",draggable:this.draggable,resizable:!1},on:{dragging:function(e){if(o[r]=0,c.width=Math.max(h,Math.min(e,d)),a.cellWidth){var t=me(me({},a.cellWidth),{},pe({},c.key,c.width));a.$emit("update:cellWidth",me({},t))}},dragstop:function(){o[r]=s.getBoundingClientRect().width}},style:{height:"100% !important",bottom:0,left:"auto !important",right:"-5px",cursor:this.draggable?"col-resize":"default","touch-action":"none",transform:"none !important",position:"absolute"}})])},initSortable:function(){var e=this,t=this.$refs.tableSort.$el.querySelectorAll("tbody"),n=Object.assign({},this.dragOption);de.default.create(t[t.length>1?1:0],me(me({handle:".ant-table-row",animation:150},n),{},{onUpdate:function(t){var n=e.$attrs["data-source"],a=t.oldIndex,i=t.newIndex,o=n.splice(a,1)[0];n.splice(i,0,o),e.$emit("onUpdate",{dataSource:n,evt:t})},onStart:function(t){e.$emit("onStart",t)},onAdd:function(t){e.$emit("onAdd",t)},onRemove:function(t){e.$emit("onRemove",t)},onChoose:function(t){e.$emit("onChoose",t)},onEnd:function(t){e.$emit("onEnd",t)},onFilter:function(t){e.$emit("onFilter",t)},onMove:function(t){e.$emit("onMove",t)}}))},changeHandler:function(e){this.$emit("change",e)},refresh:function(e){console.log("refresh"),this.$attrs.columns||this.$forceUpdate()}},install:function(e){e.component(en.name,en)}};mt.install=function(e){e.component(mt.name,mt)};const tn={name:"DOperationBox",components:{IconFontBox:mt,CellEllipsisTip:Kt},inject:{selectionContent:{from:"selectionContent",default:void 0},pagination:{from:"pagination",default:void 0}},props:{value:{type:Object,default:function(){return{}}},optionList:{type:Array,default:function(){return[]}},moreSearch:{type:Boolean,default:!0},modalConfig:{type:Object,default:function(){return{}}}},data:function(){return{actOptionList:[],loading:{},visible:!1}},computed:{selectList:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},baseModalConfig:function(){return me({title:"",okText:"确定",cancelText:"取消",width:"492px",style:"",class:"",resetText:"清空"},this.modalConfig)},actPagination:function(){return this.pagination?this.pagination:{total:0,pageSize:30,current:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["30","50","100"],showTotal:function(e){return"总".concat(e,"条")}}},actSelectionContent:function(){return this.selectionContent?this.selectionContent:{selectedRowKeys:[],selectedRows:{},noSelectedRowKeys:[],noSelectedRows:{},selectType:"",rowSelection:{},primaryKey:"skuId"}}},created:function(){this.generateOptionList()},watch:{optionList:function(){this.generateOptionList()}},methods:{generateOptionList:function(){var e=this;this.loading={},this.actOptionList=[];var t={name:"",key:"",icon:"",iconColor:"#378EFB",textColor:"#378EFB",size:16,loading:void 0};this.optionList.forEach((function(n){n.loading&&e.$set(e.loading,n.key,!1),e.actOptionList.push(me(me({},t),n))}))},handleSelect:function(e){"more"===e&&this.$slots.modal?this.visible=!0:this.$emit("optionClick",{name:e,close:this.closeLoading(e),key:e})},optionHandle:function(e){this.loading[e.key]||(e.loading&&(this.loading[e.key]=!0),this.$emit("optionClick",{key:e.key,close:this.closeLoading(e.key),data:e,name:e.name}))},handleDelete:function(e){var t=this,n=null;if("all"===e)this.selectList={};else{n=tt(this.selectList[e]);var a=this.selectList;delete a[e],this.selectList=me({},a)}this.$nextTick((function(){t.$emit("delete",{name:e,old:n,key:e,config:{name:e,status:"delete",type:"operation",resultName:e}})}))},closeLoading:function(e){var t=this,n=e;return function(){if("all"===n)for(var e in t.loading)t.loading.hasOwnProperty(e)&&(t.loading[e]=!1);else t.loading.hasOwnProperty(n)&&(t.loading[n]=!1)}},modalOk:function(){var e=this;this.modalConfig.ok?this.modalConfig.ok((function(){e.visible=!1})):this.visible=!1},modalCancel:function(){var e=this;this.modalConfig.cancel?this.modalConfig.cancel((function(){e.visible=!1})):this.visible=!1},resetHandle:function(){var e=this;this.modalConfig.reset&&this.modalConfig.reset((function(){e.visible=!1}))}}};var nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"operation-index"},[n("div",{staticClass:"opt-top"},[e.actSelectionContent.selectedRowKeys.length?e._e():n("div",{staticClass:"filter-box"},[n("div",{staticClass:"filter-list"},[e._t("default")],2),e._v(" "),e.moreSearch?n("div",{staticClass:"more-search"},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.handleSelect("more")}}},[e._v("\n          更多搜索\n          "),n("icon-font-box",{attrs:{type:"icongengduosousuo",size:"16",color:"#378EFB"}})],1)]):e._e()]),e._v(" "),e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"select-list"},[n("div",{staticClass:"select-box"},[n("icon-font-box",{attrs:{type:"icon_warning",size:"16",color:"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-text"},[e._v("已选"),n("span",{staticClass:"select-num"},[e._v(e._s("allPage"===e.actSelectionContent.selectType?e.actPagination.total-e.actSelectionContent.noSelectedRowKeys.length:e.actSelectionContent.selectedRowKeys.length))]),e._v("条")]),e._v(" "),n("a",{staticClass:"clear-row",attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleSelect("clear")}}},[e._v("清空选中")])],1),e._v(" "),n("div",{staticClass:"select-rule"},e._l(e.actOptionList,(function(t,a){return n("a",{key:a,staticClass:"select-btn",attrs:{type:"link"},on:{click:function(n){return e.optionHandle(t)}}},[e.loading[t.key]?n("a-spin",{attrs:{size:"small"}}):e._e(),e._v(" "),e.loading[t.key]?e._e():n("icon-font-box",{attrs:{type:t.icon,size:t.size||16,color:t.iconColor||"#378EFB"}}),e._v(" "),n("span",{staticClass:"select-btn-text",style:{color:t.textColor}},[e._v(e._s(t.name))])],1)})),0)]):e._e(),e._v(" "),e.$slots.other?n("div",{staticClass:"other-btn"},[e._t("other")],2):e._e()]),e._v(" "),Object.keys(e.selectList).length&&!e.actSelectionContent.selectedRowKeys.length?n("div",{staticClass:"opt-bottom"},[e._l(e.selectList,(function(t,a){return n("div",{key:a,staticClass:"tag-box"},[n("div",{staticClass:"tag-label"},[e._v(e._s(t.label))]),e._v(" "),n("div",{staticClass:"tag-info"},[n("cell-ellipsis-tip",{attrs:{tip:t.value}},[e._v(e._s(t.value))])],1),e._v(" "),n("icon-font-box",{staticClass:"tag-close",attrs:{type:"icon_close",size:"14"},on:{click:function(n){return e.handleDelete(t.key)}}})],1)})),e._v(" "),n("a",{attrs:{href:"javascript:void(0)",type:"link"},on:{click:function(t){return e.handleDelete("all")}}},[e._v("全部清除")])],2):e._e(),e._v(" "),n("a-modal",{class:e.baseModalConfig.class,style:e.baseModalConfig.style,attrs:{title:e.baseModalConfig.title,"ok-text":e.baseModalConfig.okText,"cancel-text":e.baseModalConfig.cancelText,width:e.baseModalConfig.width,maskClosable:!1,keyboard:!1},on:{ok:e.modalOk,cancel:e.modalCancel},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e._t("modal"),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"operation-modal-footer"},[n("div",{staticClass:"operation-reset"},[n("a-button",{attrs:{type:"link"},on:{click:e.resetHandle}},[e._v(e._s(e.baseModalConfig.resetText))])],1),e._v(" "),n("div",{staticClass:"operation-btn"},[n("a-button",{key:"back",on:{click:e.modalCancel}},[e._v("\n            "+e._s(e.baseModalConfig.cancelText)+"\n          ")]),e._v(" "),n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("\n            "+e._s(e.baseModalConfig.okText)+"\n          ")])],1)])])],2)],1)};nn._withStripped=!0;const an=st({render:nn,staticRenderFns:[]},void 0,tn,void 0,!1,void 0,!1,void 0,void 0,void 0);an.install=function(e){e.component(an.name,an)};var on=[{id:0,name:"草稿"},{id:1,name:"已过账"},{id:3,name:"已红冲"}],sn={0:on[0],1:on[1],2:on[2]},rn=[{id:0,name:"未支付"},{id:1,name:"部分支付"},{id:2,name:"已支付"}],ln={0:rn[0],1:rn[1]},cn=[{id:1,name:"库存高于上限"},{id:2,name:"库存低于下限"},{id:3,name:"有货"},{id:4,name:"缺货"}],un={0:ln[0],1:ln[1]},dn=[{id:5,name:"ERP草稿",color:"#52C41A"},{id:1,name:"已过账",color:"#52C41A"},{id:4,name:"ERP删除",color:"#BBBBBB"},{id:2,name:"草稿",color:"#52C41A"},{id:3,name:"已红冲",color:"#F5222D"},{id:0,name:"未同步",color:"#378EFB"}],hn=[{id:0,name:"已下架"},{id:1,name:"已上架"}],pn=[{id:1,name:"应收调整"},{id:2,name:"应付调整"}],fn=[{id:0,name:"草稿"},{id:1,name:"盘点完成"}],mn=[{id:0,name:"全部"},{id:1,name:"采购入库"},{id:2,name:"退货入库"},{id:3,name:"盘盈入库"},{id:4,name:"其它入库"},{id:5,name:"销售出库"},{id:6,name:"采购退货"},{id:7,name:"盘亏出库"},{id:8,name:"采购入库"},{id:9,name:"其它出库"},{id:10,name:"同价调拨入库"},{id:11,name:"同价调拨出库"},{id:12,name:"撤销出库"},{id:13,name:"进销存同步"},{id:14,name:"撤销退货"},{id:15,name:"退货单取消"},{id:16,name:"订货单取消"}],gn=[{id:0,name:"微信账户"},{id:1,name:"预付款账户"},{id:2,name:"现金账户"},{id:3,name:"银行卡账户"}],vn=[{id:-1,name:"已取消",key:"canceled",btnKeys:["detail","del","share","print","export","copy"]},{id:0,name:"草稿",key:"draft",btnKeys:["detail","submit","submit_audit","del","share","print","export","copy"]},{id:1,name:"待审核",key:"to_audit",btnKeys:["detail","audit","cancel_bill","share","print","export","copy"]},{id:2,name:"待出库",key:"to_stock_removal",btnKeys:["detail","stock_removal","auditee","cancel_bill","share","print","export","copy"]},{id:3,name:"部分出库",key:"portion_stock_removal",btnKeys:["detail","stock_removal","suspend_bill","share","print","export","copy"]},{id:4,name:"待发货",key:"to_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:5,name:"部分发货",key:"portion_delivery_goods",btnKeys:["detail","delivery_goods","share","print","export","copy"]},{id:6,name:"待收货",key:"to_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:7,name:"部分收货",key:"portion_take_goods",btnKeys:["detail","take_goods","share","print","export","copy"]},{id:8,name:"已完成",key:"finish",btnKeys:["detail","share","print","export","copy"]},{id:9,name:"已中止",key:"suspend",btnKeys:["detail","share","print","export","copy"]}],yn=[{id:1,name:"已打印"},{id:0,name:"未打印"}],bn=[{id:0,name:"PC端代开"},{id:1,name:"企业微信代开"},{id:2,name:"小程序商城"},{id:3,name:"巡店"},{id:4,name:"Excel导入"}],kn=[{id:1,name:"买赠"},{id:2,name:"秒杀"},{id:3,name:"特价"},{id:4,name:"订单促销"},{id:5,name:"组合促销"},{id:6,name:"一口价"},{id:7,name:"拼团"},{id:8,name:"优惠券"},{id:9,name:"分销"}],wn=[{id:0,name:"不开发票"},{id:1,name:"普通发票"},{id:2,name:"增值税发票"}],Cn=Object.freeze({__proto__:null,billStatus:{0:{name:"草稿",color:"#378EFB",icon:"iconcaogao"},1:{name:"已过账",color:"#52C41A",icon:"iconyiguozhang",stocktakingName:"盘点完成",stocktakingIcon:"icon_stocktaking_completed"},3:{name:"已红冲",color:"#F5222D",icon:"iconyihongchong"}},payStockSync:[{id:2,name:"ERP草稿",color:"#52c41a"},{id:3,name:"已过账",color:"#52c41a"},{id:4,name:"ERP删除",color:"#bbbbbb"},{id:5,name:"同步失败",color:"#f5222d"},{id:0,name:"未同步",color:"#378efb"}],payStockSyncMap:{0:{name:"未同步",color:"#378efb"},2:{name:"ERP草稿",color:"#52c41a"},3:{name:"已过账",color:"#52c41a"},4:{name:"ERP删除",color:"#bbbbbb"},5:{name:"同步失败",color:"#f5222d"}},inStockMap:[{id:0,name:"盘盈入库"},{id:2,name:"其它入库"}],outStockMap:[{id:1,name:"盘亏出库"},{id:3,name:"其它出库"}],orderStatus:on,orderStatusMap:sn,paymentStatus:rn,paymentStatusMap:ln,stockStatus:cn,stockStatusMap:un,stockSync:dn,stockSyncMap:{},saleStatus:hn,modeOfPayment:[{id:0,name:"线下支付"},{id:1,name:"银行卡转账"}],exchangePayment:pn,stockBillStatus:fn,stockInAndOut:mn,accountType:gn,saleOrderStatus:vn,printStatus:yn,billSource:bn,marketingType:kn,invoiceType:wn});const _n=st({},void 0,{name:"DMixSelect",props:{value:{type:[String,Number,Array],default:void 0},resultName:{type:String,default:""},type:{type:Number,default:0},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},width:{type:[String,Number],default:120},list:{type:Array,default:null},exclude:{type:Array,default:function(){return[]}},mode:{type:String,default:"select"},getPopupContainer:{type:Function,default:function(){return document.querySelector(".mix-select")}}},data:function(){return{actValue:void 0,options:[],selectLoading:!1}},computed:{modalPlaceholder:function(){return this.placeholder},actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:function(e){this.actValue=e},type:{handler:function(){this.options=[],this.getData()}}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;if(console.log(Cn,this.type),!this.$slots.default)if(this.list)this.options=this.list;else if([0,1,2,11].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$post(11===this.type?Le:Ie,{type:this.type}).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1})).catch((function(){e.selectLoading=!1}))}else if([14].includes(this.type)){if(this.options.length)return;this.selectLoading=!0,this.$get(He).then((function(t){e.options=t.data,e.actValue=e.value,e.selectLoading=!1}))}else switch(this.type){case 3:this.options=on;break;case 4:this.options=rn;break;case 5:this.options=cn;break;case 6:this.options=hn;break;case 7:this.options=pn;break;case 8:this.options=dn;break;case 9:this.options=fn;break;case 10:this.options=mn;break;case 12:this.options=vn;break;case 13:this.options=yn;break;case 15:this.options=bn;break;case 16:this.options=kn;break;case 17:this.options=wn;break;default:this.options=[]}},handleChange:function(e){var t=Ze(e);if(null==e||"object"===t&&!e.length)return this.$emit("input",void 0),this.actValue=void 0,void this.$emit("change",{config:{resultName:this.resultName,status:"delete",type:"select"}});var n="number"===t?{}:[];this.options.forEach((function(a){"number"===t?a.id===e&&(n=a):e.includes(a.id)&&n.push(a)})),this.$emit("input",e),this.actValue=e,this.$emit("change",{data:e,rows:n,config:{resultName:this.resultName,status:"select",type:"select"}})},optionsVisibleHandle:function(){this.options.length||this.$slots.default||this.getData()},resetData:function(){this.actValue=void 0,this.$emit("input",void 0)}},render:function(e){var t=this,n=this;return e("div",{class:"mix-select",style:"width: ".concat(n.actWidth)},[e("a-select",{scopedSlots:n.$scopedSlots,props:{value:n.actValue,allowClear:n.allowClear,placeholder:n.modalPlaceholder,mode:n.mode,getPopupContainer:n.getPopupContainer,disabled:n.disabled},style:"width:100%;",on:{dropdownVisibleChange:n.optionsVisibleHandle,change:n.handleChange}},[n.selectLoading?e("a-spin",{props:{size:"small"},slot:"notFoundContent"}):function(){if(t.$slots.default)return t.$slots.default;var n=[];return t.options.forEach((function(a,i){t.exclude.includes(a.id)||n.push(e("a-select-option",{props:{value:a.id,key:i,title:a.name}},a.name))})),n}()])])}},"data-v-c44b6be8",void 0,void 0,!1,void 0,void 0,void 0);_n.install=function(e){e.component(_n.name,_n)};var Sn={name:"MixSearchInput",props:{value:{type:[Object,String],default:""},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},maxLength:{type:Number,default:40},name:{type:String,default:""},next:{type:Function,default:void 0},restore:{type:Boolean,default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{inputValue:"",loading:!1,dataList:[],readonly:!1,dialogFocus:!1,localDataCache:null,isBlur:!1,replaceFields:{key:"id",name:"name"}}},watch:{value:{handler:function(e){this.inputValue=e?e.name||e.value:void 0},deep:!0,immediate:!0}},methods:{generateRequest:function(){var e=arguments,t=this;return ve(be.mark((function n(){var a,i,o,s,r,l,c,u,d,h,p,f,m;return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,!["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(t.name)){n.next=12;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName",code:"code",barCode:"barCode"},n.next=6,t.$get(De,it({type:4,isShowSku:!0,pageNum:1,pageSize:30},a,t.dialogConfig.rules));case 6:return i=n.sent,o=i.data,t.localDataCache=o?o.list:[],n.abrupt("return",o?o.list:[]);case 12:if(!["person","preparer","handler"].includes(t.name)){n.next=25;break}if(!t.localDataCache){n.next=17;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 17:return n.next=19,t.$get(Pe);case 19:return s=n.sent,r=s.data,t.localDataCache=r,n.abrupt("return",r);case 23:n.next=72;break;case 25:if(!["warehouse"].includes(t.name)){n.next=34;break}return n.next=28,t.$get(Fe,me({pageNum:1,pageSize:30},a));case 28:return l=n.sent,c=l.data,t.localDataCache=c?c.list:[],n.abrupt("return",c?c.list:[]);case 34:if(!["customer","supplier","supplierCustomer"].includes(t.name)){n.next=44;break}return t.replaceFields={key:"id",name:"name",pinyin:"spellName"},n.next=38,t.$post(Oe,me({pageNum:1,pageSize:30},a));case 38:return u=n.sent,d=u.data,t.localDataCache=d?d.list:[],n.abrupt("return",d?d.list:[]);case 44:if(!["unit","brand","tag"].includes(t.name)){n.next=57;break}if(!t.localDataCache){n.next=49;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 49:return n.next=51,t.$post(Ie,{type:["unit","brand","tag"].indexOf(t.name)});case 51:return h=n.sent,p=h.data,t.localDataCache=p,n.abrupt("return",p);case 55:n.next=72;break;case 57:if(!["rateUnit"].includes(t.name)){n.next=71;break}if(t.replaceFields={key:"id",name:"unitName"},!t.localDataCache){n.next=63;break}return n.abrupt("return",t.generateLocalSearch(a.keywords));case 63:return n.next=65,t.$post(Me,t.dialogConfig.productId);case 65:return f=n.sent,m=f.data,t.localDataCache=m,n.abrupt("return",m);case 69:n.next=72;break;case 71:["account"].includes(t.name)?console.log("还没做"):console.log("未知的 name:",t.name);case 72:case"end":return n.stop()}}),n)})))()},generateLocalSearch:function(e){var t=this,n=[];return this.localDataCache.forEach((function(a){-1!==a[t.replaceFields.name].indexOf(e)&&n.push(a)})),n},clickHandle:function(){var e=this;this.disabled||this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.$emit("enterHandle",{data:null,action:"click",inputValue:this.inputValue,callback:function(){this.inputValue=""}}),setTimeout((function(){e.dialogFocus=!1,(e.value&&e.value.name!==e.inputValue||!e.value)&&(e.inputValue="")}),300))},enterHandle:function(){var e=this;this.next&&!this.next("mixSearch")||this.dialogFocus||(this.dialogFocus=!0,this.matchingData("enter"),setTimeout((function(){e.dialogFocus=!1}),300))},matchingData:function(e){var t=this,n=function(){var n=null,a=nt(t.value);if(t.dataList.length&&t.inputValue)for(var i=0;i<t.dataList.length;i++){var o=t.dataList[i];o[t.replaceFields.name]!==t.inputValue&&o[t.replaceFields.pinyin]!==t.inputValue&&o[t.replaceFields.code]!==t.inputValue&&o[t.replaceFields.barCode]!==t.inputValue||(n=o)}else a||t.inputValue!==t.value.name&&t.inputValue!==t.value.value||(n=t.value);t.restore&&"blur"===e&&(n||a||(t.inputValue=t.value.name||t.value.value,n=t.value)),t.$emit("enterHandle",{data:n,rows:n?[n]:null,action:e,inputValue:t.inputValue,baseRows:t.dataList}),t.inputValue=""};if(this.loading)var a=setInterval((function(){t.loading||(n(),clearInterval(a),a=null)}),500);else n()},changeHandle:function(){var e=this;if(this.isBlur||this.inputValue||this.$emit("clear"),this.readonly){var t=nt(this.value);this.inputValue=t?this.value.name||this.value.value:""}else this.inputValue&&this.generateRequest({keywords:this.inputValue}).then((function(t){e.dataList=t,e.loading=!1}))},blurHandle:function(){var e=this;this.isBlur=!1,setTimeout((function(){e.dialogFocus||(e.inputValue?(nt(e.value)||e.inputValue!==e.value.name)&&e.matchingData("blur"):e.restore?e.inputValue=e.value.name||e.value.value:e.value&&e.$emit("clear"))}),300)},focusHandle:function(){this.isBlur=!0,this.readonly=this.next&&!this.next("mixSearch")},focus:function(){this.$refs.mixSearchInput.focus()}}};const xn=Sn;var Dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-input",{ref:"mixSearchInput",staticClass:"mix-search-input",attrs:{placeholder:e.placeholder,disabled:e.disabled,allowClear:e.allowClear,maxLength:e.maxLength,title:e.inputValue},on:{pressEnter:e.enterHandle,change:e.changeHandle,blur:e.blurHandle,focus:e.focusHandle},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[n("a-button",{attrs:{slot:"suffix",type:"link",icon:e.loading?"loading":"ellipsis"},on:{click:e.clickHandle},slot:"suffix"})],1)};Dn._withStripped=!0;const Rn=st({render:Dn,staticRenderFns:[]},void 0,xn,"data-v-225db93a",!1,void 0,!1,void 0,void 0,void 0);var On={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"}};const Vn={name:"Empty",components:{empty:Z.empty,loading:Z.loading},props:{text:{type:String,default:""},loading:{type:Boolean,default:!1}}};var Tn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"empty"},[n("div",{staticClass:"icon"},[e._t("icon",[e.loading?n("loading",{staticClass:"empty-icon"}):n("empty",{staticClass:"empty-icon"})])],2),e._v(" "),n("h3",{staticClass:"text"},[e._t("default",[e._v(e._s(e.text?e.text:e.loading?"加载中……":"暂无搜索结果"))])],2)])};Tn._withStripped=!0;const Ln=st({render:Tn,staticRenderFns:[]},void 0,Vn,void 0,!1,void 0,!1,void 0,void 0,void 0);function $n(e){return"object"===Ze(e)&&null!==e&&e.constructor&&e.constructor===Object}function In(){for(var e=Object(arguments.length<=0?void 0:arguments[0]),t=1;t<arguments.length;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(n)for(var a=Object.keys(Object(n)),i=0;i<a.length;i++){var o=a[i],s=Object.getOwnPropertyDescriptor(n,o);s&&s.enumerable&&($n(e[o])&&$n(n[o])?In(e[o],n[o]):!$n(e[o])&&$n(n[o])?(e[o]={},In(e[o],n[o])):e[o]=n[o])}}return e}Ln.install=function(e){e.component(Ln.name,Ln)};var Fn={data:function(){return{searchResult:{},selectList:{},selectConfig:{},filterSortConfig:{},resultDealStatus:!1,searchFilterDefaultData:void 0,_searchFilterConfig:void 0}},methods:{beforeSearchChange:function(){return!0},beforeTableChange:function(){return!0},tableChange:function(e,t,n){console.log("tableChange 接收到事件改变：",e,t,n);var a=Object.keys(e).length;if(a){if(e.current!==this.pagination.current)return void this.loadTableData(e);if(e.pageSize!==this.pagination.pageSize)return e.current=1,this.pagination.pageSize=e.pageSize,this.handleSelectedClear&&this.handleSelectedClear(),void this.loadTableData(e)}if(!this.beforeTableChange||this.beforeTableChange(e,t,n)){a?e.current===this.pagination.current&&e.pageSize===this.pagination.pageSize&&(e.current=1):e=me(me({},this.pagination),{},{current:1});var i=n.columnKey,o=n.order,s=Object.prototype.hasOwnProperty.call(this.searchResult,"sort");o?s?this.searchResult.sort="ascend"===o?this.filterSortConfig[i]:0-this.filterSortConfig[i]:this.searchResult=me(me({},this.searchResult),{},{sortField:this.filterSortConfig[i]||i,sortType:"ascend"===o?"asc":"desc"}):s?this.searchResult.sort=void 0:this.searchResult=me(me({},this.searchResult),{},{sortField:void 0,sortType:void 0}),this.loadTableData(e)}},searchResultDeal:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log("searchResultDeal 接收到条件变化：",e,t),this.beforeSearchChange(e)){var n=this._resetSearchFilterDefaultData()._getFilterConfig(e);n.deal=t;var a=n.data;n.rows;var i=n.config,o=n.dataType,s=n.columnsName;if("all"===i[e.config.columnsName||e.config.resultName]||this.selectConfig[e.config.columnsName||e.config.resultName]){if("all"===i.resultName&&"delete"===i.status)return this._searchFilterClearAll(e),this.pagination&&(this.pagination.current=1),this.loadTableData(),this;"array"===o&&(a[0]||a[1]||(a=void 0,console.warn("请注意 ".concat(s," 中组件返回的 data 全是空值。")))),null==a||""===a?this._deleteValue():("string"===o||"number"===o?this._dealDataForSingle():"array"===o?this._dealDataForArray():"object"===o?this._dealDataForObject():console.log("啥也不是"),this.selectList=me({},this.selectList),this.pagination&&(this.pagination.current=1),!t&&this.loadTableData()),this._searchFilterClearRef(e)}else console.error("当前没有配置 selectConfig：",e.config.columnsName||e.config.resultName,"，请注意检查 selectConfig 和对应的 dom 节点是否配置正确！")}},_getFilterConfig:function(e){var t,n=e.data,a=e.rows,i=e.config,o=this,s=i.columnsName||i.resultName,r=In(o.searchFilterDefaultData,this.selectConfig[s]);return console.log("合并后的内容：",r,o.searchFilterDefaultData),o._searchFilterConfig={data:n,rows:a,config:i,dataType:(t=n,"[object Null]"===Object.prototype.toString.call(t)?"null":"[object Object]"===Object.prototype.toString.call(t)?"object":"[object Array]"===Object.prototype.toString.call(t)?"array":"[object Undefined]"===Object.prototype.toString.call(t)?"undefined":"[object String]"===Object.prototype.toString.call(t)?"string":"[object Number]"===Object.prototype.toString.call(t)?"number":void 0),columnsName:s,selectList:o.selectList,selectConfig:r,dataCallback:o.selectConfig[s].setText,valueCallback:o.selectConfig[s].setValue,deal:!1,linkMode:r.linkMode||"before",linkType:Ze(r.link),link:r.link||"-",valueLink:r.valueLink||","},o._searchFilterConfig},_getActValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=this._searchFilterConfig.selectConfig,i="data"===e?a.dataTarget||"data":a.valueTarget||"data",o="data"===e?a.dataKey:a.valueKey,s="data"===i?t:n;return o?s[o]:s},_checkValueCallback:function(){var e=this._searchFilterConfig,t=e.data,n=e.rows,a=e.valueCallback;if(!a)return!0;a.call(this,{data:t,rows:n})},_deleteSelect:function(e){this.$delete(this.selectList,e)},_updateSelect:function(e,t){console.log(e),this.$set(this.selectList,[e],t)},_deleteValue:function(){var e=this,t=this,n=this._searchFilterConfig,a=n.selectConfig,i=n.columnsName,o=n.deal;a.en?(this._checkValueCallback()&&a.en.forEach((function(t){e.searchResult[t]=void 0})),t._deleteSelect(i)):(this._checkValueCallback()&&(this.searchResult[i]=void 0),t._deleteSelect(i)),t.pagination?o||t.loadTableData(me(me({},t.pagination),{},{current:1})):!o&&t.loadTableData()},_dealDataForSingle:function(){var e=this,t=e._searchFilterConfig,n=t.data,a=t.rows,i=t.selectConfig,o=t.columnsName,s=t.dataCallback,r=t.config,l=i.en[0]||o;e._checkValueCallback()&&(this.searchResult[l]=e._getActValue("value",n,a[0]||a)),i.cn.forEach((function(t){e._updateSelect(o,{key:o,label:t,value:s?s({data:n,rows:a}):e._getActValue("data",n,a[0]||a),type:r.type||""})}))},_dealDataForArray:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.linkMode,c=n.linkType,u=n.link,d=n.valueLink,h=n.config,p=s.en,f=s.cn.length>1,m=a.filter((function(e){return!!e})),g="";a.forEach((function(n,o){f&&p.length===a.length?n?(t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])),e._updateSelect(p[o],{key:p[o],label:s.cn[o],value:r?r({data:a,rows:i}):e._getActValue("data",a[o],i[o]),type:h.type||""})):(e._deleteSelect(p[o]),t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)):n?(p.length===a.length?t._checkValueCallback()&&(e.searchResult[p[o]]=t._getActValue("value",a[o],i[o])):t._checkValueCallback()&&(e.searchResult[p[0]]=e.searchResult[p[0]]?"".concat(e.searchResult[p[0]]).concat(d||",").concat(e._getActValue("value",a[o],i[o])):e.searchResult[p[0]],s.valueLink||(console.error("请注意设置 valueLink 连词，否则将会导致错误。"),console.error("请注意 searchResult.".concat(s.en[o]," 的值为： ").concat(e.searchResult[s.en[o]],"。")))),r||("string"===c?g=g?"".concat(g).concat(u).concat(t._getActValue("data",a[o],i[o])):t._getActValue("data",a[o],i[o]):1===m.length?(console.log("处理只有一个值的情况"),g=t._getActValue("data",a[o],i[o])):g=a.length-1===o?"".concat(g).concat(u[o]).concat(t._getActValue("data",a[o],i[o])).concat(u[o+1]):"after"===l?"".concat(t._getActValue("data",a[o],i[o])).concat(u[o]):"".concat(u[o]).concat(t._getActValue("data",a[o],i[o])))):t._checkValueCallback()&&(e.searchResult[p[o]]=void 0)})),f&&p.length===a.length||(this.selectList[o]={key:o,label:s.cn[0],value:r?r({data:a,rows:i}):g,type:h.type||""})},_dealDataForObject:function(){var e=this,t=this,n=t._searchFilterConfig,a=n.data,i=n.rows,o=n.columnsName,s=n.selectConfig,r=n.dataCallback,l=n.config;s.cn.forEach((function(n,c){i[c]?(e._checkValueCallback()&&(e.searchResult[s.en[c]]=t._getActValue("value",a,i[c])),e.selectList[o]={key:o,label:n,value:r?r({data:a,rows:i}):t._getActValue("data",a,i[c]),type:l.type||""}):(t._checkValueCallback()&&(e.searchResult[s.en[c]]=void 0),e._deleteSelect(o))}))},_searchFilterClearAll:function(){var e=this;for(var t in this.selectConfig)if(Object.prototype.hasOwnProperty.call(this.selectConfig,t)){var n=this.selectConfig[t].setValue;n?n.call(this):this.selectConfig[t].en.forEach((function(t){e.searchResult[t]=void 0}))}this.$refs.moreSearch&&this.$refs.moreSearch.resetData("all");try{for(var a in this.selectConfig)if(this.selectConfig.hasOwnProperty(a)){var i=this.selectConfig[a].ref;this.$refs["".concat(i||a,"O")]&&this.$refs["".concat(i||a,"O")].resetData(),this.$refs["".concat(i||a,"H")]&&this.$refs["".concat(i||a,"H")].resetData()}}catch(e){console.error("错误预警：",e)}},_searchFilterClearRef:function(e){console.log("清空它的对手：",e);try{var t=e.config.columnsName||e.config.resultName,n=e.config.type,a=this.selectConfig[t].ref;"filterDown"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):"operation"===n?(this.$refs["".concat(a||t,"O")]&&this.$refs["".concat(a||t,"O")].resetData(),this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),this.$refs.moreSearch&&this.$refs.moreSearch.resetData(t)):this.$refs["".concat(a||t,"H")]&&this.$refs["".concat(a||t,"H")].resetData(),e.config.props&&e.config.props.confirm()}catch(e){console.error("错误预警：",e)}},_resetSearchFilterDefaultData:function(){return this.searchFilterDefaultData={cn:[],en:[],link:"",valueLink:"",dataKey:"",valueKey:"",dataTarget:"",valueTarget:"",linkMode:"",setText:void 0,setValue:void 0},this},moreSearchResultDeal:function(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;n++)this.searchResultDeal(e[t[n]],n!==t.length-1)}}},Mn={name:"DSelectWarehouse",components:{STable:en,Empty:Ln,DOperationBox:an,CellEllipsisTip:Kt},mixins:[ht,Fn],props:{visible:{type:Boolean,default:!1},width:{type:[String,Number],default:1e3},title:{type:String,default:"选择仓库"},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"id"}}},beforeClose:{type:Function,default:void 0},rules:{type:Object,default:function(){}},cache:{type:Boolean,default:!1},defaultValue:{type:[Object,Array],default:null},categoryInit:{type:Number,default:1},selectionLimit:{type:Number,default:100}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},data:function(){return{tableData:[],classifyOptions:[],classifyValue:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:""},resultMap:{},disabled:{warehouse:!1},opened:!1}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},baseReplaceFields:function(){return me({key:"id"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},allClassifyOptions:function(){return[{categoryName:"全部分类",haveChild:!0,isLeaf:!1,id:"1",parentId:"0",pathCode:"1",scopedSlots:{title:"custom"},children:[{categoryName:"未分类",haveChild:!1,id:"0",parentId:"1",isLeaf:!0,pathCode:"0",scopedSlots:{title:"custom"}}].concat(dt(this.classifyOptions))}]}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="id",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&(this.reset().dealResult().loadTableData(),this.loadClassify()),this.opened=!0)}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get(Fe,me(me({},this.searchResult),{},{pageNum:t.current,pageSize:t.pageSize},this.rules)).then((function(t){t.data&&(e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},searchHandle:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},classifySearchHandle:function(e){console.log("分类检索:",e)},classifyOnSelect:function(e,t){console.log("classifyOnSelect",t,this.classifyValue);var n=t.node;this.searchResult.categoryPath=t.selected?n.dataRef.pathCode:null,this.handleSelectedClear().loadTableData()},loadClassify:function(e){var t=this;if(this.$get(Ne,{}).then((function(){})),e)return new Promise((function(n){var a=e.dataRef;t.$get(Ne,{categoryType:2,parentId:a.id}).then((function(e){var i=e.data;i.length&&(a.children=i,t.classifyOptions=dt(t.classifyOptions)),n()}))}));this.$get(Ne,{categoryType:2,parentId:this.categoryInit}).then((function(e){t.classifyOptions=e.data}))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const Pn=Mn;var Nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-warehouse a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"warehouse-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入分类名称"},on:{search:e.classifySearchHandle}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"classify-wrap"},[n("a-tree",{attrs:{loadData:e.loadClassify,replaceFields:{children:"children",value:"id",title:"categoryName",key:"id"},"tree-data":e.allClassifyOptions,defaultExpandedKeys:["1"],defaultSelectedKeys:["1"],showIcon:""},on:{select:e.classifyOnSelect},model:{value:e.classifyValue,callback:function(t){e.classifyValue=t},expression:"classifyValue"}})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"仓库名称"},on:{search:e.searchHandle},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"index",attrs:{width:60},scopedSlots:e._u([{key:"default",fn:function(t,n,a){return[e._v("\n            "+e._s((e.pagination.current-1)*e.pagination.pageSize+a+1)+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:200,"data-index":"name",title:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{width:100,"data-index":"code",title:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t||"-")+"\n          ")]}}])}),e._v(" "),n("a-table-column",{attrs:{title:"地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{tip:""+t.regionName+t.address}},[e._v(" "+e._s(t.regionName)+e._s(t.address)+" ")])]}}])}),e._v(" "),n("a-table-column",{attrs:{width:75,title:"可用"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.erpId?"是":"否")+"\n          ")]}}])})],1)],1)])])};Nn._withStripped=!0;const En=st({render:Nn,staticRenderFns:[]},void 0,Pn,void 0,!1,void 0,!1,void 0,void 0,void 0);En.install=function(e){e.component(En.name,En)};const An=st({},void 0,{name:"DSelectWarehouseInput",props:{name:{type:String,default:"warehouse"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:On,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){this.modalValue=e||void 0},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e,t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];this.multiple=!0===this.valueMode&&t&&!t.length,e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=En,this.dialogProps=it(this.dialogProps,e[this.name],this.dialogConfig)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=it(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"}})},confirmHandle:function(e){["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=me({},this.modalValue))},resultExchange:function(e){var t=e.rows[0];"select"!==this.valueMode&&(this.$emit("input",t),this.modalValue=t),this.$emit("change",me(me({},e),{},{data:this.multiple?e.rows:t,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"}}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:me({},this.dialogProps),props:me(me({},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:Rn}},void 0,void 0,void 0,!1,void 0,void 0,void 0);An.install=function(e){e.component(An.name,An)};var jn=[],Bn=function e(t){for(var n=0;n<t.length;n++){var a=t[n],i=a.id;jn.push({key:i,title:a.categoryName}),a.children&&e(a.children)}},Kn=function e(t,n){for(var a,i=0;i<n.length;i++){var o=n[i];o.children&&(o.children.some((function(e){return e.id===t}))?a=o.id:e(t,o.children)&&(a=e(t,o.children)))}return a},Hn={name:"DSelectProduct",mixins:[ht],provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},props:{visible:{type:Boolean,default:!1},width:{tpye:[String,Number],default:1250},title:{type:String,default:"选择商品"},cache:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},replaceFields:{type:Object,default:function(){return{key:"id"}}},rules:{type:Object,default:function(){return{}}},origin:{type:String,default:"page"},sortList:{type:Array,default:void 0},mode:{type:String,default:"default"},defaultValue:{type:[Object,Array],default:null},displayItems:{type:Array,default:function(){return["classify","warehouse","brand","shelves","inventory","salesPromotion","bought"]}},selectionLimit:{type:Number,default:100}},data:function(){return{modalConfig:{},tableData:[],tableLoading:!1,scrollHeight:0,inventory:!1,promotion:!1,isBought:!1,searchResult:{type:4,isShowSku:!0,keywords:void 0,customerId:void 0,warehouseId:void 0,brandId:void 0,categoryPath:void 0,saleStatus:1,checkList:"",isOverrideWarehouse:"",showList:[]},resultMap:{warehouse:{key:"warehouseId",ref:"warehouseMixSearch"}},disabled:{warehouse:!1},headerConfig:{1:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],2:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}],3:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],4:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"avgPrice"}],5:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"},{key:"levelPrice"}],6:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"stock"},{key:"avgPrice"}],7:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],8:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"}],9:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"unitPrice"}],10:[{key:"code"},{key:"barCode"},{key:"cover"},{key:"name"},{key:"skuName"},{key:"warehouseName"},{key:"stock"},{key:"unitPrice"}]},treeData:[{categoryName:"全部分类",key:"1",pathCode:"",id:"1",children:[{categoryName:"未分类",key:"2",isLeaf:!0,pathCode:"0",id:"2"}]}],name:"warehouse",keywordtree:"",expandedKeys:[],autoExpandParent:!0,searchValue:"",tabLable:"0"}},watch:{visible:function(e){var t=this;e&&(this.selectionContent.primaryKey=this.baseReplaceFields.key,this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.modalConfig={title:"选择商品"},this.$nextTick((function(){t.handleSelectedClear(),t.dealResult(),t.cache||(t.mergeResult(),t.dealResult(),"0"===t.tabLable?t.initTreeData():t.loadTableData())})))}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}},sortColumns:function(){return this.sortList?this.sortList:this.headerConfig[this.searchResult.type]},baseReplaceFields:function(){return me({key:"id",warehouse:"warehouseId"},this.replaceFields)}},filters:{getPrice:function(e){return void 0===e||""===e||null===e?"-":e}},methods:{inventoryChange:function(){this.inventory?this.changeData(!0,"2"):this.changeData(!1,"2")},isBoughtChange:function(){this.isBought?(this.tabLable="1",this.changeData(!0,"1")):(this.searchResult.categoryPath="",this.tabLable="0",this.changeData(!1,"1"))},promotionChange:function(){this.promotion?this.changeData(!0,"3"):this.changeData(!1,"3")},onSearchTree:function(e){var t=this,n=e.target.value,a=jn.map((function(e){return e.title.indexOf(n)>-1?Kn(e.key,t.treeData):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:n,autoExpandParent:!0})},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onLoadData:function(e){var t=this;return new Promise((function(n){e.dataRef.children?n():t.$get(Ne,{categoryType:0,parentId:e.dataRef.id}).then((function(a){"warehouse"===t.name&&(a.data.length&&(e.dataRef.children=a.data,t.treeData=dt(t.treeData),Bn(t.treeData)),n())}))}))},initTreeData:function(){var e=this;this.$get(Ne,{categoryType:0,parentId:0}).then((function(t){e.treeData[0].children=e.treeData[0].children.concat(t.data),Bn(e.treeData),e.treeData&&e.treeData.length>0&&(e.searchResult.categoryPath=e.treeData[0].pathCode,e.loadTableData())}))},changeData:function(e,t){var n;n=this.searchResult.checkList?this.searchResult.checkList.split(","):[],e?n.includes(t)||n.push(t):n.includes(t)&&n.splice(n.indexOf(t),1),this.searchResult.checkList=n.join(","),this.searchReset().loadTableData()},loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.tableLoading=!0,this.$get(De,me(me({},at(this.searchResult)),{},{pageNum:t.current,pageSize:t.pageSize,sort:-1})).then((function(t){t.data&&(e.tableData=t.data.list,e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum)})).catch((function(e){console.error(e)})).finally((function(){e.tableLoading=!1}))},dealResult:function(){var e=this;if("warehouse"===this.mode&&(this.defaultValue&&this.defaultValue[this.baseReplaceFields.warehouse]?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=this.defaultValue[this.baseReplaceFields.warehouse]):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse&&(this.searchResult.warehouseId=this.rules.warehouse.id))),this.rules)for(var t in this.rules)if(this.rules.hasOwnProperty(t)){var n=this.rules[t],a=Ze(n);if("warehouse"===t&&"warehouse"===this.mode)return;"object"===a?(this.$refs[this.resultMap[t].ref]&&this.$refs[this.resultMap[t].ref].setData(n),this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n.id:this.searchResult[t]=n.id,this.disabled[t]=!!n.disabled):this.resultMap[t]?this.searchResult[this.resultMap[t].key]=n:this.searchResult[t]=n}if(this.defaultValue&&(this.selectionContent.selectedRowKeys=[],this.defaultValue.constructor===Array?this.defaultValue.forEach((function(t){e.selectionContent.selectedRowKeys.push(t[e.baseReplaceFields.key]),e.selectionContent.selectedRows=me(me({},e.selectionContent.selectedRows),{},pe({},t[e.baseReplaceFields.key],t))})):(this.selectionContent.selectedRowKeys=[this.defaultValue[this.baseReplaceFields.key]],this.selectionContent.selectedRows=pe({},this.defaultValue[this.baseReplaceFields.key],this.defaultValue))),this.rules.checkList&&this.rules.checkList.length>0){var i=this.rules.checkList.split(",");i.includes("1")?(this.tabLable="1",this.searchResult.categoryPath="",this.isBought=!0):(this.tabLable="0",this.isBought=!1),i.includes("2")?this.inventory=!0:this.tabLable=!1,i.includes("3")?this.promotion=!0:this.promotion=!1}},onSearch:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},saleChange:function(e){var t=e.data;this.searchResult.saleStatus=t,this.searchReset().loadTableData()},warehouseChange:function(e){"warehouse"===this.mode?e.data?(this.searchResult.isOverrideWarehouse=!0,this.searchResult.warehouseId=e.data.id):(this.searchResult.isOverrideWarehouse=!1,this.rules.warehouse?this.searchResult.warehouseId=this.rules.warehouse.id:this.searchResult.warehouseId=void 0):(this.handleSelectedClear(),e.data?this.searchResult.warehouseId=e.data.id:this.searchResult.warehouseId=void 0),this.searchReset().loadTableData()},brandChange:function(){this.handleSelectedClear(),this.searchReset().loadTableData()},selectCurrentNode:function(e,t){this.handleSelectedClear();var n=t.node.dataRef;this.searchResult.categoryPath=t.selected?n.pathCode:null,this.searchReset().loadTableData()},tableChange:function(e,t,n){if(e.current===this.pagination.current||e.pageSize!==this.pagination.pageSize)return this.handleSelectedClear(),e.current=1,void this.loadTableData();this.loadTableData(e)},searchReset:function(){return this.tableData=[],this.pagination.current=1,this.pagination.total=0,this},rowClick:function(e){var t=this;console.log("单击",e),this.multiple?this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])?(this.selectionContent.selectedRowKeys=this.selectionContent.selectedRowKeys.filter((function(n){return n!==e[t.baseReplaceFields.key]})),delete this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]):(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e):(this.selectionContent.selectedRowKeys=[e[this.baseReplaceFields.key]],this.selectionContent.selectedRows=pe({},e[this.baseReplaceFields.key],e))},dbRowClick:function(e){console.log("双击",e),this.selectionContent.selectedRowKeys.includes(e[this.baseReplaceFields.key])||(this.selectionContent.selectedRowKeys.push(e[this.baseReplaceFields.key]),this.selectionContent.selectedRows[e[this.baseReplaceFields.key]]=e),this.okHandle()},mergeResult:function(){this.pagination.current=1,this.searchResult={type:this.rules.type||4,isShowSku:this.rules.isShowSku||!0,keywords:this.rules.keywords||void 0,customerId:this.rules.customerId||void 0,warehouseId:this.rules.warehouseId||void 0,brandId:this.rules.brandId||void 0,categoryPath:this.rules.categoryPath||void 0,saleStatus:this.rules.saleStatus||void 0,checkList:this.rules.saleStatus||""}},okHandle:function(){if(!(this.selectionContent.selectedRowKeys.length>this.selectionLimit))return this.multiple?this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),void this.$emit("update:visible",!1)):void this.$emit("update:visible",!1):void(this.$attrs.product&&this.selectionContent.selectedRowKeys[0]===this.$attrs.product[this.baseReplaceFields.key]?this.$emit("update:visible",!1):this.selectionContent.selectedRowKeys.length?(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.$emit("update:visible",!1)):this.$emit("update:visible",!1));this.$message.warning("最多选择".concat(this.selectionLimit,"条"))},optionClick:function(e){"clear"===e.name&&this.handleSelectedClear()}},components:{OperationBox:an,DSelectWarehouseInput:An,MixSelect:_n,Empty:Ln,HImage:Nt,CellEllipsisTip:Kt,STable:en}};const zn=Hn;var qn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-product a-table-common",attrs:{keyboard:!1,maskClosable:!1,title:e.modalConfig.title,width:e.width},on:{ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{ref:"productModal"},[n("div",{staticClass:"choose-product-content"},["0"===e.tabLable&&e.displayItems.includes("classify")?n("div",{staticClass:"tree-control"},[n("a-input-search",{attrs:{maxLength:40,allowClear:"",placeholder:"请输入分类名称"},on:{change:e.onSearchTree},model:{value:e.keywordtree,callback:function(t){e.keywordtree=t},expression:"keywordtree"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{staticClass:"tree-control-contain"},[n("a-tree",{attrs:{"auto-expand-parent":e.autoExpandParent,"expanded-keys":e.expandedKeys,"load-data":e.onLoadData,replaceFields:{children:"children",title:"categoryName",key:"id"},"tree-data":e.treeData},on:{expand:e.onExpand,select:e.selectCurrentNode}})],1)],1):e._e(),e._v(" "),n("div",{staticClass:"table-control",class:{"table-width":"1"===e.tabLable||!e.displayItems.includes("classify")}},[n("operation-box",{attrs:{"more-search":!1},on:{optionClick:e.optionClick}},[n("a-input-search",{staticStyle:{width:"240px"},attrs:{maxLength:40,allowClear:"",placeholder:"商品名称/编号/条码/关键字"},on:{search:e.onSearch},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),e.displayItems.includes("warehouse")?n("DSelectWarehouseInput",{ref:"warehouseMixSearch",attrs:{disabled:e.disabled.warehouse,width:120,allowClear:"",name:"warehouse",placeholder:"仓库"},on:{change:e.warehouseChange}}):e._e(),e._v(" "),e.displayItems.includes("brand")?n("MixSelect",{attrs:{type:1,width:120,allowClear:""},on:{change:e.brandChange},model:{value:e.searchResult.brandId,callback:function(t){e.$set(e.searchResult,"brandId",t)},expression:"searchResult.brandId"}}):e._e(),e._v(" "),e.displayItems.includes("shelves")?n("MixSelect",{attrs:{list:[{id:1,name:"上架"},{id:0,name:"下架"}],width:120,"allow-clear":"",placeholder:"上下架"},on:{change:e.saleChange},model:{value:e.searchResult.saleStatus,callback:function(t){e.$set(e.searchResult,"saleStatus",t)},expression:"searchResult.saleStatus"}}):e._e(),e._v(" "),e.displayItems.includes("inventory")?n("a-checkbox",{staticClass:"check-line",on:{change:e.inventoryChange},model:{value:e.inventory,callback:function(t){e.inventory=t},expression:"inventory"}},[e._v("库存大于0\n          ")]):e._e(),e._v(" "),e.displayItems.includes("salesPromotion")?n("a-checkbox",{staticClass:"check-line",on:{change:e.promotionChange},model:{value:e.promotion,callback:function(t){e.promotion=t},expression:"promotion"}},[e._v("促销商品\n          ")]):e._e(),e._v(" "),e.displayItems.includes("bought")?n("a-checkbox",{staticClass:"check-line",on:{change:e.isBoughtChange},model:{value:e.isBought,callback:function(t){e.isBought=t},expression:"isBought"}},[e._v("买过商品\n          ")]):e._e()],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table-content",attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:e.selectionContent.primaryKey,scroll:{y:"calc(100vh - 490px)"},"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"code",attrs:{"data-index":"code",title:"商品编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"barCode",attrs:{title:"商品条码"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.barCode||"-"}})]}}])}),e._v(" "),n("a-table-column",{key:"cover",attrs:{title:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("h-image",{staticStyle:{width:"48px",height:"48px"},attrs:{initial:0,"preview-src-list":[t.cover],src:e._f("formatImage")(t.cover,48),fit:"cover",popover:""}})]}}])}),e._v(" "),n("a-table-column",{key:"name",attrs:{title:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.name}})]}}])}),e._v(" "),n("a-table-column",{key:"skuName",attrs:{"data-index":"skuName",title:"规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"warehouseName",attrs:{"data-index":"warehouseName",title:"仓库"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t||"-")+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"stock",attrs:{"data-index":"stock",title:"库存数量"}}),e._v(" "),n("a-table-column",{key:"avgPrice",attrs:{"data-index":"avgPrice",title:"成本均价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"lastPrice",attrs:{"data-index":"lastPrice",title:"最近进价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"baseUnitName",attrs:{"data-index":"baseUnitName",title:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"unitPrice",attrs:{"data-index":"unitPrice",title:"单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])}),e._v(" "),n("a-table-column",{key:"levelPrice",attrs:{"data-index":"levelPrice",title:"级别价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("getPrice")(t))+"\n            ")]}}])})],1)],1)])])])};qn._withStripped=!0;const Yn=st({render:qn,staticRenderFns:[]},void 0,zn,void 0,!1,void 0,!1,void 0,void 0,void 0);Yn.install=function(e){e.component(Yn.name,Yn)};var Wn={name:"DSelectPeople",mixins:[ht,Fn],components:{CellEllipsisTip:Kt,STable:en,DOperationBox:an,Empty:Ln},props:{width:{type:Number,default:1e3},cache:{type:Boolean,default:!1},visible:{type:Boolean,default:!1},title:{type:String,default:"选择经手人"},placeholderLeft:{type:String,default:"请输入部门名称"},placeholderRight:{type:String,default:"姓名/手机号"},multiple:{type:Boolean,default:!1},beforeClose:{type:Function,default:void 0},replaceFields:{type:Object,default:function(){}},rules:{type:Object,default:function(){return{}}},defaultValue:{type:[Object,Array],default:null},selectionLimit:{type:Number,default:100}},data:function(){return{corpTree:{data:[],keywords:null,expandedKeys:[],selectedKeys:[],autoExpandParent:!0,treeFirstNode:null,loading:!1},tableData:[],searchData:[],tableLoading:!1,searchResult:{keywords:"",categoryPath:{}},opened:!1}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="stafferId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),(!this.cache||this.cache&&!this.opened)&&this.reset().dealResult().getCorpTree(),this.opened=!0)}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},baseReplaceFields:function(){return me({key:"stafferId"},this.replaceFields)},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.tableLoading}})}}},methods:{onSelectCorpTreeNode:function(e,t){console.log("onSelectCorpTreeNode",e,t),t.selected?this.corpTree.selectedKeys=[t.node.dataRef.businessId]:this.corpTree.selectedKeys=[this.corpTree.treeFirstNode.businessId],this.searchResult.categoryPath=t.selected?t.node.dataRef:this.corpTree.treeFirstNode,this.dealResult().loadTableData()},onExpand:function(e){this.corpTree.expandedKeys=e,this.corpTree.autoExpandParent=!1},getParentKey:function(e,t){for(var n,a=0;a<t.length;a++){var i=t[a];i.children&&(i.children.some((function(t){return t.businessId===e}))?n=i.businessId:this.getParentKey(e,i.children)&&(n=this.getParentKey(e,i.children)))}return n},onSearchTree:function(e){var t=this,n=e.target.value;this.corpTree.expandedKeys=this.searchData.map((function(e){return e.name.indexOf(n)>-1?t.getParentKey(e.businessId,t.corpTree.data):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t})),this.corpTree.autoExpandParent=!0},handleSearchByKeywords:function(){this.handleSelectedClear(),this.pagination.current=1,this.loadTableData()},loadTableData:function(){var e=arguments,t=this;return ve(be.mark((function n(){var a,i,o;return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:t.pagination,n.prev=1,t.tableLoading=!0,n.next=5,t.$post(Be,me({corpId:t.searchResult.categoryPath.corpId||"",departmentId:t.searchResult.categoryPath.businessId||"",keyword:t.searchResult.keywords||"",dismiss:!1,entryDateBegin:"",entryDateEnd:"",isAdmin:"",locked:!1,normal:!0,pageNum:a.pageNum||1,pageSize:a.pageSize||30},t.rules));case 5:i=n.sent,o=i.data,t.tableData=o.list,t.dealSelectionCheckBox(),t.pagination.total=o.total,t.pagination.current=o.pageNum,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(1),console.error(n.t0);case 16:return n.prev=16,t.tableLoading=!1,n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[1,13,16,19]])})))()},getCorpTree:function(){var e=this;return ve(be.mark((function t(){var n,a;return be.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.corpTree.loading=!0,t.next=4,e.$get(je);case 4:n=t.sent,a=n.data,e.corpTree.data=a,function t(n){var a=[];return n.forEach((function(n){n.scopedSlots={title:"title"},e.searchData.push(n),n.children&&n.children.length&&t(n.children),a.push(n)})),a}(a),e.corpTree.data&&e.corpTree.data.length>0&&(e.corpTree.treeFirstNode=e.corpTree.data[0],e.corpTree.selectedKeys=[e.corpTree.treeFirstNode.businessId],e.searchResult.categoryPath=e.corpTree.data[0],e.loadTableData()),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0);case 15:return t.prev=15,e.corpTree.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})))()},handleOk:function(){if(this.selectionContent.selectedRowKeys.length>this.selectionLimit)this.$message.warning("最多选择".concat(this.selectionLimit,"条"));else{var e={data:this.selectionContent.selectedRowKeys,rows:this.getRowData()};this.beforeClose?this.beforeClose(e):this.$emit("confirm",e),this.$emit("update:visible",!1)}},reset:function(){return this.tableData=[],this.corpTree.keywords="",this.corpTree.expandedKeys=[],this.corpTree.selectedKeys=[],this.corpTree.autoExpandParent=!0,this.corpTree.data=[],this.searchResult={keywords:"",categoryPath:{}},this.corpTree.treeFirstNode=null,this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this},onOperationClick:function(e){"clear"===e.name&&this.handleSelectedClear()},handleCancel:function(){this.$emit("cancel"),this.$emit("update:visible",!1)}}};const Gn=Wn;var Un=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-people a-table-common modal-reset-no-padding",attrs:{footer:null,keyboard:!1,maskClosable:!1,title:e.title,width:e.width,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"people-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:e.placeholderLeft,allowClear:""},on:{change:e.onSearchTree},model:{value:e.corpTree.keywords,callback:function(t){e.$set(e.corpTree,"keywords",t)},expression:"corpTree.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.corpTree.loading,expression:"corpTree.loading"}],staticClass:"classify-wrap"},[n("a-tree",{attrs:{"auto-expand-parent":e.corpTree.autoExpandParent,"expanded-keys":e.corpTree.expandedKeys,replaceFields:{children:"children",title:"name",key:"businessId"},"selected-keys":e.corpTree.selectedKeys,"tree-data":e.corpTree.data},on:{expand:e.onExpand,select:e.onSelectCorpTreeNode},scopedSlots:e._u([{key:"title",fn:function(t){var a=t.name;return[a.indexOf(e.corpTree.keywords)>-1?n("span",[e._v("\n              "+e._s(a.substr(0,a.indexOf(e.corpTree.keywords)))+"\n              "),n("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.corpTree.keywords))]),e._v("\n              "+e._s(a.substr(a.indexOf(e.corpTree.keywords)+e.corpTree.keywords.length))+"\n            ")]):n("span",[e._v(e._s(a))])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationClick}},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholderRight,allowClear:""},on:{search:e.handleSearchByKeywords},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("搜索")])],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{"data-index":"name",title:"姓名"}}),e._v(" "),n("a-table-column",{key:"stafferNo",attrs:{"data-index":"stafferNo",title:"编号"}}),e._v(" "),n("a-table-column",{key:"departmentName",attrs:{title:"部门"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("CellEllipsisTip",{attrs:{text:e.departmentName}})]}}])}),e._v(" "),n("a-table-column",{key:"mobile",attrs:{"data-index":"mobile",title:"联系电话"}})],1)],1)]),e._v(" "),n("div",{staticClass:"select-people-footer"},[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n    "),n("a-button",{attrs:{disabled:!e.selectionContent.selectedRowKeys||0===e.selectionContent.selectedRowKeys.length,type:"primary"},on:{click:e.handleOk}},[e._v("\n      确 定\n    ")])],1)])};Un._withStripped=!0;const Xn=st({render:Un,staticRenderFns:[]},void 0,Gn,void 0,!1,void 0,!1,void 0,void 0,void 0);Xn.install=function(e){e.component(Xn.name,Xn)};var Jn={name:"DSelectSaleArea",props:{width:{require:!1,type:String,default:"120"},maxHeight:{require:!1,type:String,default:"300"},placeholder:{require:!1,type:String,default:"销售区域"}},data:function(){return{value:void 0,parentId:0,replaceFields:{children:"children",value:"id",title:"name",key:"id"},treeData:[],apiName:null}},created:function(){this.treeData.length||this.getList([],!1)},methods:{openSelect:function(){this.treeData.length||this.getList([],!1)},getList:function(){var e=arguments,t=this;return ve(be.mark((function n(){var a,i,o,s;return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:[],i=e.length>1&&void 0!==e[1]&&e[1],n.prev=2,n.next=5,t.$post(Re,{businessId:t.parentId});case 5:o=n.sent,(s=o.data).length>0&&(i?(a.children=s,t.treeData=dt(t.treeData)):t.treeData=s),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,10]])})))()},onLoadData:function(e){var t=this;return new Promise((function(n){var a=e.dataRef;a.hasChildren?setTimeout((function(){t.parentId=a.id,t.getList(a,!0),n()}),300):n()}))},changeValue:function(e){this.$emit("sureSelect",e)}}};const Qn=Jn;var Zn=function(){var e=this,t=e.$createElement;return(e._self._c||t)("a-tree-select",{style:{width:e.width+"px"},attrs:{allowClear:"","tree-data-simple-mode":"","dropdown-style":{width:+e.width+60+"px",maxHeight:e.maxHeight+"px",overflow:"auto"},"tree-data":e.treeData,placeholder:e.placeholder,"load-data":e.onLoadData,replaceFields:e.replaceFields},on:{change:e.changeValue},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})};Zn._withStripped=!0;const ea=st({render:Zn,staticRenderFns:[]},void 0,Qn,"data-v-1c52a95a",!1,void 0,!1,void 0,void 0,void 0);ea.install=function(e){e.component(ea.name,ea)};var ta={name:"DSelectCustomer",components:{Empty:Ln,SelectSaleArea:ea,DOperationBox:an,CellEllipsisTip:Kt,STable:en},mixins:[ht,Fn],props:{visible:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},cache:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:[Number,String],default:1e3},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{key:"businessId"}}},attrs:{type:Object,default:function(){}},defaultSelectedRowKeys:{type:Object,default:function(){return{selectedRowKeys:[],selectedRows:[]}}},isShowPrice:{type:Boolean,default:!1},customerType:{type:Array,default:function(){return[1,2,3,4]}},sortList:{type:Array,default:void 0},defaultValue:{type:[Array,Object],default:void 0},beforeClose:{type:Function,default:void 0},selectionLimit:{type:Number,default:100},placeholder:{type:String,default:null}},data:function(){return{tableData:[],levelPrices:{data:[],loading:!1},searchResult:{customerTypeIds:[],keywords:null,priceLevelId:null,regionId:null},customers:{loading:!1},categories:{keyword:"",data:[],loading:{}}}},provide:function(){return{selectionContent:this.selectionContent,pagination:this.pagination}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},filteredCategories:function(){var e=this;return this.categories.keyword?this.categories.data.filter((function(t){return t.label.indexOf(e.categories.keyword)>-1})):this.categories.data},locale:function(){return{emptyText:this.$createElement("empty",{props:{loading:this.customers.loading}})}},baseReplaceFields:function(){return me({key:"businessId"},this.replaceFields)},sortColumns:function(){return this.sortList?this.sortList:[{key:"name"},{key:"region"},{key:"priceLevel"}]},getTitle:function(){return this.customerType.includes(1)&&this.customerType.includes(2)?"客户":this.customerType.includes(1)?"供应商":"客户"},tablePlaceholder:function(){return this.placeholder?this.placeholder:"".concat(this.getTitle,"名称/联系人/手机")}},watch:{visible:function(e){e&&(this.selectionContent.primaryKey="businessId",this.selectionConfig.selections=!1,this.setRowSelection({type:this.multiple?"checkbox":"radio"}),this.cache||(this.reset().dealResult().loadTableData(),this.handleFetchCategories(),this.handleFetchLevelPrice()))},defaultSelectedRowKeys:{handler:function(e){var t=ae.deepClone(e);this.selectionContent.selectedRowKeys=t.selectedRowKeys,this.selectionContent.selectedRows=t.selectedRows},immediate:!0}},filters:{balance:function(e,t){if(e){var n=e.filter((function(e){return e.value===t}));return n.length?n[0].label:"-"}return"-"}},methods:{loadTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pagination;this.customers.loading=!0,this.$post(Oe,me(me({pageNum:t.current,pageSize:t.pageSize,orderCustomerTypeList:this.customerType,keyword:this.searchResult.keywords},this.searchResult),this.rules)).then((function(t){e.tableData=t.data.list,e.dealSelectionCheckBox(),e.pagination.total=t.data.total,e.pagination.current=t.data.pageNum})).finally((function(){e.customers.loading=!1}))},onCustomersSearch:function(e,t){this.searchResult[e]=t,this.handleSelectedClear().loadTableData()},handleOk:function(){var e=this;this.selectionContent.selectedRowKeys.length>this.selectionLimit?this.$message.warning("最多选择".concat(this.selectionLimit,"条")):this.beforeClose?this.beforeClose({data:this.selectionContent.selectedRowKeys,rows:this.getRowData()},(function(){e.modalVisible=!1})):(this.$emit("confirm",{data:this.selectionContent.selectedRowKeys,rows:this.getRowData()}),this.modalVisible=!1)},handleFetchCategories:function(){var e=this;this.categories.loading=!0,this.$post(Ve).then((function(t){e.categories.data=t.data||[]})).catch((function(e){return console.error(e)})).finally((function(){e.categories.loading=!1}))},handleFetchLevelPrice:function(){var e=this;this.isShowPrice&&(this.levelPrices.loading=!0,this.$post(Ae).then((function(t){e.levelPrices.data=t.data||[]})).finally((function(){e.levelPrices.loading=!1})))},onOperationOptionClick:function(e){"clear"===e.name&&this.handleSelectedClear()},reset:function(){return this.tableData=[],this.handleSelectedClear(),this.pagination.current=1,this.pagination.total=0,this}}};const na=ta;var aa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",e._b({staticClass:"d-select-customer a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.title||"选择"+e.getTitle,width:e.width},on:{ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},"a-modal",e.attrs,!1),[n("div",{staticClass:"customer-content"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{attrs:{maxLength:40,placeholder:"请输入分类名称"},model:{value:e.categories.keyword,callback:function(t){e.$set(e.categories,"keyword",t)},expression:"categories.keyword"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.categories.loading,expression:"categories.loading"}],staticClass:"classify-wrap"},[n("a-checkbox-group",{attrs:{name:"checkboxgroup"},on:{change:function(t){return e.onCustomersSearch("customerTypeIds",arguments[0])}},model:{value:e.searchResult.customerTypeIds,callback:function(t){e.$set(e.searchResult,"customerTypeIds",t)},expression:"searchResult.customerTypeIds"}},[n("a-row",[n("a-space",{attrs:{direction:"vertical"}},e._l(e.filteredCategories,(function(t,a){return n("a-col",{key:a,attrs:{span:24}},[n("a-checkbox",{attrs:{value:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])],1)})),1)],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"table-content"},[n("d-operation-box",{attrs:{"more-search":!1},on:{optionClick:e.onOperationOptionClick}},[n("a-space",[n("a-input-search",{attrs:{maxLength:40,placeholder:e.tablePlaceholder},on:{search:function(t){return e.onCustomersSearch("keywords",arguments[0])}},model:{value:e.searchResult.keywords,callback:function(t){e.$set(e.searchResult,"keywords",t)},expression:"searchResult.keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.isShowPrice?n("a-select",{staticStyle:{width:"120px"},attrs:{loading:e.levelPrices.loading,allowClear:"",placeholder:"级别价"},on:{change:function(t){return e.onCustomersSearch("priceLevelId",arguments[0])}}},e._l(e.levelPrices.data,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1):e._e(),e._v(" "),n("select-sale-area",{staticClass:"select-area",attrs:{placeholder:"销售区域"},on:{sureSelect:function(t){return e.onCustomersSearch("regionId",arguments[0])}}})],1)],1),e._v(" "),n("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.customers.loading,expression:"customers.loading"}],attrs:{customRow:function(t){return{on:{click:function(){e.rowClick(t)},dblclick:function(){e.dbRowClick(t)}}}},"data-source":e.tableData,locale:e.locale,pagination:e.pagination,rowKey:e.selectionContent.primaryKey,rowSelection:e.rowSelection,scroll:{y:"calc(100vh - 490px)"},selectOnIndeterminate:e.selectOnIndeterminate,"sort-list":e.sortColumns},on:{change:e.tableChange}},[n("a-table-column",{key:"name",attrs:{title:e.getTitle+"名称","data-index":"name"}}),e._v(" "),n("a-table-column",{key:"region",attrs:{title:"销售区域"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("cell-ellipsis-tip",{attrs:{line:2,tip:""+t.region}},[e._v("\n              "+e._s(t.region)+"\n            ")])]}}])}),e._v(" "),n("a-table-column",{key:"priceLevel",attrs:{"data-index":"priceLevel",title:"级别价"}}),e._v(" "),n("a-table-column",{key:"balanceList1",attrs:{title:"应收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,1))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList2",attrs:{title:"应付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,2))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList3",attrs:{title:"预收"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,3))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList4",attrs:{title:"预付"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,4))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList5",attrs:{title:"积分"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,5))+"\n          ")]}}])}),e._v(" "),n("a-table-column",{key:"balanceList6",attrs:{title:"第三方ERP"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("balance")(t.balanceList,6))+"\n          ")]}}])})],1)],1)])])};aa._withStripped=!0;const ia=st({render:aa,staticRenderFns:[]},void 0,na,void 0,!1,void 0,!1,void 0,void 0,void 0);ia.install=function(e){e.component(ia.name,ia)};const oa=st({},void 0,{name:"SelectGroup",props:{value:{type:[String,Boolean,Number,Array],default:void 0},options:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}}},computed:{baseReplaceFields:function(){return me({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}}},methods:{lineClick:function(e){if(this.multiple)if(this.checkValue.includes(e[this.baseReplaceFields.key])){var t=this.checkValue.indexOf(e[this.baseReplaceFields.key]);this.checkValue.splice(t,1)}else this.checkValue.push(e[this.baseReplaceFields.key]);else this.checkValue=e[this.baseReplaceFields.key]},getData:function(){var e=this,t=this.options.filter((function(t){return e.multiple?e.checkValue.includes(t[e.baseReplaceFields.key]):t[e.baseReplaceFields.key]===e.checkValue}));return{checkValue:this.checkValue,data:this.checkValue,rows:t}}},render:function(e){var t=this;return e(t.multiple?"a-checkbox-group":"a-radio-group",{props:{value:t.checkValue,name:t.multiple?"a-checkbox-group":"a-radio-group"},on:{input:function(e){t.checkValue=e}},class:"group-out-box"},t.options.map((function(n,a){return e(t.multiple?"a-checkbox":"a-radio",{attrs:{value:n[t.baseReplaceFields.key],key:a},key:a,props:{key:a},on:{click:function(e){e.stopPropagation()}}},n[t.baseReplaceFields.name])})))}},void 0,void 0,void 0,!1,void 0,void 0,void 0),sa={name:"DSelectProductAttr",components:{SelectGroup:oa,Empty:Ln},props:{value:{type:Object,default:null},visible:{type:Boolean,default:!1},width:{type:Number,default:816},destory:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入搜索关键字"},type:{type:Number,default:0},productId:{type:Array,default:function(){return[]}},inputValue:{type:String,default:""},replaceFields:{type:Object,default:function(){return{}}},rules:{type:Object,default:function(){return{}}}},data:function(){return{selectValue:void 0,keywords:"",options:[],loading:!1}},watch:{modalVisible:{handler:function(e){e&&(this.init(),this.value&&(this.selectValue=this.value.id)),this.rules.keywords&&(this.keywords=this.rules.keywords)},immediate:!0}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},title:function(){var e=this.type;return 0===e?"选择单位":1===e?"选择品牌":2===e?"选择标签":3===e?"选择单位":"选择仓库"},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t.name.match(e.keywords))return t})):this.options},baseReplaceFields:function(){return me({key:"id",name:"name"},this.replaceFields)}},methods:{init:function(){var e=this;this.loading=!0,4===this.type?this.$get(Ee,me({pageNum:1,pageSize:100},this.rules)).then((function(t){e.options=t.data.list})).finally((function(){e.loading=!1})):3===this.type?this.$post(Me,this.productId).then((function(t){e.options=t.data.map((function(e){return me(me({},e),{},{name:e.unitName})}))})).finally((function(){e.loading=!1})):this.$post(Ie,me({type:this.type},this.rules)).then((function(t){e.options=t.data})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1}))},handlerAfterClose:function(){this.$emit("afterClose")},handleOk:function(){var e=this,t=this.options.find((function(t){return t.id===e.selectValue})),n=this.options.filter((function(t){return t.id===e.selectValue}));this.$emit("confirm",{data:t,rows:n,baseRows:this.options}),this.modalVisible=!1}}};var ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{afterClose:e.handlerAfterClose,destroyOnClose:e.destory,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:function(t){e.modalVisible=!1},ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1)],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},[n("select-group",{attrs:{options:e.filteredOptions,replaceFields:e.baseReplaceFields},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};ra._withStripped=!0;const la=st({render:ra,staticRenderFns:[]},void 0,sa,void 0,!1,void 0,!1,void 0,void 0,void 0);la.install=function(e){e.component(la.name,la)};var ca="SYS_0000",ua={0:"付款账户选择",1:"多账户选择"};const da={name:"DSelectPayAccount",components:{Empty:Ln},filters:{payAccountConvert:function(e){var t=gn.find((function(t){return t.id===e}));return t?t.name:"--"}},props:{type:{type:Number,default:0},width:{type:[String,Number],default:816},visible:{type:Boolean,default:!1},payType:{type:Number,default:1},dueMoney:{type:[Number,String],default:0},customerId:{type:[String,Number],default:""},beforeClose:{type:Function,default:null},cache:{type:Boolean,default:!1},rules:{type:Object,default:function(){return{}}},excludeAccountTypes:{type:Array,default:function(){return[]}},defaultValue:{type:[String,Number,Array,Object],default:null},verifyTotalMoney:{type:Boolean,default:!0}},data:function(){return{modalTitles:ua,loading:!1,tableData:[],totalMoney:0,keywords:null}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},locale:function(){return{emptyText:this.$createElement("Empty",{props:{loading:this.loading}})}},filteredTableData:function(){var e=this;return this.keywords?this.includedTableData.filter((function(t){var n=t.name,a=t.bankDeposit,i=t.accountNumber;if(n.match(e.keywords)||a.match(e.keywords)||i.match(e.keywords))return t})):this.includedTableData},includedTableData:function(){var e=this;return this.tableData.filter((function(t){if(!e.excludeAccountTypes.includes(t.type))return t}))}},watch:{visible:function(e){e&&!this.cache?this.loadData():this.tableData.length||this.loadData(),this.rules.keywords&&(this.keywords=this.rules.keywords)}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,this.$get(Ke,me({accountType:this.payType,customerId:this.customerId},this.rules)).then((function(t){var n=t.code,a=t.data;if(n===ca){if(e.tableData=a.map((function(t,n){if(0===e.type){var a=!1;return e.defaultValue&&(a=e.defaultValue===t.accountId),me({checked:a,payMoney:0,index:n+1,sort:n+1,accountType:t.type},t)}if(1===e.type){var i=0;if(e.defaultValue&&"[object Array]"===Object.prototype.toString.call(e.defaultValue)){var o=e.defaultValue.find((function(e){return e.accountId===t.accountId}));o&&(i=o.payMoney,t.payMoney=o.payMoney,e.payMoneyBlur(t))}return me({payMoney:i,index:n+1,sort:n+1,accountType:t.type},t)}})),0===e.type&&e.tableData.length&&!e.tableData.find((function(e){return e.checked}))){var i=e.tableData.find((function(e){return 2===e.type}));i?i.checked=!0:e.tableData[0].checked=!0}e.$emit("data",e.tableData)}})).finally((function(){e.loading=!1}))},handleOk:function(){var e=this,t=null;if(1===this.type){var n=this.filteredTableData.filter((function(e){return e.checked=void 0,Number(e.payMoney)}));if(t={type:this.type,disabled:this.filteredTableData.length>1,paymentAccounts:n,payMoney:this.totalMoney},this.verifyTotalMoney&&t.payMoney>this.dueMoney)return void this.$message.error("请输入最大本次应付金额且最多2位小数的数值")}else t=this.filteredTableData.filter((function(e){return e.checked}));this.beforeClose?this.beforeClose({data:t,rows:t},(function(){e.$emit("update:visible",!1)})):(this.$emit("confirm",{data:t,rows:t}),this.$emit("update:visible",!1))},payMoneyBlur:function(e){1===e.type&&e.payMoney>e.balance&&(this.$message.error("预付金额小于本次付款金额，无法完成抵扣。"),e.payMoney=0),e.payMoney=ie.fmtNum(e.payMoney,!1,2,!1);var t=this.tableData.reduce((function(e,t){return e+Number(t.payMoney)}),0);this.totalMoney=ie.fmtNum(t,!1,2,!1)},handleCancel:function(){this.$emit("update:visible",!1)},radioChange:function(e){var t=this;this.filteredTableData.forEach((function(e){return e.checked=!1})),this.$nextTick((function(){t.filteredTableData[e].checked=!0}))}}};var ha=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-pay-account a-table-common modal-reset-no-padding",attrs:{keyboard:!1,maskClosable:!1,title:e.modalTitles[e.type],width:e.width,"cancel-text":"取消(Esc)","ok-text":"确定(Enter)"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[0===e.type?n("div",{staticClass:"single-account"},[n("div",{staticClass:"table-classify"},[n("a-input-search",{staticClass:"classify-input-search",attrs:{maxLength:40,placeholder:"请输入关键字"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),n("a-table",{attrs:{customRow:function(t,n){return{on:{click:function(){e.radioChange(n)}}}},"data-source":e.filteredTableData,loading:e.loading,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},"row-key":"index"}},[n("a-table-column",{key:"index",attrs:{width:64,align:"center","data-index":"index"},scopedSlots:e._u([{key:"default",fn:function(t,a,i){return[n("span",{on:{click:function(t){return e.radioChange(i)}}},[n("a-radio",{attrs:{checked:a.checked}})],1)]}}],null,!1,4291464169)}),e._v(" "),n("a-table-column",{attrs:{width:160,"data-index":"type",title:"账户类型"},scopedSlots:e._u([{key:"default",fn:function(t,n){return[e._v("\n          "+e._s(e._f("payAccountConvert")(n.type))+"\n        ")]}}],null,!1,2287724343)}),e._v(" "),n("a-table-column",{attrs:{width:192,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{key:"bankDeposit",attrs:{width:160,"data-index":"bankDeposit",title:"开户银行"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)}),e._v(" "),n("a-table-column",{key:"accountNumber",attrs:{width:160,"data-index":"accountNumber",title:"银行账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t||"-")+"\n        ")]}}],null,!1,2524362810)})],1)],1):n("div",{staticClass:"multiple-account"},[n("div",{staticClass:"dialog-pay"},[e._v("应"+e._s(1===e.payType?"付":"收")+"金额：¥"+e._s(e.dueMoney))]),e._v(" "),n("a-table",{staticClass:"account",attrs:{"data-source":e.filteredTableData,locale:e.locale,pagination:!1,scroll:{y:"calc(100vh - 350px)"},bordered:"",rowKey:"index"}},[n("a-table-column",{key:"index",staticClass:"style-padding",attrs:{width:88,align:"center","data-index":"index",title:"行号"}}),e._v(" "),n("a-table-column",{staticClass:"style-padding",attrs:{width:358,"data-index":"name",title:"账户名称"}}),e._v(" "),n("a-table-column",{attrs:{width:"100%","data-index":"payMoney",title:"金额"},scopedSlots:e._u([{key:"default",fn:function(t,a){return[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},on:{blur:function(t){return e.payMoneyBlur(a)}},model:{value:a.payMoney,callback:function(t){e.$set(a,"payMoney",t)},expression:"record.payMoney"}})]}}])}),e._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"total"},[n("div",{staticClass:"name"},[e._v("合计")]),e._v(" "),n("div",{staticStyle:{width:"358px"}}),e._v(" "),n("div",{staticClass:"money"},[e._v(e._s(e.totalMoney))])])])],2)],1)])};ha._withStripped=!0;const pa=st({render:ha,staticRenderFns:[]},void 0,da,void 0,!1,void 0,!1,void 0,void 0,void 0);function fa(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}pa.install=function(e){e.component(pa.name,pa)};var ma=function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.__PARENTSAPPJSONP__&&window.__POWERED_BY_QIANKUN__?window.__PARENTSAPPJSONP__(n,(function(e){t=e})):window.TMAPCALLBACK[n]=function(e){t=e},document.body.appendChild(a);var i=function(){document.body.removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},ga={"北京市":{city:"北京市",short:"京",lng:"116.39737",lat:"39.939502"},"天津市":{city:"天津市",short:"津",lng:"117.133262",lat:"39.256321"},"上海市":{city:"上海市",short:"沪",lng:"121.36464",lat:"31.303465"},"重庆市":{city:"重庆市",short:"渝",lng:"106.32485",lat:"29.895013"},"河北省":{city:"石家庄",short:"冀",lng:"114.336873",lat:"38.21885"},"山西省":{city:"太原",short:"晋",lng:"112.349964",lat:"38.044464"},"辽宁省":{city:"沈阳",short:"辽",lng:"123.241164",lat:"41.948112"},"吉林省":{city:"长春",short:"吉",lng:"125.228072",lat:"43.894927"},"黑龙江省":{city:"哈尔滨",short:"黑",lng:"126.479088",lat:"45.985284"},"江苏省":{city:"南京",short:"苏",lng:"118.715429",lat:"32.246466"},"浙江省":{city:"杭州",short:"浙",lng:"120.040035",lat:"30.350837"},"安徽省":{city:"合肥",short:"皖",lng:"117.170056",lat:"31.99595"},"福建省":{city:"福州",short:"闽",lng:"119.156964",lat:"26.182279"},"江西省":{city:"南昌",short:"赣",lng:"115.808656",lat:"28.774611"},"山东省":{city:"济南",short:"鲁",lng:"116.912494",lat:"36.812038"},"河南省":{city:"郑州",short:"豫",lng:"113.453802",lat:"34.895028"},"湖北省":{city:"武汉",short:"鄂",lng:"114.116105",lat:"30.764814"},"湖南省":{city:"长沙",short:"湘",lng:"112.800698",lat:"28.474291"},"广东省":{city:"广州",short:"粤",lng:"113.233035",lat:"23.224606"},"海南省":{city:"海口",short:"琼",lng:"110.179083",lat:"19.921006"},"四川省":{city:"成都",short:"川",lng:"103.924003",lat:"30.796585"},"贵州省":{city:"贵阳",short:"黔",lng:"106.499624",lat:"26.844365"},"云南省":{city:"昆明",short:"滇",lng:"102.599397",lat:"25.248948"},"陕西省":{city:"西安",short:"陕",lng:"108.780889",lat:"34.408508"},"甘肃省":{city:"兰州",short:"甘",lng:"103.66644",lat:"36.218003"},"青海省":{city:"西宁",short:"青",lng:"101.605943",lat:"36.752842"},"西藏自治区":{city:"拉萨",short:"藏",lng:"90.972306",lat:"29.838888"},"广西壮族自治区":{city:"南宁",short:"桂",lng:"108.265765",lat:"23.020403"},"内蒙古自治区":{city:"呼和浩特",short:"蒙",lng:"111.614073",lat:"40.951504"},"宁夏回族自治区":{city:"银川",short:"宁",lng:"106.094884",lat:"38.624116"},"新疆维吾尔自治区":{city:"乌鲁木齐",short:"新",lng:"87.476819",lat:"43.894927"},"香港特别行政区":{city:"香港",short:"港",lng:"114.1529",lat:"22.542716"},"澳门地区":{city:"澳门",short:"澳",lng:"113.417008",lat:"22.337477"},"台湾省":{city:"台北",short:"台.",lng:"121.36464",lat:"25.248948"}},va="https://apis.map.qq.com",ya={geocoder:"".concat(va,"/ws/geocoder/v1"),placeSearch:"".concat(va,"/ws/place/v1/search"),placeExplore:"".concat(va,"/ws/place/v1/explore"),placeDetail:"".concat(va,"/ws/place/v1/detail"),placeSuggestion:"".concat(va,"/ws/place/v1/suggestion"),district:"".concat(va,"/ws/district/v1"),directionDriving:"".concat(va,"/ws/direction/v1/driving"),directionTransit:"".concat(va,"/ws/direction/v1/transit"),directionWalking:"".concat(va,"/ws/direction/v1/walking"),directionBicycling:"".concat(va,"/ws/direction/v1/bicycling"),distanceMatrix:"".concat(va,"/ws/distance/v1/matrix"),locationIP:"".concat(va,"/ws/location/v1/ip"),staticmap:"".concat(va,"/ws/staticmap/v2"),coordTranslate:"".concat(va,"/ws/coord/v1/translate")},ba=function(e){var t="";if(e)for(var n in e)e.hasOwnProperty(n)&&(t+="".concat(t?"".concat(t,"&"):"").concat(n,"=").concat(e[n]));return t},ka=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=null,this.mapOptions={key:"T74BZ-KJV6U-EVEVH-B2ZLQ-YIZQF-3PFPB",container:"map",center:{lat:39.908802,lng:116.397502},zoom:16,location:!1,showMarker:!1,success:null,fail:null},this.varia={queue:[],mapStatus:!1,centerMarker:null,on:{tilesloaded:null}},this._init(t)}var t,n,a,i;return t=e,n=[{key:"_init",value:function(e){this._initConfig(e),e&&e.container&&(this._initMap(),this._afterInit())}},{key:"_initConfig",value:function(e){this.mapOptions=this.merge(this.mapOptions,e)}},{key:"_initMap",value:(i=ve(be.mark((function e(){var t=this;return be.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=this.mapOptions.key,ma("https://map.qq.com/api/gljs?v=1.exp&key=".concat(n,"&callback=TMapLoad"));case 2:this.mapOptions.center=this.latLng(this.mapOptions.center),this.map=new TMap.Map(this.mapOptions.container,this.mapOptions),this.map.once("tilesloaded",(function(){t.varia.mapStatus=!0,t.runQueue(),t.mapOptions.success&&t.mapOptions.success()}));case 5:case"end":return e.stop()}var n}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_afterInit",value:function(){this.mapOptions.location&&this.location(),this.mapOptions.showMarker&&this.setMarker(this.mapOptions.center)}},{key:"run",value:function(e,t){this.varia.mapStatus?this[e](t):this.varia.queue.push({name:e,options:t})}},{key:"on",value:function(e,t){console.log(e,t)}},{key:"runQueue",value:function(){var e=this;this.varia.queue.forEach((function(t){e[t.name](t.options)})),this.varia.queue=[]}},{key:"request",value:function(e,t){var n,a,i=(n=this.mapOptions,a="key=".concat(n.key,"&output=jsonp"),{parseLocation:function(e){return ma("https://apis.map.qq.com/ws/geocoder/v1/?".concat(ba(e),"&").concat(a))},placeSearch:function(e){return ma("".concat(ya.placeSearch,"?").concat(ba(e),"&").concat(a))},placeExplore:function(e){return ma("".concat(ya.placeExplore,"?").concat(ba(e),"&").concat(a))},placeDetail:function(e){return ma("".concat(ya.placeDetail,"?").concat(ba(e),"&").concat(a))},suggestion:function(e){return ma("".concat(ya.placeSuggestion,"?").concat(ba(e),"&").concat(a))},geocoder:function(e){var t=e.address;return t&&ga[t]&&(e.address="".concat(t).concat(ga[t].city)),ma("".concat(ya.geocoder,"?").concat(ba(e),"&").concat(a))},directionDriving:function(e){return ma("".concat(ya.directionDriving,"?").concat(ba(e),"&").concat(a))},directionWalking:function(e){return ma("".concat(ya.directionWalking,"?").concat(ba(e),"&").concat(a))},directionBicycling:function(e){return ma("".concat(ya.directionBicycling,"?").concat(ba(e),"&").concat(a))},directionTransit:function(e){return ma("".concat(ya.directionTransit,"?").concat(ba(e),"&").concat(a))},distanceMatrix:function(e){return ma("".concat(ya.distanceMatrix,"?").concat(ba(e),"&").concat(a))},district:function(e){return ma("".concat(ya.district,"?").concat(ba(e),"&").concat(a))},coordTranslate:function(e){return ma("".concat(ya.coordTranslate,"?").concat(ba(e),"&").concat(a))},locationIP:function(e){return ma("".concat(ya.locationIP,"?").concat(ba(e),"&").concat(a))}});if(!i[e])throw Error("错误警告: ".concat(e," 不是一个正确的地图请求方法，请使用正确的方法。"));return i[e](t)}},{key:"merge",value:function(e,t){for(var n in t)e[n]=e[n]&&"[object Object]"===e[n].toString()?this.merge(e[n],t[n]):e[n]=t[n];return e}},{key:"destory",value:function(){this.map.destroy()}},{key:"random",value:function(){return Math.floor(1234567890*Math.random())}},{key:"latLng",value:function(e){var t=e.lng,n=e.lat;return new TMap.LatLng(n,t)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(e){console.log(e,"设置地图中心点"),this.map.setCenter(this.latLng(e))}},{key:"setRotation",value:function(e){this.map.setRotation(e)}},{key:"setPitch",value:function(e){this.map.setPitch(e)}},{key:"setScale",value:function(e){this.map.setScale(e)}},{key:"setMode",value:function(e){"2D"===e?this.map.setViewMode("2D"):"3D"===e&&(this.map.setViewMode("3D"),this.map.setPitch(70))}},{key:"setMarker",value:function(e,t){var n=this;console.log("setMarker-point-内部函数",e),console.log("setMarker-styles-内部函数",t),this.removeMarker(),console.log("marker-layer-".concat(Math.floor(1e4*Math.random())),"IDDDDD"),console.log(this,"this"),this.varia.centerMarker=new TMap.MultiMarker({id:"marker-layer-".concat(Math.floor(1e4*Math.random())),map:this.map,styles:me({marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},t),geometries:function(e){var t=n;if("[object Object]"===Object.prototype.toString.call(e))return e.lat=Number(e.lat),e.lng=Number(e.lng),[{id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}}];var a=[];return e.forEach((function(e){a.push({id:"marker_".concat(t.random()),styleId:"marker",position:t.latLng(e),properties:{title:"marker"}})})),a}(e)})}},{key:"setMarkerCrm",value:function(e){this.varia.centerMarker=new TMap.MultiMarker({id:"marker_".concat(this.random()),map:this.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:16,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/markerDefault.png"})},geometries:[{id:"markergeo_".concat(this.random()),styleId:"marker_".concat(this.random()),position:new TMap.LatLng(e.lat,e.lng),properties:{title:"marker"}}]})}},{key:"removeMarker",value:function(){console.log("移除marker事件"),console.log(this.varia.centerMarker),this.varia.centerMarker&&(this.varia.centerMarker.setMap(null),this.varia.centerMarker=null)}},{key:"removeCluster",value:function(){}},{key:"setCircle",value:function(e){return new TMap.MultiCircle({id:"circle",map:this.map,geometries:[{center:this.latLng(e),radius:1e3}]})}},{key:"setMarkerCluster",value:function(e){var t=this;return console.log("setMarkerCluster"),this.varia.markerCluster=new TMap.MarkerCluster({id:"marker_".concat(this.random()),map:this.map,enableDefaultStyle:!1,minimumClusterSize:2,geometries:function(e){var n=t;if("[object Object]"===Object.prototype.toString.call(e))return[{position:n.latLng(e)}];var a=[];return e.forEach((function(e){a.push({position:n.latLng(e)})})),a}(e),zoomOnClick:!0,gridSize:60,averageCenter:!1,maxZoom:10}),this.varia.markerCluster}}],n&&fa(t.prototype,n),a&&fa(t,a),e}();const wa={name:"Map",props:{sceneId:{type:String,default:"default"},visible:Boolean,inputValue:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:"100%"},searchInput:{type:Boolean,default:!0},optionSelect:{type:String,default:"title"},intLocation:{type:Boolean,default:!0},config:{type:Object,default:function(){return{}}}},data:function(){return{list:[],actInputValue:"",realDot:!1,glMap:null,id:"TMapSearch_"+ce.default.guid()}},watch:{inputValue:function(e){e!==this.actInputValue&&(this.realDot=!0,this.actInputValue=e)},visible:function(e){e&&(this.glMap||this.initMap(),this.actInputValue=this.inputValue)}},mounted:function(){this.initMap()},methods:{initMap:function(){var e=this;this.$nextTick((function(){e.glMap=new ka(me({container:e.id,success:function(){console.log("地图加载完毕！"),e.$emit("init",e.glMap),e.initComplate()}},e.config)),e.actInputValue=e.inputValue,e.searchInput&&e.actInputValue&&e.intLocation&&(e.realDot=!0,e.handleSearch()),e.glMap._afterInit()}))},initComplate:function(){var e=this,t=this;this.$nextTick((function(){setTimeout((function(){e.actInputValue=e.inputValue,t.glMap.request("suggestion",{keyword:e.inputValue}).then((function(e){e.count&&t.setPosition(e.data[0].id,e.data),t.list=e.data||[],t.$forceUpdate()})),t.$forceUpdate(),e.glMap.map.on("click",(function(e){var n=e.latLng.getLat(),a=e.latLng.getLng();t.setCenter({lat:n,lng:a});var i=[];t.glMap.request("parseLocation",{location:n+","+a}).then((function(e){console.log(e,"根据经纬度".concat(n+","+a,"解析地址信息"));var o={adcode:Number(e.result.ad_info.adcode),address:e.result.formatted_addresses.recommend,city:e.result.address_component.city,district:e.result.address_component.district,location:e.result.location,id:"123456ABCD",title:e.result.formatted_addresses.recommend,province:e.result.address_component.province,type:0};console.log(o,"传给外面的数据对象 - item--1"),t.$emit("change",o),i.push(o),t.actInputValue=e.result.formatted_addresses.recommend,t.setPosition("123456ABCD",i),t.glMap.request("suggestion",{keyword:e.result.address+e.result.formatted_addresses.recommend}).then((function(e){console.log(e,"res1"),e.count&&i.push.apply(i,dt(e.data)),t.list=i,t.$forceUpdate()}))}))}))}),1e3)}))},inputHandler:function(e){var t=this;e&&(this.realDot?this.glMap.request("geocoder",{address:e}).then((function(e){t.realDot=!1,e.status?t.handleSearch():t.setAutoPosition(e.result)})):this.glMap.request("suggestion",{keyword:e}).then((function(e){console.log(e,"inputHandler--suggestion - input 输入框 输入关键词"),t.list=e.data})))},handleSearch:function(){var e=this;this.actInputValue&&(this.realDot?this.glMap.request("geocoder",{address:this.actInputValue}).then((function(t){e.realDot=!1,t.status?e.handleSearch():e.setAutoPosition(t.result)})):this.glMap.request("suggestion",{keyword:this.actInputValue}).then((function(t){console.log(t,"handleSearch--suggestion - input 手动调用搜索"),e.list=t.data})))},handleSelect:function(e){if(console.log("handleSelect：",e),e){var t=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(t.location),this.glMap.setMarker(t.location),console.log(t,"传给外面的数据对象 - item--2"),this.$emit("change",t)}},setPosition:function(e,t){this.list=t;var n=this.list.filter((function(t){return t.id===e}))[0];this.glMap.setCenter(n.location),this.glMap.setMarker(n.location),this.$forceUpdate()},setCenter:function(e){this.glMap.setMarker(e)},setAutoPosition:function(e){console.log(e)},setAddress:function(e){this.inputHandler(e)},resetValue:function(e){var t=this;this.$nextTick((function(){(t.actInputValue||t.inputValue)&&(t.actInputValue=t.inputValue,t.list=[],t.actInputValue&&!e&&(t.realDot=!0,t.handleSearch()),t.realDot=!1,t.handleSearch())}))}}};var Ca=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-search-wrapper"},[e.searchInput?n("a-auto-complete",{staticClass:"map-search",attrs:{autoFocus:"",placeholder:"请输入"},on:{search:e.inputHandler,select:e.handleSelect},model:{value:e.actInputValue,callback:function(t){e.actInputValue="string"==typeof t?t.trim():t},expression:"actInputValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t[e.optionSelect]))])})),1)],2):e._e(),e._v(" "),n("div",{staticClass:"t-map-search",style:{height:e.height,width:e.width},attrs:{id:e.id}})],1)};Ca._withStripped=!0;const _a={name:"Manage",components:{GlMap:st({render:Ca,staticRenderFns:[]},void 0,wa,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},visible:{type:Boolean,default:!1},title:{type:String,default:"地址定位"},config:{type:Object,default:function(){return null}},inputValue:{type:String,default:""},baseValue:{type:String,default:""}},data:function(){return{flag:!0,cache:null,addressInfo:{},glmap:new ka}},watch:{visible:function(e){var t=this;this.$nextTick((function(){t.addressInfo={},e&&t.$nextTick((function(){setTimeout((function(){t.inputValue&&t.$refs.map&&t.$refs.map&&(console.log(t.inputValue,"this.inputValue"),t.parseAddress(t.inputValue,(function(e){if(e.length){var n=e[0];t.addressInfo=n,t.cache?t.$refs.map.setPosition(t.cache.id,ce.default.unique([t.cache].concat(dt(e)),"id")):t.$refs.map.setPosition(n.id,e)}else t.$refs.map.setPosition(t.cache.id,[t.cache])})))}),1e3)}))}))}},computed:{modalVisible:{get:function(){return this.visible},set:function(){this.$emit("update:visible",!1)}}},mounted:function(){},methods:{parseAddress:function(e,t){"string"==typeof e&&e.trim().length&&this.glmap.request("suggestion",{keyword:e}).then((function(e){e.count?t&&t(e.data):t&&t(null)}))},handleOk:function(){console.log(this.addressInfo,"点击弹框确定按钮返回  addressInfo 给最外面"),this.cache=this.addressInfo,this.$emit("ok",this.addressInfo),this.modalVisible=!1},handleCancel:function(){this.modalVisible=!1},handleChange:function(e){console.log(e,"弹框输入框选项发生变化，选中项赋值给 - addressInfo"),this.addressInfo=e}}};var Sa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"map-dialog-modal",attrs:{title:e.title,maskClosable:!1,width:"810px",keyboard:!1},on:{ok:e.handleOk,cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("gl-map",{ref:"map",attrs:{sceneId:e.sceneId,visible:e.modalVisible,inputValue:e.inputValue,intLocation:!1},on:{change:e.handleChange}})],1)};Sa._withStripped=!0;const xa={name:"AddressSearch",components:{MapDialog:st({render:Sa,staticRenderFns:[]},void 0,_a,void 0,!1,void 0,!1,void 0,void 0,void 0)},props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},value:{type:String,default:""},icon:{type:String,default:"environment"},showBtn:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},defaultBtn:{type:Boolean,default:!1}},data:function(){return{dataSource:[],poiPicker:null,list:[],glMap:null,mapVisible:!1}},computed:{autoValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},mounted:function(){this.autoValue=this.value,this.glMap=new ka},methods:{handleSearch:function(e){var t=this;e&&this.glMap.request("suggestion",{keyword:e}).then((function(e){t.$set(t,"list",e.data)}))},handleBtn:function(){console.log("handleBtn"),this.disabled||(this.defaultBtn?this.mapVisible=!0:this.$emit("btnClick"))},handleSelect:function(e){if(e){var t=this.list.filter((function(t){return t.id===e}))[0];this.autoValue=t.title,this.$emit("change",t)}},resetOption:function(){var e=this;this.$nextTick((function(){e.list=[],e.handleSearch(e.value)}))},handleMapOk:function(e){e.adcode&&(this.autoValue=e.title||e.address,this.$emit("change",e))}}};var Da=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("a-auto-complete",{staticClass:"map-search",attrs:{placeholder:"请输入",disabled:e.disabled},on:{search:e.handleSearch,select:e.handleSelect},model:{value:e.autoValue,callback:function(t){e.autoValue=t},expression:"autoValue"}},[n("template",{slot:"dataSource"},e._l(e.list,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.title))])})),1),e._v(" "),e._t("default",[n("a-input",{attrs:{maxLength:e.maxLength}},[e.showBtn?n("a-button",{staticClass:"dot-btn",staticStyle:{"margin-right":"-12px"},attrs:{slot:"suffix",type:"link"},on:{click:function(t){return t.stopPropagation(),e.handleBtn(t)}},slot:"suffix"},[n("a-icon",{attrs:{type:e.icon}})],1):e._e()],1)])],2),e._v(" "),n("map-dialog",{ref:"mapDialog",attrs:{visible:e.mapVisible,title:"设置地址",sceneId:e.sceneId,inputValue:e.autoValue},on:{"update:visible":function(t){e.mapVisible=t},ok:e.handleMapOk}})],1)};Da._withStripped=!0;const Ra=st({render:Da,staticRenderFns:[]},void 0,xa,void 0,!1,void 0,!1,void 0,void 0,void 0);var Oa={name:"AreaSelect",props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:"span"},bottom:{type:String,default:"24px"},level:{type:Number,default:3},disabled:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{}}},url:{type:String,default:""},loadData:{type:Function,default:null},dealData:{type:Boolean,default:!1},immediate:{type:Boolean,default:!1}},data:function(){return{model:[{name:"province",label:"省"},{name:"city",label:"市"},{name:"district",label:"区"}],selectData:[],areaData:{province:[],city:[],district:[]},$request:null}},watch:{value:{handler:function(e){if(e.length){if(e[e.length-1]===this.selectData[this.selectData.length-1])return;this.dealValue()}else this.selectData=[],this.areaData.city=[],this.areaData.district=[]},deep:!0}},mounted:function(){var e=this;this.url?this.$request=function(t){return e.$get(e.url,t)}:this.$request=this.loadData,this.value.length?this.dealValue():this.getList()},methods:{getList:function(e,t,n){var a=this;this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){e||(a.areaData.province=n.data),e&&!t&&(a.areaData.city=n.data),e&&t&&(a.areaData.district=n.data)}))},dealValue:function(e,t,n){for(var a=this,i=JSON.parse(JSON.stringify(this.value)),o=0;o<i.length;o++)if(!i[o]){i.splice(o,i.length);break}this.$request({provinceId:e,cityId:t,districtId:n}).then((function(n){var o=n.data;e||(a.areaData.province=o,i[0]&&a.dealValue(i[0]),1===i.length&&(a.selectData=i,a.dealResult())),e&&!t&&(a.areaData.city=o,i[1]&&a.dealValue(i[0],i[1]),2===i.length&&(a.selectData=i,a.dealResult())),e&&t&&(a.areaData.district=o,3===i.length&&(a.selectData=i,a.dealResult()))}))},handleChange:function(e,t){"province"===t.name&&(this.areaData.city=[],this.areaData.district=[],this.selectData=[e],this.getList(e)),"city"===t.name&&(this.areaData.district=[],this.selectData=[this.selectData[0],e],this.getList.apply(this,dt(this.selectData))),this.dealResult(),this.$emit("input",JSON.parse(JSON.stringify(this.selectData)))},dealResult:function(){var e=this,t=this.areaData.province.filter((function(t){return t.id===e.selectData[0]}))[0]||null,n=this.areaData.city.filter((function(t){return t.id===e.selectData[1]}))[0]||null,a=this.areaData.district.filter((function(t){return t.id===e.selectData[2]}))[0]||null;this.$emit("change",this.selectData,{province:t,city:n,district:a})}}};const Va=Oa;var Ta=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-row",{staticClass:"area-wrap",attrs:{gutter:12}},[e._l(e.model,(function(t,a){return[a<=e.level-1?n("a-col",{key:a,style:{marginBottom:"span"===e.type||e.model.length-1===a?"":e.bottom},attrs:{span:"span"===e.type?24/e.model.length:24}},[n("a-select",{staticClass:"area-select",attrs:{placeholder:t.label,disabled:e.disabled},on:{change:function(n){return e.handleChange(n,t)}},model:{value:e.selectData[a],callback:function(t){e.$set(e.selectData,a,t)},expression:"selectData[index]"}},e._l(e.areaData[t.name],(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1):e._e()]}))],2)};Ta._withStripped=!0;var La={name:"AddressBox",props:{sceneId:{type:String,default:"default"},maxLength:{type:Number,default:100},syncInputBox:{type:Boolean,default:!0},value:{type:Object,default:function(){return{address:"",province:"",cityName:"",city:"",provinceName:"",districtName:"",district:"",fullAddress:"",lng:"",lat:"",point:null}}}},data:function(){var e=this;return{actForm:{address:""},outerLocation:{},area:[],areaData:null,confirmLoading:!1,mapLoadArea:!1,getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get(Se.city,t):t.provinceId&&t.cityId?e.$get(Se.district,t):void 0:e.$get(Se.province,t)},getAddressCodeByName:function(t){return e.$get(xe,t)},isFirst:!0}},components:{AddressSearch:Ra,AreaSelect:st({render:Ta,staticRenderFns:[]},void 0,Va,void 0,!1,void 0,!1,void 0,void 0,void 0)},watch:{value:{handler:function(){this.generateForm()},deep:!0},actForm:{handler:function(e){this.isFirst?this.isFirst=!1:this.$emit("inputChange",e)},deep:!0}},mounted:function(){this.generateForm()},methods:{generateForm:function(){this.actForm=me({address:"",province:"",city:"",district:""},this.value),this.area=[],this.actForm.province&&this.area.push(this.actForm.province),this.actForm.city?this.area.push(this.actForm.city):this.actForm.province||(this.area=[]),this.actForm.district?this.area.push(this.actForm.district):this.actForm.province||this.actForm.district||(this.area=[])},handleMapOk:function(e){var t=this;return ve(be.mark((function n(){return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(e,"地图选择 ok----"),e.adcode){n.next=3;break}return n.abrupt("return");case 3:e&&(t.getAddressCodeByName({provinceName:e.province,cityName:e.city,districtName:e.district}).then((function(e){t.mapLoadArea=!0;var n=e.data,a=n.subAddress,i=a.subAddress;t.area=[n.id,a.id,i.id]})),t.actForm.address=e.title||e.address,t.$emit("input",t.actForm));case 4:case"end":return n.stop()}}),n)})))()},handleAreaChange:function(e,t){if(this.areaData=t,this.mapLoadArea)return this.actForm.province=e[0],this.actForm.city=e[1],this.actForm.district=e[2],this.actForm.provinceName=t.province.name,this.actForm.cityName=t.city.name,this.actForm.districtName=t.district.name,this.$emit("input",this.actForm),void(this.mapLoadArea=!1);this.actForm=me(me({},this.actForm),{},{province:t.province&&t.province.id,city:t.city&&t.city.id,district:t.district&&t.district.id,provinceName:t.province&&t.province.name,cityName:t.city&&t.city.name,districtName:t.district&&t.district.name}),this.syncInputBox&&(this.actForm.address="".concat(t.province&&t.province.name||"").concat(t.city&&t.city.name||"").concat(t.district&&t.district.name||"")),this.$emit("input",this.actForm)},getData:function(){return this.areaData}}};const $a=La;var Ia=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form-model-item",{attrs:{label:"省/市/区",prop:"area"}},[n("area-select",{attrs:{loadData:e.getRegion},on:{change:e.handleAreaChange},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"详细地址",prop:"address"}},[n("address-search",{ref:"autoComplete",attrs:{sceneId:e.sceneId,maxLength:e.maxLength,defaultBtn:""},on:{change:e.handleMapOk},model:{value:e.actForm.address,callback:function(t){e.$set(e.actForm,"address",t)},expression:"actForm.address"}})],1)],1)};Ia._withStripped=!0;const Fa=st({render:Ia,staticRenderFns:[]},void 0,$a,void 0,!1,void 0,!1,void 0,void 0,void 0);Fa.install=function(e){e.component(Fa.name,Fa)},ce.default.ISREPEAT=function(e){return Object.keys(ce.default).includes(e)},ce.default.date.calcWeek=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"YYYY/MM/DD",a=new Date(t),i=ce.default.date.endOf("week",a,n),o=ce.default.date.add(e,"w",i,n),s=ce.default.date.endOf("w",o,n),r=ce.default.date.startOf("w",o,n);return{start:r,end:s}},ce.default.date.calcMonth=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=new Date(e),a=ce.default.date.startOf("month",n,t),i=ce.default.date.endOf("month",n,t);return{start:a,end:i}},ce.default.date.mandom=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=new Date(e),a=n.getMonth()+1,i=ce.default.date.daysInMonth(n),o=[],s=1;s<=i;s++)o.push(ce.default.date.format(ce.default.date.format("2021/".concat(a,"/").concat(s),"YYYY-MM-DD")+" ".concat(ce.default.rangeRandom(0,23),":").concat(ce.default.rangeRandom(0,59)),t||"YYYY-MM-DD hh:mm"));return o[ce.default.rangeRandom(1,i)[0]]},ce.default.date.period=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,a=new Date(n);if(1===e)return ce.default.date.calcWeek(0,a,t);if(2===e)return{start:ce.default.date.subtract(6,"day",a,t),end:ce.default.date.format(t)};if(3===e)return ce.default.date.calcMonth(a,t);if(4===e){var i=ce.default.date.endOf("week",a,t);return{start:ce.default.date.subtract(20,"day",i,t),end:i}}var o=ce.default.date.subtract(2,"month",ce.default.date.startOf("month",a),t),s=ce.default.date.endOf("month",a,t);return{start:o,end:s}},ce.default.date.isPeriod=function(e,t){return 1===e||2===e?ce.default.date.isToday(t):3===e&&void 0},Map.prototype.getByKey=function(e){var t=dt(this.keys()),n=t.findIndex((function(t){return Array.isArray(t)&&t.includes(e)}));return this.get(t[n])},ce.default.amap={jsonpRequest:function(e){window.TMAPCALLBACK||(window.TMAPCALLBACK={});var t,n="tmap_".concat(Math.floor(1234567890*Math.random())),a=document.createElement("script");a.setAttribute("src",e+"&callback=TMAPCALLBACK.".concat(n)),window.TMAPCALLBACK[n]=function(e){t=e},document.querySelector("body").appendChild(a);var i=function(){document.querySelector("body").removeChild(a),delete window.TMAPCALLBACK[n]};return new Promise((function(e,n){a.onload=function(){e(t),i()},a.onerror=function(){n(t),i()}}))},parsePoint:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n){var a=ce.default.urlSerialize("",Object.assign({key:"d59ce84bb495eccd65a4d238c8c06977"},t)),i="https://restapi.amap.com/v3/geocode/geo".concat(a);console.log(i,"请求地址"),n(e.jsonpRequest(i))}))},loadScript:function(e,t){var n=this;return new Promise((function(a,i){var o=document.createElement("script");t&&n.setAttr(o,t),o.onload=function(){return a(o)},o.onerror=function(){return i(o)},o.src=e,document.querySelector("body").appendChild(o)}))},isLoad:function(){for(var e=document.getElementsByTagName("script"),t=!1,n=0;n<e.length;n++)e[n].getAttribute("src").includes("https://webapi.amap.com/maps?v=1.4.6&key=d59ce84bb495eccd65a4d238c8c06977&plugin=AMap.Geocoder")&&(t=!0);return t},setAttr:function(e,t){for(var n in t)e.setAttribute(n,t[n])}},ce.default.caputured=function(){var e=ve(be.mark((function e(t){var n,a,i,o,s=arguments;return be.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",[null,o]);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[e.t0,null]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),se.default.prototype.$caputured=function(){var e=ve(be.mark((function e(t){var n,a,i,o,s=arguments;return be.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=s.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=s[i];return e.next=4,t.apply(void 0,a);case 4:return o=e.sent,e.abrupt("return",{err:null,res:o});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{err:e.t0,res:null});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ce.default.try=function(e,t){try{e&&e()}catch(e){t&&t(e)}},ce.default.jsonToArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){return[].concat(dt(t),[pe({},n,e[n])])}),[])},ce.default.icon={report:{iconList:{1:"iconreport01",2:"iconreport02",3:"iconreport03",4:"iconreport04",5:"iconreport05",6:"iconreport06",7:"iconreport07",8:"iconreport08",9:"iconreport09",10:"iconreport10",11:"iconreport11",12:"iconreport12",13:"iconreport13",15:"iconreport15",16:"iconreport16",17:"iconreport17",18:"iconreport18",19:"iconreport19",20:"iconreport20",21:"iconreport21",22:"iconreport22",23:"iconreport23",24:"iconreport24",25:"iconreport25",26:"iconreport26",27:"iconreport27",28:"iconreport28",29:"iconreport29",30:"iconreport30",31:"iconreport31",32:"iconreport32",33:"iconreport33",34:"iconreport34",35:"iconreport35",36:"iconreport36",37:"iconreport37",38:"iconreport38",39:"iconreport39",40:"iconreport40",41:"iconreport41",42:"iconreport42",43:"iconreport43",44:"iconreport44",45:"iconreport45",46:"iconreport46",47:"iconreport47",48:"iconreport48"},colorList:{1:"#0289ff",2:"#00c359",3:"#fc943d",4:"#fb602c"}},approve:{iconList:{},colorList:{}}},ce.default.mapHandler=function(e,t,n){var a=Object.keys(e).find((function(e){return JSON.parse(e).includes(t)}));a?e[a]():n&&n()};var Ma={name:"EditorAddress",components:{AddressBox:Fa},props:{visible:{type:Boolean,default:!1},editData:{type:Object,default:function(){return{}}},customerId:{type:String,default:null,require:!0},hasAddress:{type:Boolean,default:!1}},data:function(){return{form:{deliveryMethod:"",deliveryId:void 0,deliveryName:"",logisticsId:void 0,logisticsName:"",customerName:"",phone:"",detailAddress:"",address:"",province:"",city:"",district:"",longitude:"",latitude:"",provinceName:"",cityName:"",districtName:"",fullAddress:"",loadingInfo:"",allAddress:void 0,isDefault:!1},confirmLoading:!1,basicRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}]},logisticsRules:{deliveryId:[{required:!0,message:"请选择",trigger:"change"}],customerName:[{required:!0,message:"请输入",trigger:"change"}],phone:[{required:!0,message:"请输入",trigger:"change"}],allAddress:[{required:!0,message:"请选择",trigger:"change"}]},backForm:null,syncInputBox:!0,deliveryTypes:{data:[],loading:!1},logisticsCorps:{data:[],loading:!1}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},rules:function(){return 2===this.form.deliveryMethod?this.logisticsRules:this.basicRules},isUpdateMode:function(){return!!this.form.businessId},title:function(){return this.isUpdateMode?"编辑收货信息":"新增收货信息"}},watch:{visible:function(e){var t=this;return ve(be.mark((function n(){return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=6;break}return n.next=3,t.handleGetDeliveryType();case 3:return n.next=5,t.handleGetLogistcsCorp();case 5:t.editData&&t.editData.businessId?(t.syncInputBox=!1,t.form=t.editData,t.form.address=t.form.detailAddress,t.form.loadingInfo=t.form.loadingInfo||t.form.fullAddress):(t.syncInputBox=!0,t.form={deliveryId:t.deliveryTypes.data.length&&t.deliveryTypes.data[0].value,customerName:"",isDefault:!t.hasAddress});case 6:case"end":return n.stop()}}),n)})))()},backForm:{handler:function(e){var t=this;e&&(this.form.address=e.address,this.form.province=e.province,this.form.city=e.city,this.form.district=e.district,this.form.detailAddress=e.address,e.address&&e.province&&e.city&&e.district?(this.form.allAddress=!0,this.$nextTick((function(){t.$refs.allAddress&&t.$refs.allAddress.onFieldChange()}))):this.form.allAddress=void 0)},deep:!0}},methods:{handleGetDeliveryType:function(){var e=this;return ve(be.mark((function t(){var n,a;return be.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.deliveryTypes.loading=!0,t.next=4,e.$get(ze);case 4:n=t.sent,a=n.data,e.deliveryTypes.data=a.map((function(e){return me({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.deliveryTypes.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},handleGetLogistcsCorp:function(){var e=this;return ve(be.mark((function t(){var n,a;return be.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.logisticsCorps.loading=!0,t.next=4,e.$get(qe);case 4:n=t.sent,a=n.data,e.logisticsCorps.data=a.map((function(e){return me({label:e.name,value:e.id},e)})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.logisticsCorps.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},onDeliveryTypeChange:function(e){var t=this.deliveryTypes.data.find((function(t){return t.value===e}));t&&(this.form.deliveryMethod=t.requireOption)},changePhone:function(e){this.form.phone=e.replace(/[\u4E00-\u9FA5]|[A-Za-z]/g,"")},changeRadio:function(){this.form.isDefault=!this.form.isDefault},handleOk:function(){var e=this;this.$refs.ruleFormReceipt.validate(function(){var t=ve(be.mark((function t(n){var a,i,o,s,r,l,c,u,d,h,p,f,m,g;return be.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=46;break}if(a=e.deliveryTypes.data.find((function(t){return t.value===e.form.deliveryId})),2!==e.form.deliveryMethod){t.next=23;break}if(i=e.form.provinceName,o=e.form.cityName,s=e.form.districtName,r=e.form.address,l=[i,o,s,r].join(""),c="",!l){t.next=13;break}return t.next=12,ce.default.amap.parsePoint({address:l});case 12:c=t.sent;case 13:u=c?c.geocodes:[],e.form.longitude=u.length?u[0].location.split(",")[0]:"",e.form.latitude=u.length?u[0].location.split(",")[1]:"",d=[i,o,s].join(""),h="",h=d.includes(r)?d:r.includes(d)?r:d===r?d:l,p=e.logisticsCorps.data.find((function(t){return t.value===e.form.logisticsId})),e.form.logisticsName=p&&p.label,e.form.fullAddress=h,e.form.detailAddress=e.form.address;case 23:return 1===e.form.deliveryMethod&&(e.form.fullAddress=e.form.loadingInfo),e.form.deliveryName=a.label,e.$emit("confirm",e.form),t.prev=26,e.confirmLoading=!0,t.next=30,e.$post(e.isUpdateMode?Xe:Ue,me({customerId:e.customerId},e.form));case 30:if(f=t.sent,m=f.data,g=f.message,m){t.next=35;break}throw new Error(g);case 35:e.$message.success("操作成功！"),e.$emit("success"),t.next=43;break;case 39:t.prev=39,t.t0=t.catch(26),e.$message.error(t.t0),console.error(t.t0);case 43:return t.prev=43,e.confirmLoading=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[26,39,43,46]])})));return function(e){return t.apply(this,arguments)}}())},handleCancel:function(){this.modalVisible=!1,this.$emit("cancel")},afterClose:function(){this.syncInputBox=!0,this.form={customerName:"",isDefault:!1}},inputChange:function(e){this.isUpdateMode&&(this.syncInputBox=!0),this.backForm=me(me({},this.form),e)},changeTextarea:function(){this.form.loadingInfo.length>=500&&this.$message.info("限500字")}}};const Pa=Ma;var Na=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"receipt-dialog-wrap",attrs:{afterClose:e.afterClose,"confirm-loading":e.confirmLoading,maskClosable:!1,title:e.title,width:500,cancelText:"取消",okText:"确定"},on:{cancel:e.handleCancel,ok:e.handleOk},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("a-form-model",{ref:"ruleFormReceipt",attrs:{"label-col":{span:5},model:e.form,rules:e.rules,"wrapper-col":{span:17}}},[n("a-form-model-item",{attrs:{label:"发货方式",prop:"deliveryId"}},[n("a-select",{attrs:{loading:e.deliveryTypes.loading,placeholder:"请选择"},on:{change:e.onDeliveryTypeChange},model:{value:e.form.deliveryId,callback:function(t){e.$set(e.form,"deliveryId",t)},expression:"form.deliveryId"}},e._l(e.deliveryTypes.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])})),1)],1),e._v(" "),2===e.form.deliveryMethod?[n("a-form-model-item",{attrs:{label:"物流公司",prop:"logisticsId"}},[n("a-select",{attrs:{loading:e.logisticsCorps.loading,placeholder:"请选择"},model:{value:e.form.logisticsId,callback:function(t){e.$set(e.form,"logisticsId",t)},expression:"form.logisticsId"}},e._l(e.logisticsCorps.data,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n            "+e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),n("a-form-model-item",{attrs:{label:"收货人",prop:"customerName"}},[n("a-input",{staticClass:"customer-name-wrap",attrs:{maxLength:50,suffix:e.form.customerName.length+"/50",placeholder:"请输入"},model:{value:e.form.customerName,callback:function(t){e.$set(e.form,"customerName","string"==typeof t?t.trim():t)},expression:"form.customerName"}})],1),e._v(" "),n("a-form-model-item",{attrs:{label:"联系方式",prop:"phone"}},[n("a-input",{attrs:{maxLength:50,placeholder:"请输入"},on:{change:function(t){return e.changePhone(e.form.phone)}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone","string"==typeof t?t.trim():t)},expression:"form.phone"}})],1),e._v(" "),n("a-form-model-item",{ref:"allAddress",staticStyle:{"margin-bottom":"0"},attrs:{label:"所在地区",prop:"allAddress"}},[n("a-form-model",{staticClass:"cus-address-wrap",attrs:{"label-col":{span:0},"wrapper-col":{span:24}}},[n("address-box",{attrs:{maxLength:100,syncInputBox:e.syncInputBox},on:{inputChange:e.inputChange},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1)],1)]:e._e(),e._v(" "),1===e.form.deliveryMethod?n("a-form-model-item",{attrs:{label:"装车信息",prop:"loadingInfo"}},[n("a-textarea",{attrs:{maxLength:500,placeholder:"限500字",rows:5},on:{change:e.changeTextarea},model:{value:e.form.loadingInfo,callback:function(t){e.$set(e.form,"loadingInfo","string"==typeof t?t.trim():t)},expression:"form.loadingInfo"}})],1):e._e(),e._v(" "),n("a-radio",{staticStyle:{"margin-left":"76px"},attrs:{checked:e.form.isDefault},on:{click:e.changeRadio}},[e._v("设为默认")])],2)],1)};Na._withStripped=!0;const Ea=st({render:Na,staticRenderFns:[]},void 0,Pa,"data-v-0c26a3f4",!1,void 0,!1,void 0,void 0,void 0);Ea.install=function(e){e.component(Ea.name,Ea)};const Aa={name:"DSelectAddress",components:{CellEllipsisTip:Kt,STable:en,EditorAddress:Ea},props:{width:{type:Number,default:816},cache:{type:Boolean,default:!0},visible:{type:Boolean,default:!1},setContainer:{type:Function,default:function(){return document.querySelector("body")}},customerId:{type:String,default:null,require:!0},title:{type:String,default:"选择收货地址"},beforeClose:{type:Function,default:void 0},value:{type:Object,default:void 0}},data:function(){return{currentMark:-1,addressDetailsShow:!1,clickReceipt:null,opened:!1,list:{data:[],loading:!1,selected:null}}},computed:{modalVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{visible:function(e){e&&((!this.cache||this.cache&&!this.opened)&&(this.list.selected=null,this.getDeliverys()),this.opened=!0)}},methods:{getDeliverys:function(){var e=this;return ve(be.mark((function t(){var n,a;return be.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.list.loading=!0,t.next=4,e.$post(Ge,{businessId:e.customerId});case 4:n=t.sent,a=n.data,e.list.data=a||[],t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.prev=12,e.list.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},deleteAddress:function(e){var t=this;this.$confirm({title:"操作提示！",content:"您是否确定删除此地址？",okText:"确定",cancelText:"取消",onOk:function(){return ve(be.mark((function n(){return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(Je,{businessId:e.businessId,customerId:e.customerId});case 3:e.businessId===t.list.selected&&(t.list.selected=null),t.$message.success("操作成功！"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:return n.prev=10,t.getDeliverys(),n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[0,7,10,13]])})))()}})},setDefault:function(e){var t=this;return ve(be.mark((function n(){var a,i,o;return be.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$post(Qe,{businessId:e.businessId,customerId:e.customerId});case 3:if(a=n.sent,i=a.data,o=a.message,i){n.next=8;break}throw new Error(o);case 8:t.$message.success("操作成功！"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0);case 14:return n.prev=14,t.getDeliverys(),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[0,11,14,17]])})))()},handleSelectAddress:function(e){this.list.selected=e.businessId},editAddress:function(e){this.clickReceipt=e,this.addressDetailsShow=!0},addAddress:function(){this.clickReceipt=null,this.addressDetailsShow=!0},onEditAddressSucceed:function(){this.addressDetailsShow=!1,this.getDeliverys()},handleOk:function(){var e=this,t=this.list.data.find((function(t){return t.businessId===e.list.selected}));this.beforeClose?this.beforeClose({data:this.list.selected,rows:[t]}):this.$emit("confirm",{data:this.list.selected,rows:[t]}),this.modalVisible=!1},handleCancel:function(){this.$emit("cancel"),this.modalVisible=!1}}};var ja=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"d-select-address",attrs:{footer:null,"get-container":e.setContainer,keyboard:!1,maskClosable:!1,title:e.title,width:e.width},on:{cancel:e.handleCancel},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.list.loading,expression:"list.loading"}],staticClass:"select-address-content"},[e.list.data&&e.list.data.length>0?n("div",[n("a-radio-group",{staticStyle:{width:"100%"},model:{value:e.list.selected,callback:function(t){e.$set(e.list,"selected",t)},expression:"list.selected"}},e._l(e.list.data,(function(t,a){return n("div",{key:a,staticClass:"content-item",class:{"auto-class":"zt"===t.type||"nothing"===t.type},on:{mouseenter:function(t){e.currentMark=a},mouseleave:function(t){e.currentMark=-1},click:function(n){return n.stopPropagation(),e.handleSelectAddress(t)},dblclick:function(t){return t.stopPropagation(),e.handleOk(t)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentMark===a,expression:"currentMark === index"}],staticClass:"row-btn"},[n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.setDefault(t)}}},[e._v("设为默认")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.editAddress(t)}}},[e._v("修改")]),e._v(" "),n("a-button",{attrs:{type:"link"},on:{click:function(n){return n.stopPropagation(),e.deleteAddress(t)}}},[e._v("删除")])],1),e._v(" "),n("div",[n("a-radio",{style:{display:"block",height:"30px",lineHeight:"30px",marginRight:"14px"},attrs:{value:t.businessId}})],1),e._v(" "),n("div",{staticClass:"details"},[n("div",[e._v("\n              "+e._s(t.deliveryName||"")+"\n                \n              "),t.isDefault?n("a-tag",{attrs:{color:"blue"}},[e._v("默认")]):e._e()],1),e._v(" "),t.customerName&&t.phone?n("div",[e._v(e._s(t.customerName)+"  "+e._s(t.phone))]):e._e(),e._v(" "),t.detailAddress&&2===t.deliveryMethod?n("div",[e._v(e._s(t.detailAddress))]):e._e(),e._v(" "),t.fullAddress&&2!==t.deliveryMethod?n("div",[e._v(e._s(t.fullAddress))]):e._e()])])})),0)],1):n("div",{staticClass:"empty"},[n("a-empty",{attrs:{description:"暂无数据"}})],1)]),e._v(" "),n("div",{staticClass:"select-address-footer"},[n("div",{on:{click:e.addAddress}},[e._v("+新增收货地址")]),e._v(" "),n("div",[n("a-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" \n      "),n("a-button",{attrs:{disabled:!e.list.selected,type:"primary"},on:{click:e.handleOk}},[e._v("确定")])],1)]),e._v(" "),n("EditorAddress",{attrs:{customerId:e.customerId,"edit-data":e.clickReceipt,visible:e.addressDetailsShow,hasAddress:!!e.list.data.length},on:{"update:visible":function(t){e.addressDetailsShow=t},cancel:function(t){e.addressDetailsShow=!1},success:e.onEditAddressSucceed}})],1)};ja._withStripped=!0;const Ba=st({render:ja,staticRenderFns:[]},void 0,Aa,void 0,!1,void 0,!1,void 0,void 0,void 0);Ba.install=function(e){e.component(Ba.name,Ba)};const Ka={name:"SelectTree",props:{value:{type:[Array,Number,String],default:void 0},multiple:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},replaceFields:{type:Object,default:function(){return{}}},loadData:{type:Function,default:null}},data:function(){return{treeData:[],spreadData:{}}},computed:{baseReplaceFields:function(){return me({key:"id",name:"name"},this.replaceFields)},checkValue:{set:function(e){this.$emit("input",e)},get:function(){return this.value}},treeCheckValue:{get:function(){return"object"===Ze(this.checkValue)?this.checkValue:[this.checkValue]}}},watch:{options:{handler:function(e){console.log("lst",e),this.setOptions()},deep:!0,immediate:!0}},methods:{setOptions:function(){var e=this;this.spreadData={};var t=function t(n){var a=[];return n.forEach((function(n){e.spreadData[n[e.replaceFields.key]]=n,n.children&&(n.children=t(n.children)),a.push(me(me({},n),{},{scopedSlots:{icon:"radio"}}))})),a};this.treeData.length?this.treeData=t(this.treeData):this.treeData=t(this.options)},selectHandle:function(e,t){console.log(e,t)},getData:function(){var e=this,t=Ze(this.checkValue),n=[];return console.log(this.spreadData),"object"===t?this.checkValue.forEach((function(t){var a="object"===Ze(t)?t[e.replaceFields.key]:t;e.spreadData[a]&&n.push(e.spreadData[a])})):this.spreadData[this.checkValue]&&n.push(this.spreadData[this.checkValue]),{checkValue:this.checkValue,data:this.checkValue,rows:this.row||n}},onSelect:function(e,t){this.checkValue=e,this.row=t.checkedNodes.map((function(e){return e.data.props}))}},components:{Empty:Ln}};var Ha=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mix-modal-select-tree"},[e.options.length?e._e():n("empty"),e._v(" "),e.multiple?[n("a-tree",{attrs:{showIcon:"",checkable:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,multiple:"",loadData:e.loadData},on:{check:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){return[e._v("\n        "+e._s(t.name)+"\n      ")]}}]),model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}})]:[n("a-radio-group",{model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}},[n("a-tree",{attrs:{showIcon:"","tree-data":e.treeData,replaceFields:e.baseReplaceFields,loadData:e.loadData,selectable:!1},on:{select:e.selectHandle},scopedSlots:e._u([{key:"radio",fn:function(t){return[n("div",{staticClass:"radio-line"},[n("a-radio",{staticClass:"radio-line",attrs:{value:t[e.baseReplaceFields.key]}})],1)]}},{key:"title",fn:function(t){return[e._v("\n          "+e._s(t.name)+"\n        ")]}}],null,!1,3749490323),model:{value:e.treeCheckValue,callback:function(t){e.treeCheckValue=t},expression:"treeCheckValue"}})],1)]],2)};Ha._withStripped=!0;const za={name:"MixModal",props:{visible:{type:Boolean,default:!1},name:{type:String,default:"brand",validator:function(e){return-1!==["unit","brand","tag","levelPrice","productCategory","specialCategory","salesArea","classification","delivery","area","logistics","customLogistics"].indexOf(e)}},title:{type:String,default:"请选择"},cache:{type:Boolean,default:!1},beforeClose:{type:Function,default:null},defaultValue:{type:[String,Boolean,Number,Array],default:null},multiple:{type:Boolean,default:!1},extrasOperations:{type:Array,default:function(){return["refresh"]}},rules:{type:Object,default:function(){}}},data:function(){var e=this;return{keywords:"",placeholder:"请输入",options:[],checkValue:[],modelProps:{},testValue:[],loading:!0,modelType:"selectGroup",request:null,replaceFields:{key:"id",name:"name"},getRegion:function(t){return t&&t.provinceId?t.provinceId&&!t.cityId?e.$get(Se.city,me(me({},t),e.rules)):t.provinceId&&t.cityId?e.$get(Se.district,me(me({},t),e.rules)):void 0:e.$get(Se.province,e.rules)}}},computed:{modalVisible:{set:function(e){this.$emit("update:visible",e)},get:function(){return this.visible}},filteredOptions:function(){var e=this;return this.keywords?this.options.filter((function(t){if(t[e.replaceFields["selectGroup"===e.modelType?"name":"title"]].match(e.keywords))return t})):this.options}},watch:{visible:function(e){e&&(this.keywords="",this.options.length&&this.cache||(this.options=[],this.refresh(),this.getList(),this.rules&&this.rules.keywords&&(this.keywords=this.rules.keywords)))},name:function(){this.refresh()}},methods:{refresh:function(){this.options=[],this.setModel(),this.getList()},handleCheckAll:function(){var e=this;this.checkValue=this.options.map((function(t){return t[e.replaceFields.key]}))},setModel:function(){["unit","brand","tag","levelPrice","classification","delivery","logistics"].includes(this.name)?this.modelType="selectGroup":["productCategory","salesArea","area"].includes(this.name)&&(this.modelType="selectTree")},getList:function(){var e=this;if(this.checkValue=this.defaultValue||[],this.loading=!0,["unit","brand","tag"].includes(this.name)){this.checkValue=this.defaultValue||[];var t={type:["unit","brand","tag"].indexOf(this.name)};this.$post(Te,me(me({},t),this.rules)).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))}else["levelPrice"].includes(this.name)?(this.checkValue=this.defaultValue||[],this.replaceFields={},this.$post(Le,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):["productCategory","specialCategory"].includes(this.name)?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"categoryName"},this.getCateGory(),this.request=this.getCateGory):"salesArea"===this.name?(this.checkValue=this.defaultValue||void 0,this.replaceFields={key:"id",title:"name"},this.getCustomerRegionList(),this.request=this.getCustomerRegionList):"classification"===this.name?(this.replaceFields={key:"value",name:"label"},this.$post(Ve,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1}))):"delivery"===this.name?this.$get(He,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):"area"===this.name?(this.replaceFields={key:"id",title:"name"},this.getRegion().then((function(t){e.options=t.data.map((function(e){return me(me({},e),{},{isLeaf:!1})})),e.request=e.getRegionList})).finally((function(){e.loading=!1}))):"logistics"===this.name?this.$get(Ye,this.rules).then((function(t){e.options=t.data;var n=e.options.filter((function(e){return e.isCheck})).map((function(e){return e.id}));console.log("isCheckedValue:",n),e.checkValue=n})).finally((function(){e.loading=!1})):"customLogistics"===this.name?this.$get(We,this.rules).then((function(t){e.options=t.data})).finally((function(){e.loading=!1})):(console.error("当前传入名称为：",this.name,"。请确认是否正确！！！"),this.loading=!1)},getCateGory:function(e){var t=this;if(e)return new Promise((function(n){e.dataRef.children?n():t.$get($e,me({categoryType:["productCategory","specialCategory"].indexOf(t.name),parentId:e.dataRef.id},t.rules)).then((function(a){e.dataRef.children=a.data.categoryLists,t.options=dt(t.options),n(a.data.categoryLists)}))}));this.$get($e,me({categoryType:["productCategory","specialCategory"].indexOf(this.name),parentId:0},this.rules)).then((function(e){t.loading=!1,t.options=e.data.categoryLists}))},getCustomerRegionList:function(e){var t=this;if(e)return new Promise((function(n){if(e.dataRef.children)n();else{var a=e.dataRef;t.$post(Re,me({businessId:a.id||0},t.rules)).then((function(a){e.dataRef.children=a.data,t.options=dt(t.options),n(a.data)})).finally((function(){t.loading=!1}))}}));this.$post(Re,me({businessId:0},this.rules)).then((function(e){t.options=e.data})).finally((function(){t.loading=!1}))},getRegionList:function(e){var t=this,n=null,a=null;return e.dataRef&&e.$parent.dataRef&&(n=e.dataRef.parentId,a=e.dataRef.id),e.dataRef&&!e.$parent.dataRef&&(n=e.dataRef.id),new Promise((function(i){e.dataRef.children?i():t.getRegion({provinceId:n,cityId:a}).then((function(n){e.dataRef.children=n.data.map((function(e){return me(me({},e),{},{isLeaf:!!a})})),t.options=dt(t.options),i(n.data)})).finally((function(){t.loading=!1}))}))},okHandle:function(){var e=this.$refs.contentModel.getData();e.isCheckAll=this.checkValue.length===this.options.length,this.beforeClose?this.beforeClose(e,this.cancelHandle):(this.$emit("confirm",e),this.modalVisible=!1)},cancelHandle:function(){this.modalVisible=!1}},components:{SelectGroup:oa,SelectTree:st({render:Ha,staticRenderFns:[]},void 0,Ka,void 0,!1,void 0,!1,void 0,void 0,void 0),Empty:Ln}};var qa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{staticClass:"modal-reset",attrs:{keyboard:!1,maskClosable:!1,title:e.title,width:"816px"},on:{cancel:e.cancelHandle,ok:e.okHandle},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[n("div",{staticClass:"mix-modal"},[n("div",{staticClass:"operation-wrap"},[n("div",{staticClass:"operation-left"},[n("a-input-search",{attrs:{maxLength:40,placeholder:e.placeholder},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}},[n("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v(" 搜索")])],1),e._v(" "),e.extrasOperations.includes("refresh")?n("a-button",{attrs:{type:"link"},on:{click:e.refresh}},[e._v("刷新")]):e._e(),e._v(" "),(e.extrasOperations.includes("checkAll")&&this.multiple&&this.modelType,e._e())],1)]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"300px"}},[e.filteredOptions.length?n("div",{staticClass:"options-list"},["selectGroup"===e.modelType?n("SelectGroup",{ref:"contentModel",attrs:{multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e(),e._v(" "),"selectTree"===e.modelType?n("SelectTree",{ref:"contentModel",attrs:{"load-data":e.request,multiple:e.multiple,options:e.filteredOptions,"replace-fields":e.replaceFields},model:{value:e.checkValue,callback:function(t){e.checkValue=t},expression:"checkValue"}}):e._e()],1):e.filteredOptions.length||e.loading?e._e():n("Empty")],1)])])};qa._withStripped=!0;const Ya=st({render:qa,staticRenderFns:[]},void 0,za,void 0,!1,void 0,!1,void 0,void 0,void 0);Ya.install=function(e){e.component(Ya.name,Ya)};var Wa={product:{name:"SelectProduct",key:"id",value:"name",type:1},couponProduct:{name:"SelectProduct",key:"id",value:"name",type:2},recommendProduct:{name:"SelectProduct",key:"id",value:"name",type:3},purchaseProduct:{name:"SelectProduct",key:"id",value:"name",type:4},rateProduct:{name:"SelectProduct",key:"id",value:"name",type:6},person:{name:"PeopleModal",key:"id",value:"name"},preparer:{name:"PeopleModal",key:"id",value:"name"},handler:{name:"PeopleModal",key:"id",value:"name"},warehouse:{name:"ChooseEntrepot",key:"id",value:"name"},customer:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplier:{name:"ChoiceCustomer",key:"businessId",value:"name"},supplierCustomer:{name:"ChoiceCustomer",key:"businessId",value:"name"},unit:{name:"GoodAttrModal",key:"id",value:"name"},brand:{name:"GoodAttrModal",key:"id",value:"name"},tag:{name:"GoodAttrModal",key:"id",value:"name"},payment:{name:"payment",key:"id",value:"name"},rateUnit:{name:"GoodAttrModal",key:"id",value:"unitName"},account:{name:"SelectPayAccount",key:"accountId",value:"name"},delivery:{name:"SelectDelivery",key:"id",value:"name"},logistics:{name:"SelectLogistics",key:"id",value:"name"},customLogistics:{name:"SelectCustomLogistics",key:"id",value:"name"},address:{name:"SelectAddress",key:"businessId",value:"deliveryName"}};const Ga=st({},void 0,{name:"DMixSearch",props:{name:{type:String,default:"product"},value:{type:[Object,String],default:void 0},resultName:{type:String,default:""},width:{type:[Number,String],default:240},placeholder:{type:String,default:"请输入"},disabled:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},restore:{type:Boolean,default:!1},require:{type:Boolean,default:!1},maxLength:{type:Number,default:40},next:{type:Function,default:null},origin:{type:String,default:"page"},valueMode:{type:[Boolean,String],default:!1},dialogConfig:{type:Object,default:function(){return{}}}},data:function(){return{componentMap:Wa,visible:!1,modalValue:null,dialog:null,dialogProps:{},multiple:!1}},computed:{actWidth:function(){return"string"==typeof this.width?this.width:"".concat(this.width,"px")}},watch:{value:{handler:function(e){"[object Object]"!==Object.prototype.toString.call(e)?this.modalValue=e||void 0:Object.keys(e).length>0?this.modalValue=e:(console.warn("value 不能为空对象"),this.modalValue=void 0)},deep:!0,immediate:!0},name:function(){this.generateDialog()},visible:function(e){e&&this.generateDialog()}},created:function(){this.dialog||this.generateDialog()},methods:{generateDialog:function(){var e={},t="string"==typeof this.modalValue?[]:this.modalValue?Object.keys(this.modalValue):[];if(this.dialogConfig.multiple?this.multiple=this.dialogConfig.multiple:this.multiple=!0===this.valueMode&&t&&!t.length,["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)){var n={type:Wa[this.name].type};e=pe({},this.name,{multiple:this.multiple,rules:n}),this.dialog=Yn}else["person","preparer","handler"].includes(this.name)?(e={person:{title:"经手人"},preparer:{title:"制单人"},handler:{title:"经手人"}},this.dialog=Xn):["warehouse"].includes(this.name)?(e={warehouse:{title:"选择仓库",multiple:!0===this.valueMode&&this.multiple}},this.dialog=En):["customer","supplier","supplierCustomer"].includes(this.name)?(e={customer:{title:"选择客户",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[2]},supplier:{title:"选择供应商",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[1]},supplierCustomer:{title:"选择往来单位",type:!0===this.valueMode&&this.multiple?"checkbox":"radio",customerType:[3]}},this.dialog=ia):["unit","brand","tag","rateUnit"].includes(this.name)?(e={unit:{type:0},brand:{type:1},tag:{type:2},rateUnit:{type:3}},this.dialog=la):["account"].includes(this.name)?this.dialog=pa:["delivery","logistics","customLogistics"].includes(this.name)?(e={delivery:{name:"delivery"},logistics:{name:"logistics"},customLogistics:{name:"customLogistics"}},this.dialog=Ya):"address"===this.name&&(e={address:{readonly:!0}},this.dialog=Ba);console.log(e[this.name],this.name);var a=tt(this.dialogConfig);a.defaultValue||(a.defaultValue=this.modalValue),this.dialogProps=In(this.dialogProps,e[this.name],a)},enterHandle:function(e){e.data?(this.dialogProps.rules&&(this.dialogProps.rules.keywords=""),this.resultExchange(e)):"blur"!==e.action?(this.dialogProps=In(this.dialogProps,{rules:{keywords:this.modalValue&&this.modalValue.name===e.inputValue?"":e.inputValue}}),this.generateDialog(),this.visible=!0):this.modalValue&&this.modalValue.name!==e.inputValue&&this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},clearHandle:function(){this.modalValue=void 0,this.$emit("input",void 0),this.$emit("change",{config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData})},confirmHandle:function(e){console.log(e),["filterDropDown"].includes(this.origin)&&this.next&&this.next("mixSearch","confirm"),e?this.resultExchange(e):this.restore&&this.modalValue&&(this.modalValue=me({},this.modalValue))},resultExchange:function(e){var t=this.componentMap[this.name],n={},a={};if(n=(a=["product","couponProduct","recommendProduct","purchaseProduct","rateProduct"].includes(this.name)?e&&e.rows.length?e.rows[0]:null:(["person","unit","brand","tag"].includes(this.name)||["supplier","customer","supplierCustomer"].includes(this.name)||["warehouse"].includes(this.name),e.rows[0]))?me(me({},a),{},{id:a[t.key],value:a[t.value]}):{},"address"===this.name){var i="";2===a.deliveryMethod&&(i=[a.customerName||"",a.phone||"",a.fullAddress||""].join(" "),n.value=i)}"select"!==this.valueMode&&(this.$emit("input",n),this.modalValue=n,console.log(this.modalValue)),this.$emit("change",me(me({},e),{},{data:this.multiple?e.rows:a?n:null,rows:e.rows,multiple:this.multiple,config:{name:this.name,resultName:this.resultName,type:"mixSearch"},reset:this.resetData}))},getData:function(){return this.modalValue},resetData:function(){this.modalValue=void 0},setData:function(e){this.modalValue=e},focus:function(){this.$refs.SearchInput.focus()}},render:function(e){var t=this;return e("div",{attrs:{class:"select-good-attr",style:"width: ".concat(t.actWidth,";display: inline-block")}},[e("div",{attrs:{class:"input-box"}},[e("SearchInput",{props:{value:t.modalValue,placeholder:t.placeholder,maxLength:t.maxLength,disabled:t.disabled,name:t.name,allowClear:t.allowClear,next:t.next,restore:t.restore,dialogConfig:t.dialogProps},ref:"SearchInput",on:{enterHandle:t.enterHandle,clear:t.clearHandle}})]),e(this.dialog,{on:{confirm:t.confirmHandle,"update:visible":function(e){t.visible=e},cancel:t.confirmHandle},attrs:me({},this.dialogProps),props:me(me({getContainer:function(){return document.querySelector("body")}},t.dialogProps),{},{visible:t.visible})})])},components:{SearchInput:ct}},void 0,void 0,void 0,!1,void 0,void 0,void 0);return Ga.install=function(e){e.component(Ga.name,Ga)},Ga}))}}]);
//# sourceMappingURL=chunk-37894812.82af4c3f.js.map