(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68ce760a"],{6223:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("upload",{ref:"uploadImage",attrs:{maxImg:5},on:{ultipleSuccess:e.handleSuccess}}),i("div",[i("a-button",{on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)},r=[],o=i("73c80"),s=i.n(o),a={name:"UploadImage",components:{Upload:s.a},methods:{handleSuccess:function(e){console.log(e)},handleSubmit:function(){this.$refs.uploadImage.save((function(e,t){e?console.log("保存成功",t):console.log("保存失败")}))}}},l=a,c=i("2877"),d=Object(c["a"])(l,n,r,!1,null,null,null);t["default"]=d.exports},"73c80":function(e,t,i){!function(t,n){e.exports=n(i("b0c0"),i("ac1f"),i("5319"),i("a9e3"),i("4de4"),i("caad"),i("a434"),i("c740"),i("fb6a"),i("d3b7"),i("d81d"),i("bc3a"),i("2532"),i("466d"),i("99af"),i("159b"),i("b64b"),i("cfba"),i("07ac"),i("b680"),i("2b0e"),i("1276"),i("fd87"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("50f6"))}(0,(function(e,t,i,n,r,o,s,a,l,c,d,u,f,h,p,m,g,v,w,y,_,b,L,I,x,S,C,$,k,O,z,U,P,E,A,j,N,D,F,H,T,R,B,M,V,Y,G){"use strict";function W(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var X=W(u),q=W(v),J=W(_),K=W(G);function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Z(e){return function(e){if(Array.isArray(e))return Q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Q(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Q(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t,i,n,r,o,s,a,l,c){"boolean"!=typeof s&&(l=a,a=s,s=!1);const d="function"==typeof i?i.options:i;let u;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),n&&(d._scopeId=n),o?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},d._ssrRegister=u):t&&(u=s?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),u)if(d.functional){const e=d.render;d.render=function(t,i){return u.call(i),e(t,i)}}else{const e=d.beforeCreate;d.beforeCreate=e?[].concat(e,u):[u]}return i}const te={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:q.default},methods:{handleClick:function(){this.$emit("click")}}};var ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"icon-font-wrap",style:{height:"auto"===e.height?"auto":e.height?e.height+"px":e.size+"px",color:e.color,fontSize:e.size+"px",display:e.display,overflow:e.overflow},on:{click:e.handleClick}},[i("icon-font",{staticClass:"icon-font-box",attrs:{type:e.type}})],1)};ie._withStripped=!0;const ne=ee({render:ie,staticRenderFns:[]},void 0,te,void 0,!1,void 0,!1,void 0,void 0,void 0);function re(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(i),!0).forEach((function(t){re(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}var le=J.default.prototype.$isServer,ce=!le&&document.addEventListener?function(e,t,i){e&&t&&i&&e.addEventListener(t,i,!1)}:function(e,t,i){e&&t&&i&&e.attachEvent("on"+t,i)},de=!le&&document.removeEventListener?function(e,t,i){e&&t&&e.removeEventListener(t,i,!1)}:function(e,t,i){e&&t&&e.detachEvent("on"+t,i)};function ue(e){var t=!1;return function(){for(var i=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];t||(t=!0,window.requestAnimationFrame((function(){e.apply(i,r),t=!1})))}}"object"!==("undefined"==typeof Int8Array?"undefined":ae(Int8Array))&&(J.default.prototype.$isServer||document.childNodes),J.default.use(K.default);var fe={CONTAIN:{name:"contain",icon:"fullscreen"},ORIGINAL:{name:"original",icon:"fullscreen-exit"}},he=!J.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",pe={name:"hImageViewer",props:{host:{type:String},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},showDown:{type:Boolean,default:!0},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},prefix:{type:[Boolean,String],default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!0,mode:fe.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},baseUrlList:[]}},computed:{picList:function(){var e=this;return this.urlList.filter((function(t,i){return i===e.index}))},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.baseUrlList[this.index]},imgStyle:function(){var e=this.transform,t=e.scale,i=e.deg,n=e.offsetX,r=e.offsetY,o=e.enableTransition,s={transform:"scale(".concat(t,") rotate(").concat(i,"deg)"),transition:o?"transform .3s":"","margin-left":"".concat(n,"px"),"margin-top":"".concat(r,"px")};return this.mode===fe.CONTAIN&&(s.maxWidth=s.maxHeight="100%"),s}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg:function(){var e=this;this.$nextTick((function(){e.$refs.img[0].complete||(e.loading=!0)}))},urlList:{handler:function(){this.exchangeImage()},deep:!0}},methods:{exchangeImage:function(){var e=this.prefix,t=this.baseUrlList,i="";"string"==typeof e?i=e:e&&(i=this.host);for(var n=0;n<this.urlList.length;n++){var r=this.urlList[n];if(/(http|https):\/\//.test(r))t.push(r);else{var o=r.indexOf("/")>0?"/":"";t.push("".concat(i).concat(o?"/":"").concat(r))}}},hide:function(){this.deviceSupportUninstall(),this.onClose()},download:function(){this.$emit("download",this.currentImg)},deviceSupportInstall:function(){var e=this;this._keyDownHandler=ue((function(t){switch(t.keyCode){case 27:e.hide();break;case 32:e.toggleMode();break;case 37:e.prev();break;case 38:e.handleActions("zoomIn");break;case 39:e.next();break;case 40:e.handleActions("zoomOut")}})),this._mouseWheelHandler=ue((function(t){(t.wheelDelta?t.wheelDelta:-t.detail)>0?e.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):e.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),ce(document,"keydown",this._keyDownHandler),ce(document,he,this._mouseWheelHandler)},deviceSupportUninstall:function(){de(document,"keydown",this._keyDownHandler),de(document,he,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(){this.loading=!1},handleImgError:function(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown:function(e){var t=this;if(!this.loading&&0===e.button){var i=this.transform,n=i.offsetX,r=i.offsetY,o=e.pageX,s=e.pageY;this._dragHandler=ue((function(e){t.transform.offsetX=n+e.pageX-o,t.transform.offsetY=r+e.pageY-s})),ce(document,"mousemove",this._dragHandler),ce(document,"mouseup",(function(){de(document,"mousemove",t._dragHandler)})),e.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var e=Object.keys(fe),t=(Object.values(fe).indexOf(this.mode)+1)%e.length;this.mode=fe[e[t]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var e=this.urlList.length;this.index=(this.index-1+e)%e}},next:function(){if(!this.isLast||this.infinite){var e=this.urlList.length;this.index=(this.index+1)%e}},handleActions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var i=se({zoomRate:.2,rotateDeg:90,enableTransition:!0},t),n=i.zoomRate,r=i.rotateDeg,o=i.enableTransition,s=this.transform;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-n).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+n).toFixed(3));break;case"clocelise":s.deg+=r;break;case"anticlocelise":s.deg-=r}s.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["h-image-viewer__wrapper"].focus(),this.exchangeImage()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}};const me=pe;var ge=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"viewer-fade"}},[i("div",{ref:"h-image-viewer__wrapper",staticClass:"h-image-viewer__wrapper",style:{"z-index":e.zIndex},attrs:{tabindex:"-1"}},[i("div",{staticClass:"h-image-viewer__mask",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleMaskClick(t)}}}),e._v(" "),i("span",{staticClass:"h-image-viewer__btn h-image-viewer__close",on:{click:e.hide}},[i("a-icon",{attrs:{type:"close"}})],1),e._v(" "),e.isSingle?e._e():[i("span",{staticClass:"h-image-viewer__btn h-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[i("a-icon",{attrs:{type:"arrow-left"}})],1),e._v(" "),i("span",{staticClass:"h-image-viewer__btn h-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[i("a-icon",{attrs:{type:"arrow-right"}})],1)],e._v(" "),i("div",{staticClass:"h-image-viewer__btn h-image-viewer__actions"},[i("div",{staticClass:"h-image-viewer__actions__inner"},[i("a-icon",{attrs:{type:"zoom-out"},on:{click:function(t){return e.handleActions("zoomOut")}}}),e._v(" "),i("a-icon",{attrs:{type:"zoom-in"},on:{click:function(t){return e.handleActions("zoomIn")}}}),e._v(" "),i("a-icon",{attrs:{type:"undo"},on:{click:function(t){return e.handleActions("anticlocelise")}}}),e._v(" "),i("a-icon",{attrs:{type:"redo"},on:{click:function(t){return e.handleActions("clocelise")}}}),e._v(" "),e.showDown?i("a-icon",{attrs:{type:"download"},on:{click:e.download}}):e._e()],1)]),e._v(" "),i("div",{staticClass:"h-image-viewer__canvas"},[e._l(e.picList,(function(t){return i("img",{key:t,ref:"img",refInFor:!0,staticClass:"h-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:e.handleMouseDown}})})),e._v(" "),e.loading?i("a-icon",{staticClass:"h-image-loading",attrs:{type:"loading"}}):e._e()],2)],2)])};ge._withStripped=!0;const ve=ee({render:ge,staticRenderFns:[]},void 0,me,void 0,!1,void 0,!1,void 0,void 0,void 0);var we="",ye=function(){return void 0!==document.documentElement.style.objectFit},_e=function(e,t){return be(e,null!==t||void 0!==t?t?"overflow-y":"overflow-x":"overflow").match(/(scroll|auto)/)},be=function(e,t){return(window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle)[t]},Le="none",Ie="contain",xe="cover",Se="fill",Ce="scale-down",$e={name:"HImage",inheritAttrs:!1,props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewBtn:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},showDown:{type:Boolean,default:!1},initial:{type:Number,default:0},prefix:{type:[Boolean,String],default:!0},popover:{type:Boolean,default:!1},popoverConfig:{type:Object,default:function(){return{placement:"right",trigger:"hover",width:"200px",height:"100%"}}}},components:{IconFontBox:ne,IconFont:q.default,ImageViewer:ve},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1,imageSrc:""}},provide:function(){return{download:this.download}},computed:{imgHost:function(){return this.$config?this.$config.cosPrefix:""},imageStyle:function(){var e=this.fit;return window&&e?ye()?{"object-fit":e}:this.getImageStyle(e):{}},alignCenter:function(){return window&&!ye()&&this.fit!==Se},preview:function(){var e=this.previewSrcList;return Array.isArray(e)&&e.length>0},imageIndex:function(){var e=this.initial||0,t=this.previewSrcList.indexOf(this.src);return t>=0&&(e=t),e}},watch:{src:function(){this.imageSrc=this.exchangeImage(),this.show&&this.loadImage()},show:function(e){e&&this.loadImage()}},mounted:function(){this.imageSrc=this.exchangeImage(),this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{exchangeImage:function(){var e=this.src,t=this.prefix;if(!e)return e;if(/(http|https):\/\//.test(e))return e;var i="";"string"==typeof t?i=t:t&&(i=this.imgHost);var n=e.indexOf("/")>0;return"".concat(i).concat(n?"/":"").concat(e)},handleLazyLoad:function(){var e,t,i,n;e=this.$el,t=this._scrollContainer,n=e.getBoundingClientRect(),i=[window,document,document.documentElement,null,void 0].includes(t)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:t.getBoundingClientRect(),n.top<i.bottom&&n.bottom>i.top&&n.right>i.left&&n.left<i.right&&(this.show=!0,this.removeLazyLoadListener())},download:function(e){this.$emit("download",e)},addLazyLoadListener:function(){var e,t,i=this.scrollContainer,n=null;(t=i)&&t.nodeType===Node.ELEMENT_NODE?n=i:(e=i,n="[object String]"===Object.prototype.toString.call(e)?document.querySelector(n):function(e){for(var t=e;t;){if([window,document,document.documentElement].includes(parent))return window;if(_e(t))return t;t=t.parentNode}return t}(this.$el)),n&&(this._scrollContainer=n,this._lazyLoadHandler=function(e,t,i,n){var r,o=!1,s=0;function a(){r&&clearTimeout(r)}function l(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=this,f=Date.now()-s;function h(){s=Date.now(),i.apply(u,c)}function p(){r=void 0}o||(n&&!r&&h(),a(),void 0===n&&f>e?h():!0!==t&&(r=setTimeout(n?p:h,void 0===n?e-f:e)))}return"boolean"!=typeof t&&(n=i,i=t,t=void 0),l.cancel=function(){a(),o=!0},l}(200,this.handleLazyLoad),n.addEventListener("scroll",this._lazyLoadHandler,!1),this.handleLazyLoad())},removeLazyLoadListener:function(){var e=this._scrollContainer,t=this._lazyLoadHandler;!this.$isServer&&e&&t&&(e.removeEventListener("scroll",t),this._scrollContainer=null,this._lazyLoadHandler=null)},loadImage:function(){var e=this;if(window){this.loading=!0,this.error=!1;var t=new Image;t.onload=function(i){return e.handleLoad(i,t)},t.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(i){var n=e.$attrs[i];t.setAttribute(i,n)})),t.src=this.imageSrc}},handleLoad:function(e,t){this.imageWidth=t.width,this.imageHeight=t.height,this.loading=!1,this.error=!1},handleError:function(e){this.loading=!1,this.error=!0,this.$emit("error",e)},getImageStyle:function(e){var t=this.imageWidth,i=this.imageHeight,n=this.$el,r=n.clientWidth,o=n.clientHeight;if(!(t&&i&&r&&o))return{};var s=t/i<1;switch(e===Ce&&(e=t<r&&i<o?Le:Ie),e){case Le:return{width:"auto",height:"auto"};case Ie:return s?{width:"auto"}:{height:"auto"};case xe:return s?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(e){!this.preview&&this.previewBtn||this.openViewer()},openViewer:function(){we=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closeViewer:function(){document.body.style.overflow=we,this.showViewer=!1}}};const ke=$e;var Oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"a-image"},[e.loading?e._t("placeholder",[i("div",{staticClass:"a-image__placeholder"},[e._t("loading",[i("a-icon",{staticClass:"placeholder-icon",attrs:{type:"picture"}})])],2)]):e.error&&e.src?e._t("error",[i("div",{staticClass:"a-image__error"},[i("icon-font",{staticClass:"img-icon",attrs:{type:"icontupianjiazaishibai"}})],1)]):e.popover&&e.src?i("a-popover",{attrs:{placement:e.popoverConfig.placement,trigger:e.popoverConfig.trigger}},[i("template",{slot:"content"},[i("img",{style:{width:e.popoverConfig.width,height:e.popoverConfig.height},attrs:{src:e.src}})]),e._v(" "),i("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners))],2):e.src?i("img",e._g(e._b({staticClass:"a-image__inner",class:{"a-image__inner--center":e.alignCenter,"a-image__preview":e.preview},style:e.imageStyle,attrs:{src:e.imageSrc},on:{click:e.clickHandler}},"img",e.$attrs,!1),e.$listeners)):e.src?e._e():e._t("none",[i("div",{staticClass:"a-image__none"},[i("icon-font",{staticClass:"img-icon",attrs:{type:"iconzanwutupian2"}})],1)]),e._v(" "),e.preview?[e.showViewer?i("image-viewer",{attrs:{"z-index":e.zIndex,"initial-index":e.imageIndex,"on-close":e.closeViewer,showDown:e.showDown,"url-list":e.previewSrcList,prefix:e.prefix,host:e.imgHost},on:{download:e.download}}):e._e()]:e._e()],2)};Oe._withStripped=!0;const ze=ee({render:Oe,staticRenderFns:[]},void 0,ke,void 0,!1,void 0,!1,void 0,void 0,void 0);function Ue(e){for(var t=1,i=arguments.length;t<i;t++){var n=arguments[t]||{};for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];void 0!==o&&(e[r]=o)}}return e}var Pe={zIndex:2e3,initialIndex:0,urlList:[]},Ee=J.default.extend(ve);ze.install=function(e){e.component(ze.name,ze)},ze.api=function(e){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Ue({},Pe,e);var t=new Ee({el:document.createElement("div"),propsData:e,methods:{hide:function(){this.deviceSupportUninstall(),this.$el.parentNode.removeChild(this.$el)},download:function(){e.download&&e.download(this.currentImg)}}}),i=e.body?document.body:e.target;console.log(i),document.body.appendChild(t.$el)}(e)};var Ae=(localStorage.getItem("Access-Token")||"").replace(/\"/g,""),je=X.default.create({timeout:3e5});je.interceptors.request.use((function(e){return Ae&&(e.headers.Authorization="Bearer ".concat(Ae)),e}));var Ne={name:"Upload",props:{isFailReplace:Boolean,maxImg:{type:Number,default:20},baseUrl:{type:String,default:"/api/v1/fileservice/files/advanceduploadbusiness"},previewUrl:{type:String,default:"/api/v1/fileservice/previwe/file_not_check_status"},isSubmit:{type:Boolean,default:!0}},data:function(){return this.Authorization="Bearer ".concat(Ae),{accept:"image/png, image/jpeg, image/jpg, image/gif",illegalCode:"",errorIndex:-1,fileListUploadList:[],fileList:[],pictureGroupList:[],businesParams:{},isStart:!0,isOverisOverMaxLimite:!1,uploadedList:[],form:{group:""},rules:{group:[{required:!0,message:"请选择",trigger:"change"}]}}},inject:{isExpire:{default:1}},components:{HImage:ze},mounted:function(){this.isExpireParam=void 0!==this.$attrs.isExpire?this.$attrs.isExpire:this.isExpire,this.loadPictureGroup()},computed:{uploadNumInfo:function(){return this.$emit("success",this.fileList),this.fileList.reduce((function(e,t){return"done"===t.status&&e.done++,"error"===t.status&&e.error++,"illegal"===t.status&&e.illegal++,e}),{done:0,error:0,illegal:0})}},methods:{loadPictureGroup:function(){var e=this;this.$get("/api/v1/fileservice/material/get_upload_business_id").then((function(t){var i=t.data;e.businesParams=i,e.businesParams.isExpire=e.isExpireParam})),this.$get("/api/v1/fileservice/group/get_group_statistics",{groupType:1}).then((function(t){var i=t.data;i.groups.unshift({groupName:"未分组",groupId:0,storageNum:i.notGroupNum}),e.pictureGroupList=i.groups,e.form.group=0}))},loadPreviewPicture:function(e,t){var i=this,n=e.mediaId,r=e.corpId,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.previewUrl;je.post(s,{mediaId:n,corpId:r}).then((function(e){"SYS_0000"===e.data.code?(i.fileList[t].imageUrl=e.data.data.url+"&imageView2/1/w/100/h/100/q/85",i.fileList[t].mediaId=e.data.data.mediaId,i.uploadedList.push(e.data.data)):i.fileList[t].status="error",o?i.fileList.filter((function(e){return["error","done","illegal"].includes(e.status)})).length===i.fileListUploadList.length&&i.$emit("ultipleSuccess",i.fileList):i.$emit("singleSuccess",i.fileList)})).catch((function(){i.fileList[t].status="error"}))},singleChange:function(e){var t=e.file,i=t.status,n=t.percent,r=t.response;"done"===i&&r&&r.data&&100===n&&this.loadPreviewPicture({mediaId:r.data.mediaId,corpId:this.businesParams.corpId||""},this.errorIndex,!1),this.fileList[this.errorIndex].status=i,this.fileList[this.errorIndex].progress=n,this.fileListUploadList.splice(this.errorIndex,1,e.file)},ultipleChange:function(e){var t=e.file,i=t.response,n=t.percent,r=t.status,o=t.uid,s=e.fileList;if(i&&"SYS_0006"==i.code&&window.location.replace("".concat(window.location.origin,"/pmweb/user/login-result?status=3")),this.isStart||(this.isStart=!0),!this.isOverisOverMaxLimite)try{this.fileListUploadList=s;var a=this.fileList.findIndex((function(e){return e.uid===o}));if(i&&"SYS_0000"!==i.code)return this.$message.error(i.message),this.fileList[a].status=i.code===this.illegalCode?"illegal":"error",this.fileList.filter((function(e){return["error","done","illegal"].includes(e.status)})).length===this.fileListUploadList.length&&this.$emit("ultipleSuccess",this.fileList),!1;if("done"===r&&i&&i.data){var l=i.data.mediaId;this.loadPreviewPicture({mediaId:l,corpId:this.businesParams.corpId||""},a)}this.fileList[a].status=r,this.fileList[a].progress=n}catch(e){console.error(e)}},beforeUploadUltiple:function(e,t){var i=e.name.slice(e.name.lastIndexOf(".")+1);if(!["png","jpg","gif","jpeg"].includes(i))return this.$message.error("上传图片格式错误！"),Promise.reject();if(e.size/1024/1024>10)return this.$message.error("图片超出单个文件限制大小，请调整后重新上传"),Promise.reject();if(this.isStart&&(this.isOverisOverMaxLimite=!1),this.isOverisOverMaxLimite)return!1;if(this.isStart){if(t.length+this.fileList.length>this.maxImg)return this.$message.error("最多上传图片"+this.maxImg+"张"),this.isStart=!1,this.isOverisOverMaxLimite=!0,!1;var n,r=t.map((function(e){return{name:e.name,uid:e.uid,status:"uploading",progress:3,imageUrl:"",mediaId:"",file:e}}));(n=this.fileList).push.apply(n,Z(r)),this.isStart=!1}},beforeUploadSingle:function(e){var t=e.size,i=e.name,n=e.uid,r=i.slice(i.lastIndexOf(".")+1);return["png","jpg","gif","jpeg"].includes(r)?t/1024/1024>10?(this.$message.error("图片超出单个文件限制大小，请调整后重新上传"),Promise.reject()):void this.$set(this.fileList,this.errorIndex,{name:i,uid:n,status:"uploading",progress:3,imageUrl:"",mediaId:""}):(this.$message.error("上传图片格式错误！"),Promise.reject())},reUpload:function(){var e,t,i=this;je({url:this.baseUrl,method:"post",onUploadProgress:function(e){var t=e.lengthComputable,n=e.loaded,r=e.total;t&&(i.fileList[i.errorIndex].progress=n/r*100)},data:(e={isExpire:this.isExpireParam,corpId:this.businesParams.corpId||"",businessId:this.businesParams.businessId,file:this.fileList[this.errorIndex].file},t=Object.keys(e).reduce((function(t,i){return!t.append(i,e[i])&&t}),new FormData),t.check=function(){return e},t)}).then((function(e){if(e.data.code&&"SYS_0000"===e.data.code){var t=e.data.data.mediaId;i.loadPreviewPicture({mediaId:t,corpId:i.businesParams.corpId||""},i.errorIndex,!1),i.fileList[i.errorIndex].status="done",i.$emit("singleSuccess",i.fileList)}else i.$message.error(e.data.message),i.fileList[i.errorIndex].status=e.data.code===i.illegalCode?"illegal":"error",i.$emit("singleFail",i.fileList)})).catch((function(){i.fileList[i.errorIndex].status="error",i.$emit("singleFail",i.fileList)}))},handleRestUpload:function(e){this.errorIndex=e,this.isFailReplace?document.querySelector(".upload input").click():(this.fileList[e].progress=0,this.fileList[e].status="uploading",this.fileList[e].imageUrl="",this.reUpload())},handleDel:function(e,t){var i=this;if(e){var n={corpId:this.businesParams.corpId,mediaIdList:[e]};this.$post("/api/v1/fileservice/objects/deletebykey",n,{isRemovePending:!1}).then((function(){i.fileList.splice(t,1),i.uploadedList.splice(t,1),i.fileListUploadList.splice(t,1),i.$emit("ultipleSuccess",i.fileList)}))}else this.fileList.splice(t,1),this.uploadedList.splice(t,1),this.fileListUploadList.splice(t,1)},save:function(e){var t=this;if(null===this.form.groupId)return this.$message.error("请选择分组"),void(e&&e(!1));var i=this.fileList.filter((function(e){return"error"!==e})).map((function(e){return{preViewUrl:e.imageUrl}}));if(!i.length)return this.$message.error("请上传图片"),void(e&&e(!1));if(this.isSubmit){var n={businessId:this.businesParams.businessId,groupId:this.form.group,isExpire:this.isExpireParam};this.$post("/api/v1/fileservice/material/submit_pic_material",n).then((function(n){var r=n.code,o=n.message;if("SYS_0000"===r)try{e&&e(!0,i,t.uploadedList.map((function(e){return e.storageId=e.fileId,e.preViewUrl=e.url,e})))}catch(t){e&&e(!0,i)}else t.$message.error(o),e&&e(!1)})).catch((function(t){console.error(t),e&&e(!1)}))}else try{e&&e(!0,i,this.uploadedList.map((function(e){return e.storageId=e.fileId,e.preViewUrl=e.url,e})))}catch(t){e&&e(!0,i)}},getData:function(){return{fileList:this.fileList.filter((function(e){return"error"!==e})),groupId:this.form.group,businessId:this.businesParams}}}};const De=Ne;var Fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-image"},[e.fileList.length?i("div",{staticClass:"upload-info"},[i("a-icon",{staticClass:"info-circle",attrs:{type:"info-circle"}}),e._v(" "),i("span",{staticClass:"text-info"},[e._v("已上传成功"+e._s(e.uploadNumInfo.done)+"张，失败"+e._s(e.uploadNumInfo.error)+"张，违规"+e._s(e.uploadNumInfo.illegal)+"张")])],1):e._e(),e._v(" "),i("div",{staticClass:"select-item"},[i("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,labelAlign:"right",layout:"inline"}},[i("a-form-model-item",{attrs:{label:"图片分组",prop:"group"}},[i("a-select",{staticStyle:{width:"275px"},attrs:{"default-value":"请选择"},model:{value:e.form.group,callback:function(t){e.$set(e.form,"group",t)},expression:"form.group"}},e._l(e.pictureGroupList,(function(t){return i("a-select-option",{key:t.groupId,attrs:{value:t.groupId}},[e._v(e._s(t.groupName))])})),1)],1)],1)],1),e._v(" "),i("div",{staticClass:"upload-list"},[i("div",{staticClass:"image-list"},e._l(e.fileList,(function(t,n){return i("div",{key:n,class:["image-item",t.status,"done"===t.status?"":"border"]},["uploading"===t.status?i("div",{staticClass:"pending"},[i("div",{staticClass:"text"},[e._v("上传中")]),e._v(" "),i("div",{staticClass:"progress-bar"},[i("div",{staticClass:"bar",style:{width:(t.progress||2)+"%"}})])]):"illegal"===t.status?i("div",{staticClass:"illegal"},[i("div",{staticClass:"text illegal-text",staticStyle:{color:"#fff"}},[e._v("图片包含敏感信息")])]):"error"===t.status?i("div",{staticClass:"fail",on:{click:function(t){return e.handleRestUpload(n)}}},[i("div",{staticClass:"text"},[e._v("上传失败")]),e._v(" "),i("a-icon",{staticClass:"relaod",attrs:{type:"reload"}})],1):t.imageUrl?i("h-image",{staticClass:"image",attrs:{fit:"cover",src:t.imageUrl}}):e._e(),e._v(" "),"uploading"!==t.status?i("div",{staticClass:"del",on:{click:function(i){return e.handleDel(t.mediaId,n)}}},[i("a-icon",{attrs:{type:"close-circle"}})],1):e._e()],1)})),0),e._v(" "),i("a-upload-dragger",{ref:"upload",staticClass:"uploadRef",attrs:{name:"file",accept:e.accept,multiple:!0,action:e.baseUrl,headers:{Authorization:e.Authorization},data:e.businesParams,beforeUpload:e.beforeUploadUltiple,fileList:e.fileListUploadList,showUploadList:!1},on:{change:e.ultipleChange}},[i("p",{staticClass:"ant-upload-hint"},[i("a-icon",{attrs:{slot:"indicator",type:"upload"},slot:"indicator"}),e._v("\n        点击上传或将文件拖拽至框内上传\n      ")],1)]),e._v(" "),i("a-upload-dragger",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"upload",attrs:{name:"file",accept:e.accept,headers:{Authorization:e.Authorization},data:e.businesParams,action:e.baseUrl,beforeUpload:e.beforeUploadSingle,showUploadList:!1},on:{change:e.singleChange}}),e._v(" "),i("p",{staticClass:"uplaod-tips"},[e._v("支持PNG、JPG、JPEG、GIF格式图片，建议不超过5M。")])],1)])};Fe._withStripped=!0;const He=ee({render:Fe,staticRenderFns:[]},void 0,De,void 0,!1,void 0,!1,void 0,void 0,void 0);return He.install=function(e){e.component(He.name,He)},He}))},c740:function(e,t,i){"use strict";var n=i("23e7"),r=i("b727").findIndex,o=i("44d2"),s="findIndex",a=!0;s in[]&&Array(1)[s]((function(){a=!1})),n({target:"Array",proto:!0,forced:a},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},d81d:function(e,t,i){"use strict";var n=i("23e7"),r=i("b727").map,o=i("1dde"),s=o("map");n({target:"Array",proto:!0,forced:!s},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-68ce760a.8bdf2514.js.map