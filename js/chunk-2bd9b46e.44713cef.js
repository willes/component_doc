(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bd9b46e"],{a846:function(t,e,i){!function(e,n){t.exports=n(i("b0c0"),i("ac1f"),i("5319"),i("a9e3"),i("4de4"),i("b64b"),i("caad"),i("2532"),i("d81d"),i("d3b7"),i("b680"),i("fb6a"),i("a434"),i("c740"),i("cfba"),i("bc3a"),i("466d"),i("99af"),i("159b"),i("07ac"),i("2b0e"),i("1276"),i("fd87"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("50f6"))}(0,(function(t,e,i,n,r,o,a,s,l,c,u,d,f,h,p,m,v,g,y,w,b,_,x,L,I,S,C,k,O,z,$,j,E,A,P,F,U,N,T,D,H,R,B,M,Y,G,V){"use strict";function W(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var X=W(p),K=W(m),q=W(b),J=W(V);function Z(t,e,i,n,r,o,a){try{var s=t[o](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,r)}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function tt(t,e){if(t){if("string"==typeof t)return Q(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Q(t,e):void 0}}function et(t){return function(t){if(Array.isArray(t))return Q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,o=[],a=!0,s=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(t,e)||tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nt=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=function(t){var e,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof v?e:v,o=Object.create(r.prototype),a=new O(n||[]);return o._invoke=function(t,e,i){var n=d;return function(r,o){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===r)throw o;return $()}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var s=S(a,i);if(s){if(s===m)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=h;var l=u(t,e,i);if("normal"===l.type){if(n=i.done?p:f,l.arg===m)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=p,i.method="throw",i.arg=l.arg)}}}(t,i,a),o}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",m={};function v(){}function g(){}function y(){}var w={};l(w,o,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(z([])));_&&_!==i&&n.call(_,o)&&(w=_);var x=y.prototype=v.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function i(r,o,a,s){var l=u(t[r],t,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(l.arg)}var r;this._invoke=function(t,n){function o(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(o,o):o()}}function S(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,S(t,i),"throw"===i.method))return m;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=u(n,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,m;var o=r.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,m):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function z(t){if(t){var i=t[o];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return a.next=a}}return{next:$}}function $(){return{value:e,done:!0}}return g.prototype=y,l(x,"constructor",y),l(y,"constructor",g),g.displayName=l(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},L(I.prototype),l(I.prototype,a,(function(){return this})),t.AsyncIterator=I,t.async=function(e,i,n,r,o){void 0===o&&(o=Promise);var a=new I(c(e,i,n,r),o);return t.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(x),l(x,s,"Generator"),l(x,o,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=z,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return s.type="throw",s.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;k(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:z(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}));function rt(t,e,i,n,r,o,a,s,l,c){"boolean"!=typeof a&&(l=s,s=a,a=!1);const u="function"==typeof i?i.options:i;let d;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,r&&(u.functional=!0)),n&&(u._scopeId=n),o?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=d):e&&(d=a?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),d)if(u.functional){const t=u.render;u.render=function(e,i){return d.call(i),t(e,i)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,d):[d]}return i}const ot={name:"IconFontBox",props:{type:{type:String,default:"iconqiyeweixin_021"},height:{type:[String,Number],default:""},color:{type:String,default:""},size:{type:[String,Number],default:"20"},display:{type:String,default:"inline-block"},overflow:{type:String,default:"hidden"}},components:{IconFont:X.default},methods:{handleClick:function(){this.$emit("click")}}};var at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"icon-font-wrap",style:{height:"auto"===t.height?"auto":t.height?t.height+"px":t.size+"px",color:t.color,fontSize:t.size+"px",display:t.display,overflow:t.overflow},on:{click:t.handleClick}},[i("icon-font",{staticClass:"icon-font-box",attrs:{type:t.type}})],1)};at._withStripped=!0;const st=rt({render:at,staticRenderFns:[]},void 0,ot,void 0,!1,void 0,!1,void 0,void 0,void 0);function lt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ct(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ut(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(i),!0).forEach((function(e){lt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ct(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}var ft=q.default.prototype.$isServer,ht=!ft&&document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)},pt=!ft&&document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)};function mt(t){var e=!1;return function(){for(var i=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e||(e=!0,window.requestAnimationFrame((function(){t.apply(i,r),e=!1})))}}"object"!==("undefined"==typeof Int8Array?"undefined":dt(Int8Array))&&(q.default.prototype.$isServer||document.childNodes),q.default.use(J.default);var vt={CONTAIN:{name:"contain",icon:"fullscreen"},ORIGINAL:{name:"original",icon:"fullscreen-exit"}},gt=!q.default.prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",yt={name:"hImageViewer",props:{host:{type:String},urlList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:function(){}},showDown:{type:Boolean,default:!0},onClose:{type:Function,default:function(){}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},prefix:{type:[Boolean,String],default:!0}},data:function(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!0,mode:vt.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1},baseUrlList:[]}},computed:{picList:function(){var t=this;return this.urlList.filter((function(e,i){return i===t.index}))},isSingle:function(){return this.urlList.length<=1},isFirst:function(){return 0===this.index},isLast:function(){return this.index===this.urlList.length-1},currentImg:function(){return this.baseUrlList[this.index]},imgStyle:function(){var t=this.transform,e=t.scale,i=t.deg,n=t.offsetX,r=t.offsetY,o=t.enableTransition,a={transform:"scale(".concat(e,") rotate(").concat(i,"deg)"),transition:o?"transform .3s":"","margin-left":"".concat(n,"px"),"margin-top":"".concat(r,"px")};return this.mode===vt.CONTAIN&&(a.maxWidth=a.maxHeight="100%"),a}},watch:{index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg:function(){var t=this;this.$nextTick((function(){t.$refs.img[0].complete||(t.loading=!0)}))},urlList:{handler:function(){this.exchangeImage()},deep:!0}},methods:{exchangeImage:function(){var t=this.prefix,e=this.baseUrlList,i="";"string"==typeof t?i=t:t&&(i=this.host);for(var n=0;n<this.urlList.length;n++){var r=this.urlList[n];if(/(http|https):\/\//.test(r))e.push(r);else{var o=r.indexOf("/")>0?"/":"";e.push("".concat(i).concat(o?"/":"").concat(r))}}},hide:function(){this.deviceSupportUninstall(),this.onClose()},download:function(){this.$emit("download",this.currentImg)},deviceSupportInstall:function(){var t=this;this._keyDownHandler=mt((function(e){switch(e.keyCode){case 27:t.hide();break;case 32:t.toggleMode();break;case 37:t.prev();break;case 38:t.handleActions("zoomIn");break;case 39:t.next();break;case 40:t.handleActions("zoomOut")}})),this._mouseWheelHandler=mt((function(e){(e.wheelDelta?e.wheelDelta:-e.detail)>0?t.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):t.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),ht(document,"keydown",this._keyDownHandler),ht(document,gt,this._mouseWheelHandler)},deviceSupportUninstall:function(){pt(document,"keydown",this._keyDownHandler),pt(document,gt,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad:function(){this.loading=!1},handleImgError:function(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown:function(t){var e=this;if(!this.loading&&0===t.button){var i=this.transform,n=i.offsetX,r=i.offsetY,o=t.pageX,a=t.pageY;this._dragHandler=mt((function(t){e.transform.offsetX=n+t.pageX-o,e.transform.offsetY=r+t.pageY-a})),ht(document,"mousemove",this._dragHandler),ht(document,"mouseup",(function(){pt(document,"mousemove",e._dragHandler)})),t.preventDefault()}},handleMaskClick:function(){this.maskClosable&&this.hide()},reset:function(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode:function(){if(!this.loading){var t=Object.keys(vt),e=(Object.values(vt).indexOf(this.mode)+1)%t.length;this.mode=vt[t[e]],this.reset()}},prev:function(){if(!this.isFirst||this.infinite){var t=this.urlList.length;this.index=(this.index-1+t)%t}},next:function(){if(!this.isLast||this.infinite){var t=this.urlList.length;this.index=(this.index+1)%t}},handleActions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.loading){var i=ut({zoomRate:.2,rotateDeg:90,enableTransition:!0},e),n=i.zoomRate,r=i.rotateDeg,o=i.enableTransition,a=this.transform;switch(t){case"zoomOut":a.scale>.2&&(a.scale=parseFloat((a.scale-n).toFixed(3)));break;case"zoomIn":a.scale=parseFloat((a.scale+n).toFixed(3));break;case"clocelise":a.deg+=r;break;case"anticlocelise":a.deg-=r}a.enableTransition=o}}},mounted:function(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["h-image-viewer__wrapper"].focus(),this.exchangeImage()},destroyed:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}};const wt=yt;var bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"viewer-fade"}},[i("div",{ref:"h-image-viewer__wrapper",staticClass:"h-image-viewer__wrapper",style:{"z-index":t.zIndex},attrs:{tabindex:"-1"}},[i("div",{staticClass:"h-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleMaskClick(e)}}}),t._v(" "),i("span",{staticClass:"h-image-viewer__btn h-image-viewer__close",on:{click:t.hide}},[i("a-icon",{attrs:{type:"close"}})],1),t._v(" "),t.isSingle?t._e():[i("span",{staticClass:"h-image-viewer__btn h-image-viewer__prev",class:{"is-disabled":!t.infinite&&t.isFirst},on:{click:t.prev}},[i("a-icon",{attrs:{type:"arrow-left"}})],1),t._v(" "),i("span",{staticClass:"h-image-viewer__btn h-image-viewer__next",class:{"is-disabled":!t.infinite&&t.isLast},on:{click:t.next}},[i("a-icon",{attrs:{type:"arrow-right"}})],1)],t._v(" "),i("div",{staticClass:"h-image-viewer__btn h-image-viewer__actions"},[i("div",{staticClass:"h-image-viewer__actions__inner"},[i("a-icon",{attrs:{type:"zoom-out"},on:{click:function(e){return t.handleActions("zoomOut")}}}),t._v(" "),i("a-icon",{attrs:{type:"zoom-in"},on:{click:function(e){return t.handleActions("zoomIn")}}}),t._v(" "),i("a-icon",{attrs:{type:"undo"},on:{click:function(e){return t.handleActions("anticlocelise")}}}),t._v(" "),i("a-icon",{attrs:{type:"redo"},on:{click:function(e){return t.handleActions("clocelise")}}}),t._v(" "),t.showDown?i("a-icon",{attrs:{type:"download"},on:{click:t.download}}):t._e()],1)]),t._v(" "),i("div",{staticClass:"h-image-viewer__canvas"},[t._l(t.picList,(function(e){return i("img",{key:e,ref:"img",refInFor:!0,staticClass:"h-image-viewer__img",style:t.imgStyle,attrs:{src:t.currentImg},on:{load:t.handleImgLoad,error:t.handleImgError,mousedown:t.handleMouseDown}})})),t._v(" "),t.loading?i("a-icon",{staticClass:"h-image-loading",attrs:{type:"loading"}}):t._e()],2)],2)])};bt._withStripped=!0;const _t=rt({render:bt,staticRenderFns:[]},void 0,wt,void 0,!1,void 0,!1,void 0,void 0,void 0);var xt="",Lt=function(){return void 0!==document.documentElement.style.objectFit},It=function(t,e){return St(t,null!==e||void 0!==e?e?"overflow-y":"overflow-x":"overflow").match(/(scroll|auto)/)},St=function(t,e){return(window.getComputedStyle?window.getComputedStyle(t,null):t.currentStyle)[e]},Ct="none",kt="contain",Ot="cover",zt="fill",$t="scale-down",jt={name:"HImage",inheritAttrs:!1,props:{src:String,fit:String,lazy:Boolean,scrollContainer:{},previewBtn:{},previewSrcList:{type:Array,default:function(){return[]}},zIndex:{type:Number,default:2e3},showDown:{type:Boolean,default:!1},initial:{type:Number,default:0},prefix:{type:[Boolean,String],default:!0},popover:{type:Boolean,default:!1},popoverConfig:{type:Object,default:function(){return{placement:"right",trigger:"hover",width:"200px",height:"100%"}}}},components:{IconFontBox:st,IconFont:X.default,ImageViewer:_t},data:function(){return{loading:!0,error:!1,show:!this.lazy,imageWidth:0,imageHeight:0,showViewer:!1,imageSrc:""}},provide:function(){return{download:this.download}},computed:{imgHost:function(){return this.$config?this.$config.cosPrefix:""},imageStyle:function(){var t=this.fit;return window&&t?Lt()?{"object-fit":t}:this.getImageStyle(t):{}},alignCenter:function(){return window&&!Lt()&&this.fit!==zt},preview:function(){var t=this.previewSrcList;return Array.isArray(t)&&t.length>0},imageIndex:function(){var t=this.initial||0,e=this.previewSrcList.indexOf(this.src);return e>=0&&(t=e),t}},watch:{src:function(){this.imageSrc=this.exchangeImage(),this.show&&this.loadImage()},show:function(t){t&&this.loadImage()}},mounted:function(){this.imageSrc=this.exchangeImage(),this.lazy?this.addLazyLoadListener():this.loadImage()},beforeDestroy:function(){this.lazy&&this.removeLazyLoadListener()},methods:{exchangeImage:function(){var t=this.src,e=this.prefix;if(!t)return t;if(/(http|https):\/\//.test(t))return t;var i="";"string"==typeof e?i=e:e&&(i=this.imgHost);var n=t.indexOf("/")>0;return"".concat(i).concat(n?"/":"").concat(t)},handleLazyLoad:function(){var t,e,i,n;t=this.$el,e=this._scrollContainer,n=t.getBoundingClientRect(),i=[window,document,document.documentElement,null,void 0].includes(e)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:e.getBoundingClientRect(),n.top<i.bottom&&n.bottom>i.top&&n.right>i.left&&n.left<i.right&&(this.show=!0,this.removeLazyLoadListener())},download:function(t){this.$emit("download",t)},addLazyLoadListener:function(){var t,e,i=this.scrollContainer,n=null;(e=i)&&e.nodeType===Node.ELEMENT_NODE?n=i:(t=i,n="[object String]"===Object.prototype.toString.call(t)?document.querySelector(n):function(t){for(var e=t;e;){if([window,document,document.documentElement].includes(parent))return window;if(It(e))return e;e=e.parentNode}return e}(this.$el)),n&&(this._scrollContainer=n,this._lazyLoadHandler=function(t,e,i,n){var r,o=!1,a=0;function s(){r&&clearTimeout(r)}function l(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=this,f=Date.now()-a;function h(){a=Date.now(),i.apply(d,c)}function p(){r=void 0}o||(n&&!r&&h(),s(),void 0===n&&f>t?h():!0!==e&&(r=setTimeout(n?p:h,void 0===n?t-f:t)))}return"boolean"!=typeof e&&(n=i,i=e,e=void 0),l.cancel=function(){s(),o=!0},l}(200,this.handleLazyLoad),n.addEventListener("scroll",this._lazyLoadHandler,!1),this.handleLazyLoad())},removeLazyLoadListener:function(){var t=this._scrollContainer,e=this._lazyLoadHandler;!this.$isServer&&t&&e&&(t.removeEventListener("scroll",e),this._scrollContainer=null,this._lazyLoadHandler=null)},loadImage:function(){var t=this;if(window){this.loading=!0,this.error=!1;var e=new Image;e.onload=function(i){return t.handleLoad(i,e)},e.onerror=this.handleError.bind(this),Object.keys(this.$attrs).forEach((function(i){var n=t.$attrs[i];e.setAttribute(i,n)})),e.src=this.imageSrc}},handleLoad:function(t,e){this.imageWidth=e.width,this.imageHeight=e.height,this.loading=!1,this.error=!1},handleError:function(t){this.loading=!1,this.error=!0,this.$emit("error",t)},getImageStyle:function(t){var e=this.imageWidth,i=this.imageHeight,n=this.$el,r=n.clientWidth,o=n.clientHeight;if(!(e&&i&&r&&o))return{};var a=e/i<1;switch(t===$t&&(t=e<r&&i<o?Ct:kt),t){case Ct:return{width:"auto",height:"auto"};case kt:return a?{width:"auto"}:{height:"auto"};case Ot:return a?{height:"auto"}:{width:"auto"};default:return{}}},clickHandler:function(t){!this.preview&&this.previewBtn||this.openViewer()},openViewer:function(){xt=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closeViewer:function(){document.body.style.overflow=xt,this.showViewer=!1}}};const Et=jt;var At=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"a-image"},[t.loading?t._t("placeholder",[i("div",{staticClass:"a-image__placeholder"},[t._t("loading",[i("a-icon",{staticClass:"placeholder-icon",attrs:{type:"picture"}})])],2)]):t.error&&t.src?t._t("error",[i("div",{staticClass:"a-image__error"},[i("icon-font",{staticClass:"img-icon",attrs:{type:"icontupianjiazaishibai"}})],1)]):t.popover&&t.src?i("a-popover",{attrs:{placement:t.popoverConfig.placement,trigger:t.popoverConfig.trigger}},[i("template",{slot:"content"},[i("img",{style:{width:t.popoverConfig.width,height:t.popoverConfig.height},attrs:{src:t.src}})]),t._v(" "),i("img",t._g(t._b({staticClass:"a-image__inner",class:{"a-image__inner--center":t.alignCenter,"a-image__preview":t.preview},style:t.imageStyle,attrs:{src:t.imageSrc},on:{click:t.clickHandler}},"img",t.$attrs,!1),t.$listeners))],2):t.src?i("img",t._g(t._b({staticClass:"a-image__inner",class:{"a-image__inner--center":t.alignCenter,"a-image__preview":t.preview},style:t.imageStyle,attrs:{src:t.imageSrc},on:{click:t.clickHandler}},"img",t.$attrs,!1),t.$listeners)):t.src?t._e():t._t("none",[i("div",{staticClass:"a-image__none"},[i("icon-font",{staticClass:"img-icon",attrs:{type:"iconzanwutupian2"}})],1)]),t._v(" "),t.preview?[t.showViewer?i("image-viewer",{attrs:{"z-index":t.zIndex,"initial-index":t.imageIndex,"on-close":t.closeViewer,showDown:t.showDown,"url-list":t.previewSrcList,prefix:t.prefix,host:t.imgHost},on:{download:t.download}}):t._e()]:t._e()],2)};At._withStripped=!0;const Pt=rt({render:At,staticRenderFns:[]},void 0,Et,void 0,!1,void 0,!1,void 0,void 0,void 0);function Ft(t){for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e]||{};for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];void 0!==o&&(t[r]=o)}}return t}var Ut={zIndex:2e3,initialIndex:0,urlList:[]},Nt=q.default.extend(_t);Pt.install=function(t){t.component(Pt.name,Pt)},Pt.api=function(t){!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Ft({},Ut,t);var e=new Nt({el:document.createElement("div"),propsData:t,methods:{hide:function(){this.deviceSupportUninstall(),this.$el.parentNode.removeChild(this.$el)},download:function(){t.download&&t.download(this.currentImg)}}}),i=t.body?document.body:t.target;console.log(i),document.body.appendChild(e.$el)}(t)};var Tt="/gateway/oss-service/api/v1/",Dt=(localStorage.getItem("Access-Token")||"").replace(/\"/g,""),Ht=K.default.create({timeout:3e5});Ht.interceptors.request.use((function(t){return Dt&&(t.headers.Authorization="Bearer ".concat(Dt)),t}));var Rt={name:"AttachmentUpload",components:{IconFont:X.default},props:{isFailReplace:{type:Boolean,default:!1},limit:{type:Number,default:20},list:{type:Array,default:function(){return[]}},propsKey:{type:Object,default:function(){return{fileId:"annexId",primaryKey:"id"}}},cache:{type:Boolean,default:!1}},data:function(){return this.Authorization="Bearer ".concat(Dt),{baseUrl:Tt+"fileservice/files/advanceduploadbusiness",errorIndex:-1,fileListUploadList:[],fileList:[],businesParams:{},isStart:!0,isOverisOverMaxLimite:!1,deleteList:[],loading:!1}},created:function(){this.getUploadBusinessId()},computed:{formateIcon:function(){return function(t){var e={"docx,doc":"icondoc",pdf:"iconpdf","xlsx,csv,xls":"iconxls","zip,rar":"iconzip","bmp,png,jpeg,jpg,gif":"iconimage",mp3:"iconaudio",mp4:"iconmedia","wps,pptx,ppt":"iconppt",txt:"icontxt"};return e[it(Object.keys(e).filter((function(e){return e.includes(t)})),1)[0]]}},showPreview:function(){return function(t){return!["mp3","mp4","zip","rar"].includes(t)}},fileName:function(){return function(t){return t.substring(0,t.lastIndexOf("."))}}},watch:{list:{handler:function(t){t.length&&this.loadPreviewList()},deep:!0}},methods:{loadPreviewList:function(){var t=this,e=this.businesParams.corpId;if(e){var i=this.list.map((function(e){return e[t.propsKey.fileId]}));this.loading=!0,this.fileList=[],this.$post(Tt+"fileservice/objects/list_files_businessId",{businessId:i,corpId:e}).then((function(e){t.fileList=e.data.map((function(e,i){return{fileId:e.businessId,suffix:e.suffix,mediaId:e.id,size:e.filesSize/1024/1024>1?(e.filesSize/1024/1024).toFixed(1)+"M":(e.filesSize/1024).toFixed(1)+"K",url:e.preUrl,name:e.fileName,status:"done",id:t.list[i][t.propsKey.primaryKey]}}))})).finally((function(){t.loading=!1}))}},getUploadBusinessId:function(){var t=this;this.$get(Tt+"fileservice/material/get_upload_business_id").then((function(e){var i=e.data;t.businesParams=i,t.list.length&&t.loadPreviewList()}))},beforeUploadUltiple:function(t,e){var i=t.name.slice(t.name.lastIndexOf(".")+1),n=["docx","doc","pdf","csv","pptx","wps","txt","xlsx","xls","zip","rar","bmp","png","jpeg","jpg","gif","txt","mp3","mp4"];if(!n.includes(i))return this.$message.error("上传附件格式错误！"),Promise.reject();if(t.size/1024/1024>20)return this.$message.error("超出单个文件限制大小，请调整后重新上传"),Promise.reject();if(this.isStart&&(this.isOverisOverMaxLimite=!1),this.isOverisOverMaxLimite)return!1;if(this.isStart){if(e.length+this.fileList.length>this.limit)return this.$message.error("已达当前最大限制数"),this.isStart=!1,this.isOverisOverMaxLimite=!0,!1;var r,o=e.filter((function(t){return t.size/1024/1024<20&&n.includes(t.name.slice(t.name.lastIndexOf(".")+1))})).map((function(t){return{name:t.name,uid:t.uid,status:"uploading",progress:3,url:"",mediaId:"",file:t,suffix:t.name.slice(t.name.lastIndexOf(".")+1),size:t.size/1024/1024>1?(t.size/1024/1024).toFixed(1)+"M":(t.size/1024).toFixed(1)+"K"}}));(r=this.fileList).push.apply(r,et(o)),this.isStart=!1}},beforeUploadSingle:function(t){var e=t.size,i=t.name,n=t.uid,r=i.slice(i.lastIndexOf(".")+1);return["docx","doc","pdf","csv","pptx","wps","txt","xlsx","xls","zip","rar","bmp","png","jpeg","jpg","gif","txt","mp3","mp4"].includes(r)?e/1024/1024>20?(this.$message.error("超出单个文件限制大小，请调整后重新上传"),Promise.reject()):void this.$set(this.fileList,this.errorIndex,{name:i,uid:n,status:"uploading",progress:3,url:"",mediaId:"",suffix:i.slice(i.lastIndexOf(".")+1),size:e/1024/1024>1?(e/1024/1024).toFixed(1)+"M":(e/1024).toFixed(1)+"K"}):(this.$message.error("上传附件格式错误！"),Promise.reject())},singleChange:function(t){var e=t.file,i=e.status,n=e.percent,r=e.response;if("done"===i&&r&&r.data&&100===n){var o=r.data.mediaId;this.loadPreview({mediaId:o,corpId:this.businesParams.corpId||""},this.errorIndex,!1)}this.fileList[this.errorIndex].status=i,this.fileList[this.errorIndex].progress=Math.floor(n),this.fileListUploadList.splice(this.errorIndex,1,t.file)},ultipleChange:function(t){var e=t.file,i=e.response,n=e.percent,r=e.status,o=e.uid,a=t.fileList;if(this.isStart||(this.isStart=!0),!this.isOverisOverMaxLimite)try{this.fileListUploadList=a;var s=this.fileList.findIndex((function(t){return t.uid===o}));if(i&&"SYS_0000"!==i.code)return this.$message.error(i.message),this.fileList[s].status="error",this.fileList.filter((function(t){return["error","done"].includes(t.status)})).length===this.fileListUploadList.length&&this.$emit("ultipleSuccess",this.fileList),!1;"done"===r&&i&&i.data&&100===n&&this.loadPreview({mediaId:i.data.mediaId,corpId:this.businesParams.corpId||""},s),this.fileList[s].status=r,this.fileList[s].progress=Math.floor(n)}catch(t){console.error(t)}},loadPreview:function(t,e){var i=this,n=t.mediaId,r=t.corpId,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a="".concat(Tt,"fileservice/previwe/file_not_check_status");Ht.post(a,{mediaId:n,corpId:r}).then((function(t){"SYS_0000"===t.data.code?(i.fileList[e].url=t.data.data.url,i.fileList[e].mediaId=t.data.data.mediaId,i.fileList[e].fileId=t.data.data.fileId):i.fileList[e].status="error",o?i.fileList.filter((function(t){return["error","done"].includes(t.status)})).length===i.fileListUploadList.length&&i.$emit("ultipleSuccess",i.fileList):i.$emit("singleSuccess",i.fileList)})).catch((function(){i.fileList[e].status="error"}))},handleRestUpload:function(t){this.errorIndex=t,this.isFailReplace?document.querySelector(".upload input").click():(this.fileList[t].progress=0,this.fileList[t].status="uploading",this.fileList[t].url="",this.reUpload())},handleDelete:function(t,e){this.fileList.splice(e,1),this.fileListUploadList.splice(e,1),this.deleteList.push(t)},deleteFile:function(){var t={corpId:this.businesParams.corpId,mediaIdList:this.deleteList};return this.$post(Tt+"fileservice/objects/deletebykey",t,{isRemovePending:!1})},reUpload:function(){var t,e,i=this;Ht({url:this.baseUrl,method:"post",onUploadProgress:function(t){var e=t.lengthComputable,n=t.loaded,r=t.total;e&&(i.fileList[i.errorIndex].progress=n/r*100)},data:(t={corpId:this.businesParams.corpId||"",businessId:this.businesParams.businessId,file:this.fileList[this.errorIndex].file},e=Object.keys(t).reduce((function(e,i){return!e.append(i,t[i])&&e}),new FormData),e.check=function(){return t},e)}).then((function(t){if(t.data.code&&"SYS_0000"===t.data.code){var e=t.data.data.mediaId;i.loadPreview({mediaId:e,corpId:i.businesParams.corpId||""},i.errorIndex,!1),i.fileList[i.errorIndex].status="done",i.$emit("singleSuccess",i.fileList)}else i.$message.error(t.data.message),i.fileList[i.errorIndex].status="error",i.$emit("singleFail",i.fileList)})).catch((function(){i.fileList[i.errorIndex].status="error",i.$emit("singleFail",i.fileList)}))},previewFile:function(t){["bmp","png","jpeg","jpg","gif"].includes(t.suffix)?Pt.api({urlList:[t.url]}):window.open(t.url)},save:function(t){var e,i=this;return(e=nt.mark((function e(){var n,r,o;return nt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=i.fileList.filter((function(t){return"error"!==t.status}))).length){e.next=5;break}return i.$message.error("请上传附件"),t&&t(!1),e.abrupt("return");case 5:if(r={businessId:i.businesParams.businessId,groupId:0},!i.deleteList.length){e.next=9;break}return e.next=9,i.deleteFile();case 9:if(o=i.fileList.every((function(t){return"done"===t.status})),n.filter((function(t){return!t.id})).length){e.next=13;break}return t&&t(o,n),e.abrupt("return");case 13:if(o){e.next=16;break}return t&&t(o,n),e.abrupt("return");case 16:i.$post(Tt+"fileservice/material/submit_pic_material",r).then((function(e){var r=e.code,a=e.message;"SYS_0000"===r?t&&t(o,n):(i.$message.error(a),t&&t(!1))})).catch((function(e){console.error(e),t&&t(!1)}));case 17:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,r){var o=e.apply(t,i);function a(t){Z(o,n,r,a,s,"next",t)}function s(t){Z(o,n,r,a,s,"throw",t)}a(void 0)}))})()}}};const Bt=Rt;var Mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"attachmentUpload"},[i("p",{staticClass:"title"},[t._v("附件")]),t._v(" "),i("div",{staticClass:"file-content"},[i("a-upload-dragger",{ref:"upload",staticClass:"uploadRef",attrs:{name:"file",multiple:!0,headers:{Authorization:t.Authorization},action:t.baseUrl,data:t.businesParams,beforeUpload:t.beforeUploadUltiple,fileList:t.fileListUploadList,showUploadList:!1},on:{change:t.ultipleChange}},[i("p",{staticClass:"ant-upload-hint"},[i("a-icon",{attrs:{slot:"indicator",type:"upload"},slot:"indicator"}),t._v("\n        点击上传或将文件拖拽至框内上传\n      ")],1)]),t._v(" "),i("a-upload-dragger",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"upload",attrs:{name:"file",headers:{Authorization:t.Authorization},data:t.businesParams,action:t.baseUrl,beforeUpload:t.beforeUploadSingle,showUploadList:!1},on:{change:t.singleChange}}),t._v(" "),i("div",{staticClass:"desc"},[t._v("附件最大20M，支持格式：PDF，Word，Excel，Txt，JPG，PNG，BMP，GIF，RAR，ZIP")]),t._v(" "),i("div",{staticClass:"file-list"},[i("a-spin",{staticClass:"spin",attrs:{spinning:t.loading}},[i("a-icon",{staticStyle:{"font-size":"30px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1),t._v(" "),t._l(t.fileList,(function(e,n){return i("div",{key:n,staticClass:"file-item"},[i("icon-font",{staticClass:"file-icon",attrs:{type:t.formateIcon(e.suffix)}}),t._v(" "),i("div",{staticClass:"file-info"},[i("div",{staticClass:"file-name"},[i("span",{staticClass:"name"},[t._v(t._s(t.fileName(e.name)))]),t._v(" "),i("span",[t._v("."+t._s(e.suffix))]),t._v(" "),i("span",{staticClass:"size"},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),"uploading"===e.status?i("div",{staticClass:"progress"},[i("div",{staticClass:"progress-bar"},[i("div",{staticClass:"bar",style:{width:e.progress+"%"}})]),t._v(" "),i("span",{staticClass:"progress-value"},[t._v(t._s(e.progress)+"%")]),t._v(" "),i("span",{staticClass:"delete",on:{click:function(i){return t.handleDelete(e.mediaId,n)}}},[t._v("删除")])]):i("div",{staticClass:"handle-box"},["error"===e.status?i("span",{staticClass:"error-msg"},[t._v("链接超时，上传失败")]):t._e(),t._v(" "),"error"===e.status?i("span",{on:{click:function(e){return t.handleRestUpload(n)}}},[t._v("重新上传")]):t._e(),t._v(" "),"done"===e.status&&t.showPreview(e.suffix)?i("span",{on:{click:function(i){return t.previewFile(e)}}},[t._v("预览")]):t._e(),t._v(" "),i("span",{on:{click:function(i){return t.handleDelete(e.mediaId,n)}}},[t._v("删除")])])])],1)}))],2)],1)])};Mt._withStripped=!0;const Yt=rt({render:Mt,staticRenderFns:[]},void 0,Bt,void 0,!1,void 0,!1,void 0,void 0,void 0);return Yt.install=function(t){t.component(Yt.name,Yt)},Yt}))},ad87:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("attachment-upload",{ref:"uploadAttachment",attrs:{limit:20},on:{ultipleSuccess:t.handleSuccess}})],1)},r=[],o=i("a846"),a=i.n(o),s={name:"attachment",components:{AttachmentUpload:a.a},methods:{handleSuccess:function(t){console.log(t)},handleSubmit:function(){this.$refs.uploadImage.save((function(t,e){t?console.log("保存成功",e):console.log("保存失败")}))}}},l=s,c=i("2877"),u=Object(c["a"])(l,n,r,!1,null,null,null);e["default"]=u.exports},c740:function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").findIndex,o=i("44d2"),a="findIndex",s=!0;a in[]&&Array(1)[a]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},d81d:function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").map,o=i("1dde"),a=o("map");n({target:"Array",proto:!0,forced:!a},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-2bd9b46e.44713cef.js.map